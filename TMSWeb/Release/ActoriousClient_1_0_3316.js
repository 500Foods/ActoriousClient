//***********************************************************************************
// TMS WEB CORE framework code is copyright (c) 2018 - 2021 by tmssoftware.com bvba
// The code or parts of the code cannot be used in any way outside 
// a TMS WEB Core application generated by a licensed user or company.
//***********************************************************************************
var pas = { $libimports: {}};

var rtl = {

  version: 20301,

  quiet: false,
  debug_load_units: false,
  debug_rtti: false,

  $res : {},

  debug: function(){
    if (rtl.quiet || !console || !console.log) return;
    console.log(arguments);
  },

  error: function(s){
    rtl.debug('Error: ',s);
    throw s;
  },

  warn: function(s){
    rtl.debug('Warn: ',s);
  },

  checkVersion: function(v){
    if (rtl.version != v) throw "expected rtl version "+v+", but found "+rtl.version;
  },

  hiInt: Math.pow(2,53),

  hasString: function(s){
    return rtl.isString(s) && (s.length>0);
  },

  isArray: function(a) {
    return Array.isArray(a);
  },

  isFunction: function(f){
    return typeof(f)==="function";
  },

  isModule: function(m){
    return rtl.isObject(m) && rtl.hasString(m.$name) && (pas[m.$name]===m);
  },

  isImplementation: function(m){
    return rtl.isObject(m) && rtl.isModule(m.$module) && (m.$module.$impl===m);
  },

  isNumber: function(n){
    return typeof(n)==="number";
  },

  isObject: function(o){
    var s=typeof(o);
    return (typeof(o)==="object") && (o!=null);
  },

  isString: function(s){
    return typeof(s)==="string";
  },

  getNumber: function(n){
    return typeof(n)==="number"?n:NaN;
  },

  getChar: function(c){
    return ((typeof(c)==="string") && (c.length===1)) ? c : "";
  },

  getObject: function(o){
    return ((typeof(o)==="object") || (typeof(o)==='function')) ? o : null;
  },

  isTRecord: function(type){
    return (rtl.isObject(type) && type.hasOwnProperty('$new') && (typeof(type.$new)==='function'));
  },

  isPasClass: function(type){
    return (rtl.isObject(type) && type.hasOwnProperty('$classname') && rtl.isObject(type.$module));
  },

  isPasClassInstance: function(type){
    return (rtl.isObject(type) && rtl.isPasClass(type.$class));
  },

  hexStr: function(n,digits){
    return ("000000000000000"+n.toString(16).toUpperCase()).slice(-digits);
  },

  m_loading: 0,
  m_loading_intf: 1,
  m_intf_loaded: 2,
  m_loading_impl: 3, // loading all used unit
  m_initializing: 4, // running initialization
  m_initialized: 5,

  module: function(module_name, intfuseslist, intfcode, impluseslist){
    if (rtl.debug_load_units) rtl.debug('rtl.module name="'+module_name+'" intfuses='+intfuseslist+' impluses='+impluseslist);
    if (!rtl.hasString(module_name)) rtl.error('invalid module name "'+module_name+'"');
    if (!rtl.isArray(intfuseslist)) rtl.error('invalid interface useslist of "'+module_name+'"');
    if (!rtl.isFunction(intfcode)) rtl.error('invalid interface code of "'+module_name+'"');
    if (!(impluseslist==undefined) && !rtl.isArray(impluseslist)) rtl.error('invalid implementation useslist of "'+module_name+'"');

    if (pas[module_name])
      rtl.error('module "'+module_name+'" is already registered');

    var r = Object.create(rtl.tSectionRTTI);
    var module = r.$module = pas[module_name] = {
      $name: module_name,
      $intfuseslist: intfuseslist,
      $impluseslist: impluseslist,
      $state: rtl.m_loading,
      $intfcode: intfcode,
      $implcode: null,
      $impl: null,
      $rtti: r
    };
    if (impluseslist) module.$impl = {
          $module: module,
          $rtti: r
        };
  },

  exitcode: 0,

  run: function(module_name){
    try {
      if (!rtl.hasString(module_name)) module_name='program';
      if (rtl.debug_load_units) rtl.debug('rtl.run module="'+module_name+'"');
      rtl.initRTTI();
      var module = pas[module_name];
      if (!module) rtl.error('rtl.run module "'+module_name+'" missing');
      rtl.loadintf(module);
      rtl.loadimpl(module);
      if ((module_name=='program') || (module_name=='library')){
        if (rtl.debug_load_units) rtl.debug('running $main');
        var r = pas[module_name].$main();
        if (rtl.isNumber(r)) rtl.exitcode = r;
      }
    } catch(re) {
      if (!rtl.showUncaughtExceptions) {
        throw re
      } else {  
        if (!rtl.handleUncaughtException(re)) {
          rtl.showException(re);
          rtl.exitcode = 216;
        }  
      }
    } 
    return rtl.exitcode;
  },
  
  showException : function (re) {
    var errMsg = rtl.hasString(re.$classname) ? re.$classname : '';
    errMsg +=  ((errMsg) ? ': ' : '') + (re.hasOwnProperty('fMessage') ? re.fMessage : re);
    alert('Uncaught Exception : '+errMsg);
  },

  handleUncaughtException: function (e) {
    if (rtl.onUncaughtException) {
      try {
        rtl.onUncaughtException(e);
        return true;
      } catch (ee) {
        return false; 
      }
    } else {
      return false;
    }
  },

  loadintf: function(module){
    if (module.$state>rtl.m_loading_intf) return; // already finished
    if (rtl.debug_load_units) rtl.debug('loadintf: "'+module.$name+'"');
    if (module.$state===rtl.m_loading_intf)
      rtl.error('unit cycle detected "'+module.$name+'"');
    module.$state=rtl.m_loading_intf;
    // load interfaces of interface useslist
    rtl.loaduseslist(module,module.$intfuseslist,rtl.loadintf);
    // run interface
    if (rtl.debug_load_units) rtl.debug('loadintf: run intf of "'+module.$name+'"');
    module.$intfcode(module.$intfuseslist);
    // success
    module.$state=rtl.m_intf_loaded;
    // Note: units only used in implementations are not yet loaded (not even their interfaces)
  },

  loaduseslist: function(module,useslist,f){
    if (useslist==undefined) return;
    var len = useslist.length;
    for (var i = 0; i<len; i++) {
      var unitname=useslist[i];
      if (rtl.debug_load_units) rtl.debug('loaduseslist of "'+module.$name+'" uses="'+unitname+'"');
      if (pas[unitname]==undefined)
        rtl.error('module "'+module.$name+'" misses "'+unitname+'"');
      f(pas[unitname]);
    }
  },

  loadimpl: function(module){
    if (module.$state>=rtl.m_loading_impl) return; // already processing
    if (module.$state<rtl.m_intf_loaded) rtl.error('loadimpl: interface not loaded of "'+module.$name+'"');
    if (rtl.debug_load_units) rtl.debug('loadimpl: load uses of "'+module.$name+'"');
    module.$state=rtl.m_loading_impl;
    // load interfaces of implementation useslist
    rtl.loaduseslist(module,module.$impluseslist,rtl.loadintf);
    // load implementation of interfaces useslist
    rtl.loaduseslist(module,module.$intfuseslist,rtl.loadimpl);
    // load implementation of implementation useslist
    rtl.loaduseslist(module,module.$impluseslist,rtl.loadimpl);
    // Note: At this point all interfaces used by this unit are loaded. If
    //   there are implementation uses cycles some used units might not yet be
    //   initialized. This is by design.
    // run implementation
    if (rtl.debug_load_units) rtl.debug('loadimpl: run impl of "'+module.$name+'"');
    if (rtl.isFunction(module.$implcode)) module.$implcode(module.$impluseslist);
    // run initialization
    if (rtl.debug_load_units) rtl.debug('loadimpl: run init of "'+module.$name+'"');
    module.$state=rtl.m_initializing;
    if (rtl.isFunction(module.$init)) module.$init();
    // unit initialized
    module.$state=rtl.m_initialized;
  },

  createCallback: function(scope, fn){
    var cb;
    if (typeof(fn)==='string'){
      if (!scope.hasOwnProperty('$events')) scope.$events = {};
      cb = scope.$events[fn];
      if (cb) return cb;
      scope.$events[fn] = cb = function(){
        return scope[fn].apply(scope,arguments);
      };
    } else {
      cb = function(){
        return fn.apply(scope,arguments);
      };
    };
    cb.scope = scope;
    cb.fn = fn;
    return cb;
  },

  createSafeCallback: function(scope, fn){
    var cb;
    if (typeof(fn)==='string'){
      if (!scope.hasOwnProperty('$events')) scope.$events = {};
      cb = scope.$events[fn];
      if (cb) return cb;
      scope.$events[fn] = cb = function(){
        try{
          return scope[fn].apply(scope,arguments);
        } catch (err) {
          if (!rtl.handleUncaughtException(err)) throw err;
        }
      };
    } else {
      cb = function(){
        try{
          return fn.apply(scope,arguments);
        } catch (err) {
          if (!rtl.handleUncaughtException(err)) throw err;
        }
      };
    };
    cb.scope = scope;
    cb.fn = fn;
    return cb;
  },

  eqCallback: function(a,b){
    // can be a function or a function wrapper
    if (a===b){
      return true;
    } else {
      return (a!=null) && (b!=null) && (a.fn) && (a.scope===b.scope) && (a.fn===b.fn);
    }
  },

  initStruct: function(c,parent,name){
    if ((parent.$module) && (parent.$module.$impl===parent)) parent=parent.$module;
    c.$parent = parent;
    if (rtl.isModule(parent)){
      c.$module = parent;
      c.$name = name;
    } else {
      c.$module = parent.$module;
      c.$name = parent.$name+'.'+name;
    };
    return parent;
  },

  initClass: function(c,parent,name,initfn,rttiname){
    parent[name] = c;
    c.$class = c; // Note: o.$class === Object.getPrototypeOf(o)
    c.$classname = rttiname?rttiname:name;
    parent = rtl.initStruct(c,parent,name);
    c.$fullname = parent.$name+'.'+name;
    // rtti
    if (rtl.debug_rtti) rtl.debug('initClass '+c.$fullname);
    var t = c.$module.$rtti.$Class(c.$classname,{ "class": c });
    c.$rtti = t;
    if (rtl.isObject(c.$ancestor)) t.ancestor = c.$ancestor.$rtti;
    if (!t.ancestor) t.ancestor = null;
    // init members
    initfn.call(c);
  },

  createClass: function(parent,name,ancestor,initfn,rttiname){
    // create a normal class,
    // ancestor must be null or a normal class,
    // the root ancestor can be an external class
    var c = null;
    if (ancestor != null){
      c = Object.create(ancestor);
      c.$ancestor = ancestor;
      // Note:
      // if root is an "object" then c.$ancestor === Object.getPrototypeOf(c)
      // if root is a "function" then c.$ancestor === c.__proto__, Object.getPrototypeOf(c) returns the root
    } else {
      c = { $ancestor: null };
      c.$create = function(fn,args){
        if (args == undefined) args = [];
        var o = Object.create(this);
        o.$init();
        try{
          if (typeof(fn)==="string"){
            o[fn].apply(o,args);
          } else {
            fn.apply(o,args);
          };
          o.AfterConstruction();
        } catch($e){
          // do not call BeforeDestruction
          if (o.Destroy) o.Destroy();
          o.$final();
          throw $e;
        }
        return o;
      };
      c.$destroy = function(fnname){
        this.BeforeDestruction();
        if (this[fnname]) this[fnname]();
        this.$final();
      };
    };
    rtl.initClass(c,parent,name,initfn,rttiname);
  },

  createClassExt: function(parent,name,ancestor,newinstancefnname,initfn,rttiname){
    // Create a class using an external ancestor.
    // If newinstancefnname is given, use that function to create the new object.
    // If exist call BeforeDestruction and AfterConstruction.
    var isFunc = rtl.isFunction(ancestor);
    var c = null;
    if (isFunc){
      // create pascal class descendent from JS function
      c = Object.create(ancestor.prototype);
      c.$ancestorfunc = ancestor;
      c.$ancestor = null; // no pascal ancestor
    } else if (ancestor.$func){
      // create pascal class descendent from a pascal class descendent of a JS function
      isFunc = true;
      c = Object.create(ancestor);
      c.$ancestor = ancestor;
    } else {
      c = Object.create(ancestor);
      c.$ancestor = null; // no pascal ancestor
    }
    c.$create = function(fn,args){
      if (args == undefined) args = [];
      var o = null;
      if (newinstancefnname.length>0){
        o = this[newinstancefnname](fn,args);
      } else if(isFunc) {
        o = new this.$func(args);
      } else {
        o = Object.create(c);
      }
      if (o.$init) o.$init();
      try{
        if (typeof(fn)==="string"){
          this[fn].apply(o,args);
        } else {
          fn.apply(o,args);
        };
        if (o.AfterConstruction) o.AfterConstruction();
      } catch($e){
        // do not call BeforeDestruction
        if (o.Destroy) o.Destroy();
        if (o.$final) o.$final();
        throw $e;
      }
      return o;
    };
    c.$destroy = function(fnname){
      if (this.BeforeDestruction) this.BeforeDestruction();
      if (this[fnname]) this[fnname]();
      if (this.$final) this.$final();
    };
    rtl.initClass(c,parent,name,initfn,rttiname);
    if (isFunc){
      function f(){}
      f.prototype = c;
      c.$func = f;
    }
  },

  createHelper: function(parent,name,ancestor,initfn,rttiname){
    // create a helper,
    // ancestor must be null or a helper,
    var c = null;
    if (ancestor != null){
      c = Object.create(ancestor);
      c.$ancestor = ancestor;
      // c.$ancestor === Object.getPrototypeOf(c)
    } else {
      c = { $ancestor: null };
    };
    parent[name] = c;
    c.$class = c; // Note: o.$class === Object.getPrototypeOf(o)
    c.$classname = rttiname?rttiname:name;
    parent = rtl.initStruct(c,parent,name);
    c.$fullname = parent.$name+'.'+name;
    // rtti
    var t = c.$module.$rtti.$Helper(c.$classname,{ "helper": c });
    c.$rtti = t;
    if (rtl.isObject(ancestor)) t.ancestor = ancestor.$rtti;
    if (!t.ancestor) t.ancestor = null;
    // init members
    initfn.call(c);
  },

  tObjectDestroy: "Destroy",

  free: function(obj,name){
    if (obj[name]==null) return null;
    obj[name].$destroy(rtl.tObjectDestroy);
    obj[name]=null;
  },

  freeLoc: function(obj){
    if (obj==null) return null;
    obj.$destroy(rtl.tObjectDestroy);
    return null;
  },

  hideProp: function(o,p,v){
    Object.defineProperty(o,p, {
      enumerable: false,
      configurable: true,
      writable: true
    });
    if(arguments.length>2){ o[p]=v; }
  },

  recNewT: function(parent,name,initfn,full){
    // create new record type
    var t = {};
    if (parent) parent[name] = t;
    var h = rtl.hideProp;
    if (full){
      rtl.initStruct(t,parent,name);
      t.$record = t;
      h(t,'$record');
      h(t,'$name');
      h(t,'$parent');
      h(t,'$module');
      h(t,'$initSpec');
    }
    initfn.call(t);
    if (!t.$new){
      t.$new = function(){ return Object.create(t); };
    }
    t.$clone = function(r){ return t.$new().$assign(r); };
    h(t,'$new');
    h(t,'$clone');
    h(t,'$eq');
    h(t,'$assign');
    return t;
  },

  is: function(instance,type){
    return type.isPrototypeOf(instance) || (instance===type);
  },

  isExt: function(instance,type,mode){
    // mode===1 means instance must be a Pascal class instance
    // mode===2 means instance must be a Pascal class
    // Notes:
    // isPrototypeOf and instanceof return false on equal
    // isPrototypeOf does not work for Date.isPrototypeOf(new Date())
    //   so if isPrototypeOf is false test with instanceof
    // instanceof needs a function on right side
    if (instance == null) return false; // Note: ==null checks for undefined too
    if ((typeof(type) !== 'object') && (typeof(type) !== 'function')) return false;
    if (instance === type){
      if (mode===1) return false;
      if (mode===2) return rtl.isPasClass(instance);
      return true;
    }
    if (type.isPrototypeOf && type.isPrototypeOf(instance)){
      if (mode===1) return rtl.isPasClassInstance(instance);
      if (mode===2) return rtl.isPasClass(instance);
      return true;
    }
    if ((typeof type == 'function') && (instance instanceof type)) return true;
    return false;
  },

  Exception: null,
  EInvalidCast: null,
  EAbstractError: null,
  ERangeError: null,
  EIntOverflow: null,
  EPropWriteOnly: null,

  raiseE: function(typename){
    var t = rtl[typename];
    if (t==null){
      var mod = pas.SysUtils;
      if (!mod) mod = pas.sysutils;
      if (mod){
        t = mod[typename];
        if (!t) t = mod[typename.toLowerCase()];
        if (!t) t = mod['Exception'];
        if (!t) t = mod['exception'];
      }
    }
    if (t){
      if (t.Create){
        throw t.$create("Create");
      } else if (t.create){
        throw t.$create("create");
      }
    }
    if (typename === "EInvalidCast") throw "invalid type cast";
    if (typename === "EAbstractError") throw "Abstract method called";
    if (typename === "ERangeError") throw "range error";
    throw typename;
  },

  as: function(instance,type){
    if((instance === null) || rtl.is(instance,type)) return instance;
    rtl.raiseE("EInvalidCast");
  },

  asExt: function(instance,type,mode){
    if((instance === null) || rtl.isExt(instance,type,mode)) return instance;
    rtl.raiseE("EInvalidCast");
  },

  createInterface: function(module, name, guid, fnnames, ancestor, initfn){
    //console.log('createInterface name="'+name+'" guid="'+guid+'" names='+fnnames);
    var i = ancestor?Object.create(ancestor):{};
    module[name] = i;
    i.$module = module;
    i.$name = name;
    i.$fullname = module.$name+'.'+name;
    i.$guid = guid;
    i.$guidr = null;
    i.$names = fnnames?fnnames:[];
    if (rtl.isFunction(initfn)){
      // rtti
      if (rtl.debug_rtti) rtl.debug('createInterface '+i.$fullname);
      var t = i.$module.$rtti.$Interface(name,{ "interface": i, module: module });
      i.$rtti = t;
      if (ancestor) t.ancestor = ancestor.$rtti;
      if (!t.ancestor) t.ancestor = null;
      initfn.call(i);
    }
    return i;
  },

  strToGUIDR: function(s,g){
    var p = 0;
    function n(l){
      var h = s.substr(p,l);
      p+=l;
      return parseInt(h,16);
    }
    p+=1; // skip {
    g.D1 = n(8);
    p+=1; // skip -
    g.D2 = n(4);
    p+=1; // skip -
    g.D3 = n(4);
    p+=1; // skip -
    if (!g.D4) g.D4=[];
    g.D4[0] = n(2);
    g.D4[1] = n(2);
    p+=1; // skip -
    for(var i=2; i<8; i++) g.D4[i] = n(2);
    return g;
  },

  guidrToStr: function(g){
    if (g.$intf) return g.$intf.$guid;
    var h = rtl.hexStr;
    var s='{'+h(g.D1,8)+'-'+h(g.D2,4)+'-'+h(g.D3,4)+'-'+h(g.D4[0],2)+h(g.D4[1],2)+'-';
    for (var i=2; i<8; i++) s+=h(g.D4[i],2);
    s+='}';
    return s;
  },

  createTGUID: function(guid){
    var TGuid = (pas.System)?pas.System.TGuid:pas.system.tguid;
    var g = rtl.strToGUIDR(guid,TGuid.$new());
    return g;
  },

  getIntfGUIDR: function(intfTypeOrVar){
    if (!intfTypeOrVar) return null;
    if (!intfTypeOrVar.$guidr){
      var g = rtl.createTGUID(intfTypeOrVar.$guid);
      if (!intfTypeOrVar.hasOwnProperty('$guid')) intfTypeOrVar = Object.getPrototypeOf(intfTypeOrVar);
      g.$intf = intfTypeOrVar;
      intfTypeOrVar.$guidr = g;
    }
    return intfTypeOrVar.$guidr;
  },

  addIntf: function (aclass, intf, map){
    function jmp(fn){
      if (typeof(fn)==="function"){
        return function(){ return fn.apply(this.$o,arguments); };
      } else {
        return function(){ rtl.raiseE('EAbstractError'); };
      }
    }
    if(!map) map = {};
    var t = intf;
    var item = Object.create(t);
    if (!aclass.hasOwnProperty('$intfmaps')) aclass.$intfmaps = {};
    aclass.$intfmaps[intf.$guid] = item;
    do{
      var names = t.$names;
      if (!names) break;
      for (var i=0; i<names.length; i++){
        var intfname = names[i];
        var fnname = map[intfname];
        if (!fnname) fnname = intfname;
        //console.log('addIntf: intftype='+t.$name+' index='+i+' intfname="'+intfname+'" fnname="'+fnname+'" old='+typeof(item[intfname]));
        item[intfname] = jmp(aclass[fnname]);
      }
      t = Object.getPrototypeOf(t);
    }while(t!=null);
  },

  getIntfG: function (obj, guid, query){
    if (!obj) return null;
    //console.log('getIntfG: obj='+obj.$classname+' guid='+guid+' query='+query);
    // search
    var maps = obj.$intfmaps;
    if (!maps) return null;
    var item = maps[guid];
    if (!item) return null;
    // check delegation
    //console.log('getIntfG: obj='+obj.$classname+' guid='+guid+' query='+query+' item='+typeof(item));
    if (typeof item === 'function') return item.call(obj); // delegate. Note: COM contains _AddRef
    // check cache
    var intf = null;
    if (obj.$interfaces){
      intf = obj.$interfaces[guid];
      //console.log('getIntfG: obj='+obj.$classname+' guid='+guid+' cache='+typeof(intf));
    }
    if (!intf){ // intf can be undefined!
      intf = Object.create(item);
      intf.$o = obj;
      if (!obj.$interfaces) obj.$interfaces = {};
      obj.$interfaces[guid] = intf;
    }
    if (typeof(query)==='object'){
      // called by queryIntfT
      var o = null;
      if (intf.QueryInterface(rtl.getIntfGUIDR(query),
          {get:function(){ return o; }, set:function(v){ o=v; }}) === 0){
        return o;
      } else {
        return null;
      }
    } else if(query===2){
      // called by TObject.GetInterfaceByStr
      if (intf.$kind === 'com') intf._AddRef();
    }
    return intf;
  },

  getIntfT: function(obj,intftype){
    return rtl.getIntfG(obj,intftype.$guid);
  },

  queryIntfT: function(obj,intftype){
    return rtl.getIntfG(obj,intftype.$guid,intftype);
  },

  queryIntfIsT: function(obj,intftype){
    var i = rtl.getIntfG(obj,intftype.$guid);
    if (!i) return false;
    if (i.$kind === 'com') i._Release();
    return true;
  },

  asIntfT: function (obj,intftype){
    var i = rtl.getIntfG(obj,intftype.$guid);
    if (i!==null) return i;
    rtl.raiseEInvalidCast();
  },

  intfIsIntfT: function(intf,intftype){
    return (intf!==null) && rtl.queryIntfIsT(intf.$o,intftype);
  },

  intfAsIntfT: function (intf,intftype){
    if (!intf) return null;
    var i = rtl.getIntfG(intf.$o,intftype.$guid);
    if (i) return i;
    rtl.raiseEInvalidCast();
  },

  intfIsClass: function(intf,classtype){
    return (intf!=null) && (rtl.is(intf.$o,classtype));
  },

  intfAsClass: function(intf,classtype){
    if (intf==null) return null;
    return rtl.as(intf.$o,classtype);
  },

  intfToClass: function(intf,classtype){
    if ((intf!==null) && rtl.is(intf.$o,classtype)) return intf.$o;
    return null;
  },

  // interface reference counting
  intfRefs: { // base object for temporary interface variables
    ref: function(id,intf){
      // called for temporary interface references needing delayed release
      var old = this[id];
      //console.log('rtl.intfRefs.ref: id='+id+' old="'+(old?old.$name:'null')+'" intf="'+(intf?intf.$name:'null')+' $o='+(intf?intf.$o:'null'));
      if (old){
        // called again, e.g. in a loop
        delete this[id];
        old._Release(); // may fail
      }
      if(intf) {
        this[id]=intf;
      }
      return intf;
    },
    free: function(){
      //console.log('rtl.intfRefs.free...');
      for (var id in this){
        if (this.hasOwnProperty(id)){
          var intf = this[id];
          if (intf){
            //console.log('rtl.intfRefs.free: id='+id+' '+intf.$name+' $o='+intf.$o.$classname);
            intf._Release();
          }
        }
      }
    }
  },

  createIntfRefs: function(){
    //console.log('rtl.createIntfRefs');
    return Object.create(rtl.intfRefs);
  },

  setIntfP: function(path,name,value,skipAddRef){
    var old = path[name];
    //console.log('rtl.setIntfP path='+path+' name='+name+' old="'+(old?old.$name:'null')+'" value="'+(value?value.$name:'null')+'"');
    if (old === value) return;
    if (old !== null){
      path[name]=null;
      old._Release();
    }
    if (value !== null){
      if (!skipAddRef) value._AddRef();
      path[name]=value;
    }
  },

  setIntfL: function(old,value,skipAddRef){
    //console.log('rtl.setIntfL old="'+(old?old.$name:'null')+'" value="'+(value?value.$name:'null')+'"');
    if (old !== value){
      if (value!==null){
        if (!skipAddRef) value._AddRef();
      }
      if (old!==null){
        old._Release();  // Release after AddRef, to avoid double Release if Release creates an exception
      }
    } else if (skipAddRef){
      if (old!==null){
        old._Release();  // value has an AddRef
      }
    }
    return value;
  },

  _AddRef: function(intf){
    //if (intf) console.log('rtl._AddRef intf="'+(intf?intf.$name:'null')+'"');
    if (intf) intf._AddRef();
    return intf;
  },

  _Release: function(intf){
    //if (intf) console.log('rtl._Release intf="'+(intf?intf.$name:'null')+'"');
    if (intf) intf._Release();
    return intf;
  },

  _ReleaseArray: function(a,dim){
    if (!a) return null;
    for (var i=0; i<a.length; i++){
      if (dim<=1){
        if (a[i]) a[i]._Release();
      } else {
        rtl._ReleaseArray(a[i],dim-1);
      }
    }
    return null;
  },

  trunc: function(a){
    return a<0 ? Math.ceil(a) : Math.floor(a);
  },

  checkMethodCall: function(obj,type){
    if (rtl.isObject(obj) && rtl.is(obj,type)) return;
    rtl.raiseE("EInvalidCast");
  },

  oc: function(i){
    // overflow check integer
    if ((Math.floor(i)===i) && (i>=-0x1fffffffffffff) && (i<=0x1fffffffffffff)) return i;
    rtl.raiseE('EIntOverflow');
  },

  rc: function(i,minval,maxval){
    // range check integer
    if ((Math.floor(i)===i) && (i>=minval) && (i<=maxval)) return i;
    rtl.raiseE('ERangeError');
  },

  rcc: function(c,minval,maxval){
    // range check char
    if ((typeof(c)==='string') && (c.length===1)){
      var i = c.charCodeAt(0);
      if ((i>=minval) && (i<=maxval)) return c;
    }
    rtl.raiseE('ERangeError');
  },

  rcSetCharAt: function(s,index,c){
    // range check setCharAt
    if ((typeof(s)!=='string') || (index<0) || (index>=s.length)) rtl.raiseE('ERangeError');
    return rtl.setCharAt(s,index,c);
  },

  rcCharAt: function(s,index){
    // range check charAt
    if ((typeof(s)!=='string') || (index<0) || (index>=s.length)) rtl.raiseE('ERangeError');
    return s.charAt(index);
  },

  rcArrR: function(arr,index){
    // range check read array
    if (Array.isArray(arr) && (typeof(index)==='number') && (index>=0) && (index<arr.length)){
      if (arguments.length>2){
        // arr,index1,index2,...
        arr=arr[index];
        for (var i=2; i<arguments.length; i++) arr=rtl.rcArrR(arr,arguments[i]);
        return arr;
      }
      return arr[index];
    }
    rtl.raiseE('ERangeError');
  },

  rcArrW: function(arr,index,value){
    // range check write array
    // arr,index1,index2,...,value
    for (var i=3; i<arguments.length; i++){
      arr=rtl.rcArrR(arr,index);
      index=arguments[i-1];
      value=arguments[i];
    }
    if (Array.isArray(arr) && (typeof(index)==='number') && (index>=0) && (index<arr.length)){
      return arr[index]=value;
    }
    rtl.raiseE('ERangeError');
  },

  length: function(arr){
    return (arr == null) ? 0 : arr.length;
  },

  arrayRef: function(a){
    if (a!=null) rtl.hideProp(a,'$pas2jsrefcnt',1);
    return a;
  },

  arraySetLength: function(arr,defaultvalue,newlength){
    var stack = [];
    var s = 9999;
    for (var i=2; i<arguments.length; i++){
      var j = arguments[i];
      if (j==='s'){ s = i-2; }
      else {
        stack.push({ dim:j+0, a:null, i:0, src:null });
      }
    }
    var dimmax = stack.length-1;
    var depth = 0;
    var lastlen = 0;
    var item = null;
    var a = null;
    var src = arr;
    var srclen = 0, oldlen = 0;
    do{
      if (depth>0){
        item=stack[depth-1];
        src = (item.src && item.src.length>item.i)?item.src[item.i]:null;
      }
      if (!src){
        a = [];
        srclen = 0;
        oldlen = 0;
      } else if (src.$pas2jsrefcnt>0 || depth>=s){
        a = [];
        srclen = src.length;
        oldlen = srclen;
      } else {
        a = src;
        srclen = 0;
        oldlen = a.length;
      }
      lastlen = stack[depth].dim;
      a.length = lastlen;
      if (depth>0){
        item.a[item.i]=a;
        item.i++;
        if ((lastlen===0) && (item.i<item.a.length)) continue;
      }
      if (lastlen>0){
        if (depth<dimmax){
          item = stack[depth];
          item.a = a;
          item.i = 0;
          item.src = src;
          depth++;
          continue;
        } else {
          if (srclen>lastlen) srclen=lastlen;
          if (rtl.isArray(defaultvalue)){
            // array of dyn array
            for (var i=0; i<srclen; i++) a[i]=src[i];
            for (var i=oldlen; i<lastlen; i++) a[i]=[];
          } else if (rtl.isObject(defaultvalue)) {
            if (rtl.isTRecord(defaultvalue)){
              // array of record
              for (var i=0; i<srclen; i++) a[i]=defaultvalue.$clone(src[i]);
              for (var i=oldlen; i<lastlen; i++) a[i]=defaultvalue.$new();
            } else {
              // array of set
              for (var i=0; i<srclen; i++) a[i]=rtl.refSet(src[i]);
              for (var i=oldlen; i<lastlen; i++) a[i]={};
            }
          } else {
            for (var i=0; i<srclen; i++) a[i]=src[i];
            for (var i=oldlen; i<lastlen; i++) a[i]=defaultvalue;
          }
        }
      }
      // backtrack
      while ((depth>0) && (stack[depth-1].i>=stack[depth-1].dim)){
        depth--;
      };
      if (depth===0){
        if (dimmax===0) return a;
        return stack[0].a;
      }
    }while (true);
  },

  arrayEq: function(a,b){
    if (a===null) return b===null;
    if (b===null) return false;
    if (a.length!==b.length) return false;
    for (var i=0; i<a.length; i++) if (a[i]!==b[i]) return false;
    return true;
  },

  arrayClone: function(type,src,srcpos,endpos,dst,dstpos){
    // type: 0 for references, "refset" for calling refSet(), a function for new type()
    // src must not be null
    // This function does not range check.
    if(type === 'refSet') {
      for (; srcpos<endpos; srcpos++) dst[dstpos++] = rtl.refSet(src[srcpos]); // ref set
    } else if (type === 'slice'){
      for (; srcpos<endpos; srcpos++) dst[dstpos++] = src[srcpos].slice(0); // clone static array of simple types
    } else if (typeof(type)==='function'){
      for (; srcpos<endpos; srcpos++) dst[dstpos++] = type(src[srcpos]); // clone function
    } else if (rtl.isTRecord(type)){
      for (; srcpos<endpos; srcpos++) dst[dstpos++] = type.$clone(src[srcpos]); // clone record
    }  else {
      for (; srcpos<endpos; srcpos++) dst[dstpos++] = src[srcpos]; // reference
    };
  },

  arrayConcat: function(type){
    // type: see rtl.arrayClone
    var a = [];
    var l = 0;
    for (var i=1; i<arguments.length; i++){
      var src = arguments[i];
      if (src !== null) l+=src.length;
    };
    a.length = l;
    l=0;
    for (var i=1; i<arguments.length; i++){
      var src = arguments[i];
      if (src === null) continue;
      rtl.arrayClone(type,src,0,src.length,a,l);
      l+=src.length;
    };
    return a;
  },

  arrayConcatN: function(){
    var a = null;
    for (var i=0; i<arguments.length; i++){
      var src = arguments[i];
      if (src === null) continue;
      if (a===null){
        a=rtl.arrayRef(src); // Note: concat(a) does not clone
      } else if (a['$pas2jsrefcnt']){
        a=a.concat(src); // clone a and append src
      } else {
        for (var i=0; i<src.length; i++){
          a.push(src[i]);
        }
      }
    };
    return a;
  },

  arrayPush: function(type,a){
    if(a===null){
      a=[];
    } else if (a['$pas2jsrefcnt']){
      a=rtl.arrayCopy(type,a,0,a.length);
    }
    rtl.arrayClone(type,arguments,2,arguments.length,a,a.length);
    return a;
  },

  arrayPushN: function(a){
    if(a===null){
      a=[];
    } else if (a['$pas2jsrefcnt']){
      a=a.concat();
    }
    for (var i=1; i<arguments.length; i++){
      a.push(arguments[i]);
    }
    return a;
  },

  arrayCopy: function(type, srcarray, index, count){
    // type: see rtl.arrayClone
    // if count is missing, use srcarray.length
    if (srcarray === null) return [];
    if (index < 0) index = 0;
    if (count === undefined) count=srcarray.length;
    var end = index+count;
    if (end>srcarray.length) end = srcarray.length;
    if (index>=end) return [];
    if (type===0){
      return srcarray.slice(index,end);
    } else {
      var a = [];
      a.length = end-index;
      rtl.arrayClone(type,srcarray,index,end,a,0);
      return a;
    }
  },

  arrayInsert: function(item, arr, index){
    if (arr){
      arr.splice(index,0,item);
      return arr;
    } else {
      return [item];
    }
  },

  setCharAt: function(s,index,c){
    return s.substr(0,index)+c+s.substr(index+1);
  },

  getResStr: function(mod,name){
    var rs = mod.$resourcestrings[name];
    return rs.current?rs.current:rs.org;
  },

  createSet: function(){
    var s = {};
    for (var i=0; i<arguments.length; i++){
      if (arguments[i]!=null){
        s[arguments[i]]=true;
      } else {
        var first=arguments[i+=1];
        var last=arguments[i+=1];
        for(var j=first; j<=last; j++) s[j]=true;
      }
    }
    return s;
  },

  cloneSet: function(s){
    var r = {};
    for (var key in s) r[key]=true;
    return r;
  },

  refSet: function(s){
    rtl.hideProp(s,'$shared',true);
    return s;
  },

  includeSet: function(s,enumvalue){
    if (s.$shared) s = rtl.cloneSet(s);
    s[enumvalue] = true;
    return s;
  },

  excludeSet: function(s,enumvalue){
    if (s.$shared) s = rtl.cloneSet(s);
    delete s[enumvalue];
    return s;
  },

  diffSet: function(s,t){
    var r = {};
    for (var key in s) if (!t[key]) r[key]=true;
    return r;
  },

  unionSet: function(s,t){
    var r = {};
    for (var key in s) r[key]=true;
    for (var key in t) r[key]=true;
    return r;
  },

  intersectSet: function(s,t){
    var r = {};
    for (var key in s) if (t[key]) r[key]=true;
    return r;
  },

  symDiffSet: function(s,t){
    var r = {};
    for (var key in s) if (!t[key]) r[key]=true;
    for (var key in t) if (!s[key]) r[key]=true;
    return r;
  },

  eqSet: function(s,t){
    for (var key in s) if (!t[key]) return false;
    for (var key in t) if (!s[key]) return false;
    return true;
  },

  neSet: function(s,t){
    return !rtl.eqSet(s,t);
  },

  leSet: function(s,t){
    for (var key in s) if (!t[key]) return false;
    return true;
  },

  geSet: function(s,t){
    for (var key in t) if (!s[key]) return false;
    return true;
  },

  strSetLength: function(s,newlen){
    var oldlen = s.length;
    if (oldlen > newlen){
      return s.substring(0,newlen);
    } else if (s.repeat){
      // Note: repeat needs ECMAScript6!
      return s+' '.repeat(newlen-oldlen);
    } else {
       while (oldlen<newlen){
         s+=' ';
         oldlen++;
       };
       return s;
    }
  },

  spaceLeft: function(s,width){
    var l=s.length;
    if (l>=width) return s;
    if (s.repeat){
      // Note: repeat needs ECMAScript6!
      return ' '.repeat(width-l) + s;
    } else {
      while (l<width){
        s=' '+s;
        l++;
      };
      return s;
    };
  },

  floatToStr: function(d,w,p){
    // input 1-3 arguments: double, width, precision
    if (arguments.length>2){
      return rtl.spaceLeft(d.toFixed(p),w);
    } else {
	  // exponent width
	  var pad = "";
	  var ad = Math.abs(d);
	  if (((ad>1) && (ad<1.0e+10)) ||  ((ad>1.e-10) && (ad<1))) {
		pad='00';
	  } else if ((ad>1) && (ad<1.0e+100) || (ad<1.e-10)) {
		pad='0';
      }  	
	  if (arguments.length<2) {
	    w=24;		
      } else if (w<9) {
		w=9;
      }		  
      var p = w-8;
      var s=(d>0 ? " " : "" ) + d.toExponential(p);
      s=s.replace(/e(.)/,'E$1'+pad);
      return rtl.spaceLeft(s,w);
    }
  },

  valEnum: function(s, enumType, setCodeFn){
    s = s.toLowerCase();
    for (var key in enumType){
      if((typeof(key)==='string') && (key.toLowerCase()===s)){
        setCodeFn(0);
        return enumType[key];
      }
    }
    setCodeFn(1);
    return 0;
  },

  lw: function(l){
    // fix longword bitwise operation
    return l<0?l+0x100000000:l;
  },

  and: function(a,b){
    var hi = 0x80000000;
    var low = 0x7fffffff;
    var h = (a / hi) & (b / hi);
    var l = (a & low) & (b & low);
    return h*hi + l;
  },

  or: function(a,b){
    var hi = 0x80000000;
    var low = 0x7fffffff;
    var h = (a / hi) | (b / hi);
    var l = (a & low) | (b & low);
    return h*hi + l;
  },

  xor: function(a,b){
    var hi = 0x80000000;
    var low = 0x7fffffff;
    var h = (a / hi) ^ (b / hi);
    var l = (a & low) ^ (b & low);
    return h*hi + l;
  },

  shr: function(a,b){
    if (a<0) a += rtl.hiInt;
    if (a<0x80000000) return a >> b;
    if (b<=0) return a;
    if (b>54) return 0;
    return Math.floor(a / Math.pow(2,b));
  },

  shl: function(a,b){
    if (a<0) a += rtl.hiInt;
    if (b<=0) return a;
    if (b>54) return 0;
    var r = a * Math.pow(2,b);
    if (r <= rtl.hiInt) return r;
    return r % rtl.hiInt;
  },

  initRTTI: function(){
    if (rtl.debug_rtti) rtl.debug('initRTTI');

    // base types
    rtl.tTypeInfo = { name: "tTypeInfo", kind: 0, $module: null, attr: null };
    function newBaseTI(name,kind,ancestor){
      if (!ancestor) ancestor = rtl.tTypeInfo;
      if (rtl.debug_rtti) rtl.debug('initRTTI.newBaseTI "'+name+'" '+kind+' ("'+ancestor.name+'")');
      var t = Object.create(ancestor);
      t.name = name;
      t.kind = kind;
      rtl[name] = t;
      return t;
    };
    function newBaseInt(name,minvalue,maxvalue,ordtype){
      var t = newBaseTI(name,1 /* tkInteger */,rtl.tTypeInfoInteger);
      t.minvalue = minvalue;
      t.maxvalue = maxvalue;
      t.ordtype = ordtype;
      return t;
    };
    newBaseTI("tTypeInfoInteger",1 /* tkInteger */);
    newBaseInt("shortint",-0x80,0x7f,0);
    newBaseInt("byte",0,0xff,1);
    newBaseInt("smallint",-0x8000,0x7fff,2);
    newBaseInt("word",0,0xffff,3);
    newBaseInt("longint",-0x80000000,0x7fffffff,4);
    newBaseInt("longword",0,0xffffffff,5);
    newBaseInt("nativeint",-0x10000000000000,0xfffffffffffff,6);
    newBaseInt("nativeuint",0,0xfffffffffffff,7);
    newBaseTI("char",2 /* tkChar */);
    newBaseTI("string",3 /* tkString */);
    newBaseTI("tTypeInfoEnum",4 /* tkEnumeration */,rtl.tTypeInfoInteger);
    newBaseTI("tTypeInfoSet",5 /* tkSet */);
    newBaseTI("double",6 /* tkDouble */);
    newBaseTI("boolean",7 /* tkBool */);
    newBaseTI("tTypeInfoProcVar",8 /* tkProcVar */);
    newBaseTI("tTypeInfoMethodVar",9 /* tkMethod */,rtl.tTypeInfoProcVar);
    newBaseTI("tTypeInfoArray",10 /* tkArray */);
    newBaseTI("tTypeInfoDynArray",11 /* tkDynArray */);
    newBaseTI("tTypeInfoPointer",15 /* tkPointer */);
    var t = newBaseTI("pointer",15 /* tkPointer */,rtl.tTypeInfoPointer);
    t.reftype = null;
    newBaseTI("jsvalue",16 /* tkJSValue */);
    newBaseTI("tTypeInfoRefToProcVar",17 /* tkRefToProcVar */,rtl.tTypeInfoProcVar);

    // member kinds
    rtl.tTypeMember = { attr: null };
    function newMember(name,kind){
      var m = Object.create(rtl.tTypeMember);
      m.name = name;
      m.kind = kind;
      rtl[name] = m;
    };
    newMember("tTypeMemberField",1); // tmkField
    newMember("tTypeMemberMethod",2); // tmkMethod
    newMember("tTypeMemberProperty",3); // tmkProperty

    // base object for storing members: a simple object
    rtl.tTypeMembers = {};

    // tTypeInfoStruct - base object for tTypeInfoClass, tTypeInfoRecord, tTypeInfoInterface
    var tis = newBaseTI("tTypeInfoStruct",0);
    tis.$addMember = function(name,ancestor,options){
      if (rtl.debug_rtti){
        if (!rtl.hasString(name) || (name.charAt()==='$')) throw 'invalid member "'+name+'", this="'+this.name+'"';
        if (!rtl.is(ancestor,rtl.tTypeMember)) throw 'invalid ancestor "'+ancestor+':'+ancestor.name+'", "'+this.name+'.'+name+'"';
        if ((options!=undefined) && (typeof(options)!='object')) throw 'invalid options "'+options+'", "'+this.name+'.'+name+'"';
      };
      var t = Object.create(ancestor);
      t.name = name;
      this.members[name] = t;
      this.names.push(name);
      if (rtl.isObject(options)){
        for (var key in options) if (options.hasOwnProperty(key)) t[key] = options[key];
      };
      return t;
    };
    tis.addField = function(name,type,options){
      var t = this.$addMember(name,rtl.tTypeMemberField,options);
      if (rtl.debug_rtti){
        if (!rtl.is(type,rtl.tTypeInfo)) throw 'invalid type "'+type+'", "'+this.name+'.'+name+'"';
      };
      t.typeinfo = type;
      this.fields.push(name);
      return t;
    };
    tis.addFields = function(){
      var i=0;
      while(i<arguments.length){
        var name = arguments[i++];
        var type = arguments[i++];
        if ((i<arguments.length) && (typeof(arguments[i])==='object')){
          this.addField(name,type,arguments[i++]);
        } else {
          this.addField(name,type);
        };
      };
    };
    tis.addMethod = function(name,methodkind,params,result,flags,options){
      var t = this.$addMember(name,rtl.tTypeMemberMethod,options);
      t.methodkind = methodkind;
      t.procsig = rtl.newTIProcSig(params,result,flags);
      this.methods.push(name);
      return t;
    };
    tis.addProperty = function(name,flags,result,getter,setter,options){
      var t = this.$addMember(name,rtl.tTypeMemberProperty,options);
      t.flags = flags;
      t.typeinfo = result;
      t.getter = getter;
      t.setter = setter;
      // Note: in options: params, stored, defaultvalue
      t.params = rtl.isArray(t.params) ? rtl.newTIParams(t.params) : null;
      this.properties.push(name);
      if (!rtl.isString(t.stored)) t.stored = "";
      return t;
    };
    tis.getField = function(index){
      return this.members[this.fields[index]];
    };
    tis.getMethod = function(index){
      return this.members[this.methods[index]];
    };
    tis.getProperty = function(index){
      return this.members[this.properties[index]];
    };

    newBaseTI("tTypeInfoRecord",12 /* tkRecord */,rtl.tTypeInfoStruct);
    newBaseTI("tTypeInfoClass",13 /* tkClass */,rtl.tTypeInfoStruct);
    newBaseTI("tTypeInfoClassRef",14 /* tkClassRef */);
    newBaseTI("tTypeInfoInterface",18 /* tkInterface */,rtl.tTypeInfoStruct);
    newBaseTI("tTypeInfoHelper",19 /* tkHelper */,rtl.tTypeInfoStruct);
    newBaseTI("tTypeInfoExtClass",20 /* tkExtClass */,rtl.tTypeInfoClass);
  },

  tSectionRTTI: {
    $module: null,
    $inherited: function(name,ancestor,o){
      if (rtl.debug_rtti){
        rtl.debug('tSectionRTTI.newTI "'+(this.$module?this.$module.$name:"(no module)")
          +'"."'+name+'" ('+ancestor.name+') '+(o?'init':'forward'));
      };
      var t = this[name];
      if (t){
        if (!t.$forward) throw 'duplicate type "'+name+'"';
        if (!ancestor.isPrototypeOf(t)) throw 'typeinfo ancestor mismatch "'+name+'" ancestor="'+ancestor.name+'" t.name="'+t.name+'"';
      } else {
        t = Object.create(ancestor);
        t.name = name;
        t.$module = this.$module;
        this[name] = t;
      }
      if (o){
        delete t.$forward;
        for (var key in o) if (o.hasOwnProperty(key)) t[key]=o[key];
      } else {
        t.$forward = true;
      }
      return t;
    },
    $Scope: function(name,ancestor,o){
      var t=this.$inherited(name,ancestor,o);
      t.members = {};
      t.names = [];
      t.fields = [];
      t.methods = [];
      t.properties = [];
      return t;
    },
    $TI: function(name,kind,o){ var t=this.$inherited(name,rtl.tTypeInfo,o); t.kind = kind; return t; },
    $Int: function(name,o){ return this.$inherited(name,rtl.tTypeInfoInteger,o); },
    $Enum: function(name,o){ return this.$inherited(name,rtl.tTypeInfoEnum,o); },
    $Set: function(name,o){ return this.$inherited(name,rtl.tTypeInfoSet,o); },
    $StaticArray: function(name,o){ return this.$inherited(name,rtl.tTypeInfoArray,o); },
    $DynArray: function(name,o){ return this.$inherited(name,rtl.tTypeInfoDynArray,o); },
    $ProcVar: function(name,o){ return this.$inherited(name,rtl.tTypeInfoProcVar,o); },
    $RefToProcVar: function(name,o){ return this.$inherited(name,rtl.tTypeInfoRefToProcVar,o); },
    $MethodVar: function(name,o){ return this.$inherited(name,rtl.tTypeInfoMethodVar,o); },
    $Record: function(name,o){ return this.$Scope(name,rtl.tTypeInfoRecord,o); },
    $Class: function(name,o){ return this.$Scope(name,rtl.tTypeInfoClass,o); },
    $ClassRef: function(name,o){ return this.$inherited(name,rtl.tTypeInfoClassRef,o); },
    $Pointer: function(name,o){ return this.$inherited(name,rtl.tTypeInfoPointer,o); },
    $Interface: function(name,o){ return this.$Scope(name,rtl.tTypeInfoInterface,o); },
    $Helper: function(name,o){ return this.$Scope(name,rtl.tTypeInfoHelper,o); },
    $ExtClass: function(name,o){ return this.$Scope(name,rtl.tTypeInfoExtClass,o); }
  },

  newTIParam: function(param){
    // param is an array, 0=name, 1=type, 2=optional flags
    var t = {
      name: param[0],
      typeinfo: param[1],
      flags: (rtl.isNumber(param[2]) ? param[2] : 0)
    };
    return t;
  },

  newTIParams: function(list){
    // list: optional array of [paramname,typeinfo,optional flags]
    var params = [];
    if (rtl.isArray(list)){
      for (var i=0; i<list.length; i++) params.push(rtl.newTIParam(list[i]));
    };
    return params;
  },

  newTIProcSig: function(params,result,flags){
    var s = {
      params: rtl.newTIParams(params),
      resulttype: result?result:null,
      flags: flags?flags:0
    };
    return s;
  },

  addResource: function(aRes){
    rtl.$res[aRes.name]=aRes;
  },

  getResource: function(aName){
    var res = rtl.$res[aName];
    if (res !== undefined) {
      return res;
    } else {
      return null;
    }
  },

  getResourceList: function(){
    return Object.keys(rtl.$res);
  }
}

rtl.module("System",[],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.LineEnding = "\n";
  this.sLineBreak = this.LineEnding;
  this.MaxLongint = 0x7fffffff;
  this.Maxint = 2147483647;
  this.TTextLineBreakStyle = {"0": "tlbsLF", tlbsLF: 0, "1": "tlbsCRLF", tlbsCRLF: 1, "2": "tlbsCR", tlbsCR: 2};
  rtl.recNewT(this,"TGuid",function () {
    this.D1 = 0;
    this.D2 = 0;
    this.D3 = 0;
    this.$new = function () {
      var r = Object.create(this);
      r.D4 = rtl.arraySetLength(null,0,8);
      return r;
    };
    this.$eq = function (b) {
      return (this.D1 === b.D1) && (this.D2 === b.D2) && (this.D3 === b.D3) && rtl.arrayEq(this.D4,b.D4);
    };
    this.$assign = function (s) {
      this.D1 = s.D1;
      this.D2 = s.D2;
      this.D3 = s.D3;
      this.D4 = s.D4.slice(0);
      return this;
    };
  });
  rtl.recNewT(this,"TMethod",function () {
    this.Code = null;
    this.Data = null;
    this.$eq = function (b) {
      return (this.Code === b.Code) && (this.Data === b.Data);
    };
    this.$assign = function (s) {
      this.Code = s.Code;
      this.Data = s.Data;
      return this;
    };
  });
  rtl.createClass(this,"TObject",null,function () {
    this.$init = function () {
    };
    this.$final = function () {
    };
    this.Create = function () {
      return this;
    };
    this.Destroy = function () {
    };
    this.Free = function () {
      this.$destroy("Destroy");
    };
    this.ClassType = function () {
      return this;
    };
    this.MethodAddress = function (aName) {
      var Result = null;
      Result = null;
      if (aName === "") return Result;
      var i = 0;
        var TI = this.$rtti;
        var N = "";
        var MN = "";
        N = aName.toLowerCase();
        while ((MN === "") && (TI != null)) {
          i = 0;
          while ((MN === "") && (i < TI.methods.length)) {
            if (TI.getMethod(i).name.toLowerCase() === N) MN = TI.getMethod(i).name;
            i += 1;
          };
          if (MN === "") TI = TI.ancestor;
        };
        if (MN !== "") Result = this[MN];
      //  return Result;
      return Result;
    };
    this.FieldAddress = function (aName) {
      var Result = null;
      Result = null;
      if (aName === "") return Result;
      var aClass = this.$class;
      var ClassTI = null;
      var myName = aName.toLowerCase();
      var MemberTI = null;
      while (aClass !== null) {
        ClassTI = aClass.$rtti;
        for (var i = 0, $end2 = ClassTI.fields.length - 1; i <= $end2; i++) {
          MemberTI = ClassTI.getField(i);
          if (MemberTI.name.toLowerCase() === myName) {
             return MemberTI;
          };
        };
        aClass = aClass.$ancestor ? aClass.$ancestor : null;
      };
      return Result;
    };
    this.ClassInfo = function () {
      var Result = null;
      Result = this.$rtti;
      return Result;
    };
    this.AfterConstruction = function () {
    };
    this.BeforeDestruction = function () {
    };
    this.GetInterface = function (iid, obj) {
      var Result = false;
      var i = iid.$intf;
      if (i){
        // iid is the private TGuid of an interface
        i = rtl.getIntfG(this,i.$guid,2);
        if (i){
          obj.set(i);
          return true;
        }
      };
      Result = this.GetInterfaceByStr(rtl.guidrToStr(iid),obj);
      return Result;
    };
    this.GetInterfaceByStr = function (iidstr, obj) {
      var Result = false;
      Result = false;
      if (!$mod.IObjectInstance["$str"]) $mod.IObjectInstance["$str"] = rtl.guidrToStr($mod.IObjectInstance);
      if (iidstr == $mod.IObjectInstance["$str"]) {
        obj.set(this);
        return true;
      };
      var i = rtl.getIntfG(this,iidstr,2);
      obj.set(i);
      Result=(i!==null);
      return Result;
    };
  });
  rtl.createClass(this,"TCustomAttribute",this.TObject,function () {
  });
  this.S_OK = 0;
  this.E_NOINTERFACE = -2147467262;
  rtl.createInterface(this,"IUnknown","{00000000-0000-0000-C000-000000000046}",["QueryInterface","_AddRef","_Release"],null,function () {
    this.$kind = "com";
  });
  rtl.createClass(this,"TInterfacedObject",this.TObject,function () {
    this.$init = function () {
      $mod.TObject.$init.call(this);
      this.fRefCount = 0;
    };
    this.QueryInterface = function (iid, obj) {
      var Result = 0;
      if (this.GetInterface(iid,obj)) {
        Result = 0}
       else Result = -2147467262;
      return Result;
    };
    this._AddRef = function () {
      var Result = 0;
      this.fRefCount += 1;
      Result = this.fRefCount;
      return Result;
    };
    this._Release = function () {
      var Result = 0;
      this.fRefCount -= 1;
      Result = this.fRefCount;
      if (this.fRefCount === 0) this.$destroy("Destroy");
      return Result;
    };
    this.BeforeDestruction = function () {
      if (this.fRefCount !== 0) rtl.raiseE('EHeapMemoryError');
    };
    rtl.addIntf(this,$mod.IUnknown);
  });
  this.IObjectInstance = this.TGuid.$clone({D1: 0xD91C9AF4, D2: 0x3C93, D3: 0x420F, D4: [0xA3,0x03,0xBF,0x5B,0xA8,0x2B,0xFD,0x23]});
  this.TTypeKind = {"0": "tkUnknown", tkUnknown: 0, "1": "tkInteger", tkInteger: 1, "2": "tkChar", tkChar: 2, "3": "tkString", tkString: 3, "4": "tkEnumeration", tkEnumeration: 4, "5": "tkSet", tkSet: 5, "6": "tkDouble", tkDouble: 6, "7": "tkBool", tkBool: 7, "8": "tkProcVar", tkProcVar: 8, "9": "tkMethod", tkMethod: 9, "10": "tkArray", tkArray: 10, "11": "tkDynArray", tkDynArray: 11, "12": "tkRecord", tkRecord: 12, "13": "tkClass", tkClass: 13, "14": "tkClassRef", tkClassRef: 14, "15": "tkPointer", tkPointer: 15, "16": "tkJSValue", tkJSValue: 16, "17": "tkRefToProcVar", tkRefToProcVar: 17, "18": "tkInterface", tkInterface: 18, "19": "tkHelper", tkHelper: 19, "20": "tkExtClass", tkExtClass: 20};
  this.vtInteger = 0;
  this.vtExtended = 3;
  this.vtWideChar = 9;
  this.vtCurrency = 12;
  this.vtUnicodeString = 18;
  this.vtNativeInt = 19;
  rtl.recNewT(this,"TVarRec",function () {
    this.VType = 0;
    this.VJSValue = undefined;
    this.$eq = function (b) {
      return (this.VType === b.VType) && (this.VJSValue === b.VJSValue) && (this.VJSValue === b.VJSValue) && (this.VJSValue === b.VJSValue) && (this.VJSValue === b.VJSValue) && (this.VJSValue === b.VJSValue) && (this.VJSValue === b.VJSValue) && (this.VJSValue === b.VJSValue);
    };
    this.$assign = function (s) {
      this.VType = s.VType;
      this.VJSValue = s.VJSValue;
      this.VJSValue = s.VJSValue;
      this.VJSValue = s.VJSValue;
      this.VJSValue = s.VJSValue;
      this.VJSValue = s.VJSValue;
      this.VJSValue = s.VJSValue;
      this.VJSValue = s.VJSValue;
      return this;
    };
  });
  this.VarRecs = function () {
    var Result = [];
    var i = 0;
    var v = null;
    Result = [];
    while (i < arguments.length) {
      v = $mod.TVarRec.$new();
      v.VType = rtl.trunc(arguments[i]);
      i += 1;
      v.VJSValue = arguments[i];
      i += 1;
      Result.push($mod.TVarRec.$clone(v));
    };
    return Result;
  };
  this.Frac = function (A) {
    return A % 1;
  };
  this.Random = function (Range) {
    return Math.floor(Math.random()*Range);
  };
  this.Sqr$1 = function (A) {
    return A*A;
  };
  this.Trunc = function (A) {
    if (!Math.trunc) {
      Math.trunc = function(v) {
        v = +v;
        if (!isFinite(v)) return v;
        return (v - v % 1) || (v < 0 ? -0 : v === 0 ? v : 0);
      };
    }
    $mod.Trunc = Math.trunc;
    return Math.trunc(A);
  };
  this.DefaultTextLineBreakStyle = 0;
  this.Int = function (A) {
    var Result = 0.0;
    Result = $mod.Trunc(A);
    return Result;
  };
  this.Copy = function (S, Index, Size) {
    if (Index<1) Index = 1;
    return (Size>0) ? S.substring(Index-1,Index+Size-1) : "";
  };
  this.Copy$1 = function (S, Index) {
    if (Index<1) Index = 1;
    return S.substr(Index-1);
  };
  this.Delete = function (S, Index, Size) {
    var h = "";
    if ((Index < 1) || (Index > S.get().length) || (Size <= 0)) return;
    h = S.get();
    S.set($mod.Copy(h,1,Index - 1) + $mod.Copy$1(h,Index + Size));
  };
  this.Pos = function (Search, InString) {
    return InString.indexOf(Search)+1;
  };
  this.Insert = function (Insertion, Target, Index) {
    var t = "";
    if (Insertion === "") return;
    t = Target.get();
    if (Index < 1) {
      Target.set(Insertion + t)}
     else if (Index > t.length) {
      Target.set(t + Insertion)}
     else Target.set($mod.Copy(t,1,Index - 1) + Insertion + $mod.Copy(t,Index,t.length));
  };
  this.upcase = function (c) {
    return c.toUpperCase();
  };
  this.val = function (S, NI, Code) {
    NI.set($impl.valint(S,-9007199254740991,9007199254740991,Code));
  };
  this.val$6 = function (S, I, Code) {
    I.set($impl.valint(S,-2147483648,2147483647,Code));
  };
  this.val$8 = function (S, d, Code) {
    var x = 0.0;
    if (S === "") {
      Code.set(1);
      return;
    };
    x = Number(S);
    if (isNaN(x)) {
      Code.set(1)}
     else {
      Code.set(0);
      d.set(x);
    };
  };
  this.StringOfChar = function (c, l) {
    var Result = "";
    var i = 0;
    if ((l>0) && c.repeat) return c.repeat(l);
    Result = "";
    for (var $l = 1, $end = l; $l <= $end; $l++) {
      i = $l;
      Result = Result + c;
    };
    return Result;
  };
  this.Writeln = function () {
    var i = 0;
    var l = 0;
    var s = "";
    l = arguments.length - 1;
    if ($impl.WriteCallBack != null) {
      for (var $l = 0, $end = l; $l <= $end; $l++) {
        i = $l;
        $impl.WriteCallBack(arguments[i],i === l);
      };
    } else {
      s = $impl.WriteBuf;
      for (var $l1 = 0, $end1 = l; $l1 <= $end1; $l1++) {
        i = $l1;
        s = s + ("" + arguments[i]);
      };
      console.log(s);
      $impl.WriteBuf = "";
    };
  };
  this.Assigned = function (V) {
    return (V!=undefined) && (V!=null) && (!rtl.isArray(V) || (V.length > 0));
  };
  $mod.$implcode = function () {
    $impl.WriteBuf = "";
    $impl.WriteCallBack = null;
    $impl.valint = function (S, MinVal, MaxVal, Code) {
      var Result = 0;
      var x = 0.0;
      if (S === "") {
        Code.set(1);
        return Result;
      };
      x = Number(S);
      if (isNaN(x)) {
        var $tmp = $mod.Copy(S,1,1);
        if ($tmp === "$") {
          x = Number("0x" + $mod.Copy$1(S,2))}
         else if ($tmp === "&") {
          x = Number("0o" + $mod.Copy$1(S,2))}
         else if ($tmp === "%") {
          x = Number("0b" + $mod.Copy$1(S,2))}
         else {
          Code.set(1);
          return Result;
        };
      };
      if (isNaN(x) || (x !== $mod.Int(x))) {
        Code.set(1)}
       else if ((x < MinVal) || (x > MaxVal)) {
        Code.set(2)}
       else {
        Result = $mod.Trunc(x);
        Code.set(0);
      };
      return Result;
    };
  };
  $mod.$init = function () {
    rtl.exitcode = 0;
  };
},[]);
rtl.module("RTLConsts",["System"],function () {
  "use strict";
  var $mod = this;
  $mod.$resourcestrings = {SArgumentMissing: {org: 'Missing argument in format "%s"'}, SInvalidFormat: {org: 'Invalid format specifier : "%s"'}, SInvalidArgIndex: {org: 'Invalid argument index in format: "%s"'}, SListCapacityError: {org: "List capacity (%s) exceeded."}, SListCountError: {org: "List count (%s) out of bounds."}, SListIndexError: {org: "List index (%s) out of bounds"}, SSortedListError: {org: "Operation not allowed on sorted list"}, SDuplicateString: {org: "String list does not allow duplicates"}, SErrFindNeedsSortedList: {org: "Cannot use find on unsorted list"}, SInvalidName: {org: 'Invalid component name: "%s"'}, SInvalidBoolean: {org: '"%s" is not a valid boolean.'}, SDuplicateName: {org: 'Duplicate component name: "%s"'}, SErrInvalidDate: {org: 'Invalid date: "%s"'}, SErrInvalidTimeFormat: {org: 'Invalid time format: "%s"'}, SInvalidDateFormat: {org: 'Invalid date format: "%s"'}, SCantReadPropertyS: {org: 'Cannot read property "%s"'}, SCantWritePropertyS: {org: 'Cannot write property "%s"'}, SErrPropertyNotFound: {org: 'Unknown property: "%s"'}, SIndexedPropertyNeedsParams: {org: 'Indexed property "%s" needs parameters'}, SErrInvalidInteger: {org: 'Invalid integer value: "%s"'}, SErrInvalidFloat: {org: 'Invalid floating-point value: "%s"'}, SInvalidCurrency: {org: "Invalid currency value: %s"}};
});
rtl.module("Types",["System"],function () {
  "use strict";
  var $mod = this;
  this.TDirection = {"0": "FromBeginning", FromBeginning: 0, "1": "FromEnd", FromEnd: 1};
  this.TDuplicates = {"0": "dupIgnore", dupIgnore: 0, "1": "dupAccept", dupAccept: 1, "2": "dupError", dupError: 2};
  rtl.recNewT(this,"TPoint",function () {
    this.x = 0;
    this.y = 0;
    this.$eq = function (b) {
      return (this.x === b.x) && (this.y === b.y);
    };
    this.$assign = function (s) {
      this.x = s.x;
      this.y = s.y;
      return this;
    };
    var $r = $mod.$rtti.$Record("TPoint",{});
    $r.addField("x",rtl.longint);
    $r.addField("y",rtl.longint);
  });
  rtl.recNewT(this,"TRect",function () {
    this.Left = 0;
    this.Top = 0;
    this.Right = 0;
    this.Bottom = 0;
    this.$eq = function (b) {
      return (this.Left === b.Left) && (this.Top === b.Top) && (this.Right === b.Right) && (this.Bottom === b.Bottom);
    };
    this.$assign = function (s) {
      this.Left = s.Left;
      this.Top = s.Top;
      this.Right = s.Right;
      this.Bottom = s.Bottom;
      return this;
    };
    var $r = $mod.$rtti.$Record("TRect",{});
    $r.addField("Left",rtl.longint);
    $r.addField("Top",rtl.longint);
    $r.addField("Right",rtl.longint);
    $r.addField("Bottom",rtl.longint);
  });
  this.Rect = function (Left, Top, Right, Bottom) {
    var Result = $mod.TRect.$new();
    Result.Left = Left;
    Result.Top = Top;
    Result.Right = Right;
    Result.Bottom = Bottom;
    return Result;
  };
  this.Point = function (x, y) {
    var Result = $mod.TPoint.$new();
    Result.x = x;
    Result.y = y;
    return Result;
  };
});
rtl.module("JS",["System","Types"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"AsyncAttribute",pas.System.TCustomAttribute,function () {
  });
  this.isBoolean = function (v) {
    return typeof(v) == 'boolean';
  };
  this.isInteger = function (v) {
    return Math.floor(v)===v;
  };
  this.isNull = function (v) {
    return v === null;
  };
  this.isUndefined = function (v) {
    return v == undefined;
  };
  this.toObject = function (Value) {
    var Result = null;
    if (rtl.isObject(Value)) {
      Result = Value}
     else Result = null;
    return Result;
  };
  this.toBoolean = function (Value) {
    var Result = false;
    if ($mod.isBoolean(Value)) {
      Result = !(Value == false)}
     else Result = false;
    return Result;
  };
  this.ToString = function (Value) {
    var Result = "";
    if (rtl.isString(Value)) {
      Result = "" + Value}
     else Result = "";
    return Result;
  };
  this.TJSValueType = {"0": "jvtNull", jvtNull: 0, "1": "jvtBoolean", jvtBoolean: 1, "2": "jvtInteger", jvtInteger: 2, "3": "jvtFloat", jvtFloat: 3, "4": "jvtString", jvtString: 4, "5": "jvtObject", jvtObject: 5, "6": "jvtArray", jvtArray: 6};
  this.GetValueType = function (JS) {
    var Result = 0;
    var t = "";
    if ($mod.isNull(JS)) {
      Result = 0}
     else {
      t = typeof(JS);
      if (t === "string") {
        Result = 4}
       else if (t === "boolean") {
        Result = 1}
       else if (t === "object") {
        if (rtl.isArray(JS)) {
          Result = 6}
         else Result = 5;
      } else if (t === "number") if ($mod.isInteger(JS)) {
        Result = 2}
       else Result = 3;
    };
    return Result;
  };
});
rtl.module("SysUtils",["System","RTLConsts","JS"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.FreeAndNil = function (Obj) {
    var o = null;
    o = Obj.get();
    if (o === null) return;
    Obj.set(null);
    o.$destroy("Destroy");
  };
  this.FloatRecDigits = 19;
  rtl.recNewT(this,"TFloatRec",function () {
    this.Exponent = 0;
    this.Negative = false;
    this.$new = function () {
      var r = Object.create(this);
      r.Digits = rtl.arraySetLength(null,"",19);
      return r;
    };
    this.$eq = function (b) {
      return (this.Exponent === b.Exponent) && (this.Negative === b.Negative) && rtl.arrayEq(this.Digits,b.Digits);
    };
    this.$assign = function (s) {
      this.Exponent = s.Exponent;
      this.Negative = s.Negative;
      this.Digits = s.Digits.slice(0);
      return this;
    };
  });
  rtl.recNewT(this,"TFormatSettings",function () {
    this.CurrencyDecimals = 0;
    this.CurrencyFormat = 0;
    this.CurrencyString = "";
    this.DateSeparator = "";
    this.DecimalSeparator = "";
    this.LongDateFormat = "";
    this.LongTimeFormat = "";
    this.NegCurrFormat = 0;
    this.ShortDateFormat = "";
    this.ShortTimeFormat = "";
    this.ThousandSeparator = "";
    this.TimeAMString = "";
    this.TimePMString = "";
    this.TimeSeparator = "";
    this.TwoDigitYearCenturyWindow = 0;
    this.InitLocaleHandler = null;
    this.$new = function () {
      var r = Object.create(this);
      r.DateTimeToStrFormat = rtl.arraySetLength(null,"",2);
      r.LongDayNames = rtl.arraySetLength(null,"",7);
      r.LongMonthNames = rtl.arraySetLength(null,"",12);
      r.ShortDayNames = rtl.arraySetLength(null,"",7);
      r.ShortMonthNames = rtl.arraySetLength(null,"",12);
      return r;
    };
    this.$eq = function (b) {
      return (this.CurrencyDecimals === b.CurrencyDecimals) && (this.CurrencyFormat === b.CurrencyFormat) && (this.CurrencyString === b.CurrencyString) && (this.DateSeparator === b.DateSeparator) && rtl.arrayEq(this.DateTimeToStrFormat,b.DateTimeToStrFormat) && (this.DecimalSeparator === b.DecimalSeparator) && (this.LongDateFormat === b.LongDateFormat) && rtl.arrayEq(this.LongDayNames,b.LongDayNames) && rtl.arrayEq(this.LongMonthNames,b.LongMonthNames) && (this.LongTimeFormat === b.LongTimeFormat) && (this.NegCurrFormat === b.NegCurrFormat) && (this.ShortDateFormat === b.ShortDateFormat) && rtl.arrayEq(this.ShortDayNames,b.ShortDayNames) && rtl.arrayEq(this.ShortMonthNames,b.ShortMonthNames) && (this.ShortTimeFormat === b.ShortTimeFormat) && (this.ThousandSeparator === b.ThousandSeparator) && (this.TimeAMString === b.TimeAMString) && (this.TimePMString === b.TimePMString) && (this.TimeSeparator === b.TimeSeparator) && (this.TwoDigitYearCenturyWindow === b.TwoDigitYearCenturyWindow);
    };
    this.$assign = function (s) {
      this.CurrencyDecimals = s.CurrencyDecimals;
      this.CurrencyFormat = s.CurrencyFormat;
      this.CurrencyString = s.CurrencyString;
      this.DateSeparator = s.DateSeparator;
      this.DateTimeToStrFormat = s.DateTimeToStrFormat.slice(0);
      this.DecimalSeparator = s.DecimalSeparator;
      this.LongDateFormat = s.LongDateFormat;
      this.LongDayNames = s.LongDayNames.slice(0);
      this.LongMonthNames = s.LongMonthNames.slice(0);
      this.LongTimeFormat = s.LongTimeFormat;
      this.NegCurrFormat = s.NegCurrFormat;
      this.ShortDateFormat = s.ShortDateFormat;
      this.ShortDayNames = s.ShortDayNames.slice(0);
      this.ShortMonthNames = s.ShortMonthNames.slice(0);
      this.ShortTimeFormat = s.ShortTimeFormat;
      this.ThousandSeparator = s.ThousandSeparator;
      this.TimeAMString = s.TimeAMString;
      this.TimePMString = s.TimePMString;
      this.TimeSeparator = s.TimeSeparator;
      this.TwoDigitYearCenturyWindow = s.TwoDigitYearCenturyWindow;
      return this;
    };
    this.GetJSLocale = function () {
      return Intl.DateTimeFormat().resolvedOptions().locale;
    };
    this.GetLocaleDecimalSeparator = function (ALocale) {
      var lNumber = 1.1;
      lNumber = lNumber.toLocaleString(ALocale).substring(1, 2);
      return lNumber;
    };
    this.GetLocaleLongDayName = function (ADayOfWeek, ALocale) {
      var lBaseDate = new Date(2017, 0, 1); // Sunday
      lBaseDate.setDate(lBaseDate.getDate() + ADayOfWeek - 1);
      return lBaseDate.toLocaleDateString(ALocale, { weekday: 'long' });
    };
    this.GetLocaleLongMonthName = function (AMonth, ALocale) {
      var lBaseDate = new Date(2017, AMonth - 1, 1);
      return lBaseDate.toLocaleDateString(ALocale, { month: 'long' });
    };
    this.GetLocaleLongTimeFormat = function (ALocale) {
      var Result = "";
      Result = "hh:nn:ss";
      if ($mod.UpperCase(ALocale) === "EN-US") Result = "hh:nn:ss AMPM";
      return Result;
    };
    var cDeli = "-";
    var cShortLength = 2;
    this.GetLocaleShortDateFormat = function (ALocale) {
      var Result = "";
      var lIndex = 0;
      var res = "";
      res = $mod.TStringHelper.Empty;
      ALocale = $mod.TStringHelper.ToLower.call({get: function () {
          return ALocale;
        }, set: function (v) {
          ALocale = v;
        }});
      lIndex = $mod.TStringHelper.IndexOf.call({get: function () {
          return ALocale;
        }, set: function (v) {
          ALocale = v;
        }},cDeli);
      if (lIndex >= 0) {
        ALocale = $mod.TStringHelper.Substring$1.call({get: function () {
            return ALocale;
          }, set: function (v) {
            ALocale = v;
          }},0,lIndex) + $mod.TStringHelper.ToUpper.call({a: $mod.TStringHelper.Substring.call({get: function () {
              return ALocale;
            }, set: function (v) {
              ALocale = v;
            }},lIndex), get: function () {
            return this.a;
          }, set: function (v) {
            this.a = v;
          }})}
       else {
        if ($mod.TStringHelper.GetLength.call({get: function () {
            return ALocale;
          }, set: function (v) {
            ALocale = v;
          }}) === 2) ALocale = ALocale + cDeli + $mod.TStringHelper.ToUpper.call({get: function () {
            return ALocale;
          }, set: function (v) {
            ALocale = v;
          }});
      };
      var lFormats = {
        "ar-SA" : "dd/MM/yy",
        "bg-BG" : "dd.M.yyyy",
        "ca-ES" : "dd/MM/yyyy",
        "zh-TW" : "yyyy/M/d",
        "cs-CZ" : "d.M.yyyy",
        "da-DK" : "dd-MM-yyyy",
        "de-DE" : "dd.MM.yyyy",
        "el-GR" : "d/M/yyyy",
        "en-US" : "M/d/yyyy",
        "fi-FI" : "d.M.yyyy",
        "fr-FR" : "dd/MM/yyyy",
        "he-IL" : "dd/MM/yyyy",
        "hu-HU" : "yyyy. MM. dd.",
        "is-IS" : "d.M.yyyy",
        "it-IT" : "dd/MM/yyyy",
        "ja-JP" : "yyyy/MM/dd",
        "ko-KR" : "yyyy-MM-dd",
        "nl-NL" : "d-M-yyyy",
        "nb-NO" : "dd.MM.yyyy",
        "pl-PL" : "yyyy-MM-dd",
        "pt-BR" : "d/M/yyyy",
        "ro-RO" : "dd.MM.yyyy",
        "ru-RU" : "dd.MM.yyyy",
        "hr-HR" : "d.M.yyyy",
        "sk-SK" : "d. M. yyyy",
        "sq-AL" : "yyyy-MM-dd",
        "sv-SE" : "yyyy-MM-dd",
        "th-TH" : "d/M/yyyy",
        "tr-TR" : "dd.MM.yyyy",
        "ur-PK" : "dd/MM/yyyy",
        "id-ID" : "dd/MM/yyyy",
        "uk-UA" : "dd.MM.yyyy",
        "be-BY" : "dd.MM.yyyy",
        "sl-SI" : "d.M.yyyy",
        "et-EE" : "d.MM.yyyy",
        "lv-LV" : "yyyy.MM.dd.",
        "lt-LT" : "yyyy.MM.dd",
        "fa-IR" : "MM/dd/yyyy",
        "vi-VN" : "dd/MM/yyyy",
        "hy-AM" : "dd.MM.yyyy",
        "az-Latn-AZ" : "dd.MM.yyyy",
        "eu-ES" : "yyyy/MM/dd",
        "mk-MK" : "dd.MM.yyyy",
        "af-ZA" : "yyyy/MM/dd",
        "ka-GE" : "dd.MM.yyyy",
        "fo-FO" : "dd-MM-yyyy",
        "hi-IN" : "dd-MM-yyyy",
        "ms-MY" : "dd/MM/yyyy",
        "kk-KZ" : "dd.MM.yyyy",
        "ky-KG" : "dd.MM.yy",
        "sw-KE" : "M/d/yyyy",
        "uz-Latn-UZ" : "dd/MM yyyy",
        "tt-RU" : "dd.MM.yyyy",
        "pa-IN" : "dd-MM-yy",
        "gu-IN" : "dd-MM-yy",
        "ta-IN" : "dd-MM-yyyy",
        "te-IN" : "dd-MM-yy",
        "kn-IN" : "dd-MM-yy",
        "mr-IN" : "dd-MM-yyyy",
        "sa-IN" : "dd-MM-yyyy",
        "mn-MN" : "yy.MM.dd",
        "gl-ES" : "dd/MM/yy",
        "kok-IN" : "dd-MM-yyyy",
        "syr-SY" : "dd/MM/yyyy",
        "dv-MV" : "dd/MM/yy",
        "ar-IQ" : "dd/MM/yyyy",
        "zh-CN" : "yyyy/M/d",
        "de-CH" : "dd.MM.yyyy",
        "en-GB" : "dd/MM/yyyy",
        "es-MX" : "dd/MM/yyyy",
        "fr-BE" : "d/MM/yyyy",
        "it-CH" : "dd.MM.yyyy",
        "nl-BE" : "d/MM/yyyy",
        "nn-NO" : "dd.MM.yyyy",
        "pt-PT" : "dd-MM-yyyy",
        "sr-Latn-CS" : "d.M.yyyy",
        "sv-FI" : "d.M.yyyy",
        "az-Cyrl-AZ" : "dd.MM.yyyy",
        "ms-BN" : "dd/MM/yyyy",
        "uz-Cyrl-UZ" : "dd.MM.yyyy",
        "ar-EG" : "dd/MM/yyyy",
        "zh-HK" : "d/M/yyyy",
        "de-AT" : "dd.MM.yyyy",
        "en-AU" : "d/MM/yyyy",
        "es-ES" : "dd/MM/yyyy",
        "fr-CA" : "yyyy-MM-dd",
        "sr-Cyrl-CS" : "d.M.yyyy",
        "ar-LY" : "dd/MM/yyyy",
        "zh-SG" : "d/M/yyyy",
        "de-LU" : "dd.MM.yyyy",
        "en-CA" : "dd/MM/yyyy",
        "es-GT" : "dd/MM/yyyy",
        "fr-CH" : "dd.MM.yyyy",
        "ar-DZ" : "dd-MM-yyyy",
        "zh-MO" : "d/M/yyyy",
        "de-LI" : "dd.MM.yyyy",
        "en-NZ" : "d/MM/yyyy",
        "es-CR" : "dd/MM/yyyy",
        "fr-LU" : "dd/MM/yyyy",
        "ar-MA" : "dd-MM-yyyy",
        "en-IE" : "dd/MM/yyyy",
        "es-PA" : "MM/dd/yyyy",
        "fr-MC" : "dd/MM/yyyy",
        "ar-TN" : "dd-MM-yyyy",
        "en-ZA" : "yyyy/MM/dd",
        "es-DO" : "dd/MM/yyyy",
        "ar-OM" : "dd/MM/yyyy",
        "en-JM" : "dd/MM/yyyy",
        "es-VE" : "dd/MM/yyyy",
        "ar-YE" : "dd/MM/yyyy",
        "en-029" : "MM/dd/yyyy",
        "es-CO" : "dd/MM/yyyy",
        "ar-SY" : "dd/MM/yyyy",
        "en-BZ" : "dd/MM/yyyy",
        "es-PE" : "dd/MM/yyyy",
        "ar-JO" : "dd/MM/yyyy",
        "en-TT" : "dd/MM/yyyy",
        "es-AR" : "dd/MM/yyyy",
        "ar-LB" : "dd/MM/yyyy",
        "en-ZW" : "M/d/yyyy",
        "es-EC" : "dd/MM/yyyy",
        "ar-KW" : "dd/MM/yyyy",
        "en-PH" : "M/d/yyyy",
        "es-CL" : "dd-MM-yyyy",
        "ar-AE" : "dd/MM/yyyy",
        "es-UY" : "dd/MM/yyyy",
        "ar-BH" : "dd/MM/yyyy",
        "es-PY" : "dd/MM/yyyy",
        "ar-QA" : "dd/MM/yyyy",
        "es-BO" : "dd/MM/yyyy",
        "es-SV" : "dd/MM/yyyy",
        "es-HN" : "dd/MM/yyyy",
        "es-NI" : "dd/MM/yyyy",
        "es-PR" : "dd/MM/yyyy",
        "am-ET" : "d/M/yyyy",
        "tzm-Latn-DZ" : "dd-MM-yyyy",
        "iu-Latn-CA" : "d/MM/yyyy",
        "sma-NO" : "dd.MM.yyyy",
        "mn-Mong-CN" : "yyyy/M/d",
        "gd-GB" : "dd/MM/yyyy",
        "en-MY" : "d/M/yyyy",
        "prs-AF" : "dd/MM/yy",
        "bn-BD" : "dd-MM-yy",
        "wo-SN" : "dd/MM/yyyy",
        "rw-RW" : "M/d/yyyy",
        "qut-GT" : "dd/MM/yyyy",
        "sah-RU" : "MM.dd.yyyy",
        "gsw-FR" : "dd/MM/yyyy",
        "co-FR" : "dd/MM/yyyy",
        "oc-FR" : "dd/MM/yyyy",
        "mi-NZ" : "dd/MM/yyyy",
        "ga-IE" : "dd/MM/yyyy",
        "se-SE" : "yyyy-MM-dd",
        "br-FR" : "dd/MM/yyyy",
        "smn-FI" : "d.M.yyyy",
        "moh-CA" : "M/d/yyyy",
        "arn-CL" : "dd-MM-yyyy",
        "ii-CN" : "yyyy/M/d",
        "dsb-DE" : "d. M. yyyy",
        "ig-NG" : "d/M/yyyy",
        "kl-GL" : "dd-MM-yyyy",
        "lb-LU" : "dd/MM/yyyy",
        "ba-RU" : "dd.MM.yy",
        "nso-ZA" : "yyyy/MM/dd",
        "quz-BO" : "dd/MM/yyyy",
        "yo-NG" : "d/M/yyyy",
        "ha-Latn-NG" : "d/M/yyyy",
        "fil-PH" : "M/d/yyyy",
        "ps-AF" : "dd/MM/yy",
        "fy-NL" : "d-M-yyyy",
        "ne-NP" : "M/d/yyyy",
        "se-NO" : "dd.MM.yyyy",
        "iu-Cans-CA" : "d/M/yyyy",
        "sr-Latn-RS" : "d.M.yyyy",
        "si-LK" : "yyyy-MM-dd",
        "sr-Cyrl-RS" : "d.M.yyyy",
        "lo-LA" : "dd/MM/yyyy",
        "km-KH" : "yyyy-MM-dd",
        "cy-GB" : "dd/MM/yyyy",
        "bo-CN" : "yyyy/M/d",
        "sms-FI" : "d.M.yyyy",
        "as-IN" : "dd-MM-yyyy",
        "ml-IN" : "dd-MM-yy",
        "en-IN" : "dd-MM-yyyy",
        "or-IN" : "dd-MM-yy",
        "bn-IN" : "dd-MM-yy",
        "tk-TM" : "dd.MM.yy",
        "bs-Latn-BA" : "d.M.yyyy",
        "mt-MT" : "dd/MM/yyyy",
        "sr-Cyrl-ME" : "d.M.yyyy",
        "se-FI" : "d.M.yyyy",
        "zu-ZA" : "yyyy/MM/dd",
        "xh-ZA" : "yyyy/MM/dd",
        "tn-ZA" : "yyyy/MM/dd",
        "hsb-DE" : "d. M. yyyy",
        "bs-Cyrl-BA" : "d.M.yyyy",
        "tg-Cyrl-TJ" : "dd.MM.yy",
        "sr-Latn-BA" : "d.M.yyyy",
        "smj-NO" : "dd.MM.yyyy",
        "rm-CH" : "dd/MM/yyyy",
        "smj-SE" : "yyyy-MM-dd",
        "quz-EC" : "dd/MM/yyyy",
        "quz-PE" : "dd/MM/yyyy",
        "hr-BA" : "d.M.yyyy.",
        "sr-Latn-ME" : "d.M.yyyy",
        "sma-SE" : "yyyy-MM-dd",
        "en-SG" : "d/M/yyyy",
        "ug-CN" : "yyyy-M-d",
        "sr-Cyrl-BA" : "d.M.yyyy",
        "es-US" : "M/d/yyyy"};
      res = lFormats[ALocale] || 'dd/MM/yyyy';
      Result = res;
      return Result;
    };
    this.GetLocaleShortDayName = function (ADayOfWeek, ALocale) {
      var lBaseDate = new Date(2017, 0, 1); // Sunday
        lBaseDate.setDate(lBaseDate.getDate() + ADayOfWeek - 1);
      
        var lLoc = "";
        if (ALocale == '')
          lLoc = navigator.language
        else
          lLoc = ALocale;
      
        return lBaseDate.toLocaleDateString(lLoc, { weekday: 'short' });
    };
    this.GetLocaleShortMonthName = function (AMonth, ALocale) {
      var lBaseDate = new Date(2017, AMonth - 1, 1);
      var lLoc = "";
      if (ALocale == '')
        lLoc = navigator.language
      else
        lLoc = ALocale;
      return lBaseDate.toLocaleDateString(lLoc, { month: 'short' });
    };
    this.GetLocaleShortTimeFormat = function (ALocale) {
      var Result = "";
      Result = "hh:nn";
      if ($mod.UpperCase(ALocale) === "EN-US") Result = "h:nn AMPM";
      return Result;
    };
    this.Create = function () {
      var Result = $mod.TFormatSettings.$new();
      Result.$assign($mod.TFormatSettings.Create$1($mod.TFormatSettings.GetJSLocale()));
      return Result;
    };
    var cDateSeps = ["/",".","-"];
    var cTimeSeps = [":",".","-"];
    var cDecSeps = [",","."];
    var cThousandSeps = [".",","];
    this.Create$1 = function (ALocale) {
      var Result = $mod.TFormatSettings.$new();
      var lTimeStr = "";
      var lCount = 0;
      var lLoc = "";
      lLoc = $mod.UpperCase(ALocale);
      if (pas.System.Pos("DE-",lLoc) === 1) {
        Result.LongDayNames[0] = "Sonntag";
        Result.LongDayNames[1] = "Montag";
        Result.LongDayNames[2] = "Dienstag";
        Result.LongDayNames[3] = "Mittwoch";
        Result.LongDayNames[4] = "Donnerstag";
        Result.LongDayNames[5] = "Freitag";
        Result.LongDayNames[6] = "Samstag";
        Result.ShortDayNames[0] = "Son";
        Result.ShortDayNames[1] = "Mon";
        Result.ShortDayNames[2] = "Die";
        Result.ShortDayNames[3] = "Mit";
        Result.ShortDayNames[4] = "Don";
        Result.ShortDayNames[5] = "Fre";
        Result.ShortDayNames[6] = "Sam";
        Result.ShortMonthNames[0] = "Jan";
        Result.ShortMonthNames[1] = "Feb";
        Result.ShortMonthNames[2] = "M\uFFFDr";
        Result.ShortMonthNames[3] = "Apr";
        Result.ShortMonthNames[4] = "Mai";
        Result.ShortMonthNames[5] = "Jun";
        Result.ShortMonthNames[6] = "Jul";
        Result.ShortMonthNames[7] = "Aug";
        Result.ShortMonthNames[8] = "Sep";
        Result.ShortMonthNames[9] = "Okt";
        Result.ShortMonthNames[10] = "Nov";
        Result.ShortMonthNames[11] = "Dez";
        Result.LongMonthNames[0] = "Januar";
        Result.LongMonthNames[1] = "Februar";
        Result.LongMonthNames[2] = "M\uFFFDrz";
        Result.LongMonthNames[3] = "April";
        Result.LongMonthNames[4] = "Mai";
        Result.LongMonthNames[5] = "Juni";
        Result.LongMonthNames[6] = "Juli";
        Result.LongMonthNames[7] = "August";
        Result.LongMonthNames[8] = "September";
        Result.LongMonthNames[9] = "Oktober";
        Result.LongMonthNames[10] = "November";
        Result.LongMonthNames[11] = "Dezember";
      } else if (pas.System.Pos("FR-",$mod.UpperCase(ALocale)) === 1) {
        Result.LongDayNames[0] = "Dimanche";
        Result.LongDayNames[1] = "Lundi";
        Result.LongDayNames[2] = "Mardi";
        Result.LongDayNames[3] = "Mecredi";
        Result.LongDayNames[4] = "Jeudi";
        Result.LongDayNames[5] = "Vendredi";
        Result.LongDayNames[6] = "Samedi";
        Result.ShortDayNames[0] = "Dim";
        Result.ShortDayNames[1] = "Lun";
        Result.ShortDayNames[2] = "Mar";
        Result.ShortDayNames[3] = "Mer";
        Result.ShortDayNames[4] = "Jeu";
        Result.ShortDayNames[5] = "Ven";
        Result.ShortDayNames[6] = "Sam";
        Result.ShortMonthNames[0] = "Jan";
        Result.ShortMonthNames[1] = "F\uFFFDv";
        Result.ShortMonthNames[2] = "Mar";
        Result.ShortMonthNames[3] = "Avr";
        Result.ShortMonthNames[4] = "Mai";
        Result.ShortMonthNames[5] = "Jun";
        Result.ShortMonthNames[6] = "Jul";
        Result.ShortMonthNames[7] = "Ao\uFFFD";
        Result.ShortMonthNames[8] = "Sep";
        Result.ShortMonthNames[9] = "Oct";
        Result.ShortMonthNames[10] = "Nov";
        Result.ShortMonthNames[11] = "Dec";
        Result.LongMonthNames[0] = "Janvier";
        Result.LongMonthNames[1] = "F\uFFFDvrier";
        Result.LongMonthNames[2] = "Mars";
        Result.LongMonthNames[3] = "Avril";
        Result.LongMonthNames[4] = "Mai";
        Result.LongMonthNames[5] = "Juin";
        Result.LongMonthNames[6] = "Juillet";
        Result.LongMonthNames[7] = "Ao\uFFFDt";
        Result.LongMonthNames[8] = "Septembre";
        Result.LongMonthNames[9] = "Octobre";
        Result.LongMonthNames[10] = "Novembre";
        Result.LongMonthNames[11] = "D\uFFFDcembre";
      } else if (pas.System.Pos("ES-",$mod.UpperCase(ALocale)) === 1) {
        Result.LongDayNames[0] = "Domingo";
        Result.LongDayNames[1] = "Lunes";
        Result.LongDayNames[2] = "Martes";
        Result.LongDayNames[3] = "Mi\uFFFDrcoles";
        Result.LongDayNames[4] = "Jueves";
        Result.LongDayNames[5] = "Viernes";
        Result.LongDayNames[6] = "S\uFFFDbado";
        Result.ShortDayNames[0] = "Dom";
        Result.ShortDayNames[1] = "Lun";
        Result.ShortDayNames[2] = "Mar";
        Result.ShortDayNames[3] = "Mi\uFFFD";
        Result.ShortDayNames[4] = "Jue";
        Result.ShortDayNames[5] = "Vie";
        Result.ShortDayNames[6] = "Sab";
        Result.ShortMonthNames[0] = "Ene";
        Result.ShortMonthNames[1] = "Feb";
        Result.ShortMonthNames[2] = "Mar";
        Result.ShortMonthNames[3] = "Abr";
        Result.ShortMonthNames[4] = "May";
        Result.ShortMonthNames[5] = "Jun";
        Result.ShortMonthNames[6] = "Jul";
        Result.ShortMonthNames[7] = "Ago";
        Result.ShortMonthNames[8] = "Sep";
        Result.ShortMonthNames[9] = "Oct";
        Result.ShortMonthNames[10] = "Nov";
        Result.ShortMonthNames[11] = "Dic";
        Result.LongMonthNames[0] = "January";
        Result.LongMonthNames[1] = "Febrero";
        Result.LongMonthNames[2] = "Marzi";
        Result.LongMonthNames[3] = "Abril";
        Result.LongMonthNames[4] = "Mayo";
        Result.LongMonthNames[5] = "Junio";
        Result.LongMonthNames[6] = "Julio";
        Result.LongMonthNames[7] = "Agusto";
        Result.LongMonthNames[8] = "Septiembre";
        Result.LongMonthNames[9] = "Octubre";
        Result.LongMonthNames[10] = "Noviembre";
        Result.LongMonthNames[11] = "Diciembre";
      } else {
        Result.LongDayNames[0] = "Sunday";
        Result.LongDayNames[1] = "Monday";
        Result.LongDayNames[2] = "Tuesday";
        Result.LongDayNames[3] = "Wednesday";
        Result.LongDayNames[4] = "Thursday";
        Result.LongDayNames[5] = "Friday";
        Result.LongDayNames[6] = "Saturday";
        Result.ShortDayNames[0] = "Sun";
        Result.ShortDayNames[1] = "Mon";
        Result.ShortDayNames[2] = "Tue";
        Result.ShortDayNames[3] = "Wed";
        Result.ShortDayNames[4] = "Thu";
        Result.ShortDayNames[5] = "Fri";
        Result.ShortDayNames[6] = "Sat";
        Result.ShortMonthNames[0] = "Jan";
        Result.ShortMonthNames[1] = "Feb";
        Result.ShortMonthNames[2] = "Mar";
        Result.ShortMonthNames[3] = "Apr";
        Result.ShortMonthNames[4] = "May";
        Result.ShortMonthNames[5] = "Jun";
        Result.ShortMonthNames[6] = "Jul";
        Result.ShortMonthNames[7] = "Aug";
        Result.ShortMonthNames[8] = "Sep";
        Result.ShortMonthNames[9] = "Oct";
        Result.ShortMonthNames[10] = "Nov";
        Result.ShortMonthNames[11] = "Dec";
        Result.LongMonthNames[0] = "January";
        Result.LongMonthNames[1] = "February";
        Result.LongMonthNames[2] = "March";
        Result.LongMonthNames[3] = "April";
        Result.LongMonthNames[4] = "May";
        Result.LongMonthNames[5] = "June";
        Result.LongMonthNames[6] = "July";
        Result.LongMonthNames[7] = "August";
        Result.LongMonthNames[8] = "September";
        Result.LongMonthNames[9] = "October";
        Result.LongMonthNames[10] = "November";
        Result.LongMonthNames[11] = "December";
      };
      Result.DateTimeToStrFormat[0] = "c";
      Result.DateTimeToStrFormat[1] = "f";
      Result.DateSeparator = "-";
      Result.TimeSeparator = ":";
      Result.ShortDateFormat = "yyyy-mm-dd";
      Result.LongDateFormat = "ddd, yyyy-mm-dd";
      Result.DecimalSeparator = ".";
      Result.ThousandSeparator = ",";
      Result.TimeAMString = "AM";
      Result.TimePMString = "PM";
      Result.TwoDigitYearCenturyWindow = 50;
      Result.ShortTimeFormat = $mod.TFormatSettings.GetLocaleShortTimeFormat(ALocale);
      Result.LongTimeFormat = $mod.TFormatSettings.GetLocaleLongTimeFormat(ALocale);
      Result.ShortDateFormat = $mod.TFormatSettings.GetLocaleShortDateFormat(ALocale);
      for (var $l = 0, $end = rtl.length(cDateSeps) - 1; $l <= $end; $l++) {
        lCount = $l;
        if ($mod.TStringHelper.IndexOf.call({p: Result, get: function () {
            return this.p.ShortDateFormat;
          }, set: function (v) {
            this.p.ShortDateFormat = v;
          }},cDateSeps[lCount]) >= 0) Result.DateSeparator = cDateSeps[lCount];
      };
      var lEvent = new Date('Jan 1, 1980 06:07:08 GMT+00:00');
      var lLoc = "";
      if (ALocale == "")
        lLoc = navigator.language;
      else
        lLoc = ALocale;
      lTimeStr = lEvent.toLocaleTimeString(lLoc);
      for (var $l1 = 0, $end1 = rtl.length(cTimeSeps) - 1; $l1 <= $end1; $l1++) {
        lCount = $l1;
        if ($mod.TStringHelper.IndexOf.call({get: function () {
            return lTimeStr;
          }, set: function (v) {
            lTimeStr = v;
          }},cTimeSeps[lCount]) >= 0) Result.TimeSeparator = cTimeSeps[lCount];
      };
      for (lCount = 1; lCount <= 7; lCount++) Result.ShortDayNames[lCount - 1] = $mod.TFormatSettings.GetLocaleShortDayName(lCount,ALocale);
      for (lCount = 1; lCount <= 7; lCount++) Result.LongDayNames[lCount - 1] = $mod.TFormatSettings.GetLocaleLongDayName(lCount,ALocale);
      for (lCount = 1; lCount <= 12; lCount++) Result.ShortMonthNames[lCount - 1] = $mod.TFormatSettings.GetLocaleShortMonthName(lCount,ALocale);
      for (lCount = 1; lCount <= 12; lCount++) Result.LongMonthNames[lCount - 1] = $mod.TFormatSettings.GetLocaleLongMonthName(lCount,ALocale);
      Result.DecimalSeparator = $mod.TFormatSettings.GetLocaleDecimalSeparator(ALocale);
      for (var $l2 = 0, $end2 = rtl.length(cDecSeps) - 1; $l2 <= $end2; $l2++) {
        lCount = $l2;
        if (Result.DecimalSeparator === cDecSeps[lCount]) {
          Result.ThousandSeparator = cThousandSeps[lCount];
          break;
        };
      };
      if ($mod.TFormatSettings.InitLocaleHandler != null) $mod.TFormatSettings.InitLocaleHandler($mod.UpperCase(ALocale),$mod.TFormatSettings.$clone(Result));
      return Result;
    };
    this.Invariant = function () {
      var Result = $mod.TFormatSettings.$new();
      if (!$impl.FInvariantCreated) {
        $impl.FInvariant.$assign($mod.TFormatSettings.Create$1("EN-US"));
        $impl.FInvariant.CurrencyString = "¤";
        $impl.FInvariant.CurrencyFormat = 0;
        $impl.FInvariant.CurrencyDecimals = 2;
        $impl.FInvariant.DateSeparator = "/";
        $impl.FInvariant.TimeSeparator = ":";
        $impl.FInvariant.ShortDateFormat = "MM/dd/yyyy";
        $impl.FInvariant.LongDateFormat = "dddd, dd MMMMM yyyy HH:mm:ss";
        $impl.FInvariant.TimeAMString = "AM";
        $impl.FInvariant.TimePMString = "PM";
        $impl.FInvariant.ShortTimeFormat = "HH:mm";
        $impl.FInvariant.LongTimeFormat = "HH:mm:ss";
        $impl.FInvariant.ShortMonthNames = $impl.DefaultShortMonthNames.slice(0);
        $impl.FInvariant.LongMonthNames = $impl.DefaultLongMonthNames.slice(0);
        $impl.FInvariant.ShortDayNames = $impl.DefaultShortDayNames.slice(0);
        $impl.FInvariant.LongDayNames = $impl.DefaultLongDayNames.slice(0);
        $impl.FInvariant.ThousandSeparator = ",";
        $impl.FInvariant.DecimalSeparator = ".";
        $impl.FInvariant.TwoDigitYearCenturyWindow = 50;
        $impl.FInvariant.NegCurrFormat = 0;
        $impl.FInvariantCreated = true;
      };
      Result.$assign($impl.FInvariant);
      return Result;
    };
  },true);
  rtl.createClass(this,"Exception",pas.System.TObject,function () {
    this.LogMessageOnCreate = false;
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FMessage = "";
      this.FJSError = null;
      this.FStack = undefined;
    };
    this.$final = function () {
      this.FJSError = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (Msg) {
      this.FMessage = Msg;
      this.FJSError = new Error(Msg);
      this.FStack = this.FJSError.stack;
      if (this.LogMessageOnCreate) pas.System.Writeln("Created exception ",this.$classname," with message: ",Msg);
      return this;
    };
    this.CreateFmt = function (Msg, Args) {
      this.Create$1($mod.Format(Msg,Args));
      return this;
    };
  });
  rtl.createClass(this,"EConvertError",this.Exception,function () {
  });
  rtl.createClass(this,"EArgumentException",this.Exception,function () {
  });
  rtl.createClass(this,"EArgumentOutOfRangeException",this.EArgumentException,function () {
  });
  this.Trim = function (S) {
    return S.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,'').replace(/[\s\uFEFF\xA0\x00-\x1f]+$/,'');
  };
  this.TrimLeft = function (S) {
    return S.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,'');
  };
  this.UpperCase = function (s) {
    return s.toUpperCase();
  };
  this.LowerCase = function (s) {
    return s.toLowerCase();
  };
  this.CompareStr = function (s1, s2) {
    var l1 = s1.length;
    var l2 = s2.length;
    if (l1<=l2){
      var s = s2.substr(0,l1);
      if (s1<s){ return -1;
      } else if (s1>s){ return 1;
      } else { return l1<l2 ? -1 : 0; };
    } else {
      var s = s1.substr(0,l2);
      if (s<s2){ return -1;
      } else { return 1; };
    };
  };
  this.CompareText = function (s1, s2) {
    var l1 = s1.toLowerCase();
    var l2 = s2.toLowerCase();
    if (l1>l2){ return 1;
    } else if (l1<l2){ return -1;
    } else { return 0; };
  };
  this.SameText = function (s1, s2) {
    return s1.toLowerCase() == s2.toLowerCase();
  };
  this.Format = function (Fmt, Args) {
    var Result = "";
    Result = $mod.Format$1(Fmt,Args,$mod.FormatSettings);
    return Result;
  };
  this.Format$1 = function (Fmt, Args, aSettings) {
    var Result = "";
    var ChPos = 0;
    var OldPos = 0;
    var ArgPos = 0;
    var DoArg = 0;
    var Len = 0;
    var Hs = "";
    var ToAdd = "";
    var Index = 0;
    var Width = 0;
    var Prec = 0;
    var Left = false;
    var Fchar = "";
    var vq = 0;
    function ReadFormat() {
      var Result = "";
      var Value = 0;
      function ReadInteger() {
        var Code = 0;
        var ArgN = 0;
        if (Value !== -1) return;
        OldPos = ChPos;
        while ((ChPos <= Len) && (Fmt.charAt(ChPos - 1) <= "9") && (Fmt.charAt(ChPos - 1) >= "0")) ChPos += 1;
        if (ChPos > Len) $impl.DoFormatError(1,Fmt);
        if (Fmt.charAt(ChPos - 1) === "*") {
          if (Index === 255) {
            ArgN = ArgPos}
           else {
            ArgN = Index;
            Index += 1;
          };
          if ((ChPos > OldPos) || (ArgN > (rtl.length(Args) - 1))) $impl.DoFormatError(1,Fmt);
          ArgPos = ArgN + 1;
          var $tmp = Args[ArgN].VType;
          if ($tmp === 0) {
            Value = Args[ArgN].VJSValue}
           else if ($tmp === 19) {
            Value = Args[ArgN].VJSValue}
           else {
            $impl.DoFormatError(1,Fmt);
          };
          ChPos += 1;
        } else {
          if (OldPos < ChPos) {
            pas.System.val(pas.System.Copy(Fmt,OldPos,ChPos - OldPos),{get: function () {
                return Value;
              }, set: function (v) {
                Value = v;
              }},{get: function () {
                return Code;
              }, set: function (v) {
                Code = v;
              }});
            if (Code > 0) $impl.DoFormatError(1,Fmt);
          } else Value = -1;
        };
      };
      function ReadIndex() {
        if (Fmt.charAt(ChPos - 1) !== ":") {
          ReadInteger()}
         else Value = 0;
        if (Fmt.charAt(ChPos - 1) === ":") {
          if (Value === -1) $impl.DoFormatError(2,Fmt);
          Index = Value;
          Value = -1;
          ChPos += 1;
        };
      };
      function ReadLeft() {
        if (Fmt.charAt(ChPos - 1) === "-") {
          Left = true;
          ChPos += 1;
        } else Left = false;
      };
      function ReadWidth() {
        ReadInteger();
        if (Value !== -1) {
          Width = Value;
          Value = -1;
        };
      };
      function ReadPrec() {
        if (Fmt.charAt(ChPos - 1) === ".") {
          ChPos += 1;
          ReadInteger();
          if (Value === -1) Value = 0;
          Prec = Value;
        };
      };
      Index = 255;
      Width = -1;
      Prec = -1;
      Value = -1;
      ChPos += 1;
      if (Fmt.charAt(ChPos - 1) === "%") {
        Result = "%";
        return Result;
      };
      ReadIndex();
      ReadLeft();
      ReadWidth();
      ReadPrec();
      Result = pas.System.upcase(Fmt.charAt(ChPos - 1));
      return Result;
    };
    function Checkarg(AT, err) {
      var Result = false;
      Result = false;
      if (Index === 255) {
        DoArg = ArgPos}
       else DoArg = Index;
      ArgPos = DoArg + 1;
      if ((DoArg > (rtl.length(Args) - 1)) || (Args[DoArg].VType !== AT)) {
        if (err) $impl.DoFormatError(3,Fmt);
        ArgPos -= 1;
        return Result;
      };
      Result = true;
      return Result;
    };
    Result = "";
    Len = Fmt.length;
    ChPos = 1;
    OldPos = 1;
    ArgPos = 0;
    while (ChPos <= Len) {
      while ((ChPos <= Len) && (Fmt.charAt(ChPos - 1) !== "%")) ChPos += 1;
      if (ChPos > OldPos) Result = Result + pas.System.Copy(Fmt,OldPos,ChPos - OldPos);
      if (ChPos < Len) {
        Fchar = ReadFormat();
        var $tmp = Fchar;
        if ($tmp === "D") {
          if (Checkarg(0,false)) {
            ToAdd = $mod.IntToStr(Args[DoArg].VJSValue)}
           else if (Checkarg(19,true)) ToAdd = $mod.IntToStr(Args[DoArg].VJSValue);
          Width = Math.abs(Width);
          Index = Prec - ToAdd.length;
          if (ToAdd.charAt(0) !== "-") {
            ToAdd = pas.System.StringOfChar("0",Index) + ToAdd}
           else pas.System.Insert(pas.System.StringOfChar("0",Index + 1),{get: function () {
              return ToAdd;
            }, set: function (v) {
              ToAdd = v;
            }},2);
        } else if ($tmp === "U") {
          if (Checkarg(0,false)) {
            ToAdd = $mod.IntToStr(Args[DoArg].VJSValue >>> 0)}
           else if (Checkarg(19,true)) ToAdd = $mod.IntToStr(Args[DoArg].VJSValue);
          Width = Math.abs(Width);
          Index = Prec - ToAdd.length;
          ToAdd = pas.System.StringOfChar("0",Index) + ToAdd;
        } else if ($tmp === "E") {
          if (Checkarg(12,false)) {
            ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue / 10000,2,3,Prec,aSettings)}
           else if (Checkarg(3,true)) ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue,2,3,Prec,aSettings);
        } else if ($tmp === "F") {
          if (Checkarg(12,false)) {
            ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue / 10000,0,9999,Prec,aSettings)}
           else if (Checkarg(0,false)) {
            ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue,0,9999,Prec,aSettings)}
           else if (Checkarg(3,true)) ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue,0,9999,Prec,aSettings);
        } else if ($tmp === "G") {
          if (Checkarg(12,false)) {
            ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue / 10000,1,Prec,3,aSettings)}
           else if (Checkarg(3,true)) ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue,1,Prec,3,aSettings);
        } else if ($tmp === "N") {
          if (Checkarg(12,false)) {
            ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue / 10000,3,9999,Prec,aSettings)}
           else if (Checkarg(3,true)) ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue,3,9999,Prec,aSettings);
        } else if ($tmp === "M") {
          if (Checkarg(12,false)) {
            ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue / 10000,4,9999,Prec,aSettings)}
           else if (Checkarg(3,true)) ToAdd = $mod.FloatToStrF$1(Args[DoArg].VJSValue,4,9999,Prec,aSettings);
        } else if ($tmp === "S") {
          if (Checkarg(18,false)) {
            Hs = Args[DoArg].VJSValue}
           else if (Checkarg(9,true)) Hs = Args[DoArg].VJSValue;
          Index = Hs.length;
          if ((Prec !== -1) && (Index > Prec)) Index = Prec;
          ToAdd = pas.System.Copy(Hs,1,Index);
        } else if ($tmp === "P") {
          if (Checkarg(0,false)) {
            ToAdd = $mod.IntToHex(Args[DoArg].VJSValue,8)}
           else if (Checkarg(0,true)) ToAdd = $mod.IntToHex(Args[DoArg].VJSValue,16);
        } else if ($tmp === "X") {
          if (Checkarg(0,false)) {
            vq = Args[DoArg].VJSValue;
            Index = 16;
          } else if (Checkarg(19,true)) {
            vq = Args[DoArg].VJSValue;
            Index = 31;
          };
          if (Prec > Index) {
            ToAdd = $mod.IntToHex(vq,Index)}
           else {
            Index = 1;
            while ((rtl.shl(1,Index * 4) <= vq) && (Index < 16)) Index += 1;
            if (Index > Prec) Prec = Index;
            ToAdd = $mod.IntToHex(vq,Prec);
          };
        } else if ($tmp === "%") ToAdd = "%";
        if (Width !== -1) if (ToAdd.length < Width) if (!Left) {
          ToAdd = pas.System.StringOfChar(" ",Width - ToAdd.length) + ToAdd}
         else ToAdd = ToAdd + pas.System.StringOfChar(" ",Width - ToAdd.length);
        Result = Result + ToAdd;
      };
      ChPos += 1;
      OldPos = ChPos;
    };
    return Result;
  };
  var Alpha = rtl.createSet(null,65,90,null,97,122,95);
  var AlphaNum = rtl.unionSet(Alpha,rtl.createSet(null,48,57));
  var Dot = ".";
  this.IsValidIdent = function (Ident, AllowDots, StrictDots) {
    var Result = false;
    var First = false;
    var I = 0;
    var Len = 0;
    Len = Ident.length;
    if (Len < 1) return false;
    First = true;
    Result = false;
    I = 1;
    while (I <= Len) {
      if (First) {
        if (!(Ident.charCodeAt(I - 1) in Alpha)) return Result;
        First = false;
      } else if (AllowDots && (Ident.charAt(I - 1) === Dot)) {
        if (StrictDots) {
          if (I >= Len) return Result;
          First = true;
        };
      } else if (!(Ident.charCodeAt(I - 1) in AlphaNum)) return Result;
      I = I + 1;
    };
    Result = true;
    return Result;
  };
  this.TStringReplaceFlag = {"0": "rfReplaceAll", rfReplaceAll: 0, "1": "rfIgnoreCase", rfIgnoreCase: 1};
  this.StringReplace = function (aOriginal, aSearch, aReplace, Flags) {
    var Result = "";
    var REFlags = "";
    var REString = "";
    REFlags = "";
    if (0 in Flags) REFlags = "g";
    if (1 in Flags) REFlags = REFlags + "i";
    REString = aSearch.replace(new RegExp($impl.RESpecials,"g"),"\\$1");
    Result = aOriginal.replace(new RegExp(REString,REFlags),aReplace);
    return Result;
  };
  this.IntToStr = function (Value) {
    var Result = "";
    Result = "" + Value;
    return Result;
  };
  this.TryStrToInt = function (S, res) {
    var Result = false;
    Result = $mod.TryStrToInt$1(S,res,$mod.FormatSettings);
    return Result;
  };
  this.TryStrToInt$1 = function (S, res, aSettings) {
    var Result = false;
    var NI = 0;
    Result = $mod.TryStrToInt$3(S,{get: function () {
        return NI;
      }, set: function (v) {
        NI = v;
      }},aSettings);
    Result = Result && (-2147483648 <= NI) && (NI <= 2147483647);
    if (Result) res.set(NI);
    return Result;
  };
  this.TryStrToInt$2 = function (S, res) {
    var Result = false;
    Result = $impl.IntTryStrToInt(S,res,$mod.FormatSettings.DecimalSeparator);
    return Result;
  };
  this.TryStrToInt$3 = function (S, res, aSettings) {
    var Result = false;
    Result = $impl.IntTryStrToInt(S,res,aSettings.DecimalSeparator);
    return Result;
  };
  this.StrToIntDef$1 = function (S, aDef) {
    var Result = 0;
    var R = 0;
    if ($mod.TryStrToInt$2(S,{get: function () {
        return R;
      }, set: function (v) {
        R = v;
      }})) {
      Result = R}
     else Result = aDef;
    return Result;
  };
  this.StrToInt = function (S) {
    var Result = 0;
    var R = 0;
    if (!$mod.TryStrToInt$2(S,{get: function () {
        return R;
      }, set: function (v) {
        R = v;
      }})) throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidInteger"),pas.System.VarRecs(18,S)]);
    Result = R;
    return Result;
  };
  this.TryStrToInt64 = function (S, res) {
    var Result = false;
    Result = $mod.TryStrToInt64$1(S,res,$mod.FormatSettings);
    return Result;
  };
  this.TryStrToInt64$1 = function (S, res, ASettings) {
    var Result = false;
    var R = 0;
    Result = $mod.TryStrToInt$3(S,{get: function () {
        return R;
      }, set: function (v) {
        R = v;
      }},ASettings);
    if (Result) res.set(R);
    return Result;
  };
  this.IntToHex = function (Value, Digits) {
    var Result = "";
    Result = "";
    if (Value < 0) if (Value<0) Value = 0xFFFFFFFF + Value + 1;
    Result=Value.toString(16);
    Result = $mod.UpperCase(Result);
    while (Result.length < Digits) Result = "0" + Result;
    return Result;
  };
  this.TFloatFormat = {"0": "ffFixed", ffFixed: 0, "1": "ffGeneral", ffGeneral: 1, "2": "ffExponent", ffExponent: 2, "3": "ffNumber", ffNumber: 3, "4": "ffCurrency", ffCurrency: 4};
  var Rounds = "123456789:";
  this.FloatToDecimal = function (Value, Precision, Decimals) {
    var Result = $mod.TFloatRec.$new();
    var Buffer = "";
    var InfNan = "";
    var OutPos = 0;
    var error = 0;
    var N = 0;
    var L = 0;
    var C = 0;
    var GotNonZeroBeforeDot = false;
    var BeforeDot = false;
    Result.Negative = false;
    Result.Exponent = 0;
    for (C = 0; C <= 19; C++) Result.Digits[C] = "0";
    if (Value === 0) return Result;
    Buffer = rtl.floatToStr(Value,24);
    N = 1;
    L = Buffer.length;
    while (Buffer.charAt(N - 1) === " ") N += 1;
    Result.Negative = Buffer.charAt(N - 1) === "-";
    if (Result.Negative) {
      N += 1}
     else if (Buffer.charAt(N - 1) === "+") N += 1;
    if (L >= (N + 2)) {
      InfNan = pas.System.Copy(Buffer,N,3);
      if (InfNan === "Inf") {
        Result.Digits[0] = "\x00";
        Result.Exponent = 32767;
        return Result;
      };
      if (InfNan === "Nan") {
        Result.Digits[0] = "\x00";
        Result.Exponent = -32768;
        return Result;
      };
    };
    OutPos = 0;
    Result.Exponent = 0;
    BeforeDot = true;
    GotNonZeroBeforeDot = false;
    while ((L >= N) && (Buffer.charAt(N - 1) !== "E")) {
      if (Buffer.charAt(N - 1) === ".") {
        BeforeDot = false}
       else {
        if (BeforeDot) {
          Result.Exponent += 1;
          Result.Digits[OutPos] = Buffer.charAt(N - 1);
          if (Buffer.charAt(N - 1) !== "0") GotNonZeroBeforeDot = true;
        } else Result.Digits[OutPos] = Buffer.charAt(N - 1);
        OutPos += 1;
      };
      N += 1;
    };
    N += 1;
    if (N <= L) {
      pas.System.val$6(pas.System.Copy(Buffer,N,(L - N) + 1),{get: function () {
          return C;
        }, set: function (v) {
          C = v;
        }},{get: function () {
          return error;
        }, set: function (v) {
          error = v;
        }});
      Result.Exponent += C;
    };
    N = OutPos;
    L = 19;
    while (N < L) {
      Result.Digits[N] = "0";
      N += 1;
    };
    if ((Decimals + Result.Exponent) < Precision) {
      N = Decimals + Result.Exponent}
     else N = Precision;
    if (N >= L) N = L - 1;
    if (N === 0) {
      if (Result.Digits[0] >= "5") {
        Result.Digits[0] = "1";
        Result.Digits[1] = "\x00";
        Result.Exponent += 1;
      } else Result.Digits[0] = "\x00";
    } else if (N > 0) {
      if (Result.Digits[N] >= "5") {
        do {
          Result.Digits[N] = "\x00";
          N -= 1;
          Result.Digits[N] = Rounds.charAt(($mod.StrToInt(Result.Digits[N]) + 1) - 1);
        } while (!((N === 0) || (Result.Digits[N] < ":")));
        if (Result.Digits[0] === ":") {
          Result.Digits[0] = "1";
          Result.Exponent += 1;
        };
      } else {
        Result.Digits[N] = "0";
        while ((N > -1) && (Result.Digits[N] === "0")) {
          Result.Digits[N] = "\x00";
          N -= 1;
        };
      };
    } else Result.Digits[0] = "\x00";
    if ((Result.Digits[0] === "\x00") && !GotNonZeroBeforeDot) {
      Result.Exponent = 0;
      Result.Negative = false;
    };
    return Result;
  };
  this.FloatToStr = function (Value) {
    var Result = "";
    Result = $mod.FloatToStr$1(Value,$mod.FormatSettings);
    return Result;
  };
  this.FloatToStr$1 = function (Value, aSettings) {
    var Result = "";
    Result = $mod.FloatToStrF$1(Value,1,15,0,aSettings);
    return Result;
  };
  this.FloatToStrF$1 = function (Value, format, Precision, Digits, aSettings) {
    var Result = "";
    var TS = "";
    var DS = "";
    DS = aSettings.DecimalSeparator;
    TS = aSettings.ThousandSeparator;
    var $tmp = format;
    if ($tmp === 1) {
      Result = $impl.FormatGeneralFloat(Value,Precision,DS)}
     else if ($tmp === 2) {
      Result = $impl.FormatExponentFloat(Value,Precision,Digits,DS)}
     else if ($tmp === 0) {
      Result = $impl.FormatFixedFloat(Value,Digits,DS)}
     else if ($tmp === 3) {
      Result = $impl.FormatNumberFloat(Value,Digits,DS,TS)}
     else if ($tmp === 4) Result = $impl.FormatNumberCurrency(Value * 10000,Digits,aSettings);
    if ((format !== 4) && (Result.length > 1) && (Result.charAt(0) === "-")) $impl.RemoveLeadingNegativeSign({get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},DS,TS);
    return Result;
  };
  var TDecimalPart = {"0": "dpDigit", dpDigit: 0, "1": "dpSignificand", dpSignificand: 1, "2": "dpExp", dpExp: 2};
  this.TryStrToFloat$3 = function (S, res, aSettings) {
    var Result = false;
    var J = undefined;
    var I = 0;
    var aStart = 0;
    var Len = 0;
    var N = "";
    var p = 0;
    Result = false;
    N = S;
    if (aSettings.ThousandSeparator !== "") N = $mod.StringReplace(N,aSettings.ThousandSeparator,"",rtl.createSet(0));
    if (aSettings.DecimalSeparator !== ".") N = $mod.StringReplace(N,aSettings.DecimalSeparator,".",{});
    p = 0;
    I = 1;
    aStart = 1;
    Len = N.length;
    while (I <= Len) {
      var $tmp = N.charAt(I - 1);
      if (($tmp === "+") || ($tmp === "-")) {
        var $tmp1 = p;
        if ($tmp1 === 1) {
          return Result}
         else if ($tmp1 === 0) {
          if (I > aStart) return Result}
         else if ($tmp1 === 2) if (I > (aStart + 1)) return Result;
      } else if (($tmp >= "0") && ($tmp <= "9")) {}
      else if ($tmp === ".") {
        if (p !== 0) return Result;
        p = 1;
        aStart = I;
      } else if (($tmp === "E") || ($tmp === "e")) {
        if (p === 2) {
          return Result}
         else {
          p = 2;
          aStart = I;
        };
      } else {
        return Result;
      };
      I += 1;
    };
    J = parseFloat(N);
    Result = !isNaN(J);
    if (Result) res.set(rtl.getNumber(J));
    return Result;
  };
  this.StrToFloatDef = function (S, aDef) {
    var Result = 0.0;
    if (!$mod.TryStrToFloat$3(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},$mod.FormatSettings)) Result = aDef;
    return Result;
  };
  this.StrToFloat = function (S) {
    var Result = 0.0;
    Result = $mod.StrToFloat$1(S,$mod.FormatSettings);
    return Result;
  };
  this.StrToFloat$1 = function (S, aSettings) {
    var Result = 0.0;
    if (!$mod.TryStrToFloat$3(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},aSettings)) throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrInvalidFloat"),pas.System.VarRecs(18,S)]);
    return Result;
  };
  this.FormatFloat = function (Fmt, aValue) {
    var Result = "";
    Result = $mod.FormatFloat$1(Fmt,aValue,$mod.TFormatSettings.$clone($mod.FormatSettings));
    return Result;
  };
  var MaxPrecision = 18;
  this.FormatFloat$1 = function (Fmt, aValue, aSettings) {
    var Result = "";
    var E = 0.0;
    var FV = $mod.TFloatRec.$new();
    var Section = "";
    var SectionLength = 0;
    var ThousandSep = false;
    var IsScientific = false;
    var DecimalPos = 0;
    var FirstDigit = 0;
    var LastDigit = 0;
    var RequestedDigits = 0;
    var ExpSize = 0;
    var Available = 0;
    var Current = 0;
    var PadZeroes = 0;
    var DistToDecimal = 0;
    function InitVars() {
      E = aValue;
      Section = "";
      SectionLength = 0;
      ThousandSep = false;
      IsScientific = false;
      DecimalPos = 0;
      FirstDigit = 2147483647;
      LastDigit = 0;
      RequestedDigits = 0;
      ExpSize = 0;
      Available = -1;
    };
    function ToResult(AChar) {
      Result = Result + AChar;
    };
    function AddToResult(AStr) {
      Result = Result + AStr;
    };
    function WriteDigit(ADigit) {
      if (ADigit === "\x00") return;
      DistToDecimal -= 1;
      if (DistToDecimal === -1) {
        AddToResult(aSettings.DecimalSeparator);
        ToResult(ADigit);
      } else {
        ToResult(ADigit);
        if (ThousandSep && ((DistToDecimal % 3) === 0) && (DistToDecimal > 1)) AddToResult(aSettings.ThousandSeparator);
      };
    };
    function GetDigit() {
      var Result = "";
      Result = "\x00";
      if (Current <= Available) {
        Result = FV.Digits[Current];
        Current += 1;
      } else if (DistToDecimal <= LastDigit) {
        DistToDecimal -= 1}
       else Result = "0";
      return Result;
    };
    function CopyDigit() {
      if (PadZeroes === 0) {
        WriteDigit(GetDigit())}
       else if (PadZeroes < 0) {
        PadZeroes += 1;
        if (DistToDecimal <= FirstDigit) {
          WriteDigit("0")}
         else DistToDecimal -= 1;
      } else {
        while (PadZeroes > 0) {
          WriteDigit(GetDigit());
          PadZeroes -= 1;
        };
        WriteDigit(GetDigit());
      };
    };
    function GetSections(SP) {
      var Result = 0;
      var FL = 0;
      var i = 0;
      var C = "";
      var Q = "";
      var inQuote = false;
      Result = 1;
      SP.get()[1] = -1;
      SP.get()[2] = -1;
      SP.get()[3] = -1;
      inQuote = false;
      Q = "\x00";
      i = 1;
      FL = Fmt.length;
      while (i <= FL) {
        C = Fmt.charAt(i - 1);
        var $tmp = C;
        if ($tmp === ";") {
          if (!inQuote) {
            if (Result > 3) throw $mod.Exception.$create("Create$1",["Invalid float format"]);
            SP.get()[Result] = i;
            Result += 1;
          };
        } else if (($tmp === '"') || ($tmp === "'")) {
          if (inQuote) {
            inQuote = C !== Q}
           else {
            inQuote = true;
            Q = C;
          };
        };
        i += 1;
      };
      if (SP.get()[Result] === -1) SP.get()[Result] = FL + 1;
      return Result;
    };
    function AnalyzeFormat() {
      var I = 0;
      var Len = 0;
      var Q = "";
      var C = "";
      var InQuote = false;
      Len = Section.length;
      I = 1;
      InQuote = false;
      Q = "\x00";
      while (I <= Len) {
        C = Section.charAt(I - 1);
        if (C.charCodeAt() in rtl.createSet(34,39)) {
          if (InQuote) {
            InQuote = C !== Q}
           else {
            InQuote = true;
            Q = C;
          };
        } else if (!InQuote) {
          var $tmp = C;
          if ($tmp === ".") {
            if (DecimalPos === 0) DecimalPos = RequestedDigits + 1}
           else if ($tmp === ",") {
            ThousandSep = aSettings.ThousandSeparator !== "\x00"}
           else if (($tmp === "e") || ($tmp === "E")) {
            I += 1;
            if (I < Len) {
              C = Section.charAt(I - 1);
              IsScientific = C.charCodeAt() in rtl.createSet(45,43);
              if (IsScientific) while ((I < Len) && (Section.charAt((I + 1) - 1) === "0")) {
                ExpSize += 1;
                I += 1;
              };
              if (ExpSize > 4) ExpSize = 4;
            };
          } else if ($tmp === "#") {
            RequestedDigits += 1}
           else if ($tmp === "0") {
            if (RequestedDigits < FirstDigit) FirstDigit = RequestedDigits + 1;
            RequestedDigits += 1;
            LastDigit = RequestedDigits + 1;
          };
        };
        I += 1;
      };
      if (DecimalPos === 0) DecimalPos = RequestedDigits + 1;
      LastDigit = DecimalPos - LastDigit;
      if (LastDigit > 0) LastDigit = 0;
      FirstDigit = DecimalPos - FirstDigit;
      if (FirstDigit < 0) FirstDigit = 0;
    };
    function ValueOutSideScope() {
      var Result = false;
      Result = ((FV.Exponent >= 18) && !IsScientific) || (FV.Exponent === 0x7FF) || (FV.Exponent === 0x800);
      return Result;
    };
    function CalcRunVars() {
      var D = 0;
      var P = 0;
      if (IsScientific) {
        P = RequestedDigits;
        D = 9999;
      } else {
        P = 18;
        D = (RequestedDigits - DecimalPos) + 1;
      };
      FV.$assign($mod.FloatToDecimal(aValue,P,D));
      DistToDecimal = DecimalPos - 1;
      if (IsScientific) {
        PadZeroes = 0}
       else {
        PadZeroes = FV.Exponent - (DecimalPos - 1);
        if (PadZeroes >= 0) DistToDecimal = FV.Exponent;
      };
      Available = -1;
      while ((Available < 18) && (FV.Digits[Available + 1] !== "\x00")) Available += 1;
    };
    function FormatExponent(ASign, aExponent) {
      var Result = "";
      Result = $mod.IntToStr(aExponent);
      Result = pas.System.StringOfChar("0",ExpSize - Result.length) + Result;
      if (aExponent < 0) {
        Result = "-" + Result}
       else if ((aExponent > 0) && (ASign === "+")) Result = ASign + Result;
      return Result;
    };
    var I = 0;
    var S = 0;
    var C = "";
    var Q = "";
    var PA = [];
    var InLiteral = false;
    PA = rtl.arraySetLength(PA,0,4);
    Result = "";
    InitVars();
    if (E > 0) {
      S = 1}
     else if (E < 0) {
      S = 2}
     else S = 3;
    PA[0] = 0;
    I = GetSections({get: function () {
        return PA;
      }, set: function (v) {
        PA = v;
      }});
    if ((I < S) || ((PA[S] - PA[S - 1]) === 0)) S = 1;
    SectionLength = PA[S] - PA[S - 1] - 1;
    Section = pas.System.Copy(Fmt,PA[S - 1] + 1,SectionLength);
    Section = rtl.strSetLength(Section,SectionLength);
    AnalyzeFormat();
    CalcRunVars();
    if ((SectionLength === 0) || ValueOutSideScope()) {
      Section=E.toPrecision(15);
      Result = Section;
    };
    I = 1;
    Current = 0;
    Q = " ";
    InLiteral = false;
    if (FV.Negative && (S === 1)) ToResult("-");
    while (I <= SectionLength) {
      C = Section.charAt(I - 1);
      if (C.charCodeAt() in rtl.createSet(34,39)) {
        if (InLiteral) {
          InLiteral = C !== Q}
         else {
          InLiteral = true;
          Q = C;
        };
      } else if (InLiteral) {
        ToResult(C)}
       else {
        var $tmp = C;
        if (($tmp === "0") || ($tmp === "#")) {
          CopyDigit()}
         else if (($tmp === ".") || ($tmp === ",")) {}
        else if (($tmp === "e") || ($tmp === "E")) {
          ToResult(C);
          I += 1;
          if (I <= Section.length) {
            C = Section.charAt(I - 1);
            if (C.charCodeAt() in rtl.createSet(43,45)) {
              AddToResult(FormatExponent(C,(FV.Exponent - DecimalPos) + 1));
              while ((I < SectionLength) && (Section.charAt((I + 1) - 1) === "0")) I += 1;
            };
          };
        } else {
          ToResult(C);
        };
      };
      I += 1;
    };
    return Result;
  };
  this.TrueBoolStrs = [];
  this.FalseBoolStrs = [];
  this.StrToBool = function (S) {
    var Result = false;
    if (!$mod.TryStrToBool(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }})) throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidBoolean"),pas.System.VarRecs(18,S)]);
    return Result;
  };
  this.BoolToStr = function (B, UseBoolStrs) {
    var Result = "";
    if (UseBoolStrs) {
      $impl.CheckBoolStrs();
      if (B) {
        Result = $mod.TrueBoolStrs[0]}
       else Result = $mod.FalseBoolStrs[0];
    } else if (B) {
      Result = "-1"}
     else Result = "0";
    return Result;
  };
  this.StrToBoolDef = function (S, Default) {
    var Result = false;
    if (!$mod.TryStrToBool(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }})) Result = Default;
    return Result;
  };
  this.TryStrToBool = function (S, Value) {
    var Result = false;
    var Temp = "";
    var I = 0;
    var D = 0.0;
    var Code = 0;
    Temp = $mod.UpperCase(S);
    pas.System.val$8(Temp,{get: function () {
        return D;
      }, set: function (v) {
        D = v;
      }},{get: function () {
        return Code;
      }, set: function (v) {
        Code = v;
      }});
    Result = true;
    if (Code === 0) {
      Value.set(D !== 0.0)}
     else {
      $impl.CheckBoolStrs();
      for (var $l = 0, $end = rtl.length($mod.TrueBoolStrs) - 1; $l <= $end; $l++) {
        I = $l;
        if (Temp === $mod.UpperCase($mod.TrueBoolStrs[I])) {
          Value.set(true);
          return Result;
        };
      };
      for (var $l1 = 0, $end1 = rtl.length($mod.FalseBoolStrs) - 1; $l1 <= $end1; $l1++) {
        I = $l1;
        if (Temp === $mod.UpperCase($mod.FalseBoolStrs[I])) {
          Value.set(false);
          return Result;
        };
      };
      Result = false;
    };
    return Result;
  };
  rtl.recNewT(this,"TTimeStamp",function () {
    this.Time = 0;
    this.Date = 0;
    this.$eq = function (b) {
      return (this.Time === b.Time) && (this.Date === b.Date);
    };
    this.$assign = function (s) {
      this.Time = s.Time;
      this.Date = s.Date;
      return this;
    };
  });
  this.TimeSeparator = "";
  this.DateSeparator = "";
  this.ShortDateFormat = "";
  this.LongDateFormat = "";
  this.ShortTimeFormat = "";
  this.LongTimeFormat = "";
  this.DecimalSeparator = "";
  this.ThousandSeparator = "";
  this.TimeAMString = "";
  this.TimePMString = "";
  this.HoursPerDay = 24;
  this.MinsPerHour = 60;
  this.SecsPerMin = 60;
  this.MSecsPerSec = 1000;
  this.MinsPerDay = 24 * 60;
  this.SecsPerDay = 1440 * 60;
  this.MSecsPerDay = 86400 * 1000;
  this.MaxDateTime = 2958465.99999999;
  this.DateDelta = 693594;
  this.MonthDays$a$clone = function (a) {
    var b = [];
    b.length = 2;
    for (var c = 0; c < 2; c++) b[c] = a[c].slice(0);
    return b;
  };
  this.MonthDays = [[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]];
  this.ShortMonthNames = rtl.arraySetLength(null,"",12);
  this.LongMonthNames = rtl.arraySetLength(null,"",12);
  this.ShortDayNames = rtl.arraySetLength(null,"",7);
  this.LongDayNames = rtl.arraySetLength(null,"",7);
  this.FormatSettings = this.TFormatSettings.$new();
  this.TwoDigitYearCenturyWindow = 50;
  this.JSDateToDateTime = function (aDate) {
    var Result = 0.0;
    Result = $mod.EncodeDate(aDate.getFullYear(),aDate.getMonth() + 1,aDate.getDate()) + $mod.EncodeTime(aDate.getHours(),aDate.getMinutes(),aDate.getSeconds(),aDate.getMilliseconds());
    return Result;
  };
  this.DateTimeToTimeStamp = function (DateTime) {
    var Result = $mod.TTimeStamp.$new();
    var D = 0.0;
    D = DateTime * 86400000;
    if (D < 0) {
      D = D - 0.5}
     else D = D + 0.5;
    Result.Time = pas.System.Trunc(Math.abs(pas.System.Trunc(D)) % 86400000);
    Result.Date = 693594 + rtl.trunc(pas.System.Trunc(D) / 86400000);
    return Result;
  };
  this.TryEncodeDate = function (Year, Month, Day, date) {
    var Result = false;
    var c = 0;
    var ya = 0;
    Result = (Year > 0) && (Year < 10000) && (Month >= 1) && (Month <= 12) && (Day > 0) && (Day <= $mod.MonthDays[+$mod.IsLeapYear(Year)][Month - 1]);
    if (Result) {
      if (Month > 2) {
        Month -= 3}
       else {
        Month += 9;
        Year -= 1;
      };
      c = rtl.trunc(Year / 100);
      ya = Year - (100 * c);
      date.set(((146097 * c) >>> 2) + ((1461 * ya) >>> 2) + rtl.trunc(((153 * Month) + 2) / 5) + Day);
      date.set(date.get() - 693900);
    };
    return Result;
  };
  this.TryEncodeTime = function (Hour, Min, Sec, MSec, Time) {
    var Result = false;
    Result = (Hour < 24) && (Min < 60) && (Sec < 60) && (MSec < 1000);
    if (Result) Time.set(((Hour * 3600000) + (Min * 60000) + (Sec * 1000) + MSec) / 86400000);
    return Result;
  };
  this.EncodeDate = function (Year, Month, Day) {
    var Result = 0.0;
    if (!$mod.TryEncodeDate(Year,Month,Day,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }})) throw $mod.EConvertError.$create("CreateFmt",["%s-%s-%s is not a valid date specification",pas.System.VarRecs(18,$mod.IntToStr(Year),18,$mod.IntToStr(Month),18,$mod.IntToStr(Day))]);
    return Result;
  };
  this.EncodeTime = function (Hour, Minute, Second, MilliSecond) {
    var Result = 0.0;
    if (!$mod.TryEncodeTime(Hour,Minute,Second,MilliSecond,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }})) throw $mod.EConvertError.$create("CreateFmt",["%s:%s:%s.%s is not a valid time specification",pas.System.VarRecs(18,$mod.IntToStr(Hour),18,$mod.IntToStr(Minute),18,$mod.IntToStr(Second),18,$mod.IntToStr(MilliSecond))]);
    return Result;
  };
  this.DecodeDate = function (date, Year, Month, Day) {
    var ly = 0;
    var ld = 0;
    var lm = 0;
    var j = 0;
    if (date <= -693594) {
      Year.set(0);
      Month.set(0);
      Day.set(0);
    } else {
      if (date > 0) {
        date = date + (1 / (86400000 * 2))}
       else date = date - (1 / (86400000 * 2));
      if (date > $mod.MaxDateTime) date = $mod.MaxDateTime;
      j = rtl.shl(pas.System.Trunc(date) + 693900,2) - 1;
      ly = rtl.trunc(j / 146097);
      j = j - (146097 * ly);
      ld = rtl.lw(j >>> 2);
      j = rtl.trunc((rtl.lw(ld << 2) + 3) / 1461);
      ld = rtl.lw(((rtl.lw(ld << 2) + 7) - (1461 * j)) >>> 2);
      lm = rtl.trunc(((5 * ld) - 3) / 153);
      ld = rtl.trunc((((5 * ld) + 2) - (153 * lm)) / 5);
      ly = (100 * ly) + j;
      if (lm < 10) {
        lm += 3}
       else {
        lm -= 9;
        ly += 1;
      };
      Year.set(ly);
      Month.set(lm);
      Day.set(ld);
    };
  };
  this.DecodeTime = function (Time, Hour, Minute, Second, MilliSecond) {
    var l = 0;
    l = $mod.DateTimeToTimeStamp(Time).Time;
    Hour.set(rtl.trunc(l / 3600000));
    l = l % 3600000;
    Minute.set(rtl.trunc(l / 60000));
    l = l % 60000;
    Second.set(rtl.trunc(l / 1000));
    l = l % 1000;
    MilliSecond.set(l);
  };
  this.DecodeDateFully = function (DateTime, Year, Month, Day, DOW) {
    var Result = false;
    $mod.DecodeDate(DateTime,Year,Month,Day);
    DOW.set($mod.DayOfWeek(DateTime));
    Result = $mod.IsLeapYear(Year.get());
    return Result;
  };
  this.ComposeDateTime = function (date, Time) {
    var Result = 0.0;
    if (date < 0) {
      Result = pas.System.Trunc(date) - Math.abs(pas.System.Frac(Time))}
     else Result = pas.System.Trunc(date) + Math.abs(pas.System.Frac(Time));
    return Result;
  };
  this.Date = function () {
    var Result = 0.0;
    Result = pas.System.Trunc($mod.Now());
    return Result;
  };
  this.Time = function () {
    var Result = 0.0;
    Result = $mod.Now() - $mod.Date();
    return Result;
  };
  this.Now = function () {
    var Result = 0.0;
    Result = $mod.JSDateToDateTime(new Date());
    return Result;
  };
  this.DayOfWeek = function (DateTime) {
    var Result = 0;
    Result = 1 + ((pas.System.Trunc(DateTime) - 1) % 7);
    if (Result <= 0) Result += 7;
    return Result;
  };
  this.IsLeapYear = function (Year) {
    var Result = false;
    Result = ((Year % 4) === 0) && (((Year % 100) !== 0) || ((Year % 400) === 0));
    return Result;
  };
  this.DateToStr = function (date) {
    var Result = "";
    Result = $mod.DateToStr$1(date,$mod.FormatSettings);
    return Result;
  };
  this.DateToStr$1 = function (date, aSettings) {
    var Result = "";
    Result = $mod.FormatDateTime$1("ddddd",date,aSettings);
    return Result;
  };
  this.StrToDate = function (S) {
    var Result = 0.0;
    Result = $mod.StrToDate$3(S,$mod.FormatSettings);
    return Result;
  };
  this.StrToDate$2 = function (S, useformat, separator) {
    var Result = 0.0;
    var MSg = "";
    Result = $impl.IntStrToDate({get: function () {
        return MSg;
      }, set: function (v) {
        MSg = v;
      }},S,useformat,separator);
    if (MSg !== "") throw $mod.EConvertError.$create("Create$1",[MSg]);
    return Result;
  };
  this.StrToDate$3 = function (S, aSettings) {
    var Result = 0.0;
    Result = $mod.StrToDate$2(S,aSettings.ShortDateFormat,aSettings.DateSeparator);
    return Result;
  };
  this.TryStrToDate = function (S, Value) {
    var Result = false;
    Result = $mod.TryStrToDate$1(S,Value,$mod.FormatSettings);
    return Result;
  };
  this.TryStrToDate$1 = function (S, Value, aSettings) {
    var Result = false;
    Result = $mod.TryStrToDate$3(S,Value,aSettings.ShortDateFormat,aSettings.DateSeparator);
    return Result;
  };
  this.TryStrToDate$2 = function (S, Value, separator) {
    var Result = false;
    Result = $mod.TryStrToDate$3(S,Value,$mod.FormatSettings.ShortDateFormat,separator);
    return Result;
  };
  this.TryStrToDate$3 = function (S, Value, useformat, separator) {
    var Result = false;
    var Msg = "";
    Result = S.length !== 0;
    if (Result) {
      Value.set($impl.IntStrToDate({get: function () {
          return Msg;
        }, set: function (v) {
          Msg = v;
        }},S,useformat,separator));
      Result = Msg === "";
    };
    return Result;
  };
  this.StrToDateDef = function (S, Defvalue) {
    var Result = 0.0;
    Result = $mod.StrToDateDef$1(S,Defvalue,"\x00");
    return Result;
  };
  this.StrToDateDef$1 = function (S, Defvalue, separator) {
    var Result = 0.0;
    if (!$mod.TryStrToDate$2(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},separator)) Result = Defvalue;
    return Result;
  };
  this.TimeToStr = function (Time) {
    var Result = "";
    Result = $mod.TimeToStr$1(Time,$mod.FormatSettings);
    return Result;
  };
  this.TimeToStr$1 = function (Time, aSettings) {
    var Result = "";
    Result = $mod.FormatDateTime$1("tt",Time,aSettings);
    return Result;
  };
  this.StrToTime = function (S) {
    var Result = 0.0;
    Result = $mod.StrToTime$2(S,$mod.FormatSettings);
    return Result;
  };
  this.StrToTime$2 = function (S, aSettings) {
    var Result = 0.0;
    var Msg = "";
    Result = $impl.IntStrToTime({get: function () {
        return Msg;
      }, set: function (v) {
        Msg = v;
      }},S,S.length,aSettings);
    if (Msg !== "") throw $mod.EConvertError.$create("Create$1",[Msg]);
    return Result;
  };
  this.TryStrToTime$1 = function (S, Value, aSettings) {
    var Result = false;
    var Msg = "";
    Result = S.length !== 0;
    if (Result) {
      Value.set($impl.IntStrToTime({get: function () {
          return Msg;
        }, set: function (v) {
          Msg = v;
        }},S,S.length,aSettings));
      Result = Msg === "";
    };
    return Result;
  };
  this.TryStrToTime$2 = function (S, Value, separator) {
    var Result = false;
    var Fmt = $mod.TFormatSettings.$new();
    Fmt.$assign($mod.TFormatSettings.Create());
    Fmt.TimeSeparator = separator;
    Result = $mod.TryStrToTime$1(S,Value,$mod.TFormatSettings.$clone(Fmt));
    return Result;
  };
  this.StrToTimeDef = function (S, Defvalue) {
    var Result = 0.0;
    Result = $mod.StrToTimeDef$1(S,Defvalue,"\x00");
    return Result;
  };
  this.StrToTimeDef$1 = function (S, Defvalue, separator) {
    var Result = 0.0;
    if (!$mod.TryStrToTime$2(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},separator)) Result = Defvalue;
    return Result;
  };
  this.StrToDateTime = function (S) {
    var Result = 0.0;
    Result = $mod.StrToDateTime$1(S,$mod.FormatSettings);
    return Result;
  };
  this.StrToDateTime$1 = function (s, aSettings) {
    var Result = 0.0;
    var TimeStr = "";
    var DateStr = "";
    var PartsFound = 0;
    PartsFound = $impl.SplitDateTimeStr(s,{get: function () {
        return DateStr;
      }, set: function (v) {
        DateStr = v;
      }},{get: function () {
        return TimeStr;
      }, set: function (v) {
        TimeStr = v;
      }},aSettings);
    var $tmp = PartsFound;
    if ($tmp === 0) {
      Result = $mod.StrToDate("")}
     else if ($tmp === 1) {
      if (DateStr.length > 0) {
        Result = $mod.StrToDate$2(DateStr,aSettings.ShortDateFormat,aSettings.DateSeparator)}
       else Result = $mod.StrToTime(TimeStr)}
     else if ($tmp === 2) Result = $mod.ComposeDateTime($mod.StrToDate$2(DateStr,aSettings.ShortDateFormat,aSettings.DateSeparator),$mod.StrToTime(TimeStr));
    return Result;
  };
  this.TryStrToDateTime$1 = function (S, Value, aSettings) {
    var Result = false;
    var I = 0;
    var dtdate = 0.0;
    var dttime = 0.0;
    Result = false;
    I = pas.System.Pos(aSettings.TimeSeparator,S);
    if (I > 0) {
      while ((I > 0) && (S.charAt(I - 1) !== " ")) I -= 1;
      if (I > 0) {
        if (!$mod.TryStrToDate$1(pas.System.Copy(S,1,I - 1),{get: function () {
            return dtdate;
          }, set: function (v) {
            dtdate = v;
          }},aSettings)) return Result;
        if (!$mod.TryStrToTime$1(pas.System.Copy(S,I + 1,S.length - I),{get: function () {
            return dttime;
          }, set: function (v) {
            dttime = v;
          }},$mod.TFormatSettings.$clone(aSettings))) return Result;
        Value.set($mod.ComposeDateTime(dtdate,dttime));
        Result = true;
      } else Result = $mod.TryStrToTime$1(S,Value,$mod.TFormatSettings.$clone(aSettings));
    } else Result = $mod.TryStrToDate$1(S,Value,aSettings);
    return Result;
  };
  this.StrToDateTimeDef = function (S, Defvalue) {
    var Result = 0.0;
    Result = $mod.StrToDateTimeDef$1(S,Defvalue,$mod.TFormatSettings.$clone($mod.FormatSettings));
    return Result;
  };
  this.StrToDateTimeDef$1 = function (S, Defvalue, aSettings) {
    var Result = 0.0;
    if (!$mod.TryStrToDateTime$1(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},aSettings)) Result = Defvalue;
    return Result;
  };
  this.FormatDateTime = function (FormatStr, DateTime) {
    var Result = "";
    Result = $mod.FormatDateTime$1(FormatStr,DateTime,$mod.FormatSettings);
    return Result;
  };
  this.FormatDateTime$1 = function (FormatStr, DateTime, aSettings) {
    var Result = "";
    function StoreStr(FormatStr, APos, Len) {
      Result = Result + pas.System.Copy(FormatStr,APos,Len);
    };
    function StoreString(AStr) {
      Result = Result + AStr;
    };
    function StoreInt(Value, Digits) {
      var S = "";
      S = $mod.IntToStr(Value);
      while (S.length < Digits) S = "0" + S;
      StoreString(S);
    };
    var Year = 0;
    var Month = 0;
    var Day = 0;
    var DayOfWeek = 0;
    var Hour = 0;
    var Minute = 0;
    var Second = 0;
    var MilliSecond = 0;
    function StoreFormat(FormatStr, Nesting, TimeFlag) {
      var Token = "";
      var lastformattoken = "";
      var prevlasttoken = "";
      var Count = 0;
      var Clock12 = false;
      var tmp = 0;
      var isInterval = false;
      var P = 0;
      var FormatCurrent = 0;
      var FormatEnd = 0;
      if (Nesting > 1) return;
      FormatCurrent = 1;
      FormatEnd = FormatStr.length;
      Clock12 = false;
      isInterval = false;
      P = 1;
      while (P <= FormatEnd) {
        Token = FormatStr.charAt(P - 1);
        var $tmp = Token;
        if (($tmp === "'") || ($tmp === '"')) {
          P += 1;
          while ((P < FormatEnd) && (FormatStr.charAt(P - 1) !== Token)) P += 1;
        } else if (($tmp === "A") || ($tmp === "a")) {
          if (($mod.CompareText(pas.System.Copy(FormatStr,P,3),"A/P") === 0) || ($mod.CompareText(pas.System.Copy(FormatStr,P,4),"AMPM") === 0) || ($mod.CompareText(pas.System.Copy(FormatStr,P,5),"AM/PM") === 0)) {
            Clock12 = true;
            break;
          };
        };
        P += 1;
      };
      Token = "ÿ";
      lastformattoken = " ";
      prevlasttoken = "H";
      while (FormatCurrent <= FormatEnd) {
        Token = $mod.UpperCase(FormatStr.charAt(FormatCurrent - 1)).charAt(0);
        Count = 1;
        P = FormatCurrent + 1;
        var $tmp1 = Token;
        if (($tmp1 === "'") || ($tmp1 === '"')) {
          while ((P < FormatEnd) && (FormatStr.charAt(P - 1) !== Token)) P += 1;
          P += 1;
          Count = P - FormatCurrent;
          StoreStr(FormatStr,FormatCurrent + 1,Count - 2);
        } else if ($tmp1 === "A") {
          if ($mod.CompareText(pas.System.Copy(FormatStr,FormatCurrent,4),"AMPM") === 0) {
            Count = 4;
            if (Hour < 12) {
              StoreString(aSettings.TimeAMString)}
             else StoreString(aSettings.TimePMString);
          } else if ($mod.CompareText(pas.System.Copy(FormatStr,FormatCurrent,5),"AM/PM") === 0) {
            Count = 5;
            if (Hour < 12) {
              StoreStr(FormatStr,FormatCurrent,2)}
             else StoreStr(FormatStr,FormatCurrent + 3,2);
          } else if ($mod.CompareText(pas.System.Copy(FormatStr,FormatCurrent,3),"A/P") === 0) {
            Count = 3;
            if (Hour < 12) {
              StoreStr(FormatStr,FormatCurrent,1)}
             else StoreStr(FormatStr,FormatCurrent + 2,1);
          } else throw $mod.EConvertError.$create("Create$1",["Illegal character in format string"]);
        } else if ($tmp1 === "/") {
          StoreString(aSettings.DateSeparator);
        } else if ($tmp1 === ":") {
          StoreString(aSettings.TimeSeparator)}
         else if (($tmp1 === " ") || ($tmp1 === "C") || ($tmp1 === "D") || ($tmp1 === "H") || ($tmp1 === "M") || ($tmp1 === "N") || ($tmp1 === "S") || ($tmp1 === "T") || ($tmp1 === "Y") || ($tmp1 === "Z") || ($tmp1 === "F")) {
          while ((P <= FormatEnd) && ($mod.UpperCase(FormatStr.charAt(P - 1)) === Token)) P += 1;
          Count = P - FormatCurrent;
          var $tmp2 = Token;
          if ($tmp2 === " ") {
            StoreStr(FormatStr,FormatCurrent,Count)}
           else if ($tmp2 === "Y") {
            if (Count > 2) {
              StoreInt(Year,4)}
             else StoreInt(Year % 100,2);
          } else if ($tmp2 === "M") {
            if (isInterval && ((prevlasttoken === "H") || TimeFlag)) {
              StoreInt(Minute + ((Hour + (pas.System.Trunc(Math.abs(DateTime)) * 24)) * 60),0)}
             else if ((lastformattoken === "H") || TimeFlag) {
              if (Count === 1) {
                StoreInt(Minute,0)}
               else StoreInt(Minute,2);
            } else {
              var $tmp3 = Count;
              if ($tmp3 === 1) {
                StoreInt(Month,0)}
               else if ($tmp3 === 2) {
                StoreInt(Month,2)}
               else if ($tmp3 === 3) {
                StoreString(aSettings.ShortMonthNames[Month - 1])}
               else {
                StoreString(aSettings.LongMonthNames[Month - 1]);
              };
            };
          } else if ($tmp2 === "D") {
            var $tmp4 = Count;
            if ($tmp4 === 1) {
              StoreInt(Day,0)}
             else if ($tmp4 === 2) {
              StoreInt(Day,2)}
             else if ($tmp4 === 3) {
              StoreString(aSettings.ShortDayNames[DayOfWeek - 1])}
             else if ($tmp4 === 4) {
              StoreString(aSettings.LongDayNames[DayOfWeek - 1])}
             else if ($tmp4 === 5) {
              StoreFormat(aSettings.ShortDateFormat,Nesting + 1,false)}
             else {
              StoreFormat(aSettings.LongDateFormat,Nesting + 1,false);
            };
          } else if ($tmp2 === "H") {
            if (isInterval) {
              StoreInt(Hour + (pas.System.Trunc(Math.abs(DateTime)) * 24),0)}
             else if (Clock12) {
              tmp = Hour % 12;
              if (tmp === 0) tmp = 12;
              if (Count === 1) {
                StoreInt(tmp,0)}
               else StoreInt(tmp,2);
            } else {
              if (Count === 1) {
                StoreInt(Hour,0)}
               else StoreInt(Hour,2);
            }}
           else if ($tmp2 === "N") {
            if (isInterval) {
              StoreInt(Minute + ((Hour + (pas.System.Trunc(Math.abs(DateTime)) * 24)) * 60),0)}
             else if (Count === 1) {
              StoreInt(Minute,0)}
             else StoreInt(Minute,2)}
           else if ($tmp2 === "S") {
            if (isInterval) {
              StoreInt(Second + ((Minute + ((Hour + (pas.System.Trunc(Math.abs(DateTime)) * 24)) * 60)) * 60),0)}
             else if (Count === 1) {
              StoreInt(Second,0)}
             else StoreInt(Second,2)}
           else if ($tmp2 === "Z") {
            if (Count === 1) {
              StoreInt(MilliSecond,0)}
             else StoreInt(MilliSecond,3)}
           else if ($tmp2 === "T") {
            if (Count === 1) {
              StoreFormat(aSettings.ShortTimeFormat,Nesting + 1,true)}
             else StoreFormat(aSettings.LongTimeFormat,Nesting + 1,true)}
           else if ($tmp2 === "C") {
            StoreFormat(aSettings.ShortDateFormat,Nesting + 1,false);
            if ((Hour !== 0) || (Minute !== 0) || (Second !== 0)) {
              StoreString(" ");
              StoreFormat(aSettings.LongTimeFormat,Nesting + 1,true);
            };
          } else if ($tmp2 === "F") {
            StoreFormat(aSettings.ShortDateFormat,Nesting + 1,false);
            StoreString(" ");
            StoreFormat(aSettings.LongTimeFormat,Nesting + 1,true);
          };
          prevlasttoken = lastformattoken;
          lastformattoken = Token;
        } else {
          StoreString(Token);
        };
        FormatCurrent += Count;
      };
    };
    $mod.DecodeDateFully(DateTime,{get: function () {
        return Year;
      }, set: function (v) {
        Year = v;
      }},{get: function () {
        return Month;
      }, set: function (v) {
        Month = v;
      }},{get: function () {
        return Day;
      }, set: function (v) {
        Day = v;
      }},{get: function () {
        return DayOfWeek;
      }, set: function (v) {
        DayOfWeek = v;
      }});
    $mod.DecodeTime(DateTime,{get: function () {
        return Hour;
      }, set: function (v) {
        Hour = v;
      }},{get: function () {
        return Minute;
      }, set: function (v) {
        Minute = v;
      }},{get: function () {
        return Second;
      }, set: function (v) {
        Second = v;
      }},{get: function () {
        return MilliSecond;
      }, set: function (v) {
        MilliSecond = v;
      }});
    if (FormatStr !== "") {
      StoreFormat(FormatStr,0,false)}
     else StoreFormat("C",0,false);
    return Result;
  };
  this.CurrencyFormat = 0;
  this.NegCurrFormat = 0;
  this.CurrencyDecimals = 0;
  this.CurrencyString = "";
  this.CurrToStr = function (Value) {
    var Result = "";
    Result = $mod.FloatToStrF$1(Value / 10000,1,-1,0,$mod.FormatSettings);
    return Result;
  };
  this.StrToCurr = function (S) {
    var Result = 0;
    if (!$mod.TryStrToCurr(S,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }})) throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidCurrency"),pas.System.VarRecs(18,S)]);
    return Result;
  };
  this.TryStrToCurr = function (S, Value) {
    var Result = false;
    var D = 0.0;
    Result = $mod.TryStrToFloat$3(S,{get: function () {
        return D;
      }, set: function (v) {
        D = v;
      }},$mod.FormatSettings);
    if (Result) Value.set(rtl.trunc(D * 10000));
    return Result;
  };
  this.CreateGUID = function (GUID) {
    var Result = 0;
    function R(B) {
      var Result = 0;
      var v = 0;
      v = pas.System.Random(256);
      while (B > 1) {
        v = (v * 256) + pas.System.Random(256);
        B -= 1;
      };
      Result = v;
      return Result;
    };
    var I = 0;
    Result = 0;
    GUID.D1 = R(4);
    GUID.D2 = R(2);
    GUID.D3 = R(2);
    for (I = 0; I <= 7; I++) GUID.D4[I] = R(1);
    return Result;
  };
  rtl.createHelper(this,"TGuidHelper",null,function () {
    this.NewGuid = function () {
      var Result = pas.System.TGuid.$new();
      $mod.CreateGUID(Result);
      return Result;
    };
  });
  rtl.createHelper(this,"TStringHelper",null,function () {
    this.Empty = "";
    this.GetLength = function () {
      var Result = 0;
      Result = this.get().length;
      return Result;
    };
    this.LowerCase = function (S) {
      var Result = "";
      Result = $mod.LowerCase(S);
      return Result;
    };
    this.UpperCase = function (S) {
      var Result = "";
      Result = $mod.UpperCase(S);
      return Result;
    };
    this.IndexOf = function (AValue) {
      var Result = 0;
      Result = $mod.TStringHelper.IndexOf$4.call(this,AValue,0,$mod.TStringHelper.GetLength.call(this));
      return Result;
    };
    this.IndexOf$4 = function (AValue, StartIndex, ACount) {
      var Result = 0;
      var S = "";
      S = pas.System.Copy(this.get(),StartIndex + 1,ACount);
      Result = pas.System.Pos(AValue,S) - 1;
      if (Result !== -1) Result = Result + StartIndex;
      return Result;
    };
    this.Substring = function (AStartIndex) {
      var Result = "";
      Result = $mod.TStringHelper.Substring$1.call(this,AStartIndex,$mod.TStringHelper.GetLength.call(this) - AStartIndex);
      return Result;
    };
    this.Substring$1 = function (AStartIndex, ALen) {
      var Result = "";
      Result = pas.System.Copy(this.get(),AStartIndex + 1,ALen);
      return Result;
    };
    this.ToLower = function () {
      var Result = "";
      Result = $mod.TStringHelper.LowerCase(this.get());
      return Result;
    };
    this.ToUpper = function () {
      var Result = "";
      Result = $mod.TStringHelper.UpperCase(this.get());
      return Result;
    };
  });
  rtl.createHelper(this,"TIntegerHelper",null,function () {
    this.ToString$1 = function () {
      var Result = "";
      Result = $mod.IntToStr(this.get());
      return Result;
    };
  });
  $mod.$implcode = function () {
    $impl.DefaultShortMonthNames = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
    $impl.DefaultLongMonthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
    $impl.DefaultShortDayNames = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
    $impl.DefaultLongDayNames = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
    $impl.FInvariant = $mod.TFormatSettings.$new();
    $impl.FInvariantCreated = false;
    $impl.CheckBoolStrs = function () {
      if (rtl.length($mod.TrueBoolStrs) === 0) {
        $mod.TrueBoolStrs = rtl.arraySetLength($mod.TrueBoolStrs,"",1);
        $mod.TrueBoolStrs[0] = "True";
      };
      if (rtl.length($mod.FalseBoolStrs) === 0) {
        $mod.FalseBoolStrs = rtl.arraySetLength($mod.FalseBoolStrs,"",1);
        $mod.FalseBoolStrs[0] = "False";
      };
    };
    $impl.feInvalidFormat = 1;
    $impl.feMissingArgument = 2;
    $impl.feInvalidArgIndex = 3;
    $impl.DoFormatError = function (ErrCode, fmt) {
      var $tmp = ErrCode;
      if ($tmp === 1) {
        throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidFormat"),pas.System.VarRecs(18,fmt)])}
       else if ($tmp === 2) {
        throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SArgumentMissing"),pas.System.VarRecs(18,fmt)])}
       else if ($tmp === 3) throw $mod.EConvertError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidArgIndex"),pas.System.VarRecs(18,fmt)]);
    };
    $impl.maxdigits = 15;
    $impl.ReplaceDecimalSep = function (S, DS) {
      var Result = "";
      var P = 0;
      P = pas.System.Pos(".",S);
      if (P > 0) {
        Result = pas.System.Copy(S,1,P - 1) + DS + pas.System.Copy(S,P + 1,S.length - P)}
       else Result = S;
      return Result;
    };
    $impl.FormatGeneralFloat = function (Value, Precision, DS) {
      var Result = "";
      var P = 0;
      var PE = 0;
      var Q = 0;
      var Exponent = 0;
      if ((Precision === -1) || (Precision > 15)) Precision = 15;
      Result = rtl.floatToStr(Value,Precision + 7);
      Result = $mod.TrimLeft(Result);
      P = pas.System.Pos(".",Result);
      if (P === 0) return Result;
      PE = pas.System.Pos("E",Result);
      if (PE === 0) {
        Result = $impl.ReplaceDecimalSep(Result,DS);
        return Result;
      };
      Q = PE + 2;
      Exponent = 0;
      while (Q <= Result.length) {
        Exponent = ((Exponent * 10) + Result.charCodeAt(Q - 1)) - 48;
        Q += 1;
      };
      if (Result.charAt((PE + 1) - 1) === "-") Exponent = -Exponent;
      if (((P + Exponent) < PE) && (Exponent > -6)) {
        Result = rtl.strSetLength(Result,PE - 1);
        if (Exponent >= 0) {
          for (var $l = 0, $end = Exponent - 1; $l <= $end; $l++) {
            Q = $l;
            Result = rtl.setCharAt(Result,P - 1,Result.charAt((P + 1) - 1));
            P += 1;
          };
          Result = rtl.setCharAt(Result,P - 1,".");
          P = 1;
          if (Result.charAt(P - 1) === "-") P += 1;
          while ((Result.charAt(P - 1) === "0") && (P < Result.length) && (pas.System.Copy(Result,P + 1,DS.length) !== DS)) pas.System.Delete({get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},P,1);
        } else {
          pas.System.Insert(pas.System.Copy("00000",1,-Exponent),{get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},P - 1);
          Result = rtl.setCharAt(Result,P - Exponent - 1,Result.charAt(P - Exponent - 1 - 1));
          Result = rtl.setCharAt(Result,P - 1,".");
          if (Exponent !== -1) Result = rtl.setCharAt(Result,P - Exponent - 1 - 1,"0");
        };
        Q = Result.length;
        while ((Q > 0) && (Result.charAt(Q - 1) === "0")) Q -= 1;
        if (Result.charAt(Q - 1) === ".") Q -= 1;
        if ((Q === 0) || ((Q === 1) && (Result.charAt(0) === "-"))) {
          Result = "0"}
         else Result = rtl.strSetLength(Result,Q);
      } else {
        while (Result.charAt(PE - 1 - 1) === "0") {
          pas.System.Delete({get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},PE - 1,1);
          PE -= 1;
        };
        if (Result.charAt(PE - 1 - 1) === DS) {
          pas.System.Delete({get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},PE - 1,1);
          PE -= 1;
        };
        if (Result.charAt((PE + 1) - 1) === "+") {
          pas.System.Delete({get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},PE + 1,1)}
         else PE += 1;
        while (Result.charAt((PE + 1) - 1) === "0") pas.System.Delete({get: function () {
            return Result;
          }, set: function (v) {
            Result = v;
          }},PE + 1,1);
      };
      Result = $impl.ReplaceDecimalSep(Result,DS);
      return Result;
    };
    $impl.FormatExponentFloat = function (Value, Precision, Digits, DS) {
      var Result = "";
      var P = 0;
      DS = $mod.FormatSettings.DecimalSeparator;
      if ((Precision === -1) || (Precision > 15)) Precision = 15;
      Result = rtl.floatToStr(Value,Precision + 7);
      while (Result.charAt(0) === " ") pas.System.Delete({get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},1,1);
      P = pas.System.Pos("E",Result);
      if (P === 0) {
        Result = $impl.ReplaceDecimalSep(Result,DS);
        return Result;
      };
      P += 2;
      if (Digits > 4) Digits = 4;
      Digits = (Result.length - P - Digits) + 1;
      if (Digits < 0) {
        pas.System.Insert(pas.System.Copy("0000",1,-Digits),{get: function () {
            return Result;
          }, set: function (v) {
            Result = v;
          }},P)}
       else while ((Digits > 0) && (Result.charAt(P - 1) === "0")) {
        pas.System.Delete({get: function () {
            return Result;
          }, set: function (v) {
            Result = v;
          }},P,1);
        if (P > Result.length) {
          pas.System.Delete({get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},P - 2,2);
          break;
        };
        Digits -= 1;
      };
      Result = $impl.ReplaceDecimalSep(Result,DS);
      return Result;
    };
    $impl.FormatFixedFloat = function (Value, Digits, DS) {
      var Result = "";
      if (Digits === -1) {
        Digits = 2}
       else if (Digits > 18) Digits = 18;
      Result = rtl.floatToStr(Value,0,Digits);
      if ((Result !== "") && (Result.charAt(0) === " ")) pas.System.Delete({get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},1,1);
      Result = $impl.ReplaceDecimalSep(Result,DS);
      return Result;
    };
    $impl.FormatNumberFloat = function (Value, Digits, DS, TS) {
      var Result = "";
      var P = 0;
      if (Digits === -1) {
        Digits = 2}
       else if (Digits > 15) Digits = 15;
      Result = rtl.floatToStr(Value,0,Digits);
      if ((Result !== "") && (Result.charAt(0) === " ")) pas.System.Delete({get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},1,1);
      P = pas.System.Pos(".",Result);
      if (P <= 0) P = Result.length + 1;
      Result = $impl.ReplaceDecimalSep(Result,DS);
      P -= 3;
      if ((TS !== "") && (TS !== "\x00")) while (P > 1) {
        if (Result.charAt(P - 1 - 1) !== "-") pas.System.Insert(TS,{get: function () {
            return Result;
          }, set: function (v) {
            Result = v;
          }},P);
        P -= 3;
      };
      return Result;
    };
    $impl.RemoveLeadingNegativeSign = function (AValue, DS, aThousandSeparator) {
      var Result = false;
      var i = 0;
      var TS = "";
      var StartPos = 0;
      Result = false;
      StartPos = 2;
      TS = aThousandSeparator;
      for (var $l = StartPos, $end = AValue.get().length; $l <= $end; $l++) {
        i = $l;
        Result = (AValue.get().charCodeAt(i - 1) in rtl.createSet(48,DS.charCodeAt(),69,43)) || (AValue.get().charAt(i - 1) === TS);
        if (!Result) break;
      };
      if (Result && (AValue.get().charAt(0) === "-")) pas.System.Delete(AValue,1,1);
      return Result;
    };
    $impl.FormatNumberCurrency = function (Value, Digits, aSettings) {
      var Result = "";
      var Negative = false;
      var P = 0;
      var CS = "";
      var DS = "";
      var TS = "";
      DS = aSettings.DecimalSeparator;
      TS = aSettings.ThousandSeparator;
      CS = aSettings.CurrencyString;
      if (Digits === -1) {
        Digits = aSettings.CurrencyDecimals}
       else if (Digits > 18) Digits = 18;
      Result = rtl.floatToStr(Value / 10000,0,Digits);
      Negative = Result.charAt(0) === "-";
      if (Negative) pas.System.Delete({get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},1,1);
      P = pas.System.Pos(".",Result);
      if (TS !== "") {
        if (P !== 0) {
          Result = $impl.ReplaceDecimalSep(Result,DS)}
         else P = Result.length + 1;
        P -= 3;
        while (P > 1) {
          pas.System.Insert(TS,{get: function () {
              return Result;
            }, set: function (v) {
              Result = v;
            }},P);
          P -= 3;
        };
      };
      if (Negative) $impl.RemoveLeadingNegativeSign({get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},DS,TS);
      if (!Negative) {
        var $tmp = aSettings.CurrencyFormat;
        if ($tmp === 0) {
          Result = CS + Result}
         else if ($tmp === 1) {
          Result = Result + CS}
         else if ($tmp === 2) {
          Result = CS + " " + Result}
         else if ($tmp === 3) Result = Result + " " + CS;
      } else {
        var $tmp1 = aSettings.NegCurrFormat;
        if ($tmp1 === 0) {
          Result = "(" + CS + Result + ")"}
         else if ($tmp1 === 1) {
          Result = "-" + CS + Result}
         else if ($tmp1 === 2) {
          Result = CS + "-" + Result}
         else if ($tmp1 === 3) {
          Result = CS + Result + "-"}
         else if ($tmp1 === 4) {
          Result = "(" + Result + CS + ")"}
         else if ($tmp1 === 5) {
          Result = "-" + Result + CS}
         else if ($tmp1 === 6) {
          Result = Result + "-" + CS}
         else if ($tmp1 === 7) {
          Result = Result + CS + "-"}
         else if ($tmp1 === 8) {
          Result = "-" + Result + " " + CS}
         else if ($tmp1 === 9) {
          Result = "-" + CS + " " + Result}
         else if ($tmp1 === 10) {
          Result = Result + " " + CS + "-"}
         else if ($tmp1 === 11) {
          Result = CS + " " + Result + "-"}
         else if ($tmp1 === 12) {
          Result = CS + " " + "-" + Result}
         else if ($tmp1 === 13) {
          Result = Result + "-" + " " + CS}
         else if ($tmp1 === 14) {
          Result = "(" + CS + " " + Result + ")"}
         else if ($tmp1 === 15) Result = "(" + Result + " " + CS + ")";
      };
      return Result;
    };
    $impl.RESpecials = "([\\$\\+\\[\\]\\(\\)\\\\\\.\\*\\^\\?\\|])";
    var WhiteSpace = " \b\t\n\f\r";
    var Digits = "0123456789";
    $impl.IntStrToDate = function (ErrorMsg, S, useformat, separator) {
      var Result = 0.0;
      function FixErrorMsg(errmarg) {
        ErrorMsg.set($mod.Format(rtl.getResStr(pas.RTLConsts,"SInvalidDateFormat"),pas.System.VarRecs(18,errmarg)));
      };
      var df = "";
      var d = 0;
      var m = 0;
      var y = 0;
      var ly = 0;
      var ld = 0;
      var lm = 0;
      var n = 0;
      var i = 0;
      var len = 0;
      var c = 0;
      var dp = 0;
      var mp = 0;
      var yp = 0;
      var which = 0;
      var s1 = "";
      var values = [];
      var YearMoreThenTwoDigits = false;
      values = rtl.arraySetLength(values,0,4);
      Result = 0;
      len = S.length;
      ErrorMsg.set("");
      while ((len > 0) && (pas.System.Pos(S.charAt(len - 1),WhiteSpace) > 0)) len -= 1;
      if (len === 0) {
        FixErrorMsg(S);
        return Result;
      };
      YearMoreThenTwoDigits = false;
      if (separator === "\x00") if ($mod.FormatSettings.DateSeparator !== "\x00") {
        separator = $mod.FormatSettings.DateSeparator}
       else separator = "-";
      df = $mod.UpperCase(useformat);
      yp = 0;
      mp = 0;
      dp = 0;
      which = 0;
      i = 0;
      while ((i < df.length) && (which < 3)) {
        i += 1;
        var $tmp = df.charAt(i - 1);
        if ($tmp === "Y") {
          if (yp === 0) {
            which += 1;
            yp = which;
          }}
         else if ($tmp === "M") {
          if (mp === 0) {
            which += 1;
            mp = which;
          }}
         else if ($tmp === "D") if (dp === 0) {
          which += 1;
          dp = which;
        };
      };
      for (i = 1; i <= 3; i++) values[i] = 0;
      s1 = "";
      n = 0;
      for (var $l = 1, $end = len; $l <= $end; $l++) {
        i = $l;
        if (pas.System.Pos(S.charAt(i - 1),Digits) > 0) s1 = s1 + S.charAt(i - 1);
        if ((separator !== " ") && (S.charAt(i - 1) === " ")) continue;
        if ((S.charAt(i - 1) === separator) || ((i === len) && (pas.System.Pos(S.charAt(i - 1),Digits) > 0))) {
          n += 1;
          if (n > 3) {
            FixErrorMsg(S);
            return Result;
          };
          if ((n === yp) && (s1.length > 2)) YearMoreThenTwoDigits = true;
          pas.System.val$6(s1,{a: n, p: values, get: function () {
              return this.p[this.a];
            }, set: function (v) {
              this.p[this.a] = v;
            }},{get: function () {
              return c;
            }, set: function (v) {
              c = v;
            }});
          if (c !== 0) {
            FixErrorMsg(S);
            return Result;
          };
          s1 = "";
        } else if (pas.System.Pos(S.charAt(i - 1),Digits) === 0) {
          FixErrorMsg(S);
          return Result;
        };
      };
      if ((which < 3) && (n > which)) {
        FixErrorMsg(S);
        return Result;
      };
      $mod.DecodeDate($mod.Date(),{get: function () {
          return ly;
        }, set: function (v) {
          ly = v;
        }},{get: function () {
          return lm;
        }, set: function (v) {
          lm = v;
        }},{get: function () {
          return ld;
        }, set: function (v) {
          ld = v;
        }});
      if (n === 3) {
        y = values[yp];
        m = values[mp];
        d = values[dp];
      } else {
        y = ly;
        if (n < 2) {
          d = values[1];
          m = lm;
        } else if (dp < mp) {
          d = values[1];
          m = values[2];
        } else {
          d = values[2];
          m = values[1];
        };
      };
      if ((y >= 0) && (y < 100) && !YearMoreThenTwoDigits) {
        ly = ly - $mod.TwoDigitYearCenturyWindow;
        y += rtl.trunc(ly / 100) * 100;
        if (($mod.TwoDigitYearCenturyWindow > 0) && (y < ly)) y += 100;
      };
      if (!$mod.TryEncodeDate(y,m,d,{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }})) ErrorMsg.set(rtl.getResStr(pas.RTLConsts,"SErrInvalidDate"));
      return Result;
    };
    var AMPM_None = 0;
    var AMPM_AM = 1;
    var AMPM_PM = 2;
    var tiHour = 0;
    var tiMin = 1;
    var tiSec = 2;
    var tiMSec = 3;
    var Digits$1 = "0123456789";
    $impl.IntStrToTime = function (ErrorMsg, S, Len, aSettings) {
      var Result = 0.0;
      var AmPm = 0;
      var TimeValues = [];
      function SplitElements(TimeValues, AmPm) {
        var Result = false;
        var Cur = 0;
        var Offset = 0;
        var ElemLen = 0;
        var Err = 0;
        var TimeIndex = 0;
        var FirstSignificantDigit = 0;
        var Value = 0;
        var DigitPending = false;
        var MSecPending = false;
        var AmPmStr = "";
        var CurChar = "";
        var I = 0;
        var allowedchars = "";
        Result = false;
        AmPm.set(0);
        MSecPending = false;
        TimeIndex = 0;
        for (I = 0; I <= 3; I++) TimeValues.get()[I] = 0;
        Cur = 1;
        while ((Cur < Len) && (S.charAt(Cur - 1) === " ")) Cur += 1;
        Offset = Cur;
        if ((Cur > (Len - 1)) || (S.charAt(Cur - 1) === aSettings.TimeSeparator) || (S.charAt(Cur - 1) === aSettings.DecimalSeparator)) {
          return Result;
        };
        DigitPending = pas.System.Pos(S.charAt(Cur - 1),Digits$1) > 0;
        while (Cur <= Len) {
          CurChar = S.charAt(Cur - 1);
          if (pas.System.Pos(CurChar,Digits$1) > 0) {
            if (!DigitPending || (TimeIndex > 3)) {
              return Result;
            };
            Offset = Cur;
            if (CurChar !== "0") {
              FirstSignificantDigit = Offset}
             else FirstSignificantDigit = -1;
            while ((Cur < Len) && (pas.System.Pos(S.charAt((Cur + 1) - 1),Digits$1) > 0)) {
              if ((FirstSignificantDigit === -1) && (S.charAt(Cur - 1) !== "0")) FirstSignificantDigit = Cur;
              Cur += 1;
            };
            if (FirstSignificantDigit === -1) FirstSignificantDigit = Cur;
            ElemLen = (1 + Cur) - FirstSignificantDigit;
            if ((ElemLen <= 2) || ((ElemLen <= 3) && (TimeIndex === 3))) {
              pas.System.val$6(pas.System.Copy(S,FirstSignificantDigit,ElemLen),{get: function () {
                  return Value;
                }, set: function (v) {
                  Value = v;
                }},{get: function () {
                  return Err;
                }, set: function (v) {
                  Err = v;
                }});
              TimeValues.get()[TimeIndex] = Value;
              TimeIndex += 1;
              DigitPending = false;
            } else {
              return Result;
            };
          } else if (CurChar === " ") {}
          else if (CurChar === aSettings.TimeSeparator) {
            if (DigitPending || (TimeIndex > 2)) {
              return Result;
            };
            DigitPending = true;
            MSecPending = false;
          } else if (CurChar === aSettings.DecimalSeparator) {
            if (DigitPending || MSecPending || (TimeIndex !== 3)) {
              return Result;
            };
            DigitPending = true;
            MSecPending = true;
          } else {
            if ((AmPm.get() !== 0) || DigitPending) {
              return Result;
            };
            Offset = Cur;
            allowedchars = aSettings.DecimalSeparator + " ";
            if (aSettings.TimeSeparator !== "\x00") allowedchars = allowedchars + aSettings.TimeSeparator;
            while ((Cur < Len) && (pas.System.Pos(S.charAt((Cur + 1) - 1),allowedchars) === 0) && (pas.System.Pos(S.charAt((Cur + 1) - 1),Digits$1) === 0)) Cur += 1;
            ElemLen = (1 + Cur) - Offset;
            AmPmStr = pas.System.Copy(S,Offset,ElemLen);
            if ($mod.CompareText(AmPmStr,aSettings.TimeAMString) === 0) {
              AmPm.set(1)}
             else if ($mod.CompareText(AmPmStr,aSettings.TimePMString) === 0) {
              AmPm.set(2)}
             else if ($mod.CompareText(AmPmStr,"AM") === 0) {
              AmPm.set(1)}
             else if ($mod.CompareText(AmPmStr,"PM") === 0) {
              AmPm.set(2)}
             else {
              return Result;
            };
            if (TimeIndex === 0) {
              DigitPending = true;
            } else {
              TimeIndex = 3 + 1;
              DigitPending = false;
            };
          };
          Cur += 1;
        };
        if ((TimeIndex === 0) || ((AmPm.get() !== 0) && ((TimeValues.get()[0] > 12) || (TimeValues.get()[0] === 0))) || DigitPending) return Result;
        Result = true;
        return Result;
      };
      TimeValues = rtl.arraySetLength(TimeValues,0,4);
      AmPm = 0;
      if (!SplitElements({get: function () {
          return TimeValues;
        }, set: function (v) {
          TimeValues = v;
        }},{get: function () {
          return AmPm;
        }, set: function (v) {
          AmPm = v;
        }})) {
        ErrorMsg.set($mod.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,S)));
        return Result;
      };
      if ((AmPm === 2) && (TimeValues[0] !== 12)) {
        TimeValues[0] += 12}
       else if ((AmPm === 1) && (TimeValues[0] === 12)) TimeValues[0] = 0;
      if (!$mod.TryEncodeTime(TimeValues[0],TimeValues[1],TimeValues[2],TimeValues[3],{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }})) ErrorMsg.set($mod.Format(rtl.getResStr(pas.RTLConsts,"SErrInvalidTimeFormat"),pas.System.VarRecs(18,S)));
      return Result;
    };
    var WhiteSpace$1 = "\t\n\r ";
    $impl.SplitDateTimeStr = function (DateTimeStr, DateStr, TimeStr, aSettings) {
      var Result = 0;
      var p = 0;
      var DummyDT = 0.0;
      Result = 0;
      DateStr.set("");
      TimeStr.set("");
      DateTimeStr = $mod.Trim(DateTimeStr);
      if (DateTimeStr.length === 0) return Result;
      if ((aSettings.DateSeparator === " ") && (aSettings.TimeSeparator === " ") && (pas.System.Pos(" ",DateTimeStr) > 0)) {
        DateStr.set(DateTimeStr);
        return 1;
      };
      p = 1;
      if (aSettings.DateSeparator !== " ") {
        while ((p < DateTimeStr.length) && !(pas.System.Pos(DateTimeStr.charAt((p + 1) - 1),WhiteSpace$1) > 0)) p += 1;
      } else {
        p = pas.System.Pos(aSettings.TimeSeparator,DateTimeStr);
        if (p !== 0) do {
          p -= 1;
        } while (!((p === 0) || (pas.System.Pos(DateTimeStr.charAt(p - 1),WhiteSpace$1) > 0)));
      };
      if (p === 0) p = DateTimeStr.length;
      DateStr.set(pas.System.Copy(DateTimeStr,1,p));
      TimeStr.set($mod.Trim(pas.System.Copy(DateTimeStr,p + 1,100)));
      if (TimeStr.get().length !== 0) {
        Result = 2}
       else {
        Result = 1;
        if (((aSettings.DateSeparator !== aSettings.TimeSeparator) && (pas.System.Pos(aSettings.TimeSeparator,DateStr.get()) > 0)) || ((aSettings.DateSeparator === aSettings.TimeSeparator) && !$mod.TryStrToDate(DateStr.get(),{get: function () {
            return DummyDT;
          }, set: function (v) {
            DummyDT = v;
          }}))) {
          TimeStr.set(DateStr.get());
          DateStr.set("");
        };
      };
      return Result;
    };
    $impl.IntTryStrToInt = function (S, res, aSep) {
      var Result = false;
      var Radix = 10;
      var N = "";
      var J = undefined;
      N = S;
      if ((pas.System.Pos(aSep,N) !== 0) || (pas.System.Pos(".",N) !== 0)) return false;
      var $tmp = pas.System.Copy(N,1,1);
      if ($tmp === "$") {
        Radix = 16}
       else if ($tmp === "&") {
        Radix = 8}
       else if ($tmp === "%") Radix = 2;
      if ((Radix !== 16) && (pas.System.Pos("e",$mod.LowerCase(N)) !== 0)) return false;
      if (Radix !== 10) pas.System.Delete({get: function () {
          return N;
        }, set: function (v) {
          N = v;
        }},1,1);
      J = parseInt(N,Radix);
      Result = !isNaN(J);
      if (Result) res.set(rtl.trunc(J));
      return Result;
    };
    $impl.InitGlobalFormatSettings = function () {
      $mod.FormatSettings.$assign($mod.TFormatSettings.Create());
      $mod.TimeSeparator = $mod.FormatSettings.TimeSeparator;
      $mod.DateSeparator = $mod.FormatSettings.DateSeparator;
      $mod.ShortDateFormat = $mod.FormatSettings.ShortDateFormat;
      $mod.LongDateFormat = $mod.FormatSettings.LongDateFormat;
      $mod.ShortTimeFormat = $mod.FormatSettings.ShortTimeFormat;
      $mod.LongTimeFormat = $mod.FormatSettings.LongTimeFormat;
      $mod.DecimalSeparator = $mod.FormatSettings.DecimalSeparator;
      $mod.ThousandSeparator = $mod.FormatSettings.ThousandSeparator;
      $mod.TimeAMString = $mod.FormatSettings.TimeAMString;
      $mod.TimePMString = $mod.FormatSettings.TimePMString;
      $mod.CurrencyFormat = $mod.FormatSettings.CurrencyFormat;
      $mod.NegCurrFormat = $mod.FormatSettings.NegCurrFormat;
      $mod.CurrencyDecimals = $mod.FormatSettings.CurrencyDecimals;
      $mod.CurrencyString = $mod.FormatSettings.CurrencyString;
    };
  };
  $mod.$init = function () {
    (function () {
      $impl.InitGlobalFormatSettings();
    })();
    $mod.ShortMonthNames = $impl.DefaultShortMonthNames.slice(0);
    $mod.LongMonthNames = $impl.DefaultLongMonthNames.slice(0);
    $mod.ShortDayNames = $impl.DefaultShortDayNames.slice(0);
    $mod.LongDayNames = $impl.DefaultLongDayNames.slice(0);
  };
},[]);
rtl.module("TypInfo",["System","SysUtils","Types","RTLConsts","JS"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.pfGetFunction = 1;
  this.pfSetProcedure = 2;
  this.pfHasIndex = 16;
  rtl.createClass(this,"EPropertyError",pas.SysUtils.Exception,function () {
  });
  this.GetPropInfo = function (TI, PropName) {
    var Result = null;
    var m = null;
    var i = 0;
    var C = null;
    C = TI;
    while (C !== null) {
      m = C.members[PropName];
      if (rtl.isExt(m,rtl.tTypeMemberProperty)) return m;
      if (!rtl.isExt(C,rtl.tTypeInfoClass)) break;
      C = C.ancestor;
    };
    Result = null;
    do {
      for (var $l = 0, $end = TI.properties.length - 1; $l <= $end; $l++) {
        i = $l;
        if (pas.SysUtils.CompareText(PropName,TI.properties[i]) === 0) {
          m = TI.members[TI.properties[i]];
          if (rtl.isExt(m,rtl.tTypeMemberProperty)) Result = m;
          return Result;
        };
      };
      if (!rtl.isExt(TI,rtl.tTypeInfoClass)) break;
      TI = TI.ancestor;
    } while (!(TI === null));
    return Result;
  };
  this.FindPropInfo = function (Instance, PropName) {
    var Result = null;
    Result = $mod.GetPropInfo(Instance.$rtti,PropName);
    if (Result === null) throw $mod.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SErrPropertyNotFound"),pas.System.VarRecs(18,PropName)]);
    return Result;
  };
  this.GetJSValueProp$1 = function (Instance, PropInfo) {
    var Result = undefined;
    var gk = 0;
    gk = $impl.GetPropGetterKind(PropInfo);
    var $tmp = gk;
    if ($tmp === 0) {
      throw $mod.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantReadPropertyS"),pas.System.VarRecs(18,PropInfo.name)])}
     else if ($tmp === 1) {
      Result = Instance[PropInfo.getter]}
     else if ($tmp === 2) {
      if ((16 & PropInfo.flags) > 0) {
        Result = Instance[PropInfo.getter](PropInfo.index)}
       else Result = Instance[PropInfo.getter]()}
     else if ($tmp === 3) throw $mod.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,PropInfo.name)]);
    return Result;
  };
  this.GetJSValueProp$3 = function (Instance, PropInfo) {
    var Result = undefined;
    Result = $mod.GetJSValueProp$1(Instance,PropInfo);
    return Result;
  };
  this.SetJSValueProp$1 = function (Instance, PropInfo, Value) {
    var sk = 0;
    sk = $impl.GetPropSetterKind(PropInfo);
    var $tmp = sk;
    if ($tmp === 0) {
      throw $mod.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SCantWritePropertyS"),pas.System.VarRecs(18,PropInfo.name)])}
     else if ($tmp === 1) {
      Instance[PropInfo.setter] = Value}
     else if ($tmp === 2) {
      if ((16 & PropInfo.flags) > 0) {
        Instance[PropInfo.setter](PropInfo.index,Value)}
       else Instance[PropInfo.setter](Value)}
     else if ($tmp === 3) throw $mod.EPropertyError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SIndexedPropertyNeedsParams"),pas.System.VarRecs(18,PropInfo.name)]);
  };
  this.SetJSValueProp$3 = function (Instance, PropInfo, Value) {
    $mod.SetJSValueProp$1(Instance,PropInfo,Value);
  };
  this.GetOrdProp$1 = function (Instance, PropInfo) {
    var Result = 0;
    var o = null;
    var Key = "";
    var n = 0;
    var v = undefined;
    if (PropInfo.typeinfo.kind === 5) {
      o = $mod.GetJSValueProp$3(Instance,PropInfo);
      Result = 0;
      for (Key in o) {
        n = parseInt(Key,10);
        if (n < 32) Result = Result + (1 << n);
      };
    } else if (PropInfo.typeinfo.kind === 2) {
      v = $mod.GetJSValueProp$3(Instance,PropInfo);
      if (rtl.isNumber(v)) {
        Result = rtl.trunc(v)}
       else {
        Key = "" + v;
        if (Key === "") {
          Result = 0}
         else Result = Key.charCodeAt(0);
      };
    } else Result = rtl.trunc($mod.GetJSValueProp$3(Instance,PropInfo));
    return Result;
  };
  this.GetEnumName = function (TypeInfo, Value) {
    var Result = "";
    Result = TypeInfo.enumtype[Value];
    return Result;
  };
  this.SetMethodProp = function (Instance, PropInfo, Value) {
    var cb = null;
    var Code = null;
    Code = Value.Code;
    if (Code === null) {
      cb = null}
     else if (rtl.isFunction(Code)) {
      if ((Code["scope"] === Value.Data) && (rtl.isFunction(Code["fn"]) || rtl.isString(Code["fn"]))) {
        cb = Code;
      } else if (rtl.isString(Code["fn"])) {
        cb = rtl.createCallback(Value.Data,"" + Code["fn"])}
       else cb = rtl.createCallback(Value.Data,Code);
    } else cb = rtl.createCallback(Value.Data,Code);
    $mod.SetJSValueProp$3(Instance,PropInfo,cb);
  };
  this.SetMethodProp$1 = function (Instance, PropName, Value) {
    $mod.SetMethodProp(Instance,$mod.FindPropInfo(Instance,PropName),Value);
  };
  $mod.$implcode = function () {
    $impl.TGetterKind = {"0": "gkNone", gkNone: 0, "1": "gkField", gkField: 1, "2": "gkFunction", gkFunction: 2, "3": "gkFunctionWithParams", gkFunctionWithParams: 3};
    $impl.GetPropGetterKind = function (PropInfo) {
      var Result = 0;
      if (PropInfo.getter === "") {
        Result = 0}
       else if ((1 & PropInfo.flags) > 0) {
        if (rtl.length(PropInfo.params) > 0) {
          Result = 3}
         else Result = 2;
      } else Result = 1;
      return Result;
    };
    $impl.TSetterKind = {"0": "skNone", skNone: 0, "1": "skField", skField: 1, "2": "skProcedure", skProcedure: 2, "3": "skProcedureWithParams", skProcedureWithParams: 3};
    $impl.GetPropSetterKind = function (PropInfo) {
      var Result = 0;
      if (PropInfo.setter === "") {
        Result = 0}
       else if ((2 & PropInfo.flags) > 0) {
        if (rtl.length(PropInfo.params) > 0) {
          Result = 3}
         else Result = 2;
      } else Result = 1;
      return Result;
    };
  };
},[]);
rtl.module("Web",["System","Types","JS"],function () {
  "use strict";
  var $mod = this;
  rtl.createClassExt(this,"TJSFocusEvent",Event,"",function () {
    this.$init = function () {
    };
    this.$final = function () {
    };
  });
  this.$rtti.$ExtClass("TJSXMLHttpRequest",{ancestor: this.$rtti["TJSXMLHttpRequestEventTarget"], jsclass: "XMLHttpRequest"});
  rtl.createClass(this,"TJSKeyNames",pas.System.TObject,function () {
    this.Alt = "Alt";
    this.CapsLock = "CapsLock";
    this.Control = "Control";
    this.Shift = "Shift";
    this.Enter = "Enter";
    this.Tab = "Tab";
    this.ArrowDown = "ArrowDown";
    this.ArrowLeft = "ArrowLeft";
    this.ArrowRight = "ArrowRight";
    this.ArrowUp = "ArrowUp";
    this._End = "End";
    this.Home = "Home";
    this.PageDown = "PageDown";
    this.PageUp = "PageUp";
    this.BackSpace = "Backspace";
    this.Delete = "Delete";
    this.Insert = "Insert";
    this.Escape = "Escape";
    this.Pause = "Pause";
    this.F1 = "F1";
    this.F2 = "F2";
    this.F3 = "F3";
    this.F4 = "F4";
    this.F5 = "F5";
    this.F6 = "F6";
    this.F7 = "F7";
    this.F8 = "F8";
    this.F9 = "F9";
    this.F10 = "F10";
    this.F11 = "F11";
    this.F12 = "F12";
    this.F13 = "F13";
    this.F14 = "F14";
    this.F15 = "F15";
    this.F16 = "F16";
    this.F17 = "F17";
    this.F18 = "F18";
    this.F19 = "F19";
    this.F20 = "F20";
  });
});
rtl.module("Classes",["System","RTLConsts","Types","SysUtils","JS","TypInfo"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.$rtti.$MethodVar("TNotifyEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]]]), methodkind: 0});
  rtl.createClass(this,"EListError",pas.SysUtils.Exception,function () {
  });
  rtl.createClass(this,"EStringListError",this.EListError,function () {
  });
  rtl.createClass(this,"EComponentError",pas.SysUtils.Exception,function () {
  });
  this.TAlignment = {"0": "taLeftJustify", taLeftJustify: 0, "1": "taRightJustify", taRightJustify: 1, "2": "taCenter", taCenter: 2};
  this.$rtti.$Enum("TAlignment",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TAlignment});
  rtl.createClass(this,"TFPList",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FList = [];
      this.FCount = 0;
      this.FCapacity = 0;
    };
    this.$final = function () {
      this.FList = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Get = function (Index) {
      var Result = undefined;
      if ((Index < 0) || (Index >= this.FCount)) this.RaiseIndexError(Index);
      Result = this.FList[Index];
      return Result;
    };
    this.Put = function (Index, Item) {
      if ((Index < 0) || (Index >= this.FCount)) this.RaiseIndexError(Index);
      this.FList[Index] = Item;
    };
    this.SetCapacity = function (NewCapacity) {
      if (NewCapacity < this.FCount) this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),"" + NewCapacity);
      if (NewCapacity === this.FCapacity) return;
      this.FList = rtl.arraySetLength(this.FList,undefined,NewCapacity);
      this.FCapacity = NewCapacity;
    };
    this.SetCount = function (NewCount) {
      if (NewCount < 0) this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListCountError"),"" + NewCount);
      if (NewCount > this.FCount) {
        if (NewCount > this.FCapacity) this.SetCapacity(NewCount);
      };
      this.FCount = NewCount;
    };
    this.RaiseIndexError = function (Index) {
      this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),"" + Index);
    };
    this.Destroy = function () {
      this.Clear();
      pas.System.TObject.Destroy.call(this);
    };
    this.Add = function (Item) {
      var Result = 0;
      if (this.FCount === this.FCapacity) this.Expand();
      this.FList[this.FCount] = Item;
      Result = this.FCount;
      this.FCount += 1;
      return Result;
    };
    this.Clear = function () {
      if (rtl.length(this.FList) > 0) {
        this.SetCount(0);
        this.SetCapacity(0);
      };
    };
    this.Delete = function (Index) {
      if ((Index < 0) || (Index >= this.FCount)) this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),"" + Index);
      this.FCount = this.FCount - 1;
      this.FList.splice(Index,1);
      this.FCapacity -= 1;
    };
    this.Error = function (Msg, Data) {
      throw $mod.EListError.$create("CreateFmt",[Msg,pas.System.VarRecs(18,Data)]);
    };
    this.Expand = function () {
      var Result = null;
      var IncSize = 0;
      if (this.FCount < this.FCapacity) return this;
      IncSize = 4;
      if (this.FCapacity > 3) IncSize = IncSize + 4;
      if (this.FCapacity > 8) IncSize = IncSize + 8;
      if (this.FCapacity > 127) IncSize += this.FCapacity >>> 2;
      this.SetCapacity(this.FCapacity + IncSize);
      Result = this;
      return Result;
    };
    this.IndexOf = function (Item) {
      var Result = 0;
      var C = 0;
      Result = 0;
      C = this.FCount;
      while ((Result < C) && (this.FList[Result] != Item)) Result += 1;
      if (Result >= C) Result = -1;
      return Result;
    };
    this.IndexOfItem = function (Item, Direction) {
      var Result = 0;
      if (Direction === 0) {
        Result = this.IndexOf(Item)}
       else {
        Result = this.FCount - 1;
        while ((Result >= 0) && (this.FList[Result] != Item)) Result = Result - 1;
      };
      return Result;
    };
    this.Insert = function (Index, Item) {
      if ((Index < 0) || (Index > this.FCount)) this.$class.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),"" + Index);
      this.FList.splice(Index,0,Item);
      this.FCapacity += 1;
      this.FCount += 1;
    };
    this.Last = function () {
      var Result = undefined;
      if (this.FCount === 0) {
        Result = null}
       else Result = this.Get(this.FCount - 1);
      return Result;
    };
    this.Remove = function (Item) {
      var Result = 0;
      Result = this.IndexOf(Item);
      if (Result !== -1) this.Delete(Result);
      return Result;
    };
  });
  this.TListNotification = {"0": "lnAdded", lnAdded: 0, "1": "lnExtracted", lnExtracted: 1, "2": "lnDeleted", lnDeleted: 2};
  rtl.createClass(this,"TList",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FList = null;
    };
    this.$final = function () {
      this.FList = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Get = function (Index) {
      var Result = undefined;
      Result = this.FList.Get(Index);
      return Result;
    };
    this.Notify = function (aValue, Action) {
      if (pas.System.Assigned(aValue)) ;
      if (Action === 1) ;
    };
    this.GetCount = function () {
      var Result = 0;
      Result = this.FList.FCount;
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FList = $mod.TFPList.$create("Create");
      return this;
    };
    this.Destroy = function () {
      if (this.FList != null) this.Clear();
      pas.SysUtils.FreeAndNil({p: this, get: function () {
          return this.p.FList;
        }, set: function (v) {
          this.p.FList = v;
        }});
    };
    this.Add = function (Item) {
      var Result = 0;
      Result = this.FList.Add(Item);
      if (pas.System.Assigned(Item)) this.Notify(Item,0);
      return Result;
    };
    this.Clear = function () {
      while (this.FList.FCount > 0) this.Delete(this.GetCount() - 1);
    };
    this.Delete = function (Index) {
      var V = undefined;
      V = this.FList.Get(Index);
      this.FList.Delete(Index);
      if (pas.System.Assigned(V)) this.Notify(V,2);
    };
    this.IndexOf = function (Item) {
      var Result = 0;
      Result = this.FList.IndexOf(Item);
      return Result;
    };
    this.Insert = function (Index, Item) {
      this.FList.Insert(Index,Item);
      if (pas.System.Assigned(Item)) this.Notify(Item,0);
    };
  });
  rtl.createClass(this,"TPersistent",pas.System.TObject,function () {
    this.AssignError = function (Source) {
      var SourceName = "";
      if (Source !== null) {
        SourceName = Source.$classname}
       else SourceName = "Nil";
      throw pas.SysUtils.EConvertError.$create("Create$1",["Cannot assign a " + SourceName + " to a " + this.$classname + "."]);
    };
    this.AssignTo = function (Dest) {
      Dest.AssignError(this);
    };
    this.Assign = function (Source) {
      if (Source !== null) {
        Source.AssignTo(this)}
       else this.AssignError(null);
    };
    this.SetEvent = function (ALookupRoot, APropName, AMethodName) {
      this.SetEvent$1(this,ALookupRoot,APropName,AMethodName);
    };
    this.SetEvent$1 = function (AInstance, ALookupRoot, APropName, AMethodName) {
      var lMethod = pas.System.TMethod.$new();
      lMethod.Code = ALookupRoot.$class.MethodAddress(AMethodName);
      if (lMethod.Code === null) throw pas.SysUtils.Exception.$create("Create$1",[ALookupRoot.$classname + ' has no published method "' + AMethodName + '"']);
      lMethod.Data = ALookupRoot;
      pas.TypInfo.SetMethodProp$1(AInstance,APropName,lMethod);
    };
  });
  rtl.createClass(this,"TStrings",this.TPersistent,function () {
    this.$init = function () {
      $mod.TPersistent.$init.call(this);
      this.FSpecialCharsInited = false;
      this.FAlwaysQuote = false;
      this.FQuoteChar = "";
      this.FDelimiter = "";
      this.FNameValueSeparator = "";
      this.FUpdateCount = 0;
      this.FLBS = 0;
      this.FSkipLastLineBreak = false;
      this.FStrictDelimiter = false;
      this.FLineBreak = "";
    };
    this.GetName = function (Index) {
      var Result = "";
      var V = "";
      this.GetNameValue(Index,{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},{get: function () {
          return V;
        }, set: function (v) {
          V = v;
        }});
      return Result;
    };
    this.GetValue = function (Name) {
      var Result = "";
      var L = 0;
      var N = "";
      Result = "";
      L = this.IndexOfName(Name);
      if (L !== -1) this.GetNameValue(L,{get: function () {
          return N;
        }, set: function (v) {
          N = v;
        }},{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }});
      return Result;
    };
    this.SetCommaText = function (Value) {
      var C1 = "";
      var C2 = "";
      this.CheckSpecialChars();
      C1 = this.GetDelimiter();
      C2 = this.GetQuoteChar();
      this.SetDelimiter(",");
      this.SetQuoteChar('"');
      try {
        this.SetDelimitedText(Value);
      } finally {
        this.SetDelimiter(C1);
        this.SetQuoteChar(C2);
      };
    };
    this.SetDelimiter = function (c) {
      this.CheckSpecialChars();
      this.FDelimiter = c;
    };
    this.SetQuoteChar = function (c) {
      this.CheckSpecialChars();
      this.FQuoteChar = c;
    };
    this.DoSetTextStr = function (Value, DoClear) {
      var S = "";
      var P = 0;
      try {
        this.BeginUpdate();
        if (DoClear) this.Clear();
        P = 1;
        while (this.GetNextLinebreak(Value,{get: function () {
            return S;
          }, set: function (v) {
            S = v;
          }},{get: function () {
            return P;
          }, set: function (v) {
            P = v;
          }})) this.Add(S);
      } finally {
        this.EndUpdate();
      };
    };
    this.GetDelimiter = function () {
      var Result = "";
      this.CheckSpecialChars();
      Result = this.FDelimiter;
      return Result;
    };
    this.GetQuoteChar = function () {
      var Result = "";
      this.CheckSpecialChars();
      Result = this.FQuoteChar;
      return Result;
    };
    this.GetSkipLastLineBreak = function () {
      var Result = false;
      this.CheckSpecialChars();
      Result = this.FSkipLastLineBreak;
      return Result;
    };
    this.SetSkipLastLineBreak = function (AValue) {
      this.CheckSpecialChars();
      this.FSkipLastLineBreak = AValue;
    };
    this.Error = function (Msg, Data) {
      throw $mod.EStringListError.$create("CreateFmt",[Msg,pas.System.VarRecs(18,pas.SysUtils.IntToStr(Data))]);
    };
    this.GetCapacity = function () {
      var Result = 0;
      Result = this.GetCount();
      return Result;
    };
    this.GetObject = function (Index) {
      var Result = null;
      if (Index === 0) ;
      Result = null;
      return Result;
    };
    this.GetTextStr = function () {
      var Result = "";
      var I = 0;
      var S = "";
      var NL = "";
      this.CheckSpecialChars();
      if (this.FLineBreak !== pas.System.sLineBreak) {
        NL = this.FLineBreak}
       else {
        var $tmp = this.FLBS;
        if ($tmp === 0) {
          NL = "\n"}
         else if ($tmp === 1) {
          NL = "\r\n"}
         else if ($tmp === 2) NL = "\r";
      };
      Result = "";
      for (var $l = 0, $end = this.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        S = this.Get(I);
        Result = Result + S;
        if ((I < (this.GetCount() - 1)) || !this.GetSkipLastLineBreak()) Result = Result + NL;
      };
      return Result;
    };
    this.PutObject = function (Index, AObject) {
      if (Index === 0) return;
      if (AObject === null) return;
    };
    this.SetTextStr = function (Value) {
      this.CheckSpecialChars();
      this.DoSetTextStr(Value,true);
    };
    this.SetUpdateState = function (Updating) {
      if (Updating) ;
    };
    this.DoCompareText = function (s1, s2) {
      var Result = 0;
      Result = pas.SysUtils.CompareText(s1,s2);
      return Result;
    };
    this.SetDelimitedText = function (AValue) {
      var i = 0;
      var j = 0;
      var aNotFirst = false;
      this.CheckSpecialChars();
      this.BeginUpdate();
      i = 1;
      j = 1;
      aNotFirst = false;
      try {
        this.Clear();
        if (this.FStrictDelimiter) {
          while (i <= AValue.length) {
            if (aNotFirst && (i <= AValue.length) && (AValue.charAt(i - 1) === this.FDelimiter)) i += 1;
            if (i <= AValue.length) {
              if (AValue.charAt(i - 1) === this.FQuoteChar) {
                j = i + 1;
                while ((j <= AValue.length) && ((AValue.charAt(j - 1) !== this.FQuoteChar) || (((j + 1) <= AValue.length) && (AValue.charAt((j + 1) - 1) === this.FQuoteChar)))) {
                  if ((j <= AValue.length) && (AValue.charAt(j - 1) === this.FQuoteChar)) {
                    j += 2}
                   else j += 1;
                };
                this.Add(pas.SysUtils.StringReplace(pas.System.Copy(AValue,i + 1,j - i - 1),this.FQuoteChar + this.FQuoteChar,this.FQuoteChar,rtl.createSet(0)));
                i = j + 1;
              } else {
                j = i;
                while ((j <= AValue.length) && (AValue.charAt(j - 1) !== this.FDelimiter)) j += 1;
                this.Add(pas.System.Copy(AValue,i,j - i));
                i = j;
              };
            } else {
              if (aNotFirst) this.Add("");
            };
            aNotFirst = true;
          };
        } else {
          while (i <= AValue.length) {
            if (aNotFirst && (i <= AValue.length) && (AValue.charAt(i - 1) === this.FDelimiter)) i += 1;
            while ((i <= AValue.length) && (AValue.charCodeAt(i - 1) <= 32)) i += 1;
            if (i <= AValue.length) {
              if (AValue.charAt(i - 1) === this.FQuoteChar) {
                j = i + 1;
                while ((j <= AValue.length) && ((AValue.charAt(j - 1) !== this.FQuoteChar) || (((j + 1) <= AValue.length) && (AValue.charAt((j + 1) - 1) === this.FQuoteChar)))) {
                  if ((j <= AValue.length) && (AValue.charAt(j - 1) === this.FQuoteChar)) {
                    j += 2}
                   else j += 1;
                };
                this.Add(pas.SysUtils.StringReplace(pas.System.Copy(AValue,i + 1,j - i - 1),this.FQuoteChar + this.FQuoteChar,this.FQuoteChar,rtl.createSet(0)));
                i = j + 1;
              } else {
                j = i;
                while ((j <= AValue.length) && (AValue.charCodeAt(j - 1) > 32) && (AValue.charAt(j - 1) !== this.FDelimiter)) j += 1;
                this.Add(pas.System.Copy(AValue,i,j - i));
                i = j;
              };
            } else {
              if (aNotFirst) this.Add("");
            };
            while ((i <= AValue.length) && (AValue.charCodeAt(i - 1) <= 32)) i += 1;
            aNotFirst = true;
          };
        };
      } finally {
        this.EndUpdate();
      };
    };
    this.GetValueFromIndex = function (Index) {
      var Result = "";
      var N = "";
      this.GetNameValue(Index,{get: function () {
          return N;
        }, set: function (v) {
          N = v;
        }},{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }});
      return Result;
    };
    this.CheckSpecialChars = function () {
      if (!this.FSpecialCharsInited) {
        this.FQuoteChar = '"';
        this.FDelimiter = ",";
        this.FNameValueSeparator = "=";
        this.FLBS = pas.System.DefaultTextLineBreakStyle;
        this.FSpecialCharsInited = true;
        this.FLineBreak = pas.System.sLineBreak;
      };
    };
    this.GetNextLinebreak = function (Value, S, P) {
      var Result = false;
      var PPLF = 0;
      var PPCR = 0;
      var PP = 0;
      var PL = 0;
      S.set("");
      Result = false;
      if ((Value.length - P.get()) < 0) return Result;
      PPLF = Value.indexOf("\n",P.get() - 1) + 1;
      PPCR = Value.indexOf("\r",P.get() - 1) + 1;
      PL = 1;
      if ((PPLF > 0) && (PPCR > 0)) {
        if ((PPLF - PPCR) === 1) PL = 2;
        if (PPLF < PPCR) {
          PP = PPLF}
         else PP = PPCR;
      } else if ((PPLF > 0) && (PPCR < 1)) {
        PP = PPLF}
       else if ((PPCR > 0) && (PPLF < 1)) {
        PP = PPCR}
       else PP = Value.length + 1;
      S.set(pas.System.Copy(Value,P.get(),PP - P.get()));
      P.set(PP + PL);
      Result = true;
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FAlwaysQuote = false;
      return this;
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    this.Add = function (S) {
      var Result = 0;
      Result = this.GetCount();
      this.Insert(this.GetCount(),S);
      return Result;
    };
    this.AddObject = function (S, AObject) {
      var Result = 0;
      Result = this.Add(S);
      this.PutObject(Result,AObject);
      return Result;
    };
    this.AddStrings = function (TheStrings) {
      var Runner = 0;
      for (var $l = 0, $end = TheStrings.GetCount() - 1; $l <= $end; $l++) {
        Runner = $l;
        this.AddObject(TheStrings.Get(Runner),TheStrings.GetObject(Runner));
      };
    };
    this.Assign = function (Source) {
      var S = null;
      if ($mod.TStrings.isPrototypeOf(Source)) {
        S = Source;
        this.BeginUpdate();
        try {
          this.Clear();
          this.FSpecialCharsInited = S.FSpecialCharsInited;
          this.FQuoteChar = S.FQuoteChar;
          this.FDelimiter = S.FDelimiter;
          this.FNameValueSeparator = S.FNameValueSeparator;
          this.FLBS = S.FLBS;
          this.FLineBreak = S.FLineBreak;
          this.AddStrings(S);
        } finally {
          this.EndUpdate();
        };
      } else $mod.TPersistent.Assign.call(this,Source);
    };
    this.BeginUpdate = function () {
      if (this.FUpdateCount === 0) this.SetUpdateState(true);
      this.FUpdateCount += 1;
    };
    this.EndUpdate = function () {
      if (this.FUpdateCount > 0) this.FUpdateCount -= 1;
      if (this.FUpdateCount === 0) this.SetUpdateState(false);
    };
    this.IndexOfName = function (Name) {
      var Result = 0;
      var len = 0;
      var S = "";
      this.CheckSpecialChars();
      Result = 0;
      while (Result < this.GetCount()) {
        S = this.Get(Result);
        len = pas.System.Pos(this.FNameValueSeparator,S) - 1;
        if ((len >= 0) && (this.DoCompareText(Name,pas.System.Copy(S,1,len)) === 0)) return Result;
        Result += 1;
      };
      Result = -1;
      return Result;
    };
    this.GetNameValue = function (Index, AName, AValue) {
      var L = 0;
      this.CheckSpecialChars();
      AValue.set(this.Get(Index));
      L = pas.System.Pos(this.FNameValueSeparator,AValue.get());
      if (L !== 0) {
        AName.set(pas.System.Copy(AValue.get(),1,L - 1));
        AValue.set(pas.System.Copy(AValue.get(),L + 1,AValue.get().length - L));
      } else AName.set("");
    };
  });
  rtl.recNewT(this,"TStringItem",function () {
    this.FString = "";
    this.FObject = null;
    this.$eq = function (b) {
      return (this.FString === b.FString) && (this.FObject === b.FObject);
    };
    this.$assign = function (s) {
      this.FString = s.FString;
      this.FObject = s.FObject;
      return this;
    };
  });
  this.TStringsSortStyle = {"0": "sslNone", sslNone: 0, "1": "sslUser", sslUser: 1, "2": "sslAuto", sslAuto: 2};
  rtl.createClass(this,"TStringList",this.TStrings,function () {
    this.$init = function () {
      $mod.TStrings.$init.call(this);
      this.FList = [];
      this.FCount = 0;
      this.FOnChange = null;
      this.FOnChanging = null;
      this.FDuplicates = 0;
      this.FCaseSensitive = false;
      this.FOwnsObjects = false;
      this.FSortStyle = 0;
    };
    this.$final = function () {
      this.FList = undefined;
      this.FOnChange = undefined;
      this.FOnChanging = undefined;
      $mod.TStrings.$final.call(this);
    };
    this.GetSorted = function () {
      var Result = false;
      Result = this.FSortStyle in rtl.createSet(1,2);
      return Result;
    };
    this.Grow = function () {
      var NC = 0;
      NC = this.GetCapacity();
      if (NC >= 256) {
        NC = NC + rtl.trunc(NC / 4)}
       else if (NC === 0) {
        NC = 4}
       else NC = NC * 4;
      this.SetCapacity(NC);
    };
    this.InternalClear = function (FromIndex, ClearOnly) {
      var I = 0;
      if (FromIndex < this.FCount) {
        if (this.FOwnsObjects) {
          for (var $l = FromIndex, $end = this.FCount - 1; $l <= $end; $l++) {
            I = $l;
            this.FList[I].FString = "";
            pas.SysUtils.FreeAndNil({p: this.FList[I], get: function () {
                return this.p.FObject;
              }, set: function (v) {
                this.p.FObject = v;
              }});
          };
        } else {
          for (var $l1 = FromIndex, $end1 = this.FCount - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.FList[I].FString = "";
          };
        };
        this.FCount = FromIndex;
      };
      if (!ClearOnly) this.SetCapacity(0);
    };
    this.CheckIndex = function (AIndex) {
      if ((AIndex < 0) || (AIndex >= this.FCount)) this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),AIndex);
    };
    this.Changed = function () {
      if (this.FUpdateCount === 0) {
        if (this.FOnChange != null) this.FOnChange(this);
      };
    };
    this.Changing = function () {
      if (this.FUpdateCount === 0) if (this.FOnChanging != null) this.FOnChanging(this);
    };
    this.Get = function (Index) {
      var Result = "";
      this.CheckIndex(Index);
      Result = this.FList[Index].FString;
      return Result;
    };
    this.GetCapacity = function () {
      var Result = 0;
      Result = rtl.length(this.FList);
      return Result;
    };
    this.GetCount = function () {
      var Result = 0;
      Result = this.FCount;
      return Result;
    };
    this.GetObject = function (Index) {
      var Result = null;
      this.CheckIndex(Index);
      Result = this.FList[Index].FObject;
      return Result;
    };
    this.PutObject = function (Index, AObject) {
      this.CheckIndex(Index);
      this.Changing();
      this.FList[Index].FObject = AObject;
      this.Changed();
    };
    this.SetCapacity = function (NewCapacity) {
      if (NewCapacity < 0) this.Error(rtl.getResStr(pas.RTLConsts,"SListCapacityError"),NewCapacity);
      if (NewCapacity !== this.GetCapacity()) this.FList = rtl.arraySetLength(this.FList,$mod.TStringItem,NewCapacity);
    };
    this.SetUpdateState = function (Updating) {
      if (Updating) {
        this.Changing()}
       else this.Changed();
    };
    this.InsertItem = function (Index, S) {
      this.InsertItem$1(Index,S,null);
    };
    this.InsertItem$1 = function (Index, S, O) {
      var It = $mod.TStringItem.$new();
      this.Changing();
      if (this.FCount === this.GetCapacity()) this.Grow();
      It.FString = S;
      It.FObject = O;
      this.FList.splice(Index,0,It);
      this.FCount += 1;
      this.Changed();
    };
    this.DoCompareText = function (s1, s2) {
      var Result = 0;
      if (this.FCaseSensitive) {
        Result = pas.SysUtils.CompareStr(s1,s2)}
       else Result = pas.SysUtils.CompareText(s1,s2);
      return Result;
    };
    this.Destroy = function () {
      this.InternalClear(0,false);
      $mod.TStrings.Destroy.call(this);
    };
    this.Add = function (S) {
      var Result = 0;
      if (!(this.FSortStyle === 2)) {
        Result = this.FCount}
       else if (this.Find(S,{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }})) {
        var $tmp = this.FDuplicates;
        if ($tmp === 0) {
          return Result}
         else if ($tmp === 2) this.Error(rtl.getResStr(pas.RTLConsts,"SDuplicateString"),0);
      };
      this.InsertItem(Result,S);
      return Result;
    };
    this.Clear = function () {
      if (this.FCount === 0) return;
      this.Changing();
      this.InternalClear(0,false);
      this.Changed();
    };
    this.Find = function (S, Index) {
      var Result = false;
      var L = 0;
      var R = 0;
      var I = 0;
      var CompareRes = 0;
      Result = false;
      Index.set(-1);
      if (!this.GetSorted()) throw $mod.EListError.$create("Create$1",[rtl.getResStr(pas.RTLConsts,"SErrFindNeedsSortedList")]);
      L = 0;
      R = this.GetCount() - 1;
      while (L <= R) {
        I = L + rtl.trunc((R - L) / 2);
        CompareRes = this.DoCompareText(S,this.FList[I].FString);
        if (CompareRes > 0) {
          L = I + 1}
         else {
          R = I - 1;
          if (CompareRes === 0) {
            Result = true;
            if (this.FDuplicates !== 1) L = I;
          };
        };
      };
      Index.set(L);
      return Result;
    };
    this.Insert = function (Index, S) {
      if (this.FSortStyle === 2) {
        this.Error(rtl.getResStr(pas.RTLConsts,"SSortedListError"),0)}
       else {
        if ((Index < 0) || (Index > this.FCount)) this.Error(rtl.getResStr(pas.RTLConsts,"SListIndexError"),Index);
        this.InsertItem(Index,S);
      };
    };
  });
  rtl.createClass(this,"TCollectionItem",this.TPersistent,function () {
    this.$init = function () {
      $mod.TPersistent.$init.call(this);
      this.FCollection = null;
      this.FID = 0;
    };
    this.$final = function () {
      this.FCollection = undefined;
      $mod.TPersistent.$final.call(this);
    };
    this.SetCollection = function (Value) {
      if (Value !== this.FCollection) {
        if (this.FCollection != null) this.FCollection.RemoveItem(this);
        if (Value != null) Value.InsertItem(this);
      };
    };
    this.Create$1 = function (ACollection) {
      pas.System.TObject.Create.call(this);
      this.SetCollection(ACollection);
      return this;
    };
    this.Destroy = function () {
      this.SetCollection(null);
      pas.System.TObject.Destroy.call(this);
    };
  });
  this.TCollectionNotification = {"0": "cnAdded", cnAdded: 0, "1": "cnExtracting", cnExtracting: 1, "2": "cnDeleting", cnDeleting: 2};
  rtl.createClass(this,"TCollection",this.TPersistent,function () {
    this.$init = function () {
      $mod.TPersistent.$init.call(this);
      this.FItemClass = null;
      this.FItems = null;
      this.FUpdateCount = 0;
      this.FNextID = 0;
      this.FPropName = "";
    };
    this.$final = function () {
      this.FItemClass = undefined;
      this.FItems = undefined;
      $mod.TPersistent.$final.call(this);
    };
    this.GetCount = function () {
      var Result = 0;
      Result = this.FItems.FCount;
      return Result;
    };
    this.InsertItem = function (Item) {
      if (!this.FItemClass.isPrototypeOf(Item)) return;
      this.FItems.Add(Item);
      Item.FCollection = this;
      Item.FID = this.FNextID;
      this.FNextID += 1;
      this.SetItemName(Item);
      this.Notify(Item,0);
      this.Changed();
    };
    this.RemoveItem = function (Item) {
      var I = 0;
      this.Notify(Item,1);
      I = this.FItems.IndexOfItem(Item,1);
      if (I !== -1) this.FItems.Delete(I);
      Item.FCollection = null;
      this.Changed();
    };
    this.DoClear = function () {
      var Item = null;
      while (this.FItems.FCount > 0) {
        Item = rtl.getObject(this.FItems.Last());
        if (Item != null) Item.$destroy("Destroy");
      };
    };
    this.Changed = function () {
      if (this.FUpdateCount === 0) this.Update(null);
    };
    this.GetItem = function (Index) {
      var Result = null;
      Result = rtl.getObject(this.FItems.Get(Index));
      return Result;
    };
    this.SetItemName = function (Item) {
      if (Item === null) ;
    };
    this.Update = function (Item) {
      if (Item === null) ;
    };
    this.Notify = function (Item, Action) {
      if (Item === null) ;
      if (Action === 0) ;
    };
    this.Create$1 = function (AItemClass) {
      pas.System.TObject.Create.call(this);
      this.FItemClass = AItemClass;
      this.FItems = $mod.TFPList.$create("Create");
      return this;
    };
    this.Destroy = function () {
      this.FUpdateCount = 1;
      try {
        this.DoClear();
      } finally {
        this.FUpdateCount = 0;
      };
      if (this.FItems != null) this.FItems.$destroy("Destroy");
      pas.System.TObject.Destroy.call(this);
    };
    this.Add = function () {
      var Result = null;
      Result = this.FItemClass.$create("Create$1",[this]);
      return Result;
    };
    this.Assign = function (Source) {
      var I = 0;
      if ($mod.TCollection.isPrototypeOf(Source)) {
        this.Clear();
        for (var $l = 0, $end = Source.GetCount() - 1; $l <= $end; $l++) {
          I = $l;
          this.Add().Assign(Source.GetItem(I));
        };
        return;
      } else $mod.TPersistent.Assign.call(this,Source);
    };
    this.BeginUpdate = function () {
      this.FUpdateCount += 1;
    };
    this.Clear = function () {
      if (this.FItems.FCount === 0) return;
      this.BeginUpdate();
      try {
        this.DoClear();
      } finally {
        this.EndUpdate();
      };
    };
    this.EndUpdate = function () {
      if (this.FUpdateCount > 0) this.FUpdateCount -= 1;
      if (this.FUpdateCount === 0) this.Changed();
    };
  });
  rtl.createClass(this,"TOwnedCollection",this.TCollection,function () {
    this.$init = function () {
      $mod.TCollection.$init.call(this);
      this.FOwner = null;
    };
    this.$final = function () {
      this.FOwner = undefined;
      $mod.TCollection.$final.call(this);
    };
    this.Create$2 = function (AOwner, AItemClass) {
      this.FOwner = AOwner;
      $mod.TCollection.Create$1.call(this,AItemClass);
      return this;
    };
  });
  this.TOperation = {"0": "opInsert", opInsert: 0, "1": "opRemove", opRemove: 1};
  this.TComponentStateItem = {"0": "csLoading", csLoading: 0, "1": "csReading", csReading: 1, "2": "csWriting", csWriting: 2, "3": "csDestroying", csDestroying: 3, "4": "csDesigning", csDesigning: 4, "5": "csAncestor", csAncestor: 5, "6": "csUpdating", csUpdating: 6, "7": "csFixups", csFixups: 7, "8": "csFreeNotification", csFreeNotification: 8, "9": "csInline", csInline: 9, "10": "csDesignInstance", csDesignInstance: 10};
  this.TComponentStyleItem = {"0": "csInheritable", csInheritable: 0, "1": "csCheckPropAvail", csCheckPropAvail: 1, "2": "csSubComponent", csSubComponent: 2, "3": "csTransient", csTransient: 3};
  this.$rtti.$inherited("TComponentName",rtl.string,{});
  rtl.createClass(this,"TComponent",this.TPersistent,function () {
    this.$init = function () {
      $mod.TPersistent.$init.call(this);
      this.FOwner = null;
      this.FName = "";
      this.FTag = 0;
      this.FComponents = null;
      this.FFreeNotifies = null;
      this.FComponentState = {};
      this.FComponentStyle = {};
      this.FLeft = 0;
      this.FTop = 0;
    };
    this.$final = function () {
      this.FOwner = undefined;
      this.FComponents = undefined;
      this.FFreeNotifies = undefined;
      this.FComponentState = undefined;
      this.FComponentStyle = undefined;
      $mod.TPersistent.$final.call(this);
    };
    this.GetComponent = function (AIndex) {
      var Result = null;
      if (!(this.FComponents != null)) {
        Result = null}
       else Result = rtl.getObject(this.FComponents.Get(AIndex));
      return Result;
    };
    this.GetComponentCount = function () {
      var Result = 0;
      if (!(this.FComponents != null)) {
        Result = 0}
       else Result = this.FComponents.FCount;
      return Result;
    };
    this.Insert = function (AComponent) {
      if (!(this.FComponents != null)) this.FComponents = $mod.TFPList.$create("Create");
      this.FComponents.Add(AComponent);
      AComponent.FOwner = this;
    };
    this.Remove = function (AComponent) {
      AComponent.FOwner = null;
      if (this.FComponents != null) {
        this.FComponents.Remove(AComponent);
        if (this.FComponents.FCount === 0) {
          this.FComponents.$destroy("Destroy");
          this.FComponents = null;
        };
      };
    };
    this.RemoveNotification = function (AComponent) {
      if (this.FFreeNotifies !== null) {
        this.FFreeNotifies.Remove(AComponent);
        if (this.FFreeNotifies.FCount === 0) {
          this.FFreeNotifies.$destroy("Destroy");
          this.FFreeNotifies = null;
          this.FComponentState = rtl.excludeSet(this.FComponentState,8);
        };
      };
    };
    this.SetReference = function (Enable) {
      var aField = null;
      var aValue = null;
      var aOwner = null;
      if (this.FName === "") return;
      if (this.FOwner != null) {
        aOwner = this.FOwner;
        aField = this.FOwner.$class.FieldAddress(this.FName);
        if (aField != null) {
          if (Enable) {
            aValue = this}
           else aValue = null;
          aOwner["" + aField["name"]] = aValue;
        };
      };
    };
    this.ChangeName = function (NewName) {
      this.FName = NewName;
    };
    this.Loaded = function () {
      this.FComponentState = rtl.excludeSet(this.FComponentState,0);
    };
    this.Loading = function () {
      this.FComponentState = rtl.includeSet(this.FComponentState,0);
    };
    this.Notification = function (AComponent, Operation) {
      var C = 0;
      if (Operation === 1) this.RemoveFreeNotification(AComponent);
      if (!(this.FComponents != null)) return;
      C = this.FComponents.FCount - 1;
      while (C >= 0) {
        rtl.getObject(this.FComponents.Get(C)).Notification(AComponent,Operation);
        C -= 1;
        if (C >= this.FComponents.FCount) C = this.FComponents.FCount - 1;
      };
    };
    this.SetDesigning = function (Value, SetChildren) {
      var Runner = 0;
      if (Value) {
        this.FComponentState = rtl.includeSet(this.FComponentState,4)}
       else this.FComponentState = rtl.excludeSet(this.FComponentState,4);
      if ((this.FComponents != null) && SetChildren) for (var $l = 0, $end = this.FComponents.FCount - 1; $l <= $end; $l++) {
        Runner = $l;
        rtl.getObject(this.FComponents.Get(Runner)).SetDesigning(Value,true);
      };
    };
    this.SetName = function (NewName) {
      if (this.FName === NewName) return;
      if ((NewName !== "") && !pas.SysUtils.IsValidIdent(NewName,false,false)) throw $mod.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SInvalidName"),pas.System.VarRecs(18,NewName)]);
      if (this.FOwner != null) {
        this.FOwner.ValidateRename(this,this.FName,NewName)}
       else this.ValidateRename(null,this.FName,NewName);
      this.SetReference(false);
      this.ChangeName(NewName);
      this.SetReference(true);
    };
    this.SetParentComponent = function (Value) {
      if (Value === null) ;
    };
    this.ValidateRename = function (AComponent, CurName, NewName) {
      if ((AComponent !== null) && (pas.SysUtils.CompareText(CurName,NewName) !== 0) && (AComponent.FOwner === this) && (this.FindComponent(NewName) !== null)) throw $mod.EComponentError.$create("CreateFmt",[rtl.getResStr(pas.RTLConsts,"SDuplicateName"),pas.System.VarRecs(18,NewName)]);
      if ((4 in this.FComponentState) && (this.FOwner !== null)) this.FOwner.ValidateRename(AComponent,CurName,NewName);
    };
    this.ValidateContainer = function (AComponent) {
      AComponent.ValidateInsert(this);
    };
    this.ValidateInsert = function (AComponent) {
      if (AComponent === null) ;
    };
    this._AddRef = function () {
      var Result = 0;
      Result = -1;
      return Result;
    };
    this.GetLeft = function () {
      var Result = 0;
      Result = this.FLeft;
      return Result;
    };
    this.GetTop = function () {
      var Result = 0;
      Result = this.FTop;
      return Result;
    };
    this.SetLeft = function (AValue) {
      this.FLeft = AValue;
    };
    this.SetTop = function (AValue) {
      this.FTop = AValue;
    };
    this._Release = function () {
      var Result = 0;
      Result = -1;
      return Result;
    };
    this.Create$1 = function (AOwner) {
      this.FComponentStyle = rtl.createSet(0);
      if (AOwner != null) AOwner.InsertComponent(this);
      return this;
    };
    this.Destroy = function () {
      var I = 0;
      var C = null;
      this.Destroying();
      if (this.FFreeNotifies != null) {
        I = this.FFreeNotifies.FCount - 1;
        while (I >= 0) {
          C = rtl.getObject(this.FFreeNotifies.Get(I));
          this.FFreeNotifies.Delete(I);
          C.Notification(this,1);
          if (this.FFreeNotifies === null) {
            I = 0}
           else if (I > this.FFreeNotifies.FCount) I = this.FFreeNotifies.FCount;
          I -= 1;
        };
        pas.SysUtils.FreeAndNil({p: this, get: function () {
            return this.p.FFreeNotifies;
          }, set: function (v) {
            this.p.FFreeNotifies = v;
          }});
      };
      this.DestroyComponents();
      if (this.FOwner !== null) this.FOwner.RemoveComponent(this);
      pas.System.TObject.Destroy.call(this);
    };
    this.BeforeDestruction = function () {
      if (!(3 in this.FComponentState)) this.Destroying();
    };
    this.DestroyComponents = function () {
      var acomponent = null;
      while (this.FComponents != null) {
        acomponent = rtl.getObject(this.FComponents.Last());
        this.Remove(acomponent);
        acomponent.$destroy("Destroy");
      };
    };
    this.Destroying = function () {
      var Runner = 0;
      if (3 in this.FComponentState) return;
      this.FComponentState = rtl.includeSet(this.FComponentState,3);
      if (this.FComponents != null) for (var $l = 0, $end = this.FComponents.FCount - 1; $l <= $end; $l++) {
        Runner = $l;
        rtl.getObject(this.FComponents.Get(Runner)).Destroying();
      };
    };
    this.QueryInterface = function (IID, Obj) {
      var Result = 0;
      if (this.GetInterface(IID,Obj)) {
        Result = 0}
       else Result = -2147467262;
      return Result;
    };
    this.AfterLoadDFMValues = function () {
      this.EndUpdate();
      this.Loaded();
    };
    this.BeforeLoadDFMValues = function () {
      if (!(4 in this.FComponentState)) this.Loading();
      this.BeginUpdate();
    };
    this.BeginUpdate = function () {
    };
    this.EndUpdate = function () {
    };
    this.FindComponent = function (AName) {
      var Result = null;
      var I = 0;
      Result = null;
      if ((AName === "") || !(this.FComponents != null)) return Result;
      for (var $l = 0, $end = this.FComponents.FCount - 1; $l <= $end; $l++) {
        I = $l;
        if (pas.SysUtils.CompareText(rtl.getObject(this.FComponents.Get(I)).FName,AName) === 0) {
          Result = rtl.getObject(this.FComponents.Get(I));
          return Result;
        };
      };
      return Result;
    };
    this.FreeNotification = function (AComponent) {
      if ((this.FOwner !== null) && (AComponent === this.FOwner)) return;
      if (!(this.FFreeNotifies != null)) this.FFreeNotifies = $mod.TFPList.$create("Create");
      if (this.FFreeNotifies.IndexOf(AComponent) === -1) {
        this.FFreeNotifies.Add(AComponent);
        AComponent.FreeNotification(this);
      };
    };
    this.RemoveFreeNotification = function (AComponent) {
      this.RemoveNotification(AComponent);
      AComponent.RemoveNotification(this);
    };
    this.InsertComponent = function (AComponent) {
      AComponent.ValidateContainer(this);
      this.ValidateRename(AComponent,"",AComponent.FName);
      if (AComponent.FOwner !== null) AComponent.FOwner.RemoveComponent(AComponent);
      this.Insert(AComponent);
      if (4 in this.FComponentState) AComponent.SetDesigning(true,true);
      this.Notification(AComponent,0);
    };
    this.RemoveComponent = function (AComponent) {
      this.Notification(AComponent,1);
      this.Remove(AComponent);
      AComponent.SetDesigning(false,true);
      this.ValidateRename(AComponent,AComponent.FName,"");
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Name",6,$mod.$rtti["TComponentName"],"FName","SetName");
    $r.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",{Default: 0});
  });
  rtl.createClass(this,"TLoadHelper",pas.System.TObject,function () {
  });
  this.TShiftState$a = {"0": "ssShift", ssShift: 0, "1": "ssAlt", ssAlt: 1, "2": "ssCtrl", ssCtrl: 2, "3": "ssLeft", ssLeft: 3, "4": "ssRight", ssRight: 4, "5": "ssMIDdle", ssMIDdle: 5, "6": "ssDouble", ssDouble: 6, "7": "ssTouch", ssTouch: 7, "8": "ssPen", ssPen: 8, "9": "ssCommand", ssCommand: 9};
  this.$rtti.$Enum("TShiftState$a",{minvalue: 0, maxvalue: 9, ordtype: 1, enumtype: this.TShiftState$a});
  this.$rtti.$Set("TShiftState",{comptype: this.$rtti["TShiftState$a"]});
  this.GetClass = function (AClassName) {
    var Result = null;
    Result = null;
    if (AClassName === "") return Result;
    if (!$impl.ClassList.hasOwnProperty(AClassName)) return Result;
    Result = rtl.getObject($impl.ClassList[AClassName]);
    return Result;
  };
  this.SetLoadHelperClass = function (aClass) {
    var Result = null;
    Result = $impl.GlobalLoadHelper;
    $impl.GlobalLoadHelper = aClass;
    return Result;
  };
  $mod.$implcode = function () {
    $impl.GlobalLoadHelper = null;
    $impl.ClassList = null;
  };
  $mod.$init = function () {
    $impl.ClassList = new Object();
  };
},["Web"]);
rtl.module("WEBLib.Menus",["System","Classes","SysUtils","WEBLib.Controls","WEBLib.Graphics","Web"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.$rtti.$Class("TMainMenu");
  this.$rtti.$Class("TMenuItem");
  this.$rtti.$Class("TCustomMainMenu");
  this.TMenuItemAutoFlag = {"0": "maAutomatic", maAutomatic: 0, "1": "maManual", maManual: 1, "2": "maParent", maParent: 2};
  this.$rtti.$Enum("TMenuItemAutoFlag",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TMenuItemAutoFlag});
  this.TMenuBreak = {"0": "mbNone", mbNone: 0, "1": "mbBreak", mbBreak: 1, "2": "mbBarBreak", mbBarBreak: 2};
  this.$rtti.$Enum("TMenuBreak",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TMenuBreak});
  this.$rtti.$Int("THelpContext",{minvalue: -2147483647, maxvalue: 2147483647, ordtype: 4});
  this.$rtti.$inherited("TShortCut",rtl.word,{});
  this.TMainMenuHamburgerMenuVisible = {"0": "hmAlways", hmAlways: 0, "1": "hmNever", hmNever: 1, "2": "hmResponsive", hmResponsive: 2};
  this.$rtti.$Enum("TMainMenuHamburgerMenuVisible",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TMainMenuHamburgerMenuVisible});
  this.$rtti.$MethodVar("TMainMenuChangeEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Source",this.$rtti["TMenuItem"]],["Rebuild",rtl.boolean]]), methodkind: 0});
  rtl.createClass(this,"TMenuItemList",pas.Classes.TList,function () {
    this.GetItem = function (Index) {
      var Result = null;
      Result = rtl.getObject(this.Get(Index));
      return Result;
    };
  });
  rtl.createClass(this,"TMenuItem",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FOwner$1 = null;
      this.FCaption = "";
      this.FItems = null;
      this.FParentItem = null;
      this.FOnClick = null;
      this.FChecked = false;
      this.FEnabled = false;
      this.FDefault = false;
      this.FAutoCheck = false;
      this.FHint = "";
      this.FAutoHotkeys = 0;
      this.FRadioItem = false;
      this.FGroupIndex = 0;
      this.FVisible = false;
      this.FShortCut = 0;
      this.FBreak = 0;
      this.FImageIndex = 0;
      this.FAutoLineReduction = 0;
      this.FHelpContext = 0;
      this.FElementClassName = "";
      this.FParentMenu = null;
    };
    this.$final = function () {
      this.FOwner$1 = undefined;
      this.FItems = undefined;
      this.FParentItem = undefined;
      this.FOnClick = undefined;
      this.FParentMenu = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.SetChecked = function (Value) {
      var pm = null;
      var Item = null;
      var OtherItem = null;
      var MenuOwner = null;
      var I = 0;
      if (this.FChecked !== Value) {
        this.FChecked = Value;
        MenuOwner = this.FParentMenu;
        if (MenuOwner != null) {
          if ($mod.TMenuItem.isPrototypeOf(MenuOwner) && Value) {
            Item = MenuOwner;
            for (var $l = 0, $end = Item.FItems.GetCount() - 1; $l <= $end; $l++) {
              I = $l;
              OtherItem = Item.FItems.GetItem(I);
              if (OtherItem.FRadioItem && (OtherItem !== this)) OtherItem.SetChecked(false);
            };
          };
          while (!$mod.TCustomMainMenu.isPrototypeOf(MenuOwner) && (MenuOwner != null)) {
            MenuOwner = MenuOwner.FOwner;
          };
        };
        pm = this.GetParentMenu();
        if (pm != null) pm.UpdateElement();
      };
    };
    this.SetCaption = function (Value) {
      var pm = null;
      this.FCaption = Value;
      pm = this.GetParentMenu();
      if (pm != null) pm.UpdateElement();
    };
    this.SetImageIndex = function (Value) {
      var pm = null;
      this.FImageIndex = Value;
      pm = this.GetParentMenu();
      if (pm != null) pm.UpdateElement();
    };
    this.SetEnabled = function (Value) {
      if (this.FEnabled !== Value) {
        this.FEnabled = Value;
        this.GetParentMenu().UpdateElement();
      };
    };
    this.GetCount = function () {
      var Result = 0;
      if (this.FItems === null) {
        Result = 0}
       else Result = this.FItems.GetCount();
      return Result;
    };
    this.Create$1 = function (AOwner) {
      this.FParentMenu = null;
      if ($mod.TMainMenu.isPrototypeOf(AOwner)) this.FParentMenu = AOwner;
      pas.Classes.TComponent.Create$1.call(this,AOwner);
      this.FAutoHotkeys = 2;
      this.FAutoLineReduction = 2;
      this.FImageIndex = -1;
      this.FHint = "";
      this.FCaption = "MenuItem";
      this.FChecked = false;
      this.FEnabled = true;
      this.FDefault = false;
      this.FRadioItem = false;
      this.FVisible = true;
      this.FOwner$1 = AOwner;
      return this;
    };
    this.Destroy = function () {
      var i = 0;
      var pm = null;
      var mnu = null;
      pm = this.GetParentMenu();
      if ((this.FParentItem != null) && (pm != null)) {
        pm.BeginUpdate();
        for (var $l = this.FParentItem.FItems.GetCount() - 1; $l >= 0; $l--) {
          i = $l;
          if (this.FParentItem.FItems.GetItem(i) === this) {
            this.FParentItem.FItems.Delete(i);
          };
        };
        pm.EndUpdate();
      };
      if (this.FItems != null) {
        for (var $l1 = this.FItems.GetCount() - 1; $l1 >= 0; $l1--) {
          i = $l1;
          mnu = this.FItems.GetItem(i);
          mnu.FParentItem = null;
          mnu = rtl.freeLoc(mnu);
          this.FItems.Delete(i);
        };
      };
      pas.Classes.TComponent.Destroy.call(this);
    };
    this.Assign = function (Source) {
      var i = 0;
      var srcmenu = null;
      var mnu = null;
      var pm = null;
      if ($mod.TMenuItem.isPrototypeOf(Source)) {
        srcmenu = rtl.as(Source,$mod.TMenuItem);
        this.FAutoCheck = srcmenu.FAutoCheck;
        this.FAutoHotkeys = srcmenu.FAutoHotkeys;
        this.FAutoLineReduction = srcmenu.FAutoLineReduction;
        this.FBreak = srcmenu.FBreak;
        this.FCaption = srcmenu.FCaption;
        this.FChecked = srcmenu.FChecked;
        this.FDefault = srcmenu.FDefault;
        this.FEnabled = srcmenu.FEnabled;
        this.FGroupIndex = srcmenu.FGroupIndex;
        this.FHelpContext = srcmenu.FHelpContext;
        this.FHint = srcmenu.FHint;
        this.FImageIndex = srcmenu.FImageIndex;
        this.FRadioItem = srcmenu.FRadioItem;
        this.FShortCut = srcmenu.FShortCut;
        this.FVisible = srcmenu.FVisible;
        this.FElementClassName = srcmenu.FElementClassName;
        pm = this.GetParentMenu();
        if (this.FParentItem != null) this.SetName(pm.GetUniqueName(srcmenu.FCaption));
        if (srcmenu.FItems != null) {
          if (this.FItems != null) {
            for (var $l = this.FItems.GetCount() - 1; $l >= 0; $l--) {
              i = $l;
              this.RemoveItem(this.GetParentMenu().FParent,this.FItems.GetItem(i));
            };
            this.FItems.Clear();
          } else this.FItems = $mod.TMenuItemList.$create("Create$1");
          for (var $l1 = 0, $end = srcmenu.FItems.GetCount() - 1; $l1 <= $end; $l1++) {
            i = $l1;
            mnu = $mod.TMenuItem.$create("Create$1",[pm.FOwner]);
            mnu.FParentMenu = pm;
            mnu.FParentItem = this;
            mnu.Assign(srcmenu.FItems.GetItem(i));
            this.FItems.Add(mnu);
          };
        };
      };
    };
    this.SetParentComponent = function (Value) {
      pas.Classes.TComponent.SetParentComponent.apply(this,arguments);
      this.FParentMenu = Value;
      if (Value !== null) {
        if ($mod.TCustomMainMenu.isPrototypeOf(Value)) {
          if (!Value.FItems.IsChild(this)) Value.FItems.Add(this);
        } else if ($mod.TMenuItem.isPrototypeOf(Value)) {
          if (!Value.IsChild(this)) Value.Add(this);
        };
      };
    };
    this.Add = function (Item) {
      this.Insert$1(this.GetCount(),Item);
    };
    this.Insert$1 = function (Index, Item) {
      if (this.FItems === null) this.FItems = $mod.TMenuItemList.$create("Create$1");
      this.FItems.Insert(Index,Item);
      Item.FParentItem = this;
      if (Item.GetParentMenu() != null) Item.GetParentMenu().UpdateElement();
    };
    this.IsChild = function (Item) {
      var Result = false;
      var i = 0;
      Result = false;
      if (!(this.FItems != null)) return Result;
      for (var $l = 0, $end = this.FItems.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (this.FItems.GetItem(i) === Item) {
          Result = true;
        };
      };
      return Result;
    };
    this.GetParentMenu = function () {
      var Result = null;
      var AOwner = null;
      Result = null;
      AOwner = this.FParentMenu;
      while ((AOwner != null) && $mod.TMenuItem.isPrototypeOf(AOwner)) {
        AOwner = AOwner.FParentMenu;
      };
      if (AOwner != null) Result = AOwner;
      return Result;
    };
    this.RemoveItem = function (AOwner, AItem) {
      var I = 0;
      if (AItem.FItems != null) {
        for (var $l = AItem.FItems.GetCount() - 1; $l >= 0; $l--) {
          I = $l;
          this.RemoveItem(AOwner,AItem.FItems.GetItem(I));
        };
      };
      AOwner.RemoveComponent(AItem);
    };
    this.Click = function () {
      if (this.FOnClick != null) this.FOnClick(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("AutoCheck",0,rtl.boolean,"FAutoCheck","FAutoCheck",{Default: false});
    $r.addProperty("AutoHotkeys",0,$mod.$rtti["TMenuItemAutoFlag"],"FAutoHotkeys","FAutoHotkeys",{Default: $mod.TMenuItemAutoFlag.maParent});
    $r.addProperty("AutoLineReduction",0,$mod.$rtti["TMenuItemAutoFlag"],"FAutoLineReduction","FAutoLineReduction",{Default: $mod.TMenuItemAutoFlag.maParent});
    $r.addProperty("Break",0,$mod.$rtti["TMenuBreak"],"FBreak","FBreak",{Default: $mod.TMenuBreak.mbNone});
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("Checked",2,rtl.boolean,"FChecked","SetChecked",{Default: false});
    $r.addProperty("Default",0,rtl.boolean,"FDefault","FDefault",{Default: false});
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("GroupIndex",0,rtl.byte,"FGroupIndex","FGroupIndex",{Default: 0});
    $r.addProperty("HelpContext",0,$mod.$rtti["THelpContext"],"FHelpContext","FHelpContext",{Default: 0});
    $r.addProperty("Hint",0,rtl.string,"FHint","FHint");
    $r.addProperty("ImageIndex",2,rtl.longint,"FImageIndex","SetImageIndex",{Default: -1});
    $r.addProperty("RadioItem",0,rtl.boolean,"FRadioItem","FRadioItem",{Default: false});
    $r.addProperty("ShortCut",0,$mod.$rtti["TShortCut"],"FShortCut","FShortCut",{Default: 0});
    $r.addProperty("Visible",0,rtl.boolean,"FVisible","FVisible",{Default: true});
    $r.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","FElementClassName");
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
  });
  this.$rtti.$Class("TMainMenuAppearance");
  rtl.createClass(this,"THamburgerMenu",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FOwner = null;
      this.FVisible = 0;
      this.FCaption = "";
      this.FBackgroundColor = 0;
      this.FCaptionColor = 0;
      this.FResponsiveMaxWidth = 0;
    };
    this.$final = function () {
      this.FOwner = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.SetVisible = function (Value) {
      if (this.FVisible !== Value) {
        this.FVisible = Value;
        this.FOwner.FOwner.UpdateElement();
      };
    };
    this.SetBackgroundColor = function (Value) {
      if (this.FBackgroundColor !== Value) {
        this.FBackgroundColor = Value;
        this.FOwner.FOwner.UpdateElement();
      };
    };
    this.SetCaption = function (Value) {
      if (this.FCaption !== Value) {
        this.FCaption = Value;
        this.FOwner.FOwner.UpdateElement();
      };
    };
    this.SetCaptionColor = function (Value) {
      if (this.FCaptionColor !== Value) {
        this.FCaptionColor = Value;
        this.FOwner.FOwner.UpdateElement();
      };
    };
    this.SetResponsiveMaxWidth = function (Value) {
      if (this.FResponsiveMaxWidth !== Value) {
        this.FResponsiveMaxWidth = Value;
        this.FOwner.FOwner.UpdateElement();
      };
    };
    this.Create$1 = function (AOwner) {
      this.FBackgroundColor = 12632256;
      this.FCaption = "Menu";
      this.FCaptionColor = 16777215;
      this.FVisible = 2;
      this.FResponsiveMaxWidth = 768;
      this.FOwner = AOwner;
      return this;
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    this.Assign = function (Source) {
      pas.Classes.TPersistent.Assign.apply(this,arguments);
      if ($mod.THamburgerMenu.isPrototypeOf(Source)) {
        this.FBackgroundColor = rtl.as(Source,$mod.THamburgerMenu).FBackgroundColor;
        this.FCaption = rtl.as(Source,$mod.THamburgerMenu).FCaption;
        this.FCaptionColor = rtl.as(Source,$mod.THamburgerMenu).FCaptionColor;
        this.FVisible = rtl.as(Source,$mod.THamburgerMenu).FVisible;
        this.FResponsiveMaxWidth = rtl.as(Source,$mod.THamburgerMenu).FResponsiveMaxWidth;
      };
    };
    var $r = this.$rtti;
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("CaptionColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FCaptionColor","SetCaptionColor",{Default: 16777215});
    $r.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FBackgroundColor","SetBackgroundColor",{Default: 12632256});
    $r.addProperty("Visible",2,$mod.$rtti["TMainMenuHamburgerMenuVisible"],"FVisible","SetVisible",{Default: $mod.TMainMenuHamburgerMenuVisible.hmResponsive});
    $r.addProperty("ResponsiveMaxWidth",2,rtl.longint,"FResponsiveMaxWidth","SetResponsiveMaxWidth",{Default: 768});
  });
  rtl.createClass(this,"TMainMenuAppearance",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FOwner = null;
      this.FBackgroundColor = 0;
      this.FHoverFontColor = 0;
      this.FHoverColor = 0;
      this.FImageURLs = null;
      this.FHamburgerMenu = null;
      this.FImageSize = 0;
      this.FSubmenuIndicator = "";
    };
    this.$final = function () {
      this.FOwner = undefined;
      this.FImageURLs = undefined;
      this.FHamburgerMenu = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.SetBackgroundColor = function (Value) {
      if (this.FBackgroundColor !== Value) {
        this.FBackgroundColor = Value;
        this.FOwner.UpdateElement();
      };
    };
    this.SetHoverColor = function (Value) {
      if (this.FHoverColor !== Value) {
        this.FHoverColor = Value;
        this.FOwner.UpdateElement();
      };
    };
    this.SetHoverFontColor = function (Value) {
      if (this.FHoverFontColor !== Value) {
        this.FHoverFontColor = Value;
        this.FOwner.UpdateElement();
      };
    };
    this.SetImageURLs = function (Value) {
      this.FImageURLs.Assign(Value);
    };
    this.SetImageSize = function (Value) {
      if (this.FImageSize !== Value) {
        this.FImageSize = Value;
        this.FOwner.UpdateElement();
      };
    };
    this.SetSubmenuIndicator = function (Value) {
      if (this.FSubmenuIndicator !== Value) {
        this.FSubmenuIndicator = Value;
        this.FOwner.UpdateElement();
      };
    };
    this.HandleImageURLsChanged = function (Sender) {
      this.FOwner.UpdateElement();
    };
    this.Create$1 = function (AOwner) {
      this.FBackgroundColor = 0xF0F0F0;
      this.FHoverColor = 14120960;
      this.FHoverFontColor = 197379;
      this.FHamburgerMenu = $mod.THamburgerMenu.$create("Create$1",[this]);
      this.FImageURLs = pas.Classes.TStringList.$create("Create$1");
      this.FImageURLs.SetSkipLastLineBreak(true);
      this.FImageURLs.FOnChange = rtl.createCallback(this,"HandleImageURLsChanged");
      this.FImageSize = 16;
      this.FSubmenuIndicator = "&#9658;";
      this.FOwner = AOwner;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHamburgerMenu");
      rtl.free(this,"FImageURLs");
      pas.System.TObject.Destroy.call(this);
    };
    this.Assign = function (Source) {
      pas.Classes.TPersistent.Assign.apply(this,arguments);
      if ($mod.TMainMenu.isPrototypeOf(Source)) {
        this.FBackgroundColor = rtl.as(Source,$mod.TMainMenuAppearance).FBackgroundColor;
        this.FHoverColor = rtl.as(Source,$mod.TMainMenuAppearance).FHoverColor;
        this.FHoverFontColor = rtl.as(Source,$mod.TMainMenuAppearance).FHoverFontColor;
        this.FHamburgerMenu.Assign(rtl.as(Source,$mod.TMainMenuAppearance).FHamburgerMenu);
        this.FImageURLs.Assign(rtl.as(Source,$mod.TMainMenuAppearance).FImageURLs);
        this.FImageSize = rtl.as(Source,$mod.TMainMenuAppearance).FImageSize;
        this.FSubmenuIndicator = rtl.as(Source,$mod.TMainMenuAppearance).FSubmenuIndicator;
      };
    };
    var $r = this.$rtti;
    $r.addProperty("BackgroundColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FBackgroundColor","SetBackgroundColor",{Default: 15790320});
    $r.addProperty("HamburgerMenu",0,$mod.$rtti["THamburgerMenu"],"FHamburgerMenu","FHamburgerMenu");
    $r.addProperty("HoverColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FHoverColor","SetHoverColor",{Default: 14120960});
    $r.addProperty("HoverFontColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FHoverFontColor","SetHoverFontColor",{Default: 197379});
    $r.addProperty("ImageURLs",2,pas.Classes.$rtti["TStringList"],"FImageURLs","SetImageURLs");
    $r.addProperty("ImageSize",2,rtl.longint,"FImageSize","SetImageSize",{Default: 16});
    $r.addProperty("SubmenuIndicator",2,rtl.string,"FSubmenuIndicator","SetSubmenuIndicator");
  });
  rtl.createClass(this,"TCustomMainMenu",pas["WEBLib.Controls"].TCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TCustomControl.$init.call(this);
      this.FItems = null;
      this.FOnChange = null;
    };
    this.$final = function () {
      this.FItems = undefined;
      this.FOnChange = undefined;
      pas["WEBLib.Controls"].TCustomControl.$final.call(this);
    };
    this.Loaded = function () {
      pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);
      if (this.IsUpdating()) return;
      if (this.GetElementHandle() != null) this.UpdateElement();
    };
    this.UpdateElement = function () {
      pas["WEBLib.Controls"].TControl.UpdateElement.call(this);
      if (this.IsUpdating()) return;
    };
    this.GetUniqueName = function (AName) {
      var Result = "";
      var i = 0;
      var id = 0;
      var found = false;
      id = 1;
      if (AName === "") AName = this.FName + "item";
      AName = $impl.MakeValidName(AName);
      do {
        Result = AName + pas.SysUtils.IntToStr(id);
        found = true;
        for (var $l = 0, $end = this.FOwner.GetComponentCount() - 1; $l <= $end; $l++) {
          i = $l;
          if (this.FOwner.GetComponent(i).FName === Result) {
            found = false;
            id += 1;
            break;
          };
        };
      } while (!found);
      return Result;
    };
    this.SetName = function (NewName) {
      pas["WEBLib.Controls"].TCustomControl.SetName.apply(this,arguments);
      if (this.IsUpdating()) return;
      if (0 in this.FComponentState) return;
      this.UpdateElement();
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      this.FItems = $mod.TMenuItem.$create("Create$1",[this]);
      this.FItems.FParentMenu = this;
      this.SetWidthStyle(2);
      this.SetHeight(30);
    };
    this.Destroy = function () {
      rtl.free(this,"FItems");
      pas["WEBLib.Controls"].TCustomControl.Destroy.call(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Items",0,$mod.$rtti["TMenuItem"],"FItems","");
    $r.addProperty("OnChange",0,$mod.$rtti["TMainMenuChangeEvent"],"FOnChange","FOnChange");
  });
  rtl.createClass(this,"TMainMenu",this.TCustomMainMenu,function () {
    this.$init = function () {
      $mod.TCustomMainMenu.$init.call(this);
      this.FMenu = null;
      this.FMainMenu = false;
      this.FMenuIndex = 0;
      this.FAppearance = null;
      this.FContainer$1 = null;
      this.FIsPopupMenu = false;
      this.FShowPopup = false;
      this.FElementItemClassName = "";
    };
    this.$final = function () {
      this.FMenu = undefined;
      this.FAppearance = undefined;
      this.FContainer$1 = undefined;
      $mod.TCustomMainMenu.$final.call(this);
    };
    this.HandleChange = function (Event) {
      var Result = false;
      var h = null;
      var it = null;
      Result = true;
      if (this.FIsPopupMenu) {
        this.FShowPopup = false;
        this.UpdateElement();
      };
      h = Event.target;
      if (!h.hasAttribute("id")) h = h.parentElement;
      it = this.GetItemByName(this.FItems,h.id);
      if (it != null) {
        if (it.FAutoCheck) it.SetChecked(!it.FChecked);
        if (this.FOnChange != null) this.FOnChange(this,it,false);
        it.Click();
      };
      return Result;
    };
    this.Loaded = function () {
      $mod.TCustomMainMenu.Loaded.call(this);
      if (this.IsUpdating()) return;
      if (!(this.FContainer$1 != null) && pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent) && (rtl.as(this.FParent,pas["WEBLib.Forms"].TCustomForm).FMenu === this)) {
        this.FContainer$1 = this.FParent;
      };
      if (this.GetElementHandle() != null) this.UpdateElement();
    };
    this.UpdateElement = function () {
      var MenuStyle = "";
      var MenuColorStyle = "";
      var MenuResponsiveStyle = "";
      var MenuImageSize = "";
      var ShowPopup = "";
      var ElHandle = null;
      var ElLabel = null;
      var ElSpan = null;
      var ElIcon = null;
      var ElCheckBox = null;
      var ElStyle = null;
      var ElScript = null;
      var ElItems = null;
      $mod.TCustomMainMenu.UpdateElement.call(this);
      if (this.IsUpdating()) return;
      if (!(this.GetElementHandle() != null) && !(this.FContainer$1 != null)) return;
      if (this.FContainer$1 != null) {
        ElHandle = this.FContainer$1.GetElementHandle();
        this.SetVisible(false);
      } else {
        ElHandle = this.GetElementHandle();
        ElHandle.style.setProperty("top",pas.SysUtils.IntToStr(this.GetTop()) + "px");
        ElHandle.style.setProperty("left",pas.SysUtils.IntToStr(this.GetLeft()) + "px");
        if ((4 in this.FComponentState) && !(this.FContainer$1 != null)) this.GetElementHandle().style.setProperty("background-color","silver");
      };
      this.FMenu = ElHandle.firstChild;
      if (this.FMenu != null) this.FMenu.parentElement.removeChild(this.FMenu);
      if (3 in this.FComponentState) return;
      this.FMenu = document.createElement("NAV");
      this.FMenu.setAttribute("id",this.GetID() + "menu");
      this.FMenu.innerHTML = "";
      if (this.FContainer$1 != null) {
        this.FMenu.style.setProperty("top","0");
        this.FMenu.style.setProperty("left","0");
        this.FMenu.style.setProperty("position","absolute");
        this.FMenu.style.setProperty("width","100%");
        this.FMenu.style.setProperty("z-index","999997");
      };
      ElHandle.innerHTML = "";
      ElHandle.style.setProperty("overflow","visible");
      if (this.FAppearance.FHamburgerMenu.FVisible !== 0) {
        if (this.FShowPopup) {
          ShowPopup = "block"}
         else ShowPopup = "none";
        MenuResponsiveStyle = "  #" + this.GetID() + "menu .main-menu {\r" + "    display: block;\r" + "  }\r" + "  #" + this.GetID() + "menu #toggle-menu {\r" + "    display: none;\r" + "  }\r" + "  #" + this.GetID() + "menu ul span.drop-label {\r" + "    display: inline-block;\r" + "  }\r" + "  #" + this.GetID() + "menu li {\r" + "    float: left;\r" + "    border-width: 0 1px 0 0;\r" + "  }\r" + "  #" + this.GetID() + "menu .popup-menu li, \r" + "  #" + this.GetID() + "menu .sub-menu li {\r" + "    float: none;\r" + "  }\r" + "  #" + this.GetID() + "menu .sub-menu {\r" + "    top: 100%;\r" + "  }\r" + "  #" + this.GetID() + "menu .popup-menu { \r" + "    top: 0;\r" + "  }\r" + "  #" + this.GetID() + "menu .popup-menu, \r" + "  #" + this.GetID() + "menu .sub-menu {\r" + "    border-width: 0;\r" + "    margin: 0;\r" + "    position: absolute;\r" + "    left: 0;\r" + "    min-width: 12em;\r" + "    z-index: 9999999;\r" + "\t   white-space: nowrap;\r" + "  }\r" + "  #" + this.GetID() + "menu .sub-menu {\r" + "    top: 100%;\r" + "  }\r" + "  #" + this.GetID() + "menu .popup-menu { \r" + "    display: " + ShowPopup + ";\r" + "  }\r" + "  #" + this.GetID() + "menu .sub-menu,\r" + "  #" + this.GetID() + 'menu input[type="checkbox"]:checked + .popup-menu,\r' + "  #" + this.GetID() + 'menu input[type="checkbox"]:checked + .sub-menu {\r' + "    display: none;\r" + "  }\r" + "  #" + this.GetID() + "menu .popup-menu li, \r" + "  #" + this.GetID() + "menu .sub-menu li {\r" + "    border-width: 1px;\r" + "  }\r" + "  #" + this.GetID() + "menu .popup-menu .sub-menu, \r" + "  #" + this.GetID() + "menu .sub-menu .sub-menu {\r" + "    top: 0;\r" + "    left: 100%;\r" + "  }\r" + "  #" + this.GetID() + 'menu li:hover > input[type="checkbox"] + .popup-menu, \r' + "  #" + this.GetID() + 'menu li:hover > input[type="checkbox"] + .sub-menu {\r' + "    display: block;\r" + "  }\r";
        if (this.FAppearance.FHamburgerMenu.FVisible === 2) {
          MenuResponsiveStyle = "@media only screen and (min-width: " + pas.SysUtils.IntToStr(this.FAppearance.FHamburgerMenu.FResponsiveMaxWidth) + "px) {\r" + MenuResponsiveStyle + "}";
        };
      };
      if (this.FAppearance.FImageSize > 0) {
        MenuImageSize = "  width: " + pas.SysUtils.IntToStr(this.FAppearance.FImageSize) + "px;\r" + "  height: " + pas.SysUtils.IntToStr(this.FAppearance.FImageSize) + "px;\r";
      };
      MenuStyle = "#" + this.GetID() + "menu ul {\r" + "  margin: 0;\r" + "  padding: 0;\r" + "}\r" + "#" + this.GetID() + "menu .main-menu {\r" + "  display: none;\r" + "}\r" + "#" + this.GetID() + "menu .popup-menu {\r" + "  display: block;\r" + "}\r" + "#" + this.GetID() + "menu label img.icon," + "#" + this.GetID() + "menu label span.checked {\r" + MenuImageSize + "  margin-right: 10px;\r" + "  pointer-events: none;\r" + "}\r" + "#tm:checked + .main-menu {\r" + "  display: block;\r" + "}\r" + "#" + this.GetID() + 'menu input[type="checkbox"],\r' + "#" + this.GetID() + "menu ul span.drop-label {\r" + "  display: none;\r" + "}\r" + "#" + this.GetID() + "menu li,\r" + "#" + this.GetID() + "menu #toggle-menu,\r" + "#" + this.GetID() + "menu .popup-menu,\r" + "#" + this.GetID() + "menu .sub-menu {\r" + "  border-width: 1px;\r" + "  border-style: solid;\r" + "  border-color: rgba(0, 0, 0, .05);\r" + "  border-bottom: 0px;\r" + "  border-top: 0px;\r" + "}\r" + "#" + this.GetID() + "menu li,\r" + "#" + this.GetID() + "menu #toggle-menu {\r" + "  border-width: 0 0 3px;\r" + "}\r" + "#" + this.GetID() + "menu .popup-menu,\r" + "#" + this.GetID() + "menu .sub-menu {\r" + "  border-width: 1px 1px 0;\r" + "  margin: 0 1em;\r" + "}\r" + "#" + this.GetID() + "menu .popup-menu li:first-child,\r" + "#" + this.GetID() + "menu .sub-menu li:first-child {\r" + "  border-top: 1px solid;\r" + "  border-color: rgba(0, 0, 0, .05);\r" + "}\r" + "#" + this.GetID() + "menu .popup-menu li:last-child,\r" + "#" + this.GetID() + "menu .sub-menu li:last-child {\r" + "  border-bottom: 1px solid;\r" + "  border-color: rgba(0, 0, 0, .05);\r" + "}\r" + "#" + this.GetID() + "menu li,\r" + "#" + this.GetID() + "menu #toggle-menu,\r" + "#" + this.GetID() + "menu li label {\r" + "  position: relative;\r" + "  display: block;\r" + "}\r" + "#" + this.GetID() + "menu #toggle-menu,\r" + "#" + this.GetID() + "menu li label { \r" + "  padding: 0.75em 1.5em;\r" + "  text-decoration: none;\r" + "}\r" + "#" + this.GetID() + "menu li span.menu-separator { \r" + "  display: block;\r" + "  width: 100%;\r" + "  height: 1px;\r" + "  background-color: rgba(0, 0, 0, .05);\r" + "}\r" + "#" + this.GetID() + "menu .popup-menu, \r" + "#" + this.GetID() + "menu .sub-menu {\r" + "  display: none;\r" + "}\r" + "#" + this.GetID() + 'menu input[type="checkbox"]:checked + .popup-menu,\r' + "#" + this.GetID() + 'menu input[type="checkbox"]:checked + .sub-menu {\r' + "  display: block;\r" + "  z-index: 3000;\r" + "}\r" + "#" + this.GetID() + "menu span.drop-icon {\r" + "  margin-left: 10px;" + "}\r" + "#" + this.GetID() + "menu span.hamburger-icon {\r" + "  float: right;\r" + "  padding: 0;\r" + "  margin: 0;\r" + "  font-weight: 900;\r" + "}\r" + "@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r" + "  #" + this.GetID() + "menu li {\r" + "    width: auto;\r" + "  }\r" + "  #" + this.GetID() + "menu .sub-menu li {\r" + "    width: auto;\r" + "  }\r" + "}\r";
      MenuColorStyle = "";
      if (this.FElementClassName === "") {
        MenuColorStyle = "#" + this.GetID() + "menu .popup-menu, \r" + "#" + this.GetID() + "menu .sub-menu {\r" + "  background-color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor) + ";\r" + "}\r" + "@media only screen and (max-width: 64em) and (min-width: 52.01em) {\r" + "#" + this.GetID() + "menu .sub-menu {\r" + "  background-color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor) + ";\r" + "}\r" + "}\r" + "#" + this.GetID() + "menu li,\r" + "#" + this.GetID() + "menu #toggle-menu,\r" + "#" + this.GetID() + "menu li label {\r" + "}\r" + "#" + this.GetID() + "menu #toggle-menu {\r" + "  background-color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FBackgroundColor) + ";\r" + "  color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHamburgerMenu.FCaptionColor) + ";\r" + "}\r" + "#" + this.GetID() + "menu .main-menu li label {\r" + "  background-color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FBackgroundColor) + ";\r" + "}\r" + "#" + this.GetID() + "menu li label:hover {\r" + "  background-color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor) + ";\r" + "  color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor) + ";\r" + "}\r" + "#" + this.GetID() + "menu .popup-menu label:hover, \r" + "#" + this.GetID() + "menu .sub-menu label:hover {\r" + "  background-color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverColor) + ";\r" + "  color: " + pas["WEBLib.Graphics"].ColorToHTML(this.FAppearance.FHoverFontColor) + ";\r" + "}\r";
      };
      MenuStyle = MenuStyle + MenuColorStyle + MenuResponsiveStyle;
      this.FMainMenu = true;
      this.FMenuIndex = 0;
      ElStyle = document.createElement("STYLE");
      ElStyle.innerHTML = MenuStyle;
      ElScript = document.createElement("SCRIPT");
      ElScript.innerHTML = "function " + this.GetID() + "MenuClick(ctrl){" + "  el = ctrl.parentElement.parentElement;" + '  el.style.display = "none";' + '  setTimeout(function(){el.style.removeProperty("display")}, 25);' + "}" + "function " + this.GetID() + "MenuOut(ctrl){" + '  menuel = document.getElementById("' + this.GetID() + '");' + "  if(menuel) { " + '    popupel = menuel.getElementsByClassName("popup-menu");' + "    if(popupel) " + '      setTimeout(function(){popupel[0].style.display = "none"}, 25);' + "  }" + "}";
      ElLabel = document.createElement("LABEL");
      ElLabel.setAttribute("for","tm");
      ElLabel.setAttribute("id","toggle-menu");
      ElLabel.innerHTML = this.FAppearance.FHamburgerMenu.FCaption;
      ElSpan = document.createElement("SPAN");
      if (this.FElementItemClassName !== "") {
        ElSpan.setAttribute("class",this.FElementItemClassName)}
       else ElSpan.setAttribute("class","drop-label");
      ElLabel.appendChild(ElSpan);
      ElIcon = document.createElement("SPAN");
      ElIcon.setAttribute("class","hamburger-icon");
      ElIcon.innerHTML = "&#9776;";
      ElSpan.appendChild(ElIcon);
      ElCheckBox = document.createElement("INPUT");
      ElCheckBox.setAttribute("type","checkbox");
      ElCheckBox.setAttribute("id","tm");
      this.FMenu.appendChild(ElStyle);
      this.FMenu.appendChild(ElScript);
      this.FMenu.appendChild(ElLabel);
      this.FMenu.appendChild(ElCheckBox);
      ElItems = this.GetMenuSource(this.FItems);
      if (ElItems !== null) this.FMenu.appendChild(ElItems);
      ElHandle.appendChild(this.FMenu);
    };
    this.GetMenuSource = function (Item) {
      var Result = null;
      var I = 0;
      var it = null;
      var MenuClass = "";
      var ElListItem = null;
      var ElLabel = null;
      var ElCheckBox = null;
      var ElSymbol = null;
      var id = 0;
      var caption = "";
      Result = null;
      if ((Item.FItems != null) && (Item.FItems.GetCount() > 0)) {
        Result = document.createElement("UL");
        if (this.FMainMenu) {
          this.FMainMenu = false;
          if (this.FIsPopupMenu) {
            MenuClass = "popup-menu"}
           else MenuClass = "main-menu";
        } else MenuClass = "sub-menu";
        this.FMenuIndex = this.FMenuIndex + 1;
        Result.setAttribute("class",MenuClass);
        for (var $l = 0, $end = Item.FItems.GetCount() - 1; $l <= $end; $l++) {
          I = $l;
          it = Item.FItems.GetItem(I);
          id = id + 1;
          if (it.FName === "") {
            caption = pas.SysUtils.StringReplace(it.FCaption," ","",rtl.createSet(0));
            caption = $impl.MakeValidName(caption);
            if (caption === "") caption = "MenuItem" + pas.SysUtils.IntToStr(id);
            it.SetName(caption + pas.SysUtils.IntToStr(id));
          };
          if (it.FVisible) {
            ElListItem = document.createElement("LI");
            if (it.FCaption !== "-") {
              ElLabel = document.createElement("LABEL");
              if (this.FElementItemClassName !== "") {
                ElLabel.setAttribute("class",this.FElementItemClassName)}
               else ElLabel.setAttribute("class","drop-label");
              ElLabel.setAttribute("title",it.FHint);
              if ((it.FImageIndex >= 0) && (this.FAppearance.FImageURLs.GetCount() > it.FImageIndex)) {
                ElLabel.innerHTML = '<img class="icon" src="' + this.FAppearance.FImageURLs.Get(it.FImageIndex) + '">'}
               else if (it.FChecked) {
                if (it.FRadioItem) {
                  ElLabel.innerHTML = '<span class="checked">&#9679;</span>'}
                 else ElLabel.innerHTML = '<span class="checked">&#10004;</span>';
              };
              ElLabel.innerHTML = ElLabel.innerHTML + it.FCaption;
            } else {
              ElLabel = document.createElement("SPAN");
              ElLabel.setAttribute("class","menu-separator");
              ElLabel.innerHTML = "";
            };
            if ((it.FItems != null) && (it.FItems.GetCount() > 0)) {
              ElSymbol = document.createElement("SPAN");
              ElSymbol.setAttribute("class","drop-icon");
              ElSymbol.innerHTML = this.FAppearance.FSubmenuIndicator;
              ElLabel.setAttribute("for","sm" + pas.SysUtils.IntToStr(this.FMenuIndex));
              ElLabel.appendChild(ElSymbol);
              if (!it.FEnabled) ElLabel.style.setProperty("color","gray");
              ElCheckBox = document.createElement("INPUT");
              ElCheckBox.setAttribute("type","checkbox");
              ElCheckBox.setAttribute("id","sm" + pas.SysUtils.IntToStr(this.FMenuIndex));
              ElListItem.appendChild(ElLabel);
              ElListItem.appendChild(ElCheckBox);
              if (it.FEnabled) ElListItem.appendChild(this.GetMenuSource(it));
            } else {
              ElLabel.setAttribute("for","tm");
              ElLabel.setAttribute("id",it.FName);
              if (it.FEnabled) {
                if (MenuClass === "sub-menu") {
                  if (it.FEnabled) ElLabel.setAttribute("onMouseUp",this.GetID() + "MenuClick(this);");
                };
                ElLabel.addEventListener("click",rtl.createSafeCallback(this,"HandleChange"));
              } else ElLabel.style.setProperty("color","gray");
              ElListItem.appendChild(ElLabel);
            };
            Result.appendChild(ElListItem);
          };
        };
      };
      return Result;
    };
    this.GetItemByName = function (AMenu, Name) {
      var Result = null;
      var I = 0;
      var it = null;
      Result = null;
      if (AMenu.FItems != null) {
        for (var $l = 0, $end = AMenu.FItems.GetCount() - 1; $l <= $end; $l++) {
          I = $l;
          it = AMenu.FItems.GetItem(I);
          if (it.FName === Name) {
            Result = it;
            if (it.FOnClick != null) Result.FOnClick = it.FOnClick;
            return Result;
          };
          if (!(Result != null)) Result = this.GetItemByName(it,Name);
        };
      };
      return Result;
    };
    this.CreateInitialize = function () {
      $mod.TCustomMainMenu.CreateInitialize.call(this);
      this.FAppearance = $mod.TMainMenuAppearance.$create("Create$1",[this]);
      this.FContainer$1 = null;
      this.FMainMenu = true;
      this.FMenuIndex = 0;
      this.FIsPopupMenu = false;
      this.FShowPopup = false;
      this.SetTop(0);
      this.SetLeft(0);
      this.SetWidth(100);
      if (4 in this.FComponentState) {
        this.SetElementPosition(1);
        this.SetWidthPercent(100);
        this.SetWidthStyle(0);
      };
    };
    this.CreateElement = function () {
      var Result = null;
      var LLabel = null;
      if (4 in this.FComponentState) {
        Result = document.createElement("DIV");
        LLabel = document.createElement("DIV");
        LLabel.innerHTML = "TWebMainMenu";
        this.SetBorderStyle(1);
        LLabel.setAttribute("align","center");
        LLabel.style.setProperty("border","1px solid gray");
        LLabel.style.setProperty("vertical-align","middle");
        LLabel.style.setProperty("display","table-cell");
        Result.appendChild(LLabel);
      } else {
        Result = document.createElement("DIV");
        if (this.FIsPopupMenu) Result.setAttribute("onMouseLeave",this.GetID() + "MenuOut(this);");
      };
      return Result;
    };
    this.Destroy = function () {
      rtl.free(this,"FAppearance");
      $mod.TCustomMainMenu.Destroy.call(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Appearance",0,$mod.$rtti["TMainMenuAppearance"],"FAppearance","FAppearance");
    $r.addProperty("Container",0,pas["WEBLib.Controls"].$rtti["TControl"],"FContainer$1","FContainer$1");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementItemClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementItemClassName","FElementItemClassName");
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
  });
  rtl.createClass(this,"TPopupMenu",this.TMainMenu,function () {
    this.$init = function () {
      $mod.TMainMenu.$init.call(this);
      this.FOnPopup = null;
    };
    this.$final = function () {
      this.FOnPopup = undefined;
      $mod.TMainMenu.$final.call(this);
    };
    this.Create$1 = function (AOwner) {
      pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments);
      if (pas["WEBLib.Controls"].TControl.isPrototypeOf(AOwner)) this.SetParent(AOwner);
      return this;
    };
    this.CreateInitialize = function () {
      $mod.TMainMenu.CreateInitialize.call(this);
      this.FAppearance.FHamburgerMenu.SetVisible(1);
      this.FIsPopupMenu = true;
    };
    this.Popup = function (X, Y) {
      if (this.FOnPopup != null) this.FOnPopup(this);
      this.SetTop(Y);
      this.SetLeft(X);
      this.FShowPopup = true;
      this.UpdateElement();
      this.FShowPopup = false;
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("OnPopup",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnPopup","FOnPopup");
  });
  rtl.createClass(this,"TWebCustomControl",pas["WEBLib.Controls"].TCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TCustomControl.$init.call(this);
      this.FPopupMenu = null;
    };
    this.$final = function () {
      this.FPopupMenu = undefined;
      pas["WEBLib.Controls"].TCustomControl.$final.call(this);
    };
    this.HandleDoContextMenu = function (Event) {
      var Result = false;
      var pt = pas.Types.TPoint.$new();
      var frm = null;
      var r = null;
      pas["WEBLib.Controls"].TControl.HandleDoContextMenu.apply(this,arguments);
      if (this.FPopupMenu != null) {
        Event.stopPropagation();
        Event.preventDefault();
        pt.$assign(pas.Types.Point(Math.round(Event.clientX),Math.round(Event.clientY)));
        frm = pas["WEBLib.Forms"].GetParentForm(this);
        if ((frm != null) && (frm.GetContainer() != null)) {
          r = frm.GetContainer().getBoundingClientRect();
          pt.x = pt.x - Math.round(r.left);
          pt.y = pt.y - Math.round(r.top);
        };
        this.FPopupMenu.Popup(pt.x,pt.y);
        Result = true;
      };
      return Result;
    };
    this.Notification = function (AComponent, Operation) {
      pas.Classes.TComponent.Notification.apply(this,arguments);
      if ((Operation === 1) && (AComponent === this.FPopupMenu)) this.FPopupMenu = null;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  $mod.$implcode = function () {
    var Alpha = rtl.createSet(null,65,90,null,97,122,95);
    var AlphaNum = rtl.unionSet(Alpha,rtl.createSet(null,48,57));
    $impl.MakeValidName = function (s) {
      var Result = "";
      var i = 0;
      Result = "";
      for (var $l = 1, $end = s.length; $l <= $end; $l++) {
        i = $l;
        if (s.charCodeAt(i - 1) in AlphaNum) Result = Result + s.charAt(i - 1);
      };
      return Result;
    };
  };
},["Types","WEBLib.Forms"]);
rtl.module("WEBLib.WebCtrls",["System","Classes","WEBLib.Controls","WEBLib.Graphics","SysUtils","Web","JS","WEBLib.Menus"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"THTMLDiv",pas["WEBLib.Controls"].TCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TCustomControl.$init.call(this);
      this.FHTML = null;
      this.FOldText = "";
    };
    this.$final = function () {
      this.FHTML = undefined;
      pas["WEBLib.Controls"].TCustomControl.$final.call(this);
    };
    this.SetHTML = function (Value) {
      this.FHTML.Assign(Value);
    };
    this.UpdateElementData = function () {
      pas["WEBLib.Controls"].TControl.UpdateElementData.call(this);
      if (this.GetElementHandle() != null) {
        if ((this.FOldText !== "") || (this.FHTML.GetTextStr() !== "")) this.GetElementHandle().innerHTML = this.FHTML.GetTextStr();
        this.FOldText = this.FHTML.GetTextStr();
      } else {
        if (!this.GetIsLinked() && (4 in this.FComponentState)) this.RenderDesigning(this.$classname,this.GetContainer(),this,true,"");
      };
    };
    this.HTMLChanged = function (Sender) {
      this.UpdateElementData();
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("DIV");
      return Result;
    };
    this.CreateInitialize = function () {
      this.FHTML = pas.Classes.TStringList.$create("Create$1");
      this.FHTML.SetSkipLastLineBreak(true);
      rtl.as(this.FHTML,pas.Classes.TStringList).FOnChange = rtl.createCallback(this,"HTMLChanged");
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      this.FControlStyle = rtl.unionSet(this.FControlStyle,rtl.createSet(0));
      this.SetClipChildren(false);
      this.SetTabStop(false);
    };
    this.Destroy = function () {
      rtl.free(this,"FHTML");
      pas["WEBLib.Controls"].TCustomControl.Destroy.call(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default: 0});
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("HTML",2,pas.Classes.$rtti["TStrings"],"FHTML","SetHTML");
    $r.addProperty("Role",3,rtl.string,"GetRole","SetRole");
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchStart","FOnTouchStart");
    $r.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchEnd","FOnTouchEnd");
    $r.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchMove","FOnTouchMove");
    $r.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchCancel","FOnTouchCancel");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
},["WEBLib.Dialogs","WEBLib.WebTools"]);
rtl.module("WEBLib.Consts",["System"],function () {
  "use strict";
  var $mod = this;
  $mod.$resourcestrings = {SWarning: {org: "Warning"}, SError: {org: "Error"}, SInformation: {org: "Information"}, SConfirm: {org: "Confirm"}, SOK: {org: "OK"}, SCancel: {org: "Cancel"}, SYes: {org: "Yes"}, SNo: {org: "No"}, SAbort: {org: "Abort"}, SRetry: {org: "Retry"}, SIgnore: {org: "Ignore"}, SHelp: {org: "Help"}, SClose: {org: "Close"}, SAll: {org: "All"}, SYesToAll: {org: "Yes to all"}, SNoToAll: {org: "No to all"}, SWarningFR: {org: "Avertissement"}, SErrorFR: {org: "Erreur"}, SInformationFR: {org: "Information"}, SConfirmFR: {org: "Confirmer"}, SOKFR: {org: "OK"}, SCancelFR: {org: "Annuler"}, SYesFR: {org: "Oui"}, SNoFR: {org: "Non"}, SAbortFR: {org: "Interrompre"}, SRetryFR: {org: "Réessayer"}, SIgnoreFR: {org: "Ignorer"}, SHelpFR: {org: "Aide"}, SCloseFR: {org: "Fermer"}, SAllFR: {org: "Tout"}, SYesToAllFR: {org: "Oui à tout"}, SNoToAllFR: {org: "Non à tout"}, SWarningDE: {org: "Warnung"}, SErrorDE: {org: "Fehler"}, SInformationDE: {org: "Information"}, SConfirmDE: {org: "Bestätigen"}, SOKDE: {org: "OK"}, SCancelDE: {org: "Verzögern"}, SYesDE: {org: "Ja"}, SNoDE: {org: "Nein"}, SAbortDE: {org: "Abbrechen"}, SRetryDE: {org: "Wiederholen"}, SIgnoreDE: {org: "Ignorieren"}, SHelpDE: {org: "Hilfe"}, SCloseDE: {org: "Schließen"}, SAllDE: {org: "Alles"}, SYesToAllDE: {org: "Ja auf Alles"}, SNoToAllDE: {org: "Nein auf Alles"}, SWarningES: {org: "Advertencia"}, SErrorES: {org: "Error"}, SInformationES: {org: "Información"}, SConfirmES: {org: "Confirmado"}, SOKES: {org: "OK"}, SCancelES: {org: "Cancelar"}, SYesES: {org: "Sí"}, SNoES: {org: "No"}, SAbortES: {org: "Abortar"}, SRetryES: {org: "Rever"}, SIgnoreES: {org: "Ignorar"}, SHelpES: {org: "Ayudar"}, SCloseES: {org: "Cerrar"}, SAllES: {org: "Todos"}, SYesToAllES: {org: "Sí a todo"}, SNoToAllES: {org: "No a todo"}, SWarningNL: {org: "Waarschuwing"}, SErrorNL: {org: "Fout"}, SInformationNL: {org: "Informatie"}, SConfirmNL: {org: "Bevestiging"}, SOKNL: {org: "OK"}, SCancelNL: {org: "Afbreken"}, SYesNL: {org: "Ja"}, SNoNL: {org: "Nee"}, SAbortNL: {org: "Afbreken"}, SRetryNL: {org: "Opnieuw"}, SIgnoreNL: {org: "Negeren"}, SHelpNL: {org: "Hulp"}, SCloseNL: {org: "Sluiten"}, SAllNL: {org: "Alles"}, SYesToAllNL: {org: "Ja op alles"}, SNoToAllNL: {org: "Nee op alles"}};
});
rtl.module("WEBLib.Dialogs",["System","Classes","WEBLib.Controls","Web","JS","SysUtils","WEBLib.WebTools","WEBLib.WebCtrls","WEBLib.Graphics"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.TMsgDlgType = {"0": "mtWarning", mtWarning: 0, "1": "mtError", mtError: 1, "2": "mtInformation", mtInformation: 2, "3": "mtConfirmation", mtConfirmation: 3, "4": "mtCustom", mtCustom: 4};
  this.$rtti.$Enum("TMsgDlgType",{minvalue: 0, maxvalue: 4, ordtype: 1, enumtype: this.TMsgDlgType});
  this.TMsgDlgBtn = {"0": "mbYes", mbYes: 0, "1": "mbNo", mbNo: 1, "2": "mbOK", mbOK: 2, "3": "mbCancel", mbCancel: 3, "4": "mbAbort", mbAbort: 4, "5": "mbRetry", mbRetry: 5, "6": "mbIgnore", mbIgnore: 6, "7": "mbAll", mbAll: 7, "8": "mbNoToAll", mbNoToAll: 8, "9": "mbYesToAll", mbYesToAll: 9, "10": "mbHelp", mbHelp: 10, "11": "mbClose", mbClose: 11};
  this.$rtti.$Enum("TMsgDlgBtn",{minvalue: 0, maxvalue: 11, ordtype: 1, enumtype: this.TMsgDlgBtn});
  this.$rtti.$Set("TMsgDlgButtons",{comptype: this.$rtti["TMsgDlgBtn"]});
  rtl.createClass(this,"TCustomDialogButton",pas.Classes.TCollectionItem,function () {
    this.$init = function () {
      pas.Classes.TCollectionItem.$init.call(this);
      this.FCaption = "";
      this.FTag = 0;
      this.FElementClassName = "";
    };
    var $r = this.$rtti;
    $r.addProperty("Caption",0,rtl.string,"FCaption","FCaption");
    $r.addProperty("ElementClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","FElementClassName");
    $r.addProperty("Tag",0,rtl.longint,"FTag","FTag",{Default: 0});
  });
  rtl.createClass(this,"TCustomDialogButtons",pas.Classes.TOwnedCollection,function () {
    this.GetItem$1 = function (AIndex) {
      var Result = null;
      Result = this.GetItem(AIndex);
      return Result;
    };
  });
  rtl.createClass(this,"TMessageDlg",pas["WEBLib.Controls"].TCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TCustomControl.$init.call(this);
      this.FOpacity = 0.0;
      this.FLayer$1 = null;
      this.FDlg = null;
      this.FCancel = null;
      this.FMessage = "";
      this.FTitle = "";
      this.FMsgDlgType = 0;
      this.FOnButtonClick = null;
      this.FOnClose = null;
      this.FButtons = {};
      this.FDialogProc = null;
      this.FDialogResult = 0;
      this.FMdx = 0;
      this.FMdy = 0;
      this.FDlgX = 0;
      this.FDlgY = 0;
      this.FCaptured$1 = false;
      this.FDown = false;
      this.FElementTitleClassName = "";
      this.FElementButtonClassName = "";
      this.FElementContentClassName = "";
      this.FDialogText = null;
      this.FCustomButtons = null;
      this.FElementDialogClassName = "";
      this.FAutoLanguage = false;
    };
    this.$final = function () {
      this.FLayer$1 = undefined;
      this.FDlg = undefined;
      this.FCancel = undefined;
      this.FOnButtonClick = undefined;
      this.FOnClose = undefined;
      this.FButtons = undefined;
      this.FDialogProc = undefined;
      this.FDialogText = undefined;
      this.FCustomButtons = undefined;
      pas["WEBLib.Controls"].TCustomControl.$final.call(this);
    };
    this.SetDialogText = function (Value) {
      this.FDialogText.Assign(Value);
    };
    this.SetCustomButtons = function (Value) {
      this.FCustomButtons.Assign(Value);
    };
    this.CreateElement = function () {
      var Result = null;
      if (4 in this.FComponentState) {
        Result = null}
       else pas["WEBLib.Controls"].TCustomControl.CreateElement.call(this);
      return Result;
    };
    var TLang = {"0": "lEN", lEN: 0, "1": "lFR", lFR: 1, "2": "lDE", lDE: 2, "3": "lES", lES: 3, "4": "lNL", lNL: 4};
    this.GetDialogText = function (Index) {
      var Result = "";
      var locl = "";
      var l = 0;
      Result = "Undefined";
      if (Index < this.FDialogText.GetCount()) Result = this.FDialogText.Get(Index);
      if (this.FAutoLanguage) {
        locl = pas["WEBLib.WebTools"].GetBrowserLocale();
        l = 0;
        if (pas.System.Pos("es",locl) === 1) l = 3;
        if (pas.System.Pos("fr",locl) === 1) l = 1;
        if (pas.System.Pos("de",locl) === 1) l = 2;
        if (pas.System.Pos("nl",locl) === 1) l = 4;
        var $tmp = l;
        if ($tmp === 3) {
          var $tmp1 = Index;
          if ($tmp1 === 0) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SWarningES")}
           else if ($tmp1 === 1) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SErrorES")}
           else if ($tmp1 === 2) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SInformationES")}
           else if ($tmp1 === 3) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SConfirmES")}
           else if ($tmp1 === 5) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SOKES")}
           else if ($tmp1 === 6) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SCancelES")}
           else if ($tmp1 === 7) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesES")}
           else if ($tmp1 === 8) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoES")}
           else if ($tmp1 === 9) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAbortES")}
           else if ($tmp1 === 10) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SRetryES")}
           else if ($tmp1 === 11) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreES")}
           else if ($tmp1 === 12) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAllES")}
           else if ($tmp1 === 13) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllES")}
           else if ($tmp1 === 14) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllES")}
           else if ($tmp1 === 15) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SHelpES")}
           else if ($tmp1 === 16) Result = rtl.getResStr(pas["WEBLib.Consts"],"SCloseES");
        } else if ($tmp === 1) {
          var $tmp2 = Index;
          if ($tmp2 === 0) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SWarningFR")}
           else if ($tmp2 === 1) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SErrorFR")}
           else if ($tmp2 === 2) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SInformationFR")}
           else if ($tmp2 === 3) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SConfirmFR")}
           else if ($tmp2 === 5) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SOKFR")}
           else if ($tmp2 === 6) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SCancelFR")}
           else if ($tmp2 === 7) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesFR")}
           else if ($tmp2 === 8) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoFR")}
           else if ($tmp2 === 9) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAbortFR")}
           else if ($tmp2 === 10) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SRetryFR")}
           else if ($tmp2 === 11) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreFR")}
           else if ($tmp2 === 12) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAllFR")}
           else if ($tmp2 === 13) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllFR")}
           else if ($tmp2 === 14) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllFR")}
           else if ($tmp2 === 15) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SHelpFR")}
           else if ($tmp2 === 16) Result = rtl.getResStr(pas["WEBLib.Consts"],"SCloseFR");
        } else if ($tmp === 2) {
          var $tmp3 = Index;
          if ($tmp3 === 0) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SWarningDE")}
           else if ($tmp3 === 1) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SErrorDE")}
           else if ($tmp3 === 2) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SInformationDE")}
           else if ($tmp3 === 3) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SConfirmDE")}
           else if ($tmp3 === 5) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SOKDE")}
           else if ($tmp3 === 6) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SCancelDE")}
           else if ($tmp3 === 7) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesDE")}
           else if ($tmp3 === 8) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoDE")}
           else if ($tmp3 === 9) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAbortDE")}
           else if ($tmp3 === 10) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SRetryDE")}
           else if ($tmp3 === 11) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreDE")}
           else if ($tmp3 === 12) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAllDE")}
           else if ($tmp3 === 13) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllDE")}
           else if ($tmp3 === 14) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllDE")}
           else if ($tmp3 === 15) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SHelpDE")}
           else if ($tmp3 === 16) Result = rtl.getResStr(pas["WEBLib.Consts"],"SCloseDE");
        } else if ($tmp === 4) {
          var $tmp4 = Index;
          if ($tmp4 === 0) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SWarningNL")}
           else if ($tmp4 === 1) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SErrorNL")}
           else if ($tmp4 === 2) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SInformationNL")}
           else if ($tmp4 === 3) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SConfirmNL")}
           else if ($tmp4 === 5) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SOKNL")}
           else if ($tmp4 === 6) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SCancelNL")}
           else if ($tmp4 === 7) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesNL")}
           else if ($tmp4 === 8) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoNL")}
           else if ($tmp4 === 9) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAbortNL")}
           else if ($tmp4 === 10) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SRetryNL")}
           else if ($tmp4 === 11) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SIgnoreNL")}
           else if ($tmp4 === 12) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SAllNL")}
           else if ($tmp4 === 13) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SYesToAllNL")}
           else if ($tmp4 === 14) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SNoToAllNL")}
           else if ($tmp4 === 15) {
            Result = rtl.getResStr(pas["WEBLib.Consts"],"SHelpNL")}
           else if ($tmp4 === 16) Result = rtl.getResStr(pas["WEBLib.Consts"],"SCloseNL");
        };
      };
      return Result;
    };
    this.BindEvents = function () {
    };
    this.SetDialogResult = function (Value) {
      this.FDialogResult = Value;
      if (this.FDialogResult !== 0) this.Close();
    };
    this.CreateButton = function (Caption, DoFocus, AClass) {
      var Result = null;
      Result = document.createElement("BUTTON");
      Result.innerHTML = Caption;
      if (pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary === 1) {
        Result.setAttribute("type","BUTTON");
        Result.setAttribute("class","btn " + AClass);
        Result.setAttribute("data-dismiss","modal-dialog");
      } else {
        Result.style.setProperty("width","100px");
        Result.style.setProperty("margin-left","5px");
        if (this.FElementButtonClassName !== "") {
          Result.setAttribute("class",this.FElementButtonClassName + " " + AClass)}
         else if (pas["WEBLib.Forms"].Application.FThemeButtonClassName !== "") Result.setAttribute("class",pas["WEBLib.Forms"].Application.FThemeButtonClassName + " " + AClass);
      };
      Result.id = Caption;
      Result.addEventListener("click",rtl.createCallback(this,"HandleButtonClick"));
      Result.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown"));
      if (DoFocus.get()) {
        setTimeout(function() {Result.focus();}, 1);
        DoFocus.set(false);
      };
      return Result;
    };
    this.HandleDocMouseMove = function (Event) {
      var Result = false;
      var deltax = 0.0;
      var deltay = 0.0;
      var el = null;
      if (this.FDown) {
        deltax = Event.screenX - this.FMdx;
        deltay = Event.screenY - this.FMdy;
        el = this.FDlg;
        el.style.setProperty("transform","");
        el.style.setProperty("position","absolute");
        el.style.setProperty("left",pas.SysUtils.IntToStr(Math.round(this.FDlgX + deltax)) + "px");
        el.style.setProperty("top",pas.SysUtils.IntToStr(Math.round(this.FDlgY + deltay)) + "px");
        el = this.FCancel;
        el.style.setProperty("position","absolute");
        el.style.setProperty("top","0");
        el.style.setProperty("right","0");
      };
      Result = true;
      return Result;
    };
    this.HandleDocMouseUp = function (Event) {
      var Result = false;
      this.FDown = false;
      document.body.removeEventListener("mousemove",rtl.createCallback(this,"HandleDocMouseMove"));
      document.body.removeEventListener("mouseup",rtl.createCallback(this,"HandleDocMouseUp"));
      Result = true;
      return Result;
    };
    this.HandleMouseDown = function (Event) {
      var Result = false;
      var r = null;
      this.FMdx = Math.round(Event.screenX);
      this.FMdy = Math.round(Event.screenY);
      r = this.FDlg.getBoundingClientRect();
      this.FDlgX = Math.round(pas.System.Int(r.left));
      this.FDlgY = Math.round(pas.System.Int(r.top));
      this.FDown = true;
      if (!this.FCaptured$1) {
        this.FCaptured$1 = true;
        document.body.addEventListener("mousemove",rtl.createCallback(this,"HandleDocMouseMove"));
        document.body.addEventListener("mouseup",rtl.createCallback(this,"HandleDocMouseUp"));
      };
      Result = true;
      return Result;
    };
    this.HandleButtonClick = function (Event) {
      var Result = false;
      var id = "";
      var i = 0;
      this.SetDialogResult(0);
      id = Event.target.getAttribute("id");
      if (id === this.GetDialogText(7)) {
        this.SetDialogResult(6)}
       else if (id === this.GetDialogText(8)) {
        this.SetDialogResult(7)}
       else if (id === this.GetDialogText(5)) {
        this.SetDialogResult(1)}
       else if (id === this.GetDialogText(6)) {
        this.SetDialogResult(2)}
       else if (id === this.GetDialogText(9)) {
        this.SetDialogResult(3)}
       else if (id === this.GetDialogText(10)) {
        this.SetDialogResult(4)}
       else if (id === this.GetDialogText(11)) {
        this.SetDialogResult(5)}
       else if (id === this.GetDialogText(12)) {
        this.SetDialogResult(12)}
       else if (id === this.GetDialogText(13)) {
        this.SetDialogResult(13)}
       else if (id === this.GetDialogText(14)) {
        this.SetDialogResult(14)}
       else if (id === this.GetDialogText(15)) {
        this.SetDialogResult(9)}
       else if (id === this.GetDialogText(16)) this.SetDialogResult(8);
      if ((this.FDialogResult === 0) && (this.FCustomButtons.GetCount() > 0)) {
        for (var $l = 0, $end = this.FCustomButtons.GetCount() - 1; $l <= $end; $l++) {
          i = $l;
          if (id === this.FCustomButtons.GetItem$1(i).FCaption) {
            this.SetDialogResult(100 + i);
            break;
          };
        };
      };
      if (this.FOnButtonClick != null) this.FOnButtonClick(this);
      Result = true;
      return Result;
    };
    this.HandleKeyDown = function (Event) {
      var Result = false;
      var k = 0;
      k = this.GetKeyCode(Event.key,true);
      if (!pas.System.Assigned(k)) return Result;
      if (k === 27) this.SetDialogResult(2);
      Result = true;
      return Result;
    };
    this.InitBootstrapStyle = function () {
      this.FElementButtonClassName = "btn";
      this.FElementContentClassName = "text-body";
      this.FElementTitleClassName = "text-body";
      this.FElementDialogClassName = "shadow-lg p-3 mb-5 bg-white rounded";
    };
    this.InsertInputElement = function (AElement, DoFocus) {
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      this.FOpacity = 0.2;
      this.FMessage = "";
      this.FAutoLanguage = true;
      this.FMsgDlgType = 2;
      this.FDialogText = pas.Classes.TStringList.$create("Create$1");
      this.FDialogText.SetSkipLastLineBreak(true);
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SWarning"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SError"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SInformation"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SConfirm"));
      this.FDialogText.Add("Custom");
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SOK"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SCancel"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYes"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNo"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAbort"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SRetry"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SIgnore"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SAll"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SYesToAll"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SNoToAll"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SHelp"));
      this.FDialogText.Add(rtl.getResStr(pas["WEBLib.Consts"],"SClose"));
      this.FMsgDlgType = 4;
      this.FCustomButtons = $mod.TCustomDialogButtons.$create("Create$2",[this,$mod.TCustomDialogButton]);
      this.FCustomButtons.FPropName = "CustomButtons";
    };
    this.Destroy = function () {
      rtl.free(this,"FDialogText");
      rtl.free(this,"FCustomButtons");
      pas["WEBLib.Controls"].TCustomControl.Destroy.call(this);
    };
    this.Close = function () {
      pas["WEBLib.Forms"].Application.UnLockForm(pas["WEBLib.Forms"].Application.FMainForm);
      document.body.removeChild(this.FLayer$1);
      document.body.removeChild(this.FDlg);
      this.FDown = false;
      this.FCaptured$1 = false;
      if (this.FOnClose != null) this.FOnClose(this);
      if (this.FDialogProc != null) this.FDialogProc(this.FDialogResult);
    };
    this.Show$1 = function () {
      var title = null;
      var msg = null;
      var icon = null;
      var content = null;
      var contentdiv = null;
      var bar = null;
      var edlg = null;
      var eh = null;
      var cancel = null;
      var adiv = null;
      var ldiv = null;
      var cdiv = null;
      var MsgSymbol = "";
      var MsgColor = "";
      var MsgTitle = "";
      var BorderColor = "";
      var BarBGColor = "";
      var BarHeight = "";
      var Padding = "";
      var btnFocus = false;
      var i = 0;
      if ((pas["WEBLib.Forms"].Application === null) || (pas["WEBLib.Forms"].Application.FMainForm === null)) return;
      if (!pas["WEBLib.Forms"].Application.HasCSS($impl.lMaterial)) this.AddControlLink("material",$impl.lMaterial);
      pas["WEBLib.Forms"].Application.LockForm(pas["WEBLib.Forms"].Application.FMainForm);
      this.FLayer$1 = document.createElement("SPAN");
      document.body.appendChild(this.FLayer$1);
      this.FLayer$1.setAttribute("tabindex","0");
      this.FLayer$1.addEventListener("keydown",rtl.createCallback(this,"HandleKeyDown"));
      btnFocus = true;
      MsgTitle = this.FTitle;
      this.FMessage = $impl.StringToHTML(this.FMessage);
      var $tmp = this.FMsgDlgType;
      if ($tmp === 0) {
        MsgSymbol = "warning";
        MsgColor = "orange";
        MsgTitle = this.GetDialogText(0);
      } else if ($tmp === 1) {
        MsgSymbol = "cancel";
        MsgColor = "red";
        MsgTitle = this.GetDialogText(1);
      } else if ($tmp === 2) {
        MsgSymbol = "info";
        MsgColor = "blue";
        MsgTitle = this.GetDialogText(2);
      } else if ($tmp === 3) {
        MsgSymbol = "help";
        MsgColor = "blue";
        MsgTitle = this.GetDialogText(3);
      } else if ($tmp === 4) {
        MsgSymbol = "";
        MsgColor = "";
        MsgTitle = this.GetDialogText(4);
      };
      if (pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary === 1) {
        this.FDlg = document.createElement("DIV");
        this.FDlg.setAttribute("class","modal-dialog");
        this.FDlg.setAttribute("role","document");
        this.FDlg.style.setProperty("z-index","1999998");
        eh = document.createElement("DIV");
        eh.style.setProperty("top","0");
        eh.style.setProperty("left","0");
        eh.style.setProperty("right","0");
        eh.style.setProperty("bottom","0");
        eh.style.setProperty("z-index","1999997");
        eh.style.setProperty("display","block");
        eh.setAttribute("class","modal show fade");
        document.body.appendChild(eh);
        eh.appendChild(this.FDlg);
        ldiv = this.FDlg;
        adiv = document.createElement("DIV");
        adiv.setAttribute("class","modal-content " + this.FElementDialogClassName);
        ldiv.appendChild(adiv);
        cdiv = adiv;
        ldiv = adiv;
        adiv = document.createElement("DIV");
        adiv.setAttribute("class","modal-header");
        cdiv.appendChild(adiv);
        ldiv = adiv;
        adiv = document.createElement("H5");
        adiv.setAttribute("class","modal-title");
        adiv.innerHTML = MsgTitle;
        ldiv.appendChild(adiv);
        if (3 in this.FButtons) {
          adiv = document.createElement("BUTTON");
          adiv.setAttribute("type","button");
          adiv.setAttribute("class","close btn btn-danger");
          adiv.setAttribute("data-dismiss","modal-dialog");
          adiv.setAttribute("aria-label","Close");
          adiv.setAttribute("id",this.GetDialogText(6));
          adiv.addEventListener("click",rtl.createCallback(this,"HandleButtonClick"));
          ldiv.appendChild(adiv);
          ldiv = adiv;
          adiv = document.createElement("SPAN");
          adiv.setAttribute("aria-hidden","true");
          adiv.setAttribute("id",this.GetDialogText(6));
          adiv.innerHTML = "&times;";
          ldiv.appendChild(adiv);
        };
        adiv = document.createElement("DIV");
        adiv.setAttribute("class","modal-body");
        cdiv.appendChild(adiv);
        ldiv = adiv;
        if (this.FMsgDlgType !== 4) {
          icon = document.createElement("SPAN");
          icon.innerHTML = '<i class="material-icons" style="color:' + MsgColor + '!important;font-size:48px!important">' + MsgSymbol + "</i>";
          icon.style.setProperty("display","inline-block");
          icon.style.setProperty("float","left");
          icon.style.setProperty("padding-right","15px");
          ldiv.appendChild(icon);
        };
        adiv = document.createElement("H6");
        adiv.innerHTML = this.FMessage;
        ldiv.appendChild(adiv);
        this.InsertInputElement(ldiv,{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }});
        adiv = document.createElement("DIV");
        adiv.setAttribute("class","modal-footer");
        cdiv.appendChild(adiv);
        ldiv = adiv;
        bar = ldiv;
        this.FDlg = eh;
      } else {
        Padding = "5";
        BarHeight = "26";
        BarBGColor = "#f1f1f1";
        BorderColor = "#ababab";
        this.FDlg = document.createElement("DIV");
        document.body.appendChild(this.FDlg);
        edlg = this.FDlg;
        if (this.FElementDialogClassName !== "") {
          edlg.setAttribute("class",this.FElementDialogClassName)}
         else {
          edlg.style.setProperty("background-color","white");
          edlg.style.setProperty("border","1px solid " + BorderColor);
          edlg.style.setProperty("font-family","Arial");
          edlg.style.setProperty("font-size","10pt");
        };
        edlg.style.setProperty("cursor","default");
        edlg.style.setProperty("position","fixed");
        edlg.style.setProperty("min-width","300px");
        edlg.style.setProperty("min-height","125px");
        edlg.style.setProperty("max-width","100%");
        edlg.style.setProperty("max-height","100%");
        edlg.style.setProperty("top","50%");
        edlg.style.setProperty("left","50%");
        edlg.style.setProperty("transform","translate(-50%, -50%)");
        edlg.style.setProperty("z-index","1999998");
        edlg.style.setProperty("box-shadow","5px 5px 5px gray");
        cancel = document.createElement("DIV");
        this.FCancel = cancel;
        cancel.innerHTML = '<i id="Cancel" class="material-icons" style="font-size:16px!important">clear</i>';
        cancel.id = "Cancel";
        cancel.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor));
        cancel.style.setProperty("position","fixed");
        cancel.style.setProperty("top","0");
        cancel.style.setProperty("right","0");
        cancel.style.setProperty("padding",Padding + "px");
        cancel.style.setProperty("height",BarHeight + "px");
        cancel.style.setProperty("line-height",BarHeight + "px");
        cancel.addEventListener("click",rtl.createCallback(this,"HandleButtonClick"));
        edlg.appendChild(cancel);
        title = document.createElement("DIV");
        title.innerHTML = MsgTitle;
        if (this.FElementTitleClassName !== "") {
          title.setAttribute("class",this.FElementTitleClassName);
        } else {
          title.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeColor));
          title.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(pas["WEBLib.Forms"].Application.FThemeTextColor));
        };
        title.style.setProperty("cursor","move");
        title.style.setProperty("padding-left",Padding + "px");
        title.style.setProperty("height",BarHeight + "px");
        title.style.setProperty("vertical-align","middle");
        title.style.setProperty("line-height",BarHeight + "px");
        title.style.setProperty("border-bottom","1px solid " + BorderColor);
        title.style.setProperty("-moz-user-select","none");
        title.style.setProperty("-webkit-user-select","none");
        title.style.setProperty("-ms-user-select","none");
        title.style.setProperty("user-select","none");
        title.style.setProperty("-o-user-select","none");
        title.addEventListener("mousedown",rtl.createCallback(this,"HandleMouseDown"));
        edlg.appendChild(title);
        msg = document.createElement("DIV");
        msg.style.setProperty("padding",Padding + "px");
        msg.style.setProperty("height","auto");
        msg.style.setProperty("min-height","50px");
        msg.style.setProperty("border-bottom","1px solid " + BorderColor);
        if (this.FMsgDlgType !== 4) {
          icon = document.createElement("DIV");
          icon.innerHTML = '<i class="material-icons" style="color:' + MsgColor + '!important;font-size:48px!important">' + MsgSymbol + "</i>";
          icon.style.setProperty("display","inline-block");
          icon.style.setProperty("float","left");
          icon.style.setProperty("padding-right","15px");
          msg.appendChild(icon);
        };
        this.FMessage = pas.SysUtils.StringReplace(this.FMessage,pas.System.sLineBreak,"<BR>",rtl.createSet(0));
        contentdiv = document.createElement("DIV");
        contentdiv.innerHTML = this.FMessage;
        contentdiv.style.setProperty("height","auto");
        contentdiv.style.setProperty("min-height","50px");
        contentdiv.style.setProperty("white-space","pre-wrap");
        content = document.createElement("LABEL");
        content.innerHTML = this.FMessage;
        if (this.FElementTitleClassName !== "") {
          content.setAttribute("class",this.FElementContentClassName);
        };
        contentdiv.appendChild(content);
        msg.appendChild(content);
        this.InsertInputElement(msg,{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }});
        edlg.appendChild(msg);
        bar = document.createElement("DIV");
        bar.style.setProperty("background-color",BarBGColor);
        bar.style.setProperty("padding",Padding + "px");
        bar.style.setProperty("min-height",BarHeight + "px");
        bar.style.setProperty("height","auto");
        bar.style.setProperty("line-height",BarHeight + "px");
        bar.style.setProperty("text-align","right");
        edlg.appendChild(bar);
      };
      if (rtl.eqSet(this.FButtons,{}) && (this.FCustomButtons.GetCount() === 0)) {
        bar.appendChild(this.CreateButton(this.GetDialogText(5),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""))}
       else {
        if (0 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(7),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (1 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(8),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (2 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(5),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (3 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(6),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (4 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(9),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (5 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(10),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (6 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(11),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (7 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(12),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (9 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(13),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (8 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(14),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (10 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(15),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
        if (11 in this.FButtons) bar.appendChild(this.CreateButton(this.GetDialogText(16),{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},""));
      };
      for (var $l = 0, $end = this.FCustomButtons.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        bar.appendChild(this.CreateButton(this.FCustomButtons.GetItem$1(i).FCaption,{get: function () {
            return btnFocus;
          }, set: function (v) {
            btnFocus = v;
          }},this.FCustomButtons.GetItem$1(i).FElementClassName));
      };
      eh = this.FLayer$1;
      eh.style.setProperty("background-color","black");
      eh.style.setProperty("opacity",pas["WEBLib.WebTools"].DoubleToHTML(this.FOpacity));
      eh.style.setProperty("top","0");
      eh.style.setProperty("left","0");
      eh.style.setProperty("right","0");
      eh.style.setProperty("bottom","0");
      eh.style.setProperty("z-index","19990");
      eh.style.setProperty("webkit-user-select","none");
      eh.style.setProperty("moz-user-select","none");
      eh.style.setProperty("khtml-user-select","none");
      eh.style.setProperty("ms-user-select","none");
      eh.style.setProperty("user-select","none");
      eh.style.setProperty("position","fixed");
    };
    this.ShowDialog$1 = function (Msg, DlgType, Buttons, AProc) {
      var Result = 0;
      Result = 0;
      this.FButtons = rtl.refSet(Buttons);
      this.FMessage = Msg;
      this.FMsgDlgType = DlgType;
      this.FDialogProc = AProc;
      this.SetDialogResult(0);
      this.Show$1();
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("AutoLanguage",0,rtl.boolean,"FAutoLanguage","FAutoLanguage",{Default: true});
    $r.addProperty("Buttons",0,$mod.$rtti["TMsgDlgButtons"],"FButtons","FButtons",{Default: {}});
    $r.addProperty("CustomButtons",2,$mod.$rtti["TCustomDialogButtons"],"FCustomButtons","SetCustomButtons");
    $r.addProperty("DialogText",2,pas.Classes.$rtti["TStringList"],"FDialogText","SetDialogText");
    $r.addProperty("DialogType",0,$mod.$rtti["TMsgDlgType"],"FMsgDlgType","FMsgDlgType",{Default: $mod.TMsgDlgType.mtCustom});
    $r.addProperty("Message",0,rtl.string,"FMessage","FMessage");
    $r.addProperty("Opacity",0,rtl.double,"FOpacity","FOpacity");
    $r.addProperty("ElementButtonClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementButtonClassName","FElementButtonClassName");
    $r.addProperty("ElementDialogClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementDialogClassName","FElementDialogClassName");
    $r.addProperty("ElementTitleClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementTitleClassName","FElementTitleClassName");
    $r.addProperty("ElementContentClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementContentClassName","FElementContentClassName");
    $r.addProperty("Title",0,rtl.string,"FTitle","FTitle");
    $r.addProperty("OnButtonClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnButtonClick","FOnButtonClick");
    $r.addProperty("OnClose",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClose","FOnClose");
  });
  this.MessageDlg = function (Msg, DlgType, Buttons, AResultProc) {
    if (!($impl.WebLibDlg != null)) {
      $impl.WebLibDlg = $mod.TMessageDlg.$create("Create$1",[null]);
      if (pas["WEBLib.Forms"].Application.FMainForm.FCSSLibrary === 1) {
        $impl.WebLibDlg.InitBootstrapStyle();
      };
    };
    $impl.WebLibDlg.ShowDialog$1(Msg,DlgType,rtl.refSet(Buttons),AResultProc);
  };
  $mod.$implcode = function () {
    $impl.lMaterial = "https://fonts.googleapis.com/icon?family=Material+Icons";
    $impl.WebLibDlg = null;
    $impl.StringToHTML = function (AValue) {
      var Result = "";
      Result = pas.SysUtils.StringReplace(AValue,"\r","<BR>",rtl.createSet(0));
      Result = pas.SysUtils.StringReplace(Result,"\n","",rtl.createSet(0));
      return Result;
    };
  };
  $mod.$init = function () {
    $impl.WebLibDlg = null;
  };
},["WEBLib.Forms","WEBLib.Consts"]);
rtl.module("Math",["System"],function () {
  "use strict";
  var $mod = this;
});
rtl.module("WEBLib.Utils",["System","Types","Web","SysUtils","Math","Classes","JS"],function () {
  "use strict";
  var $mod = this;
  this.FormatProp = function (AFmt, AArgs) {
    var Result = "";
    Result = pas.SysUtils.Format$1(AFmt,AArgs,pas.SysUtils.TFormatSettings.Invariant());
    return Result;
  };
},["RTLConsts","WEBLib.Consts"]);
rtl.module("WEBLib.Controls",["System","Classes","WEBLib.Graphics","Types","SysUtils","Web","JS"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.VK_TAB = 9;
  this.VK_RETURN = 13;
  this.VK_ESCAPE = 27;
  this.WHEEL_DELTA = 120;
  this.$rtti.$inherited("TCursor",rtl.longint,{});
  this.crDefault = 0;
  this.crNone = 1;
  this.crArrow = 2;
  this.crCross = 3;
  this.crIBeam = 4;
  this.crSize = 5;
  this.crSizeNESW = 6;
  this.crSizeNS = 7;
  this.crSizeNWSE = 8;
  this.crSizeWE = 9;
  this.crUpArrow = 10;
  this.crHourGlass = 11;
  this.crDrag = 12;
  this.crNoDrop = 13;
  this.crHSplit = 14;
  this.crVSplit = 15;
  this.crMultIDrag = 16;
  this.crSQLWait = 17;
  this.crNo = 18;
  this.crAppStart = 19;
  this.crHelp = 20;
  this.crHandPoint = 21;
  this.crSizeAll = 22;
  this.CSSBackground = "background-color";
  this.CSSZIndex = "z-index";
  this.$rtti.$Class("TCSSCodeManager");
  this.TDragState = {"0": "dsDragEnter", dsDragEnter: 0, "1": "dsDragLeave", dsDragLeave: 1, "2": "dsDragMove", dsDragMove: 2};
  this.$rtti.$Enum("TDragState",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TDragState});
  this.TDragMode = {"0": "dmManual", dmManual: 0, "1": "dmAutomatic", dmAutomatic: 1};
  this.$rtti.$Enum("TDragMode",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TDragMode});
  this.TDragKind = {"0": "dkDrag", dkDrag: 0, "1": "dkDock", dkDock: 1};
  this.$rtti.$Enum("TDragKind",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TDragKind});
  rtl.createClass(this,"TDragObject",pas.System.TObject,function () {
  });
  this.TAlign = {"0": "alNone", alNone: 0, "1": "alTop", alTop: 1, "2": "alBottom", alBottom: 2, "3": "alLeft", alLeft: 3, "4": "alRight", alRight: 4, "5": "alClient", alClient: 5, "6": "alCustom", alCustom: 6};
  this.$rtti.$Enum("TAlign",{minvalue: 0, maxvalue: 6, ordtype: 1, enumtype: this.TAlign});
  this.TMouseButton = {"0": "mbLeft", mbLeft: 0, "1": "mbRight", mbRight: 1, "2": "mbMiddle", mbMiddle: 2};
  this.$rtti.$Enum("TMouseButton",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TMouseButton});
  this.TBorderStyle = {"0": "bsNone", bsNone: 0, "1": "bsSingle", bsSingle: 1};
  this.$rtti.$Enum("TBorderStyle",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TBorderStyle});
  this.TSizeStyle = {"0": "ssPercent", ssPercent: 0, "1": "ssAbsolute", ssAbsolute: 1, "2": "ssAuto", ssAuto: 2};
  this.$rtti.$Enum("TSizeStyle",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TSizeStyle});
  this.TAnchorKind = {"0": "akLeft", akLeft: 0, "1": "akTop", akTop: 1, "2": "akRight", akRight: 2, "3": "akBottom", akBottom: 3};
  this.$rtti.$Enum("TAnchorKind",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TAnchorKind});
  this.$rtti.$Set("TAnchors",{comptype: this.$rtti["TAnchorKind"]});
  this.$rtti.$inherited("TElementClassName",rtl.string,{});
  this.$rtti.$inherited("TElementID",rtl.string,{});
  this.TElementFont = {"0": "efProperty", efProperty: 0, "1": "efCSS", efCSS: 1};
  this.$rtti.$Enum("TElementFont",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TElementFont});
  this.TElementPosition = {"0": "epAbsolute", epAbsolute: 0, "1": "epRelative", epRelative: 1, "2": "epIgnore", epIgnore: 2};
  this.$rtti.$Enum("TElementPosition",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TElementPosition});
  this.TElementEvent = {"0": "eeClick", eeClick: 0, "1": "eeMouseDown", eeMouseDown: 1, "2": "eeMouseUp", eeMouseUp: 2, "3": "eeMouseMove", eeMouseMove: 3, "4": "eeDblClick", eeDblClick: 4, "5": "eeKeyPress", eeKeyPress: 5, "6": "eeKeyDown", eeKeyDown: 6, "7": "eeKeyUp", eeKeyUp: 7};
  this.TTextDirection = {"0": "tdDefault", tdDefault: 0, "1": "tdLeftToRight", tdLeftToRight: 1, "2": "tdRightToLeft", tdRightToLeft: 2, "3": "tdInherit", tdInherit: 3};
  this.$rtti.$Enum("TTextDirection",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TTextDirection});
  this.TMaterialGlyphType = {"0": "mgNormal", mgNormal: 0, "1": "mgOutlined", mgOutlined: 1, "2": "mgTwoTone", mgTwoTone: 2, "3": "mgRound", mgRound: 3, "4": "mgSharp", mgSharp: 4};
  this.$rtti.$Enum("TMaterialGlyphType",{minvalue: 0, maxvalue: 4, ordtype: 1, enumtype: this.TMaterialGlyphType});
  rtl.recNewT(this,"TJSXMLHttpRequestRecord",function () {
    this.req = null;
    this.$eq = function (b) {
      return this.req === b.req;
    };
    this.$assign = function (s) {
      this.req = s.req;
      return this;
    };
    var $r = $mod.$rtti.$Record("TJSXMLHttpRequestRecord",{});
    $r.addField("req",pas.Web.$rtti["TJSXMLHttpRequest"]);
  });
  rtl.recNewT(this,"TJSEventRecord",function () {
    this.event = null;
    this.$eq = function (b) {
      return this.event === b.event;
    };
    this.$assign = function (s) {
      this.event = s.event;
      return this;
    };
    var $r = $mod.$rtti.$Record("TJSEventRecord",{});
    $r.addField("event",pas.Web.$rtti["TJSEvent"]);
  });
  this.$rtti.$MethodVar("THTTPResponseEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["AResponse",rtl.string]]), methodkind: 0});
  this.$rtti.$MethodVar("THTTPRequestResponseEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["ARequest",this.$rtti["TJSXMLHttpRequestRecord"]],["AResponse",rtl.string]]), methodkind: 0});
  this.$rtti.$MethodVar("THTTPAbortEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]]]), methodkind: 0});
  this.$rtti.$MethodVar("THTTPErrorEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["ARequest",this.$rtti["TJSXMLHttpRequestRecord"]],["Event",this.$rtti["TJSEventRecord"]],["Handled",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TNotifyEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TMouseEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Button",this.$rtti["TMouseButton"]],["Shift",pas.Classes.$rtti["TShiftState"]],["X",rtl.longint],["Y",rtl.longint]]), methodkind: 0});
  this.$rtti.$MethodVar("TMouseWheelEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Shift",pas.Classes.$rtti["TShiftState"]],["WheelDelta",rtl.longint],["MousePos",pas.Types.$rtti["TPoint"]],["Handled",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TMouseMoveEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Shift",pas.Classes.$rtti["TShiftState"]],["X",rtl.longint],["Y",rtl.longint]]), methodkind: 0});
  this.$rtti.$MethodVar("TKeyEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["AKey",rtl.word,1],["Shift",pas.Classes.$rtti["TShiftState"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TKeyPressEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["AChar",rtl.char,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TTouchEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["X",rtl.longint],["Y",rtl.longint]]), methodkind: 0});
  this.TBiDiMode = {"0": "bdLeftToRight", bdLeftToRight: 0, "1": "bdRightToLeft", bdRightToLeft: 1, "2": "bdRightToLeftNoAlign", bdRightToLeftNoAlign: 2, "3": "bdRightToLeftReadingOnly", bdRightToLeftReadingOnly: 3};
  this.$rtti.$Enum("TBiDiMode",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TBiDiMode});
  this.$rtti.$MethodVar("TDragOverEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Source",pas.System.$rtti["TObject"]],["X",rtl.longint],["Y",rtl.longint],["State",this.$rtti["TDragState"]],["Accept",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TDragDropEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Source",pas.System.$rtti["TObject"]],["X",rtl.longint],["Y",rtl.longint]]), methodkind: 0});
  this.$rtti.$MethodVar("TStartDragEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["DragObject",this.$rtti["TDragObject"],1]]), methodkind: 0});
  this.$rtti.$MethodVar("TEndDragEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Target",pas.System.$rtti["TObject"]],["X",rtl.longint],["Y",rtl.longint]]), methodkind: 0});
  this.TControlStyleValue = {"0": "csAcceptsControls", csAcceptsControls: 0, "1": "csSetCaption", csSetCaption: 1};
  rtl.createClass(this,"TMargins",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FOnChange = null;
      this.FLeft = 0;
      this.FTop = 0;
      this.FRight = 0;
      this.FBottom = 0;
    };
    this.$final = function () {
      this.FOnChange = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.SetLeft = function (Value) {
      if (Value !== this.FLeft) {
        this.FLeft = Value;
        this.DoChange();
      };
    };
    this.SetTop = function (Value) {
      if (Value !== this.FTop) {
        this.FTop = Value;
        this.DoChange();
      };
    };
    this.SetRight = function (Value) {
      if (Value !== this.FRight) {
        this.FRight = Value;
        this.DoChange();
      };
    };
    this.SetBottom = function (Value) {
      if (Value !== this.FBottom) {
        this.FBottom = Value;
        this.DoChange();
      };
    };
    this.DoChange = function () {
      if (this.FOnChange != null) this.FOnChange(this);
    };
    this.Create$1 = function () {
      this.FLeft = 3;
      this.FTop = 3;
      this.FBottom = 3;
      this.FRight = 3;
      return this;
    };
    this.Assign = function (Source) {
      if ($mod.TMargins.isPrototypeOf(Source)) {
        this.FLeft = rtl.as(Source,$mod.TMargins).FLeft;
        this.FTop = rtl.as(Source,$mod.TMargins).FTop;
        this.FBottom = rtl.as(Source,$mod.TMargins).FBottom;
        this.FRight = rtl.as(Source,$mod.TMargins).FRight;
      } else pas.Classes.TPersistent.Assign.apply(this,arguments);
    };
    var $r = this.$rtti;
    $r.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default: 3});
    $r.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default: 3});
    $r.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default: 3});
    $r.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default: 3});
  });
  rtl.createClass(this,"TPadding",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FOnChange = null;
      this.FLeft = 0;
      this.FTop = 0;
      this.FRight = 0;
      this.FBottom = 0;
    };
    this.$final = function () {
      this.FOnChange = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.SetLeft = function (Value) {
      if (this.FLeft !== Value) {
        this.FLeft = Value;
        this.DoChange();
      };
    };
    this.SetTop = function (Value) {
      if (this.FTop !== Value) {
        this.FTop = Value;
        this.DoChange();
      };
    };
    this.SetRight = function (Value) {
      if (this.FRight !== Value) {
        this.FRight = Value;
        this.DoChange();
      };
    };
    this.SetBottom = function (Value) {
      if (this.FBottom !== Value) {
        this.FBottom = Value;
        this.DoChange();
      };
    };
    this.DoChange = function () {
      if (this.FOnChange != null) this.FOnChange(this);
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FLeft = 0;
      this.FTop = 0;
      this.FRight = 0;
      this.FBottom = 0;
      return this;
    };
    this.Assign = function (Source) {
      if ($mod.TPadding.isPrototypeOf(Source)) {
        this.FLeft = rtl.as(Source,$mod.TPadding).FLeft;
        this.FRight = rtl.as(Source,$mod.TPadding).FRight;
        this.FTop = rtl.as(Source,$mod.TPadding).FTop;
        this.FBottom = rtl.as(Source,$mod.TPadding).FBottom;
      };
    };
    var $r = this.$rtti;
    $r.addProperty("Left",2,rtl.longint,"FLeft","SetLeft",{Default: 0});
    $r.addProperty("Top",2,rtl.longint,"FTop","SetTop",{Default: 0});
    $r.addProperty("Right",2,rtl.longint,"FRight","SetRight",{Default: 0});
    $r.addProperty("Bottom",2,rtl.longint,"FBottom","SetBottom",{Default: 0});
  });
  rtl.createClass(this,"TControl",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FGotFocus = false;
      this.FAcceptDrag = false;
      this.FCaptureDown = false;
      this.FMouseInsideLayer = false;
      this.FLayer = null;
      this.FCaptured = false;
      this.FControlCreated = false;
      this.FUpdateCount = 0;
      this.FBlockUpdateElement = false;
      this.FElement = null;
      this.FID = "";
      this.FNew = false;
      this.FContainer = null;
      this.FElementEvent = null;
      this.FLastElementEvent = null;
      this.FElementClassName = "";
      this.FFont = null;
      this.FParent = null;
      this.FPrevParent = null;
      this.FControls = [];
      this.FOnDragOver = null;
      this.FOnDragDrop = null;
      this.FOnStartDrag = null;
      this.FonEndDrag = null;
      this.FOnClick = null;
      this.FOnDblClick = null;
      this.FOnMouseDown = null;
      this.FOnMouseUp = null;
      this.FOnMouseMove = null;
      this.FOnKeyDown = null;
      this.FOnKeyUp = null;
      this.FOnKeyPress = null;
      this.FOnEnter = null;
      this.FOnExit = null;
      this.FEnabled = false;
      this.FHint = "";
      this.FRole = "";
      this.FShowHint = false;
      this.FTabOrder = 0;
      this.FTabStop = false;
      this.FVisible = false;
      this.FWidth = 0;
      this.FHeight = 0;
      this.FTag$1 = 0;
      this.FAlign = 0;
      this.FAnchors = {};
      this.FAlignWithMargins = false;
      this.FIsAligning = false;
      this.FOnMouseEnter = null;
      this.FOnMouseLeave = null;
      this.FCursor = 0;
      this.FDoubleBuffered = false;
      this.FControlStyle = {};
      this.FMargins = null;
      this.FOnMouseWheel = null;
      this.FParentDoubleBuffered = false;
      this.FParentColor = false;
      this.FParentFont = false;
      this.FParentBiDiMode = false;
      this.FOnTouchMove = null;
      this.FOnTouchStart = null;
      this.FOnTouchEnd = null;
      this.FOnTouchCancel = null;
      this.FLinkTouchEvents = false;
      this.FWidthStyle = 0;
      this.FHeightStyle = 0;
      this.FWidthPercent = 0.0;
      this.FHeightPercent = 0.0;
      this.FOrigRect = pas.Types.TRect.$new();
      this.FOrigParentRect = pas.Types.TRect.$new();
      this.FIsResizing = false;
      this.FShowFocus = false;
      this.FBorderWidth = 0;
      this.FOrigTop = 0;
      this.FOrigLeft = 0;
      this.FUpdateTopLeft = false;
      this.FEnablePropagation = false;
      this.FParentShowHint = false;
      this.FScriptLoaded = false;
      this.FControlScriptCountLoaded = 0;
      this.FRequiredScripts = null;
      this.FElementFont = 0;
      this.FElementPosition = 0;
      this.FParentElement = null;
      this.FClipChildren = false;
      this.FTextDirection = 0;
      this.FEventStopPropagation = {};
      this.FOnResize = null;
      this.FMouseMovePtr = null;
      this.FMouseDownPtr = null;
      this.FMouseUpPtr = null;
      this.FMouseEnterPtr = null;
      this.FMouseLeavePtr = null;
      this.FClickPtr = null;
      this.FDblClickPtr = null;
      this.FKeyDownPtr = null;
      this.FKeyUpPtr = null;
      this.FKeyPressPtr = null;
      this.FInputPtr = null;
      this.FTouchStartPtr = null;
      this.FTouchEndPtr = null;
      this.FTouchMovePtr = null;
      this.FTouchCancelPtr = null;
      this.FContextMenuPtr = null;
      this.FExitPtr = null;
      this.FEnterPtr = null;
      this.FWheelPtr = null;
      this.FLayerMouseEnterPtr = null;
      this.FLayerMouseLeavePtr = null;
      this.FScriptLoadedPtr = null;
      this.FDragStartPtr = null;
      this.FDragOverPtr = null;
      this.FDragEnterPtr = null;
      this.FDragLeavePtr = null;
      this.FDragEndPtr = null;
      this.FDragDropPtr = null;
      this.FChildOrder = 0;
      this.FAllowTouch = false;
      this.FWheelAccumulator = 0;
      this.FWheelMousePos = pas.Types.TPoint.$new();
      this.FBiDiMode = 0;
      this.FOnMouseWheelDown = null;
      this.FOnMouseWheelUp = null;
      this.FNoUserSelect = false;
      this.FEventsBound = false;
      this.FDragMode = 0;
      this.FToolTip = undefined;
      this.FColor = 0;
    };
    this.$final = function () {
      this.FLayer = undefined;
      this.FElement = undefined;
      this.FContainer = undefined;
      this.FElementEvent = undefined;
      this.FLastElementEvent = undefined;
      this.FFont = undefined;
      this.FParent = undefined;
      this.FPrevParent = undefined;
      this.FControls = undefined;
      this.FOnDragOver = undefined;
      this.FOnDragDrop = undefined;
      this.FOnStartDrag = undefined;
      this.FonEndDrag = undefined;
      this.FOnClick = undefined;
      this.FOnDblClick = undefined;
      this.FOnMouseDown = undefined;
      this.FOnMouseUp = undefined;
      this.FOnMouseMove = undefined;
      this.FOnKeyDown = undefined;
      this.FOnKeyUp = undefined;
      this.FOnKeyPress = undefined;
      this.FOnEnter = undefined;
      this.FOnExit = undefined;
      this.FAnchors = undefined;
      this.FOnMouseEnter = undefined;
      this.FOnMouseLeave = undefined;
      this.FControlStyle = undefined;
      this.FMargins = undefined;
      this.FOnMouseWheel = undefined;
      this.FOnTouchMove = undefined;
      this.FOnTouchStart = undefined;
      this.FOnTouchEnd = undefined;
      this.FOnTouchCancel = undefined;
      this.FOrigRect = undefined;
      this.FOrigParentRect = undefined;
      this.FRequiredScripts = undefined;
      this.FParentElement = undefined;
      this.FEventStopPropagation = undefined;
      this.FOnResize = undefined;
      this.FWheelMousePos = undefined;
      this.FOnMouseWheelDown = undefined;
      this.FOnMouseWheelUp = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.GetControlsCount = function () {
      var Result = 0;
      Result = rtl.length(this.FControls);
      return Result;
    };
    this.GetControls = function (Index) {
      var Result = null;
      Result = this.FControls[Index];
      return Result;
    };
    this.SetVisible = function (AValue) {
      if (this.FVisible !== AValue) {
        this.VisibleChanging();
        this.FVisible = AValue;
        this.UpdateElement();
        this.DoRealign();
        this.AlignControl(this);
        this.VisibleChanged();
      };
    };
    this.SetHint = function (AValue) {
      if (this.FHint !== AValue) {
        this.FHint = AValue;
        this.UpdateElement();
      };
    };
    this.SetShowHint = function (AValue) {
      if (this.FShowHint !== AValue) {
        this.FShowHint = AValue;
        this.UpdateElement();
      };
    };
    this.SetTabOrder = function (AValue) {
      if (this.FTabOrder !== AValue) {
        this.FTabOrder = AValue;
        this.UpdateElement();
      };
    };
    this.SetTabStop = function (AValue) {
      if (this.FTabStop !== AValue) {
        this.FTabStop = AValue;
        this.UpdateElement();
      };
    };
    this.SetAlign = function (Value) {
      if (this.FAlign !== Value) {
        this.FAlign = Value;
        this.DoRealign();
      };
    };
    this.SetAlignWithMargins = function (Value) {
      if (this.FAlignWithMargins !== Value) {
        this.FAlignWithMargins = Value;
        this.DoRealign();
      };
    };
    this.GetBoundsRect = function () {
      var Result = pas.Types.TRect.$new();
      Result.Left = this.GetLeft();
      Result.Top = this.GetTop();
      Result.Right = this.GetLeft() + this.GetWidth();
      Result.Bottom = this.GetTop() + this.GetHeight();
      return Result;
    };
    this.SetID = function (Value) {
      var eh = null;
      var tmp = null;
      var frm = null;
      var p = null;
      var l = 0;
      var t = 0;
      var w = 0;
      var h = 0;
      if (this.FNew && (this.FID !== Value)) {
        eh = document.getElementById(Value);
        if (eh != null) {
          l = this.FLeft;
          t = this.FTop;
          w = this.FWidth;
          h = this.FHeight;
          tmp = null;
          this.UnbindEvents();
          if (this.FContainer != null) {
            this.FParentElement = this.FContainer.parentElement;
            tmp = document.createElement("SPAN");
            this.MoveElements(this.FContainer,tmp);
          };
          p = this.FParent;
          this.SetParent(null);
          this.CreateWithID(Value);
          this.SetParentComponent(p);
          this.FID = Value;
          this.FWidth = w;
          this.FHeight = h;
          this.UpdateElement();
          if (4 in this.FComponentState) {
            this.FLeft = l;
            this.FTop = t;
          };
          if (tmp != null) this.MoveElementsAndFree(tmp,this.GetElementHandle());
          return;
        };
      };
      if (!this.FNew && (this.FID !== Value)) {
        w = this.FWidth;
        h = this.FHeight;
        eh = document.getElementById(this.FID);
        if (eh != null) {
          tmp = document.createElement("SPAN");
          this.MoveElements(eh,tmp);
          this.UnbindEvents();
        };
        if (Value !== "") {
          eh = document.getElementById(Value);
          if (eh != null) {
            this.CreateWithID(Value);
            this.FID = Value;
            this.FWidth = w;
            this.FHeight = h;
            this.UpdateElement();
            this.MoveElementsAndFree(tmp,this.FContainer);
            return;
          };
        };
        this.FNew = true;
        this.FElement = null;
        this.CreateControl();
        if (Value === "") {
          this.CreateInitialize();
          this.FWidth = w;
          this.FHeight = h;
        };
        if (this.FParentElement != null) {
          this.FParentElement.appendChild(this.GetContainer());
        } else document.body.appendChild(this.GetContainer());
        frm = pas["WEBLib.Forms"].GetParentForm(this);
        if (frm != null) {
          this.SetParent(frm);
          this.SetElementPosition(0);
          this.SetLeft(0);
          this.SetTop(0);
        };
        if (tmp != null) this.MoveElementsAndFree(tmp,this.FContainer);
        this.UpdateElement();
        this.UpdateElementSize();
      };
      this.FID = Value;
      if (this.FContainer != null) this.FContainer.setAttribute("id",Value);
    };
    this.SetMargins = function (Value) {
      this.FMargins.Assign(Value);
    };
    this.SetAnchors = function (Value) {
      if (rtl.neSet(this.FAnchors,Value)) {
        this.FAnchors = rtl.refSet(Value);
        if (!(0 in this.FComponentState)) {
          this.UpdateAnchoring();
        };
      };
    };
    this.GetElementEvent = function () {
      var Result = null;
      Result = this.FElementEvent;
      return Result;
    };
    this.SetHeightStyle = function (Value) {
      if (this.FHeightStyle !== Value) {
        this.FHeightStyle = Value;
        if ((this.FHeightStyle === 2) && (this.GetElementHandle() != null)) this.GetElementStyle().removeProperty("height");
        this.UpdateElementSize();
        this.ResetAnchoring();
        this.DoBoundsChange();
      };
    };
    this.SetWidthStyle = function (Value) {
      if (this.FWidthStyle !== Value) {
        this.FWidthStyle = Value;
        if ((this.FWidthStyle === 2) && (this.GetElementHandle() != null)) this.GetElementStyle().removeProperty("width");
        this.UpdateElementSize();
        this.ResetAnchoring();
        this.DoBoundsChange();
      };
    };
    this.SetHeightPercent = function (Value) {
      if (this.FHeightPercent !== Value) {
        this.FHeightPercent = Value;
        this.UpdateElementSize();
        this.ResetAnchoring();
        this.DoBoundsChange();
      };
    };
    this.SetWidthPercent = function (Value) {
      if (this.FWidthPercent !== Value) {
        this.FWidthPercent = Value;
        this.UpdateElementSize();
        this.ResetAnchoring();
        this.DoBoundsChange();
      };
    };
    this.SetShowFocus = function (Value) {
      if (this.FShowFocus !== Value) {
        this.FShowFocus = Value;
        this.UpdateElement();
      };
    };
    this.GetIsLinked = function () {
      var Result = false;
      Result = !this.FNew;
      return Result;
    };
    this.SetElementFont = function (Value) {
      if (this.FElementFont !== Value) {
        this.FElementFont = Value;
        this.UpdateElementVisual();
      };
    };
    this.SetElementPosition = function (Value) {
      if (this.FElementPosition !== Value) {
        this.FElementPosition = Value;
        if (this.GetElementHandle() != null) {
          this.UpdateElementSize();
          this.RecreateCanvas();
          this.InternalResize();
        };
      };
    };
    this.SetClipChildren = function (Value) {
      this.FClipChildren = Value;
      this.UpdateElement();
    };
    this.SetChildOrderEx = function (Value) {
      this.FChildOrder = Value;
    };
    this.GetRole = function () {
      var Result = "";
      Result = this.FRole;
      if (this.GetElementHandle() != null) Result = this.GetElementHandle().getAttribute("role");
      return Result;
    };
    this.SetRole = function (Value) {
      this.FRole = Value;
      if (this.GetElementHandle() != null) {
        if (Value === "") {
          this.GetElementHandle().removeAttribute("role")}
         else this.GetElementHandle().setAttribute("role",Value);
      };
    };
    this.GetContainer = function () {
      var Result = null;
      Result = this.FContainer;
      return Result;
    };
    this.GetChildContainer = function () {
      var Result = null;
      Result = this.FContainer;
      return Result;
    };
    this.SetParentFont = function (Value) {
      if ((Value !== this.FParentFont) && Value && (this.FParent != null)) {
        this.BeginUpdate();
        this.FFont.Assign(this.FParent.FFont);
        this.EndUpdate();
        this.UpdateElement();
      };
      this.FParentFont = Value;
    };
    this.SetParentColor = function (Value) {
      if ((this.FParentColor !== Value) && Value && (this.FParent != null)) {
        this.SetColor(this.FParent.FColor);
      };
      this.FParentColor = Value;
    };
    this.SetDragMode = function (Value) {
      this.FDragMode = Value;
      if (Value === 1) {
        this.BeginDrag()}
       else this.DisableDrag();
    };
    this.SetWidth = function (AValue) {
      if (this.FWidth !== AValue) {
        this.FWidth = AValue;
        this.ResetAnchoring();
        this.DoBoundsChange();
        if (this.GetIsLinked() && !this.IsUpdating() && (this.GetElementHandle() != null)) {
          if (AValue >= 0) {
            this.GetElementStyle().setProperty("width",pas.SysUtils.IntToStr(AValue) + "px")}
           else this.GetElementStyle().removeProperty("width");
        };
      };
    };
    this.SetHeight = function (AValue) {
      var dr = null;
      if (this.FHeight !== AValue) {
        if ((this.FAlign in rtl.createSet(3,4,5)) && (this.GetElementHandle() != null)) {
          dr = this.GetElementHandle().getBoundingClientRect();
          if ((dr.top + AValue) >= pas["WEBLib.Forms"].WinHeight()) {
            AValue = Math.round(pas["WEBLib.Forms"].WinHeight() - dr.top);
          };
        };
        this.FHeight = AValue;
        this.ResetAnchoring();
        this.DoBoundsChange();
        if (this.GetIsLinked() && !this.IsUpdating() && (this.GetElementHandle() != null)) {
          if (AValue >= 0) {
            this.GetElementStyle().setProperty("height",pas.SysUtils.IntToStr(AValue) + "px")}
           else this.GetElementStyle().removeProperty("height");
        };
      };
    };
    this.SetWidthInt = function (AValue) {
      this.FWidth = AValue;
    };
    this.SetHeightInt = function (AValue) {
      this.FHeight = AValue;
    };
    this.SetEnabled = function (Value) {
      if (this.FEnabled !== Value) {
        this.FEnabled = Value;
        this.UpdateElementData();
      };
    };
    this.RecreateCanvas = function () {
    };
    this.VisibleChanging = function () {
    };
    this.VisibleChanged = function () {
      var i = 0;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.GetControls(i).VisibleChanged();
      };
    };
    this.ColorChanging = function () {
    };
    this.GetWidth = function () {
      var Result = 0;
      var cr = null;
      Result = this.FWidth;
      if ((this.GetElementHandle() != null) && !(0 in this.FComponentState)) {
        if (Result === -1) {
          Result = Math.round(pas.System.Int(this.GetElementHandle().offsetWidth));
        };
        if (this.FWidthStyle !== 1) {
          cr = this.GetElementHandle().getBoundingClientRect();
          Result = Math.round(pas.System.Int(cr.right - cr.left));
        };
      };
      return Result;
    };
    this.GetHeight = function () {
      var Result = 0;
      var cr = null;
      Result = this.FHeight;
      if ((this.GetElementHandle() != null) && !(0 in this.FComponentState)) {
        if (Result === -1) {
          Result = Math.round(pas.System.Int(this.GetElementHandle().offsetHeight));
        };
        if (this.FHeightStyle !== 1) {
          cr = this.GetElementHandle().getBoundingClientRect();
          Result = Math.round(pas.System.Int(cr.bottom - cr.top));
        };
      };
      return Result;
    };
    this.GetOuterWidth = function () {
      var Result = 0;
      Result = this.FWidth - this.FBorderWidth;
      return Result;
    };
    this.GetOuterHeight = function () {
      var Result = 0;
      Result = this.FHeight - this.FBorderWidth;
      return Result;
    };
    this.GetDesignWidth = function () {
      var Result = 0;
      Result = this.FWidth;
      return Result;
    };
    this.GetDesignHeight = function () {
      var Result = 0;
      Result = this.FHeight;
      return Result;
    };
    this.GetDesignLeft = function () {
      var Result = 0;
      Result = this.FLeft;
      return Result;
    };
    this.GetDesignTop = function () {
      var Result = 0;
      Result = this.FTop;
      return Result;
    };
    this.GetLeft = function () {
      var Result = 0;
      Result = this.FLeft;
      if ((Result === -1) && (this.GetElementHandle() != null) && !(0 in this.FComponentState)) Result = Math.round(this.GetElementHandle().offsetLeft);
      return Result;
    };
    this.GetTop = function () {
      var Result = 0;
      Result = this.FTop;
      if ((Result === -1) && (this.GetElementHandle() != null) && !(0 in this.FComponentState)) Result = Math.round(this.GetElementHandle().offsetTop);
      return Result;
    };
    this.CreateElement = function () {
      var Result = null;
      Result = null;
      return Result;
    };
    this.CreateChildElements = function (AContainer) {
    };
    this.ContainerElement = function () {
      var Result = null;
      Result = document.body;
      return Result;
    };
    this.IsStructuralElement = function () {
      var Result = false;
      Result = false;
      return Result;
    };
    this.IsEnabled = function () {
      var Result = false;
      Result = this.FEnabled;
      return Result;
    };
    this.GetNewName = function () {
      var Result = "";
      var s = "";
      var lPrefix = "";
      var frm = null;
      s = this.$classname;
      pas.System.Delete({get: function () {
          return s;
        }, set: function (v) {
          s = v;
        }},1,1);
      lPrefix = "";
      frm = pas["WEBLib.Forms"].GetParentForm(this);
      if (frm != null) lPrefix = frm.$classname;
      Result = lPrefix + "_" + $mod.FindUniqueName(s);
      return Result;
    };
    this.IsInputControl = function () {
      var Result = false;
      Result = false;
      return Result;
    };
    this.UseCSSFont = function () {
      var Result = false;
      Result = !((this.FElementClassName === "") && (this.FElementFont === 0) && !this.GetIsLinked());
      return Result;
    };
    this.UseCSSFontColor = function () {
      var Result = false;
      Result = !(pas["WEBLib.Forms"].Application.FThemed && (pas["WEBLib.Graphics"].ColorToRGB(this.FFont.FColor) === pas["WEBLib.Graphics"].RGB(0,0,0)));
      return Result;
    };
    this.BindElement = function () {
    };
    this.CreateInitialize = function () {
      this.FRequiredScripts = pas.Classes.TStringList.$create("Create$1");
      this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1));
      this.FClipChildren = true;
    };
    this.DestroyControls = function () {
      var i = 0;
      var ctrl = null;
      for (var $l = this.GetControlsCount() - 1; $l >= 0; $l--) {
        i = $l;
        ctrl = this.GetControls(i);
        ctrl = rtl.freeLoc(ctrl);
      };
    };
    this.ClearControls = function () {
      this.FControls = rtl.arraySetLength(this.FControls,null,0);
    };
    this.GetElementStyle = function () {
      var Result = null;
      Result = this.GetElementHandle().style;
      return Result;
    };
    this.SetControlCursor = function (Value) {
      this.FCursor = Value;
      if ((this.FElementClassName === "") && (this.GetElementHandle() != null)) {
        this.SetElementPointer(this.GetElementHandle(),Value);
      };
    };
    this.SetBiDiMode = function (Value) {
      if (this.GetElementHandle() != null) {
        if (Value === 0) {
          this.GetElementHandle().removeAttribute("dir")}
         else this.GetElementHandle().setAttribute("dir","rtl");
      };
    };
    this.GetMouseEventButton = function (Event) {
      var Result = 0;
      Result = 0;
      var $tmp = Event.button;
      if ($tmp === 0) {
        Result = 0}
       else if ($tmp === 1) {
        Result = 2}
       else if ($tmp === 2) Result = 1;
      return Result;
    };
    this.GetMouseEventShiftState = function (Event) {
      var Result = {};
      Result = {};
      if (Event.shiftKey) Result = rtl.unionSet(Result,rtl.createSet(0));
      if (Event.ctrlKey) Result = rtl.unionSet(Result,rtl.createSet(2));
      if (Event.altKey) Result = rtl.unionSet(Result,rtl.createSet(1));
      if ((Event.buttons & 1) === 1) Result = rtl.unionSet(Result,rtl.createSet(3));
      if ((Event.buttons & 2) === 2) Result = rtl.unionSet(Result,rtl.createSet(4));
      if ((Event.buttons & 4) === 4) Result = rtl.unionSet(Result,rtl.createSet(5));
      return Result;
    };
    this.GetKeyBoardEventShiftState = function (Event) {
      var Result = {};
      Result = {};
      if (Event.shiftKey) Result = rtl.unionSet(Result,rtl.createSet(0));
      if (Event.ctrlKey) Result = rtl.unionSet(Result,rtl.createSet(2));
      if (Event.altKey) Result = rtl.unionSet(Result,rtl.createSet(1));
      return Result;
    };
    this.GetMouseWheelEventShiftState = function (Event) {
      var Result = {};
      Result = {};
      if (Event.shiftKey) Result = rtl.unionSet(Result,rtl.createSet(0));
      if (Event.ctrlKey) Result = rtl.unionSet(Result,rtl.createSet(2));
      if (Event.altKey) Result = rtl.unionSet(Result,rtl.createSet(1));
      return Result;
    };
    this.GetTouchEventShiftState = function (Event) {
      var Result = {};
      Result = {};
      if (Event.shiftKey) Result = rtl.unionSet(Result,rtl.createSet(0));
      if (Event.ctrlKey) Result = rtl.unionSet(Result,rtl.createSet(2));
      if (Event.altKey) Result = rtl.unionSet(Result,rtl.createSet(1));
      return Result;
    };
    this.HandleDoClick = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      if (0 in this.FEventStopPropagation) this.StopPropagation();
      if (this.FEnabled) this.Click();
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoWheel = function (Event) {
      var Result = false;
      var ss = {};
      var h = false;
      var l = 0.0;
      var t = 0.0;
      this.FElementEvent = Event;
      this.StopPropagation();
      this.XYToClient(Event.clientX,Event.clientY,{get: function () {
          return l;
        }, set: function (v) {
          l = v;
        }},{get: function () {
          return t;
        }, set: function (v) {
          t = v;
        }});
      this.FWheelMousePos.x = Math.round(l);
      this.FWheelMousePos.y = Math.round(t);
      ss = rtl.refSet(this.GetMouseWheelEventShiftState(Event));
      h = false;
      this.MouseWheel(rtl.refSet(ss),pas.System.Trunc(-Event.deltaY),{get: function () {
          return h;
        }, set: function (v) {
          h = v;
        }});
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoDblClick = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      if (4 in this.FEventStopPropagation) this.StopPropagation();
      if (this.FEnabled) this.DblClick();
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoMouseDown = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var ss = {};
      var mb = 0;
      this.FElementEvent = Event;
      if (1 in this.FEventStopPropagation) this.StopPropagation();
      if (!this.CanFocus()) this.PreventDefault();
      $impl.FMouseX = Math.round(Event.clientX);
      $impl.FMouseY = Math.round(Event.clientY);
      this.XYToClient(Event.clientX,Event.clientY,{get: function () {
          return l;
        }, set: function (v) {
          l = v;
        }},{get: function () {
          return t;
        }, set: function (v) {
          t = v;
        }});
      if (this.HasVertScrollBar() && (l > (this.GetWidth() - $mod.GetScrollBarWidth()))) return Result;
      if (this.HasHorzScrollBar() && (t > (this.GetHeight() - $mod.GetScrollBarHeight()))) return Result;
      ss = rtl.refSet(this.GetMouseEventShiftState(Event));
      mb = this.GetMouseEventButton(Event);
      this.MouseDown(mb,rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoMouseUp = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var ss = {};
      var mb = 0;
      this.FElementEvent = Event;
      if (2 in this.FEventStopPropagation) this.StopPropagation();
      this.XYToClient(Event.clientX,Event.clientY,{get: function () {
          return l;
        }, set: function (v) {
          l = v;
        }},{get: function () {
          return t;
        }, set: function (v) {
          t = v;
        }});
      if (this.HasVertScrollBar() && (l > (this.GetWidth() - $mod.GetScrollBarWidth()))) {
        this.FElementEvent = null;
        return Result;
      };
      if (this.HasHorzScrollBar() && (t > (this.GetHeight() - $mod.GetScrollBarHeight()))) {
        this.FElementEvent = null;
        return Result;
      };
      ss = rtl.refSet(this.GetMouseEventShiftState(Event));
      mb = this.GetMouseEventButton(Event);
      if (this.FDragMode === 0) this.DisableDrag();
      this.MouseUp(mb,rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoMouseMove = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var ss = {};
      this.FElementEvent = Event;
      $impl.FCursorX = Math.round(Event.clientX);
      $impl.FCursorY = Math.round(Event.clientY);
      if (3 in this.FEventStopPropagation) this.StopPropagation();
      this.XYToClient(Event.clientX,Event.clientY,{get: function () {
          return l;
        }, set: function (v) {
          l = v;
        }},{get: function () {
          return t;
        }, set: function (v) {
          t = v;
        }});
      ss = rtl.refSet(this.GetMouseEventShiftState(Event));
      this.MouseMove(rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoMouseLeave = function (Event) {
      var Result = false;
      if (this.Captured()) return Result;
      Event.stopPropagation();
      this.DoMouseLeave();
      Result = true;
      return Result;
    };
    this.HandleDoContextMenu = function (Event) {
      var Result = false;
      Result = true;
      return Result;
    };
    this.LayerHandleDoMouseEnter = function (Event) {
      var Result = false;
      if ((Event.buttons === 0) && this.Captured() && !this.FMouseInsideLayer) {
        this.ReleaseCapture();
        this.HandleDoMouseUp(Event);
        this.HandleDoMouseLeave(Event);
      };
      this.FMouseInsideLayer = true;
      Result = true;
      return Result;
    };
    this.LayerHandleDoMouseLeave = function (Event) {
      var Result = false;
      this.FMouseInsideLayer = false;
      Result = true;
      return Result;
    };
    this.HandleDoMouseEnter = function (Event) {
      var Result = false;
      if (this.Captured()) return Result;
      Event.stopPropagation();
      this.DoMouseEnter();
      Result = true;
      return Result;
    };
    this.HandleDoKeyDown = function (Event) {
      var Result = false;
      var k = 0;
      var ss = {};
      var undef = false;
      this.FElementEvent = Event;
      if (6 in this.FEventStopPropagation) this.StopPropagation();
      undef = (Event.key == undefined);
      if (!undef) {
        k = this.GetKeyCode(Event.key,true);
        ss = rtl.refSet(this.GetKeyBoardEventShiftState(Event));
        this.KeyDown({get: function () {
            return k;
          }, set: function (v) {
            k = v;
          }},rtl.refSet(ss));
        if (k in rtl.createSet(13,27,9)) {
          this.KeyPreview({get: function () {
              return k;
            }, set: function (v) {
              k = v;
            }},rtl.refSet(ss));
        };
      };
      Result = true;
      if (k === 0) this.PreventDefault();
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoKeyUp = function (Event) {
      var Result = false;
      var k = 0;
      var ss = {};
      var c = "";
      var undef = false;
      this.FElementEvent = Event;
      if (7 in this.FEventStopPropagation) this.StopPropagation();
      undef = (Event.key == undefined);
      if (!undef) {
        k = this.GetKeyCode(Event.key,true);
        ss = rtl.refSet(this.GetKeyBoardEventShiftState(Event));
        if (k === 27) {
          c = "\x1B";
          this.KeyPress({get: function () {
              return c;
            }, set: function (v) {
              c = v;
            }});
        };
        this.KeyUp({get: function () {
            return k;
          }, set: function (v) {
            k = v;
          }},rtl.refSet(ss));
      };
      Result = true;
      if (k === 0) this.PreventDefault();
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoKeyPress = function (Event) {
      var Result = false;
      var c = "";
      this.FElementEvent = Event;
      if (5 in this.FEventStopPropagation) this.StopPropagation();
      if (this.IsKeyCharacter(Event.key)) {
        c = this.GetKeyChar(Event.key);
        this.KeyPress({get: function () {
            return c;
          }, set: function (v) {
            c = v;
          }});
      };
      Result = true;
      if (c === "\x00") this.PreventDefault();
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoInput = function (Event) {
      var Result = false;
      var c = "";
      var stemp = "";
      if ($mod.IsAndroid()) {
        this.FElementEvent = Event;
        if (5 in this.FEventStopPropagation) this.StopPropagation();
        c = "\x00";
        if (Event.data !== "") {
          stemp = Event.data;
          if (pas.System.Assigned(stemp)) {
            c = stemp.charAt(stemp.length - 1)}
           else c = "\b";
          this.KeyPress({get: function () {
              return c;
            }, set: function (v) {
              c = v;
            }});
        };
        Result = true;
        if (c === "\x00") this.PreventDefault();
        this.FElementEvent = null;
      };
      return Result;
    };
    this.HandleDoExit = function (Event) {
      var Result = false;
      this.DoExit();
      Result = true;
      return Result;
    };
    this.HandleDoEnter = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      this.StopPropagation();
      this.DoEnter();
      Result = true;
      this.FElementEvent = null;
      this.FGotFocus = true;
      return Result;
    };
    this.HandleDoTouchStart = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var touch = null;
      var ss = {};
      this.FElementEvent = Event;
      this.FLastElementEvent = Event;
      this.StopPropagation();
      if (!this.FAllowTouch) this.PreventDefault();
      if (Event.touches.length > 0) {
        touch = Event.touches.item(0);
        this.XYToClient(touch.clientX,touch.clientY,{get: function () {
            return l;
          }, set: function (v) {
            l = v;
          }},{get: function () {
            return t;
          }, set: function (v) {
            t = v;
          }});
        ss = rtl.refSet(this.GetTouchEventShiftState(Event));
        if (this.FLinkTouchEvents) {
          this.MouseDown(0,rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
        };
        this.TouchStart(pas.System.Trunc(l),pas.System.Trunc(t));
      };
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoTouchMove = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var touch = null;
      var ss = {};
      this.FElementEvent = Event;
      this.FLastElementEvent = Event;
      this.StopPropagation();
      if (!this.FAllowTouch) this.PreventDefault();
      if (this.Captured()) this.PreventDefault();
      if (Event.touches.length > 0) {
        touch = Event.touches.item(0);
        this.XYToClient(touch.clientX,touch.clientY,{get: function () {
            return l;
          }, set: function (v) {
            l = v;
          }},{get: function () {
            return t;
          }, set: function (v) {
            t = v;
          }});
        ss = rtl.refSet(this.GetTouchEventShiftState(Event));
        if (this.FLinkTouchEvents) this.MouseMove(rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
        this.TouchMove(pas.System.Trunc(l),pas.System.Trunc(t));
      };
      this.FElementEvent = null;
      Result = true;
      return Result;
    };
    this.HandleDoTouchEnd = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var touch = null;
      var ss = {};
      this.FElementEvent = Event;
      if (!this.FAllowTouch) this.PreventDefault();
      this.ReleaseCapture();
      this.StopPropagation();
      if ((this.FLastElementEvent != null) && (this.FLastElementEvent.touches.length > 0)) {
        touch = this.FLastElementEvent.touches.item(0);
        this.XYToClient(touch.clientX,touch.clientY,{get: function () {
            return l;
          }, set: function (v) {
            l = v;
          }},{get: function () {
            return t;
          }, set: function (v) {
            t = v;
          }});
        ss = rtl.refSet(this.GetTouchEventShiftState(Event));
        if (this.FLinkTouchEvents) {
          this.MouseUp(0,rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
        };
        this.TouchEnd(pas.System.Trunc(l),pas.System.Trunc(t));
      };
      this.FElementEvent = null;
      Result = true;
      return Result;
    };
    this.HandleDoTouchCancel = function (Event) {
      var Result = false;
      var l = 0.0;
      var t = 0.0;
      var touch = null;
      var ss = {};
      this.FElementEvent = Event;
      this.ReleaseCapture();
      this.StopPropagation();
      if (Event.touches.length > 0) {
        touch = Event.touches.item(0);
        this.XYToClient(touch.clientX,touch.clientY,{get: function () {
            return l;
          }, set: function (v) {
            l = v;
          }},{get: function () {
            return t;
          }, set: function (v) {
            t = v;
          }});
        ss = rtl.refSet(this.GetTouchEventShiftState(Event));
        if (this.FLinkTouchEvents) {
          this.MouseUp(0,rtl.refSet(ss),pas.System.Trunc(l),pas.System.Trunc(t));
        };
        this.TouchCancel(pas.System.Trunc(l),pas.System.Trunc(t));
      };
      this.FElementEvent = null;
      Result = true;
      return Result;
    };
    this.HandleDoDragStart = function (Event) {
      var Result = false;
      var obj = null;
      this.FElementEvent = Event;
      Event.stopPropagation();
      obj = null;
      this.DoStartDrag({get: function () {
          return obj;
        }, set: function (v) {
          obj = v;
        }});
      if (obj != null) {
        $impl.DragObject = obj}
       else $impl.DragObject = this;
      Result = true;
      return Result;
    };
    this.HandleDoDragOver = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      Event.stopPropagation();
      this.DragOver($impl.DragObject,Event.clientX,Event.clientY,2,{p: this, get: function () {
          return this.p.FAcceptDrag;
        }, set: function (v) {
          this.p.FAcceptDrag = v;
        }});
      if (this.FAcceptDrag && (!this.IsInputControl() || (Event.dataTransfer.items.length === 0))) Event.preventDefault();
      Result = !this.FAcceptDrag;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoDragEnter = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      Event.stopPropagation();
      this.FAcceptDrag = this.IsInputControl();
      this.DragOver($impl.DragObject,Event.clientX,Event.clientY,0,{p: this, get: function () {
          return this.p.FAcceptDrag;
        }, set: function (v) {
          this.p.FAcceptDrag = v;
        }});
      if (this.FAcceptDrag) Event.preventDefault();
      Result = !this.FAcceptDrag;
      this.FElementEvent = null;
      return Result;
    };
    this.HandledoDragLeave = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      Event.stopPropagation();
      this.DragOver($impl.DragObject,Event.clientX,Event.clientY,1,{p: this, get: function () {
          return this.p.FAcceptDrag;
        }, set: function (v) {
          this.p.FAcceptDrag = v;
        }});
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoDragEnd = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      Event.stopPropagation();
      this.DoEndDrag($impl.DragObject,Event.clientX,Event.clientY);
      Result = true;
      if (this.FDragMode === 0) this.DisableDrag();
      this.FElementEvent = null;
      return Result;
    };
    this.HandleDoDragDrop = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      Event.stopPropagation();
      if (!this.FAcceptDrag) {
        Event.preventDefault()}
       else {
        if (!this.IsInputControl()) Event.preventDefault();
        this.DragDrop($impl.DragObject,Event.clientX,Event.clientY);
      };
      Result = this.FAcceptDrag;
      this.FElementEvent = null;
      return Result;
    };
    this.HandleKeyPreview = function (Key) {
    };
    this.HandleFontChanged = function (Sender) {
      if (this.FUpdateCount === 0) {
        this.SetParentFont(false);
        this.ParentFontChanged();
      };
      this.FontChanged();
    };
    this.ParentFontChanged = function () {
      var i = 0;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (this.GetControls(i).FParentFont) {
          this.GetControls(i).FFont.Assign(this.FFont);
          this.GetControls(i).FontChanged();
          this.GetControls(i).FParentFont = true;
          this.GetControls(i).ParentFontChanged();
        };
      };
    };
    this.DoExit = function () {
      if (this.FOnExit != null) this.FOnExit(this);
    };
    this.DoEnter = function () {
      if (this.FOnEnter != null) this.FOnEnter(this);
    };
    this.Click = function () {
      if ((this.FOnClick != null) && this.IsEnabled()) this.FOnClick(this);
    };
    this.UpdateElement = function () {
      if (this.FBlockUpdateElement || (this.FUpdateCount > 0)) return;
      if ((this.GetElementHandle() != null) && (this.GetElementHandle() !== this.ContainerElement()) && !this.IsUpdating()) {
        this.UpdateElementData();
        if (!this.GetIsLinked()) {
          this.UpdateElementVisual();
        };
      };
    };
    this.UpdateElementSize = function () {
      var es = null;
      var offsLeft = 0;
      var offsTop = 0;
      var ow = 0;
      var ctrl = null;
      var cr = null;
      if (this.FBlockUpdateElement || (this.FUpdateCount > 0)) return;
      if (this.GetIsLinked()) return;
      if ((this.GetElementHandle() != null) && (this.GetElementHandle() !== this.ContainerElement())) {
        es = this.GetElementStyle();
        offsLeft = 0;
        offsTop = 0;
        ctrl = this.FParent;
        while ((ctrl != null) && (this.FElementPosition === 0) && (ctrl.FElementPosition !== 0) && !pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(ctrl)) {
          if (ctrl.GetIsLinked() && (ctrl.GetElementHandle() != null) && (ctrl.GetElementHandle().getAttribute("position") !== "absolute")) {
            cr = ctrl.GetElementHandle().getBoundingClientRect();
            offsLeft = Math.round(cr.left);
            offsTop = Math.round(cr.top);
            break;
          };
          ctrl = ctrl.FParent;
        };
        if ((this.FParent != null) && this.FParent.IsStructuralElement()) {
          offsLeft = this.FParent.GetLeft();
          offsTop = this.FParent.GetTop();
        };
        if (this.FElementPosition === 0) {
          if (this.FTop !== -1) {
            es.setProperty("top",pas.SysUtils.IntToStr(this.FTop + offsTop) + "px")}
           else es.setProperty("top","");
          if (this.FLeft !== -1) {
            es.setProperty("left",pas.SysUtils.IntToStr(this.FLeft + offsLeft) + "px")}
           else es.setProperty("left","");
        } else {
          es.removeProperty("top");
          es.removeProperty("left");
        };
        if (this.FWidthStyle === 1) {
          ow = this.GetOuterWidth();
          if (this.FWidth !== -1) {
            es.setProperty("width",pas.SysUtils.IntToStr(ow) + "px")}
           else es.removeProperty("width");
        };
        if (this.FWidthStyle === 2) {
          es.removeProperty("width");
        };
        if (this.FHeightStyle === 1) {
          if (this.FHeight !== -1) {
            es.setProperty("height",pas.SysUtils.IntToStr(this.GetOuterHeight()) + "px")}
           else es.removeProperty("height");
        };
        if (this.FHeightStyle === 2) {
          es.removeProperty("height");
        };
        if (this.FWidthStyle === 0) {
          if (this.FWidth !== -1) {
            es.setProperty("width",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FWidthPercent)))}
           else es.removeProperty("width");
        };
        if (this.FHeightStyle === 0) {
          if (this.FHeight !== -1) {
            es.setProperty("height",pas["WEBLib.Utils"].FormatProp("%.2f%%",pas.System.VarRecs(3,this.FHeightPercent)))}
           else es.removeProperty("height");
        };
        if (this.FElementPosition === 0) {
          es.setProperty("position","absolute")}
         else if (this.FElementPosition === 1) {
          es.setProperty("position","relative")}
         else es.removeProperty("position");
        es.setProperty("box-sizing","border-box");
      };
    };
    this.UpdateElementVisual = function () {
      var eh = null;
      var es = null;
      var useCSS = false;
      eh = this.GetElementHandle();
      if (!(eh != null)) return;
      if (this.IsUpdating()) return;
      es = this.GetElementStyle();
      if (this.FParentFont && (this.FParent != null)) {
        this.FFont.FOnChange = null;
        this.FFont.Assign(this.FParent.FFont);
        this.FFont.FOnChange = rtl.createCallback(this,"HandleFontChanged");
      };
      if (this.FElementClassName === "") {
        if (!this.GetIsLinked()) {
          if (this.FClipChildren && (pas.SysUtils.LowerCase(eh.tagName) !== pas["WEBLib.WebTools"].cBodyTag)) {
            es.setProperty("overflow","hidden")}
           else es.setProperty("overflow","");
        };
        this.SetElementPointer(eh,this.FCursor);
      };
      if (this.Captured()) this.FLayer.style.setProperty("cursor",es.getPropertyValue("cursor"));
      if ((this.FElementClassName !== "") || this.CanShowFocus()) {
        es.setProperty("outline","")}
       else es.setProperty("outline","none");
      this.UpdateElementSize();
      var $tmp = this.FTextDirection;
      if ($tmp === 0) {
        es.removeProperty("direction")}
       else if ($tmp === 2) {
        es.setProperty("direction","rtl")}
       else if ($tmp === 1) {
        es.setProperty("direction","ltr")}
       else if ($tmp === 3) es.setProperty("direction","inherit");
      if ((this.FElementClassName === "") && this.FNoUserSelect) {
        es.setProperty("webkit-user-select","none");
        es.setProperty("moz-user-select","none");
        es.setProperty("khtml-user-select","none");
        es.setProperty("ms-user-select","none");
        es.setProperty("user-select","none");
        es.setProperty("-webkit-tap-highlight-color","transparent");
      };
      this.SetElementColor(eh,this.FColor);
      useCSS = this.UseCSSFont();
      $mod.SetHTMLElementFont(eh,this.FFont,useCSS);
      if (!useCSS) {
        if (this.IsEnabled() && this.UseCSSFontColor()) es.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor));
      } else {
        es.removeProperty("color");
      };
    };
    this.UpdateElementData = function () {
      var frm = null;
      var el = null;
      var AToolTip = "";
      var ToolTipClass = "";
      var ToolTipPos = "";
      var ToolTipPause = 0;
      var ToolTipHidePause = 0;
      if (this.GetElementHandle() != null) {
        if (!(4 in this.FComponentState)) {
          if (this.FVisible) {
            this.GetElementStyle().setProperty("display","")}
           else this.GetElementStyle().setProperty("display","none");
        };
        this.EnableTab();
        if (this.IsEnabled()) {
          this.FContainer.removeAttribute("disabled")}
         else this.FContainer.setAttribute("disabled","");
        if (this.GetIsLinked() && (this.FHint === "")) return;
        if (this.GetRole() !== "") this.FContainer.setAttribute("role",this.FRole);
        frm = pas["WEBLib.Forms"].GetParentForm(this);
        if ((frm != null) && (frm.FCSSLibrary === 1) && this.FShowHint && (this.FHint !== "")) {
          el = this.GetElementHandle();
          AToolTip = this.FHint;
          var $tmp = pas["WEBLib.Forms"].Application.FHintPosition;
          if ($tmp === 0) {
            ToolTipPos = "left"}
           else if ($tmp === 2) {
            ToolTipPos = "right"}
           else if ($tmp === 1) {
            ToolTipPos = "top"}
           else if ($tmp === 3) ToolTipPos = "bottom";
          ToolTipClass = pas["WEBLib.Forms"].Application.FHintClassName;
          ToolTipPause = pas["WEBLib.Forms"].Application.FHintPause;
          ToolTipHidePause = pas["WEBLib.Forms"].Application.FHintHidePause;
          this.FTooltip = new bootstrap.Tooltip(el, {
           title: AToolTip,
           placement: ToolTipPos,
           customClass: ToolTipClass,
           delay: { "show": ToolTipPause, "hide": ToolTipHidePause }
          });
        } else {
          if (this.FShowHint && (this.FHint !== "")) {
            this.FContainer.setAttribute("title",this.FHint)}
           else this.FContainer.removeAttribute("title");
        };
        if (!this.IsEnabled() || (this.FElementFont === 1)) {
          this.GetElementStyle().removeProperty("color")}
         else if ((this.FElementFont !== 1) && this.UseCSSFontColor()) this.GetElementStyle().setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor));
      };
    };
    this.UpdateParent = function () {
      this.InternalUpdateParent();
      this.UpdateChildren(this.FPrevParent);
      this.UpdateChildren(this.FParent);
    };
    this.UpdateControlSize = function (AWidth, AHeight) {
      this.FWidth = AWidth;
      this.FHeight = AHeight;
    };
    this.InternalUpdateParent = function () {
      var p = null;
      p = this.FPrevParent;
      if (this.FNew) {
        this.CreateControl();
        if (this.GetContainer() != null) {
          if ((this.FParent != null) && !(this.FParent.GetContainer() != null)) this.FParent.CreateControl();
          if ((this.FParent !== p) && (p != null) && (p.GetContainer() != null)) {
            if (this.GetContainer().parentNode === p.GetChildContainer()) p.GetChildContainer().removeChild(this.GetContainer());
          };
          if ((this.FParent != null) && (this.FParent.GetContainer() != null)) {
            this.FParent.GetChildContainer().appendChild(this.GetContainer());
          };
        };
      };
    };
    this.UpdateChildren = function (AControl) {
      var I = 0;
      var c = null;
      if ((AControl != null) && !(3 in this.FComponentState)) {
        if (AControl.FAlign !== 0) AControl.DoRealign();
        if ($mod.TCustomControl.isPrototypeOf(AControl)) {
          rtl.as(AControl,$mod.TCustomControl).RecreateCanvas();
          rtl.as(AControl,$mod.TCustomControl).Invalidate();
        };
        for (var $l = 0, $end = AControl.GetControlsCount() - 1; $l <= $end; $l++) {
          I = $l;
          c = AControl.GetControls(I);
          this.UpdateChildren(c);
        };
      };
    };
    this.DisableTab = function () {
      var i = 0;
      if (!(this.FTabStop && this.CanFocus())) {
        if (this.GetContainer() != null) this.GetContainer().setAttribute("tabindex","-1");
      };
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.GetControls(i).DisableTab();
      };
    };
    this.EnableTab = function () {
      var i = 0;
      if ((this.FContainer != null) && !this.GetIsLinked()) {
        if (this.FTabStop && this.CanFocus()) {
          this.FContainer.setAttribute("tabindex",pas.SysUtils.IntToStr(this.FTabOrder + 1));
        } else {
          this.FContainer.setAttribute("tabindex","-1");
        };
      };
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.GetControls(i).EnableTab();
      };
    };
    this.SetElementClassName = function (AValue) {
      if (this.FElementClassName !== AValue) {
        this.FElementClassName = AValue;
        if (this.FContainer != null) this.FContainer.setAttribute("class",AValue);
        this.UpdateElement();
      };
    };
    this.SetColor = function (AValue) {
      this.FColor = AValue;
      this.UpdateElementVisual();
      this.ColorChanging();
    };
    this.SetFont = function (AValue) {
      this.FFont.SetName(AValue.FName);
      this.FFont.SetSize(AValue.FSize);
      this.FFont.SetStyle(rtl.refSet(AValue.FStyle));
      this.FFont.SetColor(AValue.FColor);
    };
    this.SetParent = function (AValue) {
      var isNew = false;
      if (AValue != null) AValue = AValue.CanAcceptChild(this);
      isNew = this.FNew;
      if (this.FParent !== AValue) {
        if (this.FParent != null) this.FParent.UnRegisterParent(this);
        this.FPrevParent = this.FParent;
        this.FParent = AValue;
        this.FGotFocus = false;
        this.UpdateParent();
        if (!(3 in this.FComponentState)) {
          if (!isNew) this.UpdateElement();
          this.InitScript();
        };
        if (this.FParent != null) {
          this.FParent.RegisterParent(this);
        };
        if ((0 in this.FComponentState) && (this.FParent != null) && !(0 in this.FParent.FComponentState)) this.Loaded();
        if ((AValue != null) && (this.FParent != null) && !this.FParent.IsUpdating()) this.Realign();
        if (!(3 in this.FComponentState)) this.Invalidate();
      };
    };
    this.RegisterParent = function (AValue) {
      this.FControls = rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls) + 1);
      this.FControls[rtl.length(this.FControls) - 1] = AValue;
    };
    this.UnRegisterParent = function (AValue) {
      var i = 0;
      var flg = false;
      flg = false;
      for (var $l = 0, $end = rtl.length(this.FControls) - 1; $l <= $end; $l++) {
        i = $l;
        if (this.FControls[i] === AValue) {
          flg = true;
        };
        if (flg && (i < (rtl.length(this.FControls) - 1))) this.FControls[i] = this.FControls[i + 1];
      };
      if (flg) this.FControls = rtl.arraySetLength(this.FControls,null,rtl.length(this.FControls) - 1);
    };
    this.CanAcceptChild = function (AValue) {
      var Result = null;
      Result = this;
      return Result;
    };
    this.SetLeft = function (AValue) {
      if (this.FLeft !== AValue) {
        this.FLeft = AValue;
        this.ResetAnchoring();
        if (!this.FUpdateTopLeft) this.FOrigLeft = AValue;
        this.UpdateElementSize();
        this.RecreateCanvas();
        this.InternalResize();
        if (!(0 in this.FComponentState) && (this.FAlign !== 0) && (this.FParent != null)) {
          this.DoRealign();
        };
      };
    };
    this.SetTop = function (AValue) {
      if (this.FTop !== AValue) {
        this.FTop = AValue;
        this.ResetAnchoring();
        if (!this.FUpdateTopLeft) this.FOrigTop = AValue;
        this.UpdateElementSize();
        this.RecreateCanvas();
        this.InternalResize();
        if (!(0 in this.FComponentState) && (this.FAlign !== 0) && (this.FParent != null)) {
          this.DoRealign();
        };
      };
    };
    this.MouseUp = function (Button, Shift, X, Y) {
      if (!this.FEnabled) return;
      if (this.FOnMouseUp != null) this.FOnMouseUp(this,Button,rtl.refSet(Shift),X,Y);
    };
    this.MouseDown = function (Button, Shift, X, Y) {
      if (!this.FEnabled) return;
      if (this.FOnMouseDown != null) this.FOnMouseDown(this,Button,rtl.refSet(Shift),X,Y);
    };
    this.MouseMove = function (Shift, X, Y) {
      if (!this.FEnabled) return;
      if (this.FOnMouseMove != null) this.FOnMouseMove(this,rtl.refSet(Shift),X,Y);
    };
    this.TouchStart = function (X, Y) {
      if (this.FOnTouchStart != null) this.FOnTouchStart(this,X,Y);
    };
    this.TouchMove = function (X, Y) {
      if (this.FOnTouchMove != null) this.FOnTouchMove(this,X,Y);
    };
    this.TouchEnd = function (X, Y) {
      if (this.FOnTouchEnd != null) this.FOnTouchEnd(this,X,Y);
    };
    this.TouchCancel = function (X, Y) {
      if (this.FOnTouchCancel != null) this.FOnTouchCancel(this,X,Y);
    };
    this.DoMouseEnter = function () {
      if (this.FOnMouseEnter != null) this.FOnMouseEnter(this);
    };
    this.DoMouseLeave = function () {
      if (this.FOnMouseLeave != null) this.FOnMouseLeave(this);
    };
    this.MouseWheel = function (Shift, WheelDelta, Handled) {
      var IsNeg = false;
      if (this.FOnMouseWheel != null) this.FOnMouseWheel(this,rtl.refSet(Shift),WheelDelta,pas.Types.TPoint.$clone(pas.Types.Point(0,0)),Handled);
      this.FWheelAccumulator += WheelDelta;
      while (Math.abs(this.FWheelAccumulator) >= 120) {
        IsNeg = this.FWheelAccumulator < 0;
        this.FWheelAccumulator = Math.abs(this.FWheelAccumulator) - 120;
        if (IsNeg) {
          if (this.FWheelAccumulator !== 0) this.FWheelAccumulator = -this.FWheelAccumulator;
          this.DoMouseWheelDown(rtl.refSet(Shift),pas.Types.TPoint.$clone(this.FWheelMousePos));
        } else this.DoMouseWheelUp(rtl.refSet(Shift),pas.Types.TPoint.$clone(this.FWheelMousePos));
      };
    };
    this.DoMouseWheelDown = function (Shift, MousePos) {
      var Result = false;
      Result = false;
      if (this.FOnMouseWheelDown != null) this.FOnMouseWheelDown(this,rtl.refSet(Shift),pas.Types.TPoint.$clone(MousePos),{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }});
      return Result;
    };
    this.DoMouseWheelUp = function (Shift, MousePos) {
      var Result = false;
      Result = false;
      if (this.FOnMouseWheelUp != null) this.FOnMouseWheelUp(this,rtl.refSet(Shift),pas.Types.TPoint.$clone(MousePos),{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }});
      return Result;
    };
    this.DblClick = function () {
      if (this.FOnDblClick != null) this.FOnDblClick(this);
    };
    this.KeyDown = function (Key, Shift) {
      if (this.FOnKeyDown != null) this.FOnKeyDown(this,Key,rtl.refSet(Shift));
    };
    this.KeyPreview = function (Key, Shift) {
      if ((this.FOwner != null) && $mod.TControl.isPrototypeOf(this.FOwner)) {
        rtl.as(this.FOwner,$mod.TControl).KeyPreview(Key,rtl.refSet(Shift));
      };
    };
    this.KeyPress = function (Key) {
      if (this.FOnKeyPress != null) this.FOnKeyPress(this,Key);
    };
    this.KeyUp = function (Key, Shift) {
      if (this.FOnKeyUp != null) this.FOnKeyUp(this,Key,rtl.refSet(Shift));
    };
    this.SetFocus = function () {
      var e = null;
      if (!this.CanFocus()) return;
      if (this.GetElementHandle() != null) {
        e = this.GetElementHandle();
        if (this.FGotFocus) {
          e.focus();
        } else {
          setTimeout(function() {e.focus();}, 1);
        };
      };
    };
    this.DoMarginsChanged = function (Sender) {
      this.DoRealign();
    };
    this.DoRealign = function () {
      if ((this.FParent != null) && !this.FParent.IsUpdating()) {
        this.FParent.AlignControl(this.FParent);
      };
    };
    this.DoBoundsChange = function () {
      var b = false;
      var frm = null;
      this.UpdateElementSize();
      this.RecreateCanvas();
      if (this.FIsResizing) return;
      this.FIsResizing = true;
      this.InternalResize();
      this.DoRealign();
      b = false;
      frm = pas["WEBLib.Forms"].GetParentForm(this);
      if (frm != null) {
        b = frm.FIsResizing$1;
        b = b || (frm.FUpdateCount > 0);
      };
      b = b || (this.FUpdateCount > 0);
      b = b || this.FIsAligning;
      if (!b) {
        this.UpdateChildAnchoring();
      };
      this.FIsResizing = false;
    };
    this.DoEndDrag = function (Target, X, Y) {
      if (this.FonEndDrag != null) this.FonEndDrag(this,Target,X,Y);
    };
    this.DoStartDrag = function (DragObject) {
      if (this.FOnStartDrag != null) this.FOnStartDrag(this,DragObject);
    };
    this.DragOver = function (Source, X, Y, State, Accept) {
      if (this.FOnDragOver != null) this.FOnDragOver(this,Source,X,Y,State,Accept);
    };
    this.Focused = function () {
      var Result = false;
      Result = this.FContainer === document.activeElement;
      return Result;
    };
    this.GetID = function () {
      var Result = "";
      Result = this.FID;
      return Result;
    };
    this.GetElementHandle = function () {
      var Result = null;
      Result = null;
      if ((this.FContainer != null) && this.FControlCreated) Result = this.FContainer;
      return Result;
    };
    this.GetElementBindHandle = function () {
      var Result = null;
      Result = this.GetElementHandle();
      return Result;
    };
    this.GetKeyCode = function (AValue, IgnoreCase) {
      var Result = 0;
      var i = 0;
      i = -1;
      var $tmp = AValue;
      if ($tmp === "Up") {
        i = 38}
       else if ($tmp === "Down") {
        i = 40}
       else if ($tmp === "Left") {
        i = 37}
       else if ($tmp === "Right") {
        i = 39}
       else if ($tmp === "!") {
        i = 56}
       else if ($tmp === '"') {
        i = 51}
       else if ($tmp === "#") {
        i = 51}
       else if ($tmp === "$") {
        i = 186}
       else if ($tmp === "%") {
        i = 192}
       else if ($tmp === "'") {
        i = 52}
       else if ($tmp === "(") {
        i = 53}
       else if ($tmp === ")") {
        i = 219}
       else if ($tmp === "*") {
        i = 106}
       else if ($tmp === "+") {
        i = 107}
       else if ($tmp === "-") {
        i = 109}
       else if ($tmp === ",") {
        i = 44}
       else if ($tmp === ".") {
        i = 46}
       else if ($tmp === "/") {
        i = 111}
       else if ($tmp === "\\") {
        i = 226}
       else if ($tmp === "=") {
        i = 187}
       else if ($tmp === "<") {
        i = 226}
       else if ($tmp === ">") {
        i = 226}
       else if ($tmp === pas.Web.TJSKeyNames.BackSpace) {
        i = 8}
       else if ($tmp === pas.Web.TJSKeyNames.Tab) {
        i = 9}
       else if ($tmp === pas.Web.TJSKeyNames.Enter) {
        i = 13}
       else if ($tmp === pas.Web.TJSKeyNames.Shift) {
        i = 16}
       else if ($tmp === pas.Web.TJSKeyNames.Control) {
        i = 17}
       else if ($tmp === pas.Web.TJSKeyNames.Alt) {
        i = 18}
       else if ($tmp === pas.Web.TJSKeyNames.Pause) {
        i = 19}
       else if ($tmp === pas.Web.TJSKeyNames.CapsLock) {
        i = 20}
       else if ($tmp === pas.Web.TJSKeyNames.Escape) {
        i = 27}
       else if ($tmp === pas.Web.TJSKeyNames.PageUp) {
        i = 33}
       else if ($tmp === pas.Web.TJSKeyNames.PageDown) {
        i = 34}
       else if ($tmp === pas.Web.TJSKeyNames._End) {
        i = 35}
       else if ($tmp === pas.Web.TJSKeyNames.Home) {
        i = 36}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowLeft) {
        i = 37}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowUp) {
        i = 38}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowRight) {
        i = 39}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowDown) {
        i = 40}
       else if ($tmp === pas.Web.TJSKeyNames.Insert) {
        i = 45}
       else if ($tmp === pas.Web.TJSKeyNames.Delete) {
        i = 46}
       else if ($tmp === pas.Web.TJSKeyNames.F1) {
        i = 112}
       else if ($tmp === pas.Web.TJSKeyNames.F2) {
        i = 113}
       else if ($tmp === pas.Web.TJSKeyNames.F3) {
        i = 114}
       else if ($tmp === pas.Web.TJSKeyNames.F4) {
        i = 115}
       else if ($tmp === pas.Web.TJSKeyNames.F5) {
        i = 116}
       else if ($tmp === pas.Web.TJSKeyNames.F6) {
        i = 117}
       else if ($tmp === pas.Web.TJSKeyNames.F7) {
        i = 118}
       else if ($tmp === pas.Web.TJSKeyNames.F8) {
        i = 119}
       else if ($tmp === pas.Web.TJSKeyNames.F9) {
        i = 120}
       else if ($tmp === pas.Web.TJSKeyNames.F10) {
        i = 121}
       else if ($tmp === pas.Web.TJSKeyNames.F11) {
        i = 122}
       else if ($tmp === pas.Web.TJSKeyNames.F12) {
        i = 123}
       else if ($tmp === pas.Web.TJSKeyNames.F13) {
        i = 124}
       else if ($tmp === pas.Web.TJSKeyNames.F14) {
        i = 125}
       else if ($tmp === pas.Web.TJSKeyNames.F15) {
        i = 126}
       else if ($tmp === pas.Web.TJSKeyNames.F16) {
        i = 127}
       else if ($tmp === pas.Web.TJSKeyNames.F17) {
        i = 128}
       else if ($tmp === pas.Web.TJSKeyNames.F18) {
        i = 129}
       else if ($tmp === pas.Web.TJSKeyNames.F19) {
        i = 130}
       else if ($tmp === pas.Web.TJSKeyNames.F20) {
        i = 131}
       else {
        if (pas.System.Assigned(AValue) && (AValue.length > 0)) {
          i = AValue.charCodeAt(1 - 1);
          if (IgnoreCase && (i >= 97) && (i <= 122)) {
            i = i & 0xDF}
           else if ((i >= 65) && (i <= 90)) {
            i = i | 0x40}
           else if (i > 122) i = i | 0x80;
        };
      };
      Result = i;
      return Result;
    };
    this.GetKeyChar = function (AValue) {
      var Result = "";
      var i = 0;
      i = -1;
      Result = "\x00";
      var $tmp = AValue;
      if ($tmp === pas.Web.TJSKeyNames.BackSpace) {
        i = 8}
       else if ($tmp === pas.Web.TJSKeyNames.Tab) {
        i = 9}
       else if ($tmp === pas.Web.TJSKeyNames.Enter) {
        i = 13}
       else if ($tmp === pas.Web.TJSKeyNames.Shift) {
        i = 16}
       else if ($tmp === pas.Web.TJSKeyNames.Control) {
        i = 17}
       else if ($tmp === pas.Web.TJSKeyNames.Alt) {
        i = 18}
       else if ($tmp === pas.Web.TJSKeyNames.Pause) {
        i = 19}
       else if ($tmp === pas.Web.TJSKeyNames.CapsLock) {
        i = 20}
       else if ($tmp === pas.Web.TJSKeyNames.Escape) {
        i = 27}
       else if ($tmp === pas.Web.TJSKeyNames.PageUp) {
        i = 33}
       else if ($tmp === pas.Web.TJSKeyNames.PageDown) {
        i = 34}
       else if ($tmp === pas.Web.TJSKeyNames._End) {
        i = 35}
       else if ($tmp === pas.Web.TJSKeyNames.Home) {
        i = 36}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowLeft) {
        i = 37}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowUp) {
        i = 38}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowRight) {
        i = 39}
       else if ($tmp === pas.Web.TJSKeyNames.ArrowDown) {
        i = 40}
       else if ($tmp === pas.Web.TJSKeyNames.Insert) {
        i = 45}
       else if ($tmp === pas.Web.TJSKeyNames.Delete) {
        i = 46}
       else if ($tmp === pas.Web.TJSKeyNames.F1) {
        i = 112}
       else if ($tmp === pas.Web.TJSKeyNames.F2) {
        i = 113}
       else if ($tmp === pas.Web.TJSKeyNames.F3) {
        i = 114}
       else if ($tmp === pas.Web.TJSKeyNames.F4) {
        i = 115}
       else if ($tmp === pas.Web.TJSKeyNames.F5) {
        i = 116}
       else if ($tmp === pas.Web.TJSKeyNames.F6) {
        i = 117}
       else if ($tmp === pas.Web.TJSKeyNames.F7) {
        i = 118}
       else if ($tmp === pas.Web.TJSKeyNames.F8) {
        i = 119}
       else if ($tmp === pas.Web.TJSKeyNames.F9) {
        i = 120}
       else if ($tmp === pas.Web.TJSKeyNames.F10) {
        i = 121}
       else if ($tmp === pas.Web.TJSKeyNames.F11) {
        i = 122}
       else if ($tmp === pas.Web.TJSKeyNames.F12) {
        i = 123}
       else if ($tmp === pas.Web.TJSKeyNames.F13) {
        i = 124}
       else if ($tmp === pas.Web.TJSKeyNames.F14) {
        i = 125}
       else if ($tmp === pas.Web.TJSKeyNames.F15) {
        i = 126}
       else if ($tmp === pas.Web.TJSKeyNames.F16) {
        i = 127}
       else if ($tmp === pas.Web.TJSKeyNames.F17) {
        i = 128}
       else if ($tmp === pas.Web.TJSKeyNames.F18) {
        i = 129}
       else if ($tmp === pas.Web.TJSKeyNames.F19) {
        i = 130}
       else if ($tmp === pas.Web.TJSKeyNames.F20) {
        i = 131}
       else {
        Result = AValue.charAt(0);
      };
      if (i !== -1) Result = String.fromCharCode(i);
      return Result;
    };
    this.IsKeyCharacter = function (AValue) {
      var Result = false;
      var $tmp = AValue;
      if (($tmp === "Up") || ($tmp === "Down") || ($tmp === "Left") || ($tmp === "Right") || ($tmp === pas.Web.TJSKeyNames.Shift) || ($tmp === pas.Web.TJSKeyNames.Control) || ($tmp === pas.Web.TJSKeyNames.Alt) || ($tmp === pas.Web.TJSKeyNames.Pause) || ($tmp === pas.Web.TJSKeyNames.CapsLock) || ($tmp === pas.Web.TJSKeyNames.PageUp) || ($tmp === pas.Web.TJSKeyNames.PageDown) || ($tmp === pas.Web.TJSKeyNames._End) || ($tmp === pas.Web.TJSKeyNames.Home) || ($tmp === pas.Web.TJSKeyNames.ArrowLeft) || ($tmp === pas.Web.TJSKeyNames.ArrowUp) || ($tmp === pas.Web.TJSKeyNames.ArrowRight) || ($tmp === pas.Web.TJSKeyNames.ArrowDown) || ($tmp === pas.Web.TJSKeyNames.Insert) || ($tmp === pas.Web.TJSKeyNames.Delete) || ($tmp === pas.Web.TJSKeyNames.F1) || ($tmp === pas.Web.TJSKeyNames.F2) || ($tmp === pas.Web.TJSKeyNames.F3) || ($tmp === pas.Web.TJSKeyNames.F4) || ($tmp === pas.Web.TJSKeyNames.F5) || ($tmp === pas.Web.TJSKeyNames.F6) || ($tmp === pas.Web.TJSKeyNames.F7) || ($tmp === pas.Web.TJSKeyNames.F8) || ($tmp === pas.Web.TJSKeyNames.F9) || ($tmp === pas.Web.TJSKeyNames.F10) || ($tmp === pas.Web.TJSKeyNames.F11) || ($tmp === pas.Web.TJSKeyNames.F12) || ($tmp === pas.Web.TJSKeyNames.F13) || ($tmp === pas.Web.TJSKeyNames.F14) || ($tmp === pas.Web.TJSKeyNames.F15) || ($tmp === pas.Web.TJSKeyNames.F16) || ($tmp === pas.Web.TJSKeyNames.F17) || ($tmp === pas.Web.TJSKeyNames.F18) || ($tmp === pas.Web.TJSKeyNames.F19) || ($tmp === pas.Web.TJSKeyNames.F20)) {
        Result = false}
       else {
        Result = true;
      };
      return Result;
    };
    this.GetClientRect = function () {
      var Result = pas.Types.TRect.$new();
      var css = "";
      var p = 0;
      var brdr = 0;
      css = pas.SysUtils.UpperCase(this.GetStyle("border-width"));
      brdr = 0;
      p = pas.System.Pos("PX",css);
      if (p > 0) {
        pas.System.Delete({get: function () {
            return css;
          }, set: function (v) {
            css = v;
          }},p,2);
        pas.System.val$6(css,{get: function () {
            return brdr;
          }, set: function (v) {
            brdr = v;
          }},{get: function () {
            return p;
          }, set: function (v) {
            p = v;
          }});
      };
      Result.$assign(pas.Types.Rect(0,0,this.GetWidth() - (2 * brdr),this.GetHeight() - (2 * brdr)));
      return Result;
    };
    this.CreateControl = function () {
      if (!(this.FElement != null)) {
        this.FElement = this.CreateElement();
        if (this.FElement != null) {
          this.FControlCreated = true;
          this.FContainer = this.FElement;
          if (!(this.GetID() === "body")) this.GetContainer().setAttribute("id",this.GetID());
          this.GetContainer().setAttribute("zindex","0");
          if (this.FElementClassName !== "") this.GetContainer().setAttribute("class",this.FElementClassName);
          this.CreateChildElements(this.FElement);
          this.BindEvents();
          this.UpdateElement();
        };
      };
    };
    this.ClearMethodPointers = function () {
      this.FWheelPtr = null;
      this.FClickPtr = null;
      this.FDblClickPtr = null;
      this.FMouseDownPtr = null;
      this.FMouseUpPtr = null;
      this.FMouseMovePtr = null;
      this.FMouseLeavePtr = null;
      this.FMouseEnterPtr = null;
      this.FKeyDownPtr = null;
      this.FKeyUpPtr = null;
      this.FKeyPressPtr = null;
      this.FInputPtr = null;
      this.FEnterPtr = null;
      this.FExitPtr = null;
      this.FTouchStartPtr = null;
      this.FTouchEndPtr = null;
      this.FTouchMovePtr = null;
      this.FTouchCancelPtr = null;
      this.FLayerMouseLeavePtr = null;
      this.FLayerMouseEnterPtr = null;
      this.FScriptLoadedPtr = null;
      this.FContextMenuPtr = null;
    };
    this.GetMethodPointers = function () {
      if (this.FWheelPtr === null) {
        this.FWheelPtr = rtl.createCallback(this,"HandleDoWheel");
        this.FClickPtr = rtl.createCallback(this,"HandleDoClick");
        this.FDblClickPtr = rtl.createCallback(this,"HandleDoDblClick");
        this.FMouseDownPtr = rtl.createCallback(this,"HandleDoMouseDown");
        this.FMouseUpPtr = rtl.createCallback(this,"HandleDoMouseUp");
        this.FMouseMovePtr = rtl.createCallback(this,"HandleDoMouseMove");
        this.FMouseLeavePtr = rtl.createCallback(this,"HandleDoMouseLeave");
        this.FMouseEnterPtr = rtl.createCallback(this,"HandleDoMouseEnter");
        this.FKeyDownPtr = rtl.createCallback(this,"HandleDoKeyDown");
        this.FKeyUpPtr = rtl.createCallback(this,"HandleDoKeyUp");
        this.FKeyPressPtr = rtl.createCallback(this,"HandleDoKeyPress");
        this.FInputPtr = rtl.createCallback(this,"HandleDoInput");
        this.FEnterPtr = rtl.createCallback(this,"HandleDoEnter");
        this.FExitPtr = rtl.createCallback(this,"HandleDoExit");
        this.FTouchStartPtr = rtl.createCallback(this,"HandleDoTouchStart");
        this.FTouchEndPtr = rtl.createCallback(this,"HandleDoTouchEnd");
        this.FTouchMovePtr = rtl.createCallback(this,"HandleDoTouchMove");
        this.FTouchCancelPtr = rtl.createCallback(this,"HandleDoTouchCancel");
        this.FLayerMouseLeavePtr = rtl.createCallback(this,"LayerHandleDoMouseLeave");
        this.FLayerMouseEnterPtr = rtl.createCallback(this,"LayerHandleDoMouseEnter");
        this.FScriptLoadedPtr = rtl.createCallback(this,"RequiredScriptLoaded");
        this.FDragStartPtr = rtl.createCallback(this,"HandleDoDragStart");
        this.FDragOverPtr = rtl.createCallback(this,"HandleDoDragOver");
        this.FDragEnterPtr = rtl.createCallback(this,"HandleDoDragEnter");
        this.FDragLeavePtr = rtl.createCallback(this,"HandledoDragLeave");
        this.FDragEndPtr = rtl.createCallback(this,"HandleDoDragEnd");
        this.FDragDropPtr = rtl.createCallback(this,"HandleDoDragDrop");
        this.FContextMenuPtr = rtl.createCallback(this,"HandleDoContextMenu");
      };
    };
    this.BindEvents = function () {
      var eh = null;
      var wp = null;
      if (this.GetElementBindHandle() != null) {
        this.GetMethodPointers();
        this.FEventsBound = true;
        eh = this.GetElementBindHandle();
        wp = this.FWheelPtr;
        eh.addEventListener('wheel', wp, { passive:true});
        eh.addEventListener("click",this.FClickPtr);
        eh.addEventListener("dblclick",this.FDblClickPtr);
        eh.addEventListener("mousedown",this.FMouseDownPtr);
        eh.addEventListener("mouseup",this.FMouseUpPtr);
        eh.addEventListener("mousemove",this.FMouseMovePtr);
        eh.addEventListener("mouseleave",this.FMouseLeavePtr);
        eh.addEventListener("mouseenter",this.FMouseEnterPtr);
        eh.addEventListener("keydown",this.FKeyDownPtr);
        eh.addEventListener("keyup",this.FKeyUpPtr);
        eh.addEventListener("keypress",this.FKeyPressPtr);
        eh.addEventListener("input",this.FInputPtr);
        eh.addEventListener("focus",this.FEnterPtr);
        eh.addEventListener("blur",this.FExitPtr);
        wp = this.FTouchStartPtr;
        eh.addEventListener('touchstart', wp, {passive: true});
        wp = this.FTouchMovePtr;
        eh.addEventListener('touchmove', wp, {passive:true});
        eh.addEventListener("touchend",this.FTouchEndPtr);
        eh.addEventListener("touchcancel",this.FTouchCancelPtr);
        eh.addEventListener("contextmenu",this.FContextMenuPtr);
        eh.addEventListener("dragstart",this.FDragStartPtr);
        eh.addEventListener("dragover",this.FDragOverPtr);
        eh.addEventListener("dragenter",this.FDragEnterPtr);
        eh.addEventListener("dragleave",this.FDragLeavePtr);
        eh.addEventListener("dragend",this.FDragEndPtr);
        eh.addEventListener("drop",this.FDragDropPtr);
      };
    };
    this.UnbindEvents = function () {
      var eh = null;
      this.ReleaseCapture();
      if (this.GetElementBindHandle() != null) {
        eh = this.GetElementBindHandle();
        eh.removeEventListener("wheel",this.FWheelPtr);
        eh.removeEventListener("click",this.FClickPtr);
        eh.removeEventListener("dblclick",this.FDblClickPtr);
        eh.removeEventListener("mousedown",this.FMouseDownPtr);
        eh.removeEventListener("mouseup",this.FMouseUpPtr);
        eh.removeEventListener("mousemove",this.FMouseMovePtr);
        eh.removeEventListener("mouseleave",this.FMouseLeavePtr);
        eh.removeEventListener("mouseenter",this.FMouseEnterPtr);
        eh.removeEventListener("keydown",this.FKeyDownPtr);
        eh.removeEventListener("keyup",this.FKeyUpPtr);
        eh.removeEventListener("keypress",this.FKeyPressPtr);
        eh.removeEventListener("focus",this.FEnterPtr);
        eh.removeEventListener("blur",this.FExitPtr);
        eh.removeEventListener("input",this.FInputPtr);
        eh.removeEventListener("touchstart",this.FTouchStartPtr);
        eh.removeEventListener("touchmove",this.FTouchMovePtr);
        eh.removeEventListener("touchend",this.FTouchEndPtr);
        eh.removeEventListener("touchcancel",this.FTouchEndPtr);
        eh.removeEventListener("contextmenu",this.FContextMenuPtr);
      };
    };
    this.AlignControls = function (AControl, ARect) {
      var $Self = this;
      var j = 0;
      function DoPosition(Control, AAlign) {
        var dl = 0;
        var dt = 0;
        var dr = 0;
        var db = 0;
        if (!Control.AnchoringInitialized()) $Self.InitAnchoring();
        Control.FUpdateTopLeft = true;
        if (Control.FAlignWithMargins) {
          dl = Control.FMargins.FLeft;
          dt = Control.FMargins.FTop;
          db = Control.FMargins.FBottom;
          dr = Control.FMargins.FRight;
        } else {
          dl = 0;
          dt = 0;
          db = 0;
          dr = 0;
        };
        var $tmp = AAlign;
        if ($tmp === 1) {
          Control.SetBoundsInt(ARect.Left + dl,ARect.Top + dt,ARect.Right - ARect.Left - dl - dr,Control.GetHeight());
          ARect.Top = ARect.Top + Control.GetHeight() + dt + db;
        } else if ($tmp === 2) {
          Control.SetBoundsInt(ARect.Left + dl,ARect.Bottom - Control.GetHeight() - db - 1,ARect.Right - ARect.Left - dl - dr - 1,Control.GetHeight());
          ARect.Bottom = ARect.Bottom - Control.GetHeight() - dt - db;
        } else if ($tmp === 3) {
          Control.SetBoundsInt(ARect.Left + dl,ARect.Top + dt,Control.GetWidth(),ARect.Bottom - ARect.Top - dt - db);
          ARect.Left = ARect.Left + Control.GetWidth() + dl + dr;
        } else if ($tmp === 4) {
          Control.SetBoundsInt(ARect.Right - Control.GetWidth() - dr,ARect.Top + dt,Control.GetWidth(),ARect.Bottom - ARect.Top - db - dt);
          ARect.Right = ARect.Right - Control.GetWidth() - dr - dl;
        } else if ($tmp === 5) {
          Control.SetBoundsInt(ARect.Left + dl,ARect.Top + dt,ARect.Right - ARect.Left - dl - dr,ARect.Bottom - ARect.Top - db - dt);
        };
        Control.FUpdateTopLeft = false;
      };
      function DoAlign(AAlign) {
        var i = 0;
        var j = 0;
        var ins = 0;
        var il = null;
        il = pas.Classes.TList.$create("Create$1");
        for (var $l = 0, $end = $Self.GetControlsCount() - 1; $l <= $end; $l++) {
          i = $l;
          if (($Self.GetControls(i).FAlign === AAlign) && ($Self.GetControls(i).FVisible || (4 in $Self.FComponentState))) {
            ins = il.GetCount();
            for (var $l1 = il.GetCount() - 1; $l1 >= 0; $l1--) {
              j = $l1;
              var $tmp = AAlign;
              if ($tmp === 1) {
                if ($Self.GetControls(i).FOrigTop < rtl.getObject(il.Get(j)).FOrigTop) ins = j}
               else if ($tmp === 3) {
                if ($Self.GetControls(i).FOrigLeft < rtl.getObject(il.Get(j)).FOrigLeft) ins = j}
               else if ($tmp === 4) {
                if (($Self.GetControls(i).FOrigLeft + $Self.GetControls(i).GetWidth()) > (rtl.getObject(il.Get(j)).FOrigLeft + rtl.getObject(il.Get(j)).GetWidth())) ins = j}
               else if ($tmp === 2) if (($Self.GetControls(i).FOrigTop + $Self.GetControls(i).GetHeight()) > (rtl.getObject(il.Get(j)).FOrigTop + rtl.getObject(il.Get(j)).GetHeight())) ins = j;
            };
            il.Insert(ins,$Self.GetControls(i));
          };
        };
        for (var $l2 = 0, $end1 = il.GetCount() - 1; $l2 <= $end1; $l2++) {
          i = $l2;
          DoPosition(rtl.getObject(il.Get(i)),AAlign);
        };
        il = rtl.freeLoc(il);
      };
      DoAlign(1);
      DoAlign(2);
      DoAlign(3);
      DoAlign(4);
      DoAlign(5);
      DoAlign(6);
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        j = $l;
        this.GetControls(j).AlignControl(this.GetControls(j));
      };
    };
    this.AlignControl = function (AControl) {
      var r = pas.Types.TRect.$new();
      var cr = null;
      var ovf = "";
      var ovfx = "";
      var ovfy = "";
      var eh = null;
      var el = null;
      var frm = null;
      var ctop = 0;
      var vscrl = 0;
      if (this.FIsAligning) return;
      if (this.IsUpdating()) return;
      if (0 in this.FComponentState) return;
      if ((this.FParent != null) && !this.FParent.FVisible) return;
      frm = pas["WEBLib.Forms"].GetParentForm(this);
      if ((frm != null) && frm.IsUpdating()) return;
      ctop = 0;
      if ((frm != null) && (frm.FFormContainer !== "") && pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(AControl)) {
        el = document.getElementById(frm.FFormContainer);
        if (el != null) {
          cr = el.getBoundingClientRect();
          ctop = Math.round(cr.top + 1);
        };
      };
      this.FIsAligning = true;
      if (!(AControl != null)) return;
      eh = AControl.GetElementHandle();
      if (eh != null) {
        ovf = AControl.GetElementStyle().getPropertyValue("overflow");
        ovfx = AControl.GetElementStyle().getPropertyValue("overflow-x");
        ovfy = AControl.GetElementStyle().getPropertyValue("overflow-y");
        if (this.FClipChildren && (pas.SysUtils.LowerCase(eh.tagName) !== pas["WEBLib.WebTools"].cBodyTag)) {
          AControl.GetElementStyle().setProperty("overflow","hidden")}
         else AControl.GetElementStyle().setProperty("overflow","");
      };
      r.$assign(this.GetClientRect());
      r.Bottom = r.Bottom - ctop;
      if (this.GetIsLinked()) {
        cr = this.GetElementHandle().getBoundingClientRect();
        r.$assign(pas.Types.Rect(0,0,Math.round(cr.right - cr.left),Math.round(cr.bottom - cr.top)));
      };
      if (((r.Bottom + ctop) > pas["WEBLib.Forms"].WinHeight()) && (this.FHeightStyle !== 1) && !(this.FElementPosition === 0) && !this.GetIsLinked() && !(pas["WEBLib.Forms"].VSIDE != null)) {
        if (((this.FParent != null) && pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this.FParent)) || pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this)) {
          r.Bottom = pas["WEBLib.Forms"].WinHeight() - ctop;
        };
      };
      if ((eh != null) && (eh.tagName === "BODY")) {
        vscrl = 0;
        if ((document.body.scrollHeight > document.body.clientHeight) && !(4 in this.FComponentState)) vscrl = 16;
        if (frm.FFormContainer !== "") {
          r.Bottom = Math.round(Math.min(r.Bottom,pas["WEBLib.Forms"].WinHeight()));
          r.Right = Math.round(Math.min(r.Right - vscrl,pas["WEBLib.Forms"].WinWidth()));
        } else {
          r.Bottom = frm.GetHeight();
          r.Right = frm.GetWidth();
        };
      };
      if (pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(AControl) && !(pas["WEBLib.Forms"].VSIDE != null)) {
        if (r.Bottom > pas["WEBLib.Forms"].WinHeight()) r.Bottom = pas["WEBLib.Forms"].WinHeight();
        if (r.Right > pas["WEBLib.Forms"].WinWidth()) r.Right = pas["WEBLib.Forms"].WinWidth();
      };
      if (AControl.IsStructuralElement()) {
        r.$assign(this.FParent.GetClientRect());
      };
      this.AlignControls(AControl,r);
      if (eh != null) {
        AControl.GetElementStyle().setProperty("overflow",ovf);
        AControl.GetElementStyle().setProperty("overflow-x",ovfx);
        AControl.GetElementStyle().setProperty("overflow-y",ovfy);
      };
      this.FIsAligning = false;
    };
    this.InitAnchoring = function () {
      var $Self = this;
      var i = 0;
      var dx = 0;
      var dy = 0;
      function SizeBorderOffset(AObject, ax, ay) {
        var prop = null;
        ax.set(0);
        ay.set(0);
        prop = pas.TypInfo.GetPropInfo(AObject.$class.ClassInfo(),"BorderStyle");
        if (prop != null) {
          i = pas.TypInfo.GetOrdProp$1(AObject,prop);
          if (i in rtl.createSet(1,4,5)) {
            ax.set(4);
            ay.set(4);
          };
          if (i in rtl.createSet(2,3)) {
            ax.set(16);
            ay.set(16);
          };
        };
      };
      if (this.AnchoringInitialized()) return;
      dx = 0;
      dy = 0;
      if (pas["WEBLib.Forms"].TForm.isPrototypeOf($Self)) {
        if (rtl.as($Self,pas["WEBLib.Forms"].TForm).IsMiletus()) SizeBorderOffset($Self,{get: function () {
            return dx;
          }, set: function (v) {
            dx = v;
          }},{get: function () {
            return dy;
          }, set: function (v) {
            dy = v;
          }});
        this.FOrigRect.$assign(pas.Types.Rect(0,0,this.GetDesignWidth() - dx,this.GetDesignHeight() - dy));
      } else {
        this.FOrigRect.$assign(pas.Types.Rect(this.GetDesignLeft(),this.GetDesignTop(),this.GetDesignLeft() + this.GetDesignWidth(),this.GetDesignTop() + this.GetDesignHeight()));
      };
      if (this.FParent != null) {
        if (pas["WEBLib.Forms"].TForm.isPrototypeOf(this.FParent)) {
          if (rtl.as(this.FParent,pas["WEBLib.Forms"].TForm).IsMiletus()) {
            SizeBorderOffset(this.FParent,{get: function () {
                return dx;
              }, set: function (v) {
                dx = v;
              }},{get: function () {
                return dy;
              }, set: function (v) {
                dy = v;
              }});
          };
          this.FOrigParentRect.$assign(pas.Types.Rect(0,0,this.FParent.GetDesignWidth() - dx,this.FParent.GetDesignHeight() - dy));
        } else {
          if (!this.FParent.AnchoringInitialized()) this.FParent.InitAnchoring();
          this.FOrigParentRect.$assign(pas.Types.Rect(this.FParent.GetDesignLeft(),this.FParent.GetDesignTop(),this.FParent.GetDesignLeft() + this.FParent.GetDesignWidth(),this.FParent.GetDesignTop() + this.FParent.GetDesignHeight()));
        };
      };
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.GetControls(i).InitAnchoring();
      };
    };
    this.AnchoringInitialized = function () {
      var Result = false;
      Result = (this.FOrigRect.Left !== -1) || (this.FOrigRect.Top !== -1);
      return Result;
    };
    this.InitScript = function () {
    };
    this.Realign = function () {
      this.AlignControl(this);
    };
    this.Loaded = function () {
      var i = 0;
      if (!(0 in this.FComponentState)) return;
      pas.Classes.TComponent.Loaded.call(this);
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if ((this.GetControls(i).FElementPosition in rtl.createSet(1,2)) && !this.GetControls(i).GetIsLinked() && (this.GetControls(i).FChildOrder >= 0)) {
          if (this.GetControls(i).FChildOrder < this.GetChildContainer().childNodes.length) {
            this.GetChildContainer().insertBefore(this.GetControls(i).GetContainer(),this.GetChildContainer().childNodes.item(this.GetControls(i).FChildOrder));
          };
        };
        this.GetControls(i).Loaded();
      };
      for (var $l1 = 0, $end1 = this.GetComponentCount() - 1; $l1 <= $end1; $l1++) {
        i = $l1;
        if (0 in this.GetComponent(i).FComponentState) this.GetComponent(i).Loaded();
      };
      var $tmp = this.FAlign;
      if ($tmp === 5) {
        if (this.FParent != null) this.SetBoundsInt(0,0,this.FParent.FWidth,this.FParent.FHeight);
      };
      this.Resize();
      this.UpdateElement();
    };
    this.InternalResize = function () {
      if (0 in this.FComponentState) return;
      this.Resize();
    };
    this.FontChanged = function () {
      this.UpdateElementVisual();
    };
    this.ClearChildElements = function () {
      var el = null;
      if (!(this.GetElementHandle() != null)) return;
      while (this.GetElementHandle().childElementCount > 0) {
        el = this.GetElementHandle().firstChild;
        this.GetElementHandle().removeChild(el);
      };
    };
    this.SetElementColor = function (AElement, AColor) {
      var noCSS = false;
      noCSS = !pas["WEBLib.Forms"].Application.FThemed && !(this.FElementClassName !== "");
      if (!this.GetIsLinked()) $mod.SetHTMLElementColor(AElement,AColor,!noCSS);
    };
    this.MoveElements = function (FromElement, ToElement) {
      if (FromElement && ToElement) {
        while (FromElement.childNodes.length) { ToElement.appendChild(FromElement.firstChild); }
      };
    };
    this.MoveElementsAndFree = function (FromElement, ToElement) {
      if (FromElement && ToElement){
        while (FromElement.childNodes.length) { ToElement.appendChild(FromElement.firstChild); }
        FromElement.remove();
      };
    };
    this.CreateWithID = function (AID) {
      var el = null;
      this.ClearMethodPointers();
      this.FUpdateCount = 0;
      this.FControlCreated = false;
      this.FLinkTouchEvents = true;
      this.FIsResizing = false;
      if (((this.FOwner != null) && (0 in this.FOwner.FComponentState)) || !(this.FOwner != null)) {
        if (!((this.FOwner != null) && (4 in this.FOwner.FComponentState))) this.Loading();
      };
      this.FElementPosition = 0;
      this.FWidthStyle = 1;
      this.FHeightStyle = 1;
      el = document.getElementById(AID);
      this.FNew = !(el != null);
      this.FFont = pas["WEBLib.Graphics"].TFont.$create("Create$1");
      this.FFont.FOnChange = rtl.createCallback(this,"HandleFontChanged");
      if (this.FNew) {
        this.FContainer = null;
      } else {
        this.FContainer = el;
        this.FControlCreated = true;
        this.FElementPosition = 1;
        this.CreateChildElements(el);
        this.BindElement();
        this.BindEvents();
      };
      this.FID = AID;
      this.FEnabled = true;
      this.FVisible = true;
      this.FLeft = 0;
      this.FTop = 0;
      this.FAlign = 0;
      this.FAlignWithMargins = false;
      this.FIsAligning = false;
      this.FParentFont = true;
      this.FParentBiDiMode = true;
      this.FParentColor = false;
      this.FAnchors = rtl.createSet(0,1);
      this.FShowFocus = false;
      this.FBorderWidth = 0;
      this.FEnablePropagation = false;
      this.FToolTip = null;
      this.FColor = 16711422;
      this.FMargins = $mod.TMargins.$create("Create$1");
      this.FMargins.FOnChange = rtl.createCallback(this,"DoMarginsChanged");
      this.FParent = null;
      this.FPrevParent = null;
      if (!(0 in this.FControlStyle)) this.ClearControls();
      this.CreateInitialize();
    };
    this.AddControlStyle = function (css) {
      var cssname = "";
      cssname = this.$classname;
      function writeStylesOnce(styleName, cssText) {
          var styleElement = document.getElementById(styleName);
          if (styleElement) {
               styleElement.innerHTML = cssText;
            return;
            }
          styleElement = document.createElement('style');
          styleElement.type = 'text/css';
          styleElement.id = styleName;
          styleElement.innerHTML = cssText;
          document.getElementsByTagName('head')[0].appendChild(styleElement);
      }
      writeStylesOnce(cssname,css);
    };
    this.AddControlLink = function (linkid, link) {
      function writeLinkOnce(linkName, linkText) {
          var linkElement = document.getElementById(linkName);
          if (linkElement)
            return;
          linkElement = document.createElement('link');
          linkElement.id = linkName;
          linkElement.setAttribute('rel', 'stylesheet');
          linkElement.setAttribute('type', 'text/css');
          linkElement.setAttribute('href', linkText);
          document.getElementsByTagName('head')[0].appendChild(linkElement);
      }
      writeLinkOnce(linkid,link);
    };
    this.ResetAnchoring = function () {
      this.FOrigRect.$assign(pas.Types.Rect(-1,-1,-1,-1));
      this.InitAnchoring();
    };
    this.UpdateSize = function () {
      var i = 0;
      this.UpdateElementSize();
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.GetControls(i).UpdateSize();
      };
    };
    this.UpdateAnchoring = function () {
      var dxr = 0;
      var dyr = 0;
      var dxo = 0;
      var dyo = 0;
      var dxw = 0;
      var dyw = 0;
      var br = pas.Types.TRect.$new();
      var r = pas.Types.TRect.$new();
      if (0 in this.FComponentState) return;
      if (!this.FControlCreated) return;
      if ((this.FOrigRect.Left === -1) && (this.FOrigRect.Top === -1)) this.InitAnchoring();
      if ((this.FParent != null) && !this.FParent.AnchoringInitialized()) return;
      if (this.FAlign !== 5) {
        if ((this.FParent != null) && !pas["WEBLib.Forms"].TForm.isPrototypeOf(this)) {
          r.$assign(this.FParent.GetBoundsRect());
          dxr = r.Right - r.Left - (this.FOrigParentRect.Right - this.FOrigParentRect.Left);
          dyr = r.Bottom - r.Top - (this.FOrigParentRect.Bottom - this.FOrigParentRect.Top);
          br.$assign(this.FOrigRect);
          dxo = 0;
          dyo = 0;
          dxw = 0;
          dyw = 0;
          if (2 in this.FAnchors) {
            if (0 in this.FAnchors) {
              dxw = dxr}
             else dxo = dxr;
          };
          if (3 in this.FAnchors) {
            if (1 in this.FAnchors) {
              dyw = dyr}
             else dyo = dyr;
          };
          if ((3 in this.FAnchors) || (2 in this.FAnchors)) {
            this.SetBoundsInt(br.Left + dxo,br.Top + dyo,(br.Right - br.Left) + dxw,(br.Bottom - br.Top) + dyw);
          };
        };
      };
      this.UpdateChildAnchoring();
    };
    this.UpdateChildAnchoring = function () {
      var i = 0;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.GetControls(i).UpdateAnchoring();
      };
    };
    this.SetElementPointer = function (AElement, ACursor) {
      if (ACursor !== 0) {
        AElement.style.setProperty("cursor",$mod.GetHTMLCursorName(ACursor))}
       else AElement.style.removeProperty("cursor");
    };
    this.GetWebClassName = function () {
      var Result = "";
      Result = this.$classname;
      pas.System.Delete({get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},1,1);
      Result = "TWeb" + Result;
      return Result;
    };
    this.GetCSSManager = function () {
      var Result = null;
      var frm = null;
      var i = 0;
      Result = null;
      frm = pas["WEBLib.Forms"].GetParentForm(this);
      if (frm != null) {
        for (var $l = 0, $end = frm.GetComponentCount() - 1; $l <= $end; $l++) {
          i = $l;
          if ($mod.TCSSCodeManager.isPrototypeOf(frm.GetComponent(i))) {
            Result = rtl.as(frm.GetComponent(i),$mod.TCSSCodeManager);
          };
        };
      };
      return Result;
    };
    this.IsUpdating = function () {
      var Result = false;
      Result = this.FUpdateCount > 0;
      return Result;
    };
    this.CanShowFocus = function () {
      var Result = false;
      Result = this.FShowFocus;
      return Result;
    };
    this.RequiredScriptLoaded = function (Event) {
      rtl.asExt(Event.target,HTMLScriptElement).title = "tmswebloaded";
      this.FControlScriptCountLoaded += 1;
    };
    this.InjectCSS = function () {
      var cssname = "";
      var css = "";
      var cssmgr = null;
      cssname = this.GetWebClassName();
      css = "";
      cssmgr = this.GetCSSManager();
      if (cssmgr != null) css = cssmgr.GetClassCSS(cssname);
      if (css !== "") this.AddControlStyle(css);
    };
    this.GetStyle = function (css) {
      var Result = "";
      var res = "";
      var el = null;
      el = this.GetElementHandle();
      res = "";
      if (!(el != null)) return Result;
      if (window.getComputedStyle) res = getComputedStyle(el, '')[css];
      if(el.currentStyle) res = el.currentStyle[css];
      Result = res;
      return Result;
    };
    this.SetBoundsInt = function (X, Y, AWidth, AHeight) {
      if ((X !== this.GetLeft()) || (Y !== this.GetTop()) || ((AWidth !== this.GetWidth()) && (this.FWidthStyle === 1)) || ((AHeight !== this.GetHeight()) && (this.FHeightStyle === 1)) || ((this.FParent != null) && this.FParent.GetIsLinked())) {
        this.FBlockUpdateElement = true;
        this.FLeft = X;
        this.FTop = Y;
        this.FWidth = AWidth;
        this.FHeight = AHeight;
        this.FBlockUpdateElement = false;
        this.UpdateElementSize();
        if (this.FAlign !== 0) {
          this.DoRealign()}
         else this.Realign();
        this.RecreateCanvas();
        this.DoBoundsChange();
        this.Invalidate();
        this.UpdateChildAnchoring();
      };
    };
    this.EnableDrag = function () {
      if (this.GetContainer() != null) this.GetContainer().setAttribute("draggable","true");
    };
    this.DisableDrag = function () {
      if ((this.GetContainer() != null) && (this.GetContainer().getAttribute("draggable") === "true")) this.GetContainer().setAttribute("draggable","false");
    };
    this.Create$2 = function (ID) {
      this.FGotFocus = false;
      this.FTabStop = true;
      this.FAllowTouch = true;
      this.CreateWithID(ID);
      return this;
    };
    this.Create$1 = function (AOwner) {
      var lName = "";
      var frm = null;
      var lDesign = false;
      this.FGotFocus = false;
      this.FEventsBound = false;
      this.FTabStop = true;
      this.FAllowTouch = true;
      this.FNoUserSelect = true;
      this.ClearMethodPointers();
      pas.Classes.TComponent.Create$1.call(this,AOwner);
      this.FEventStopPropagation = rtl.createSet(0,4,2,3,1,5,6,7);
      this.FScriptLoaded = false;
      this.FElementFont = 0;
      this.FElementPosition = 0;
      this.FParentElement = null;
      this.FTextDirection = 0;
      lDesign = false;
      frm = pas["WEBLib.Forms"].GetParentForm(this);
      if (frm != null) {
        lDesign = 4 in frm.FComponentState;
      };
      lName = this.GetNewName();
      if (lDesign) {
        this.CreateWithID("")}
       else this.CreateWithID(lName);
      if ((AOwner != null) && !(4 in AOwner.FComponentState)) this.SetName(lName);
      return this;
    };
    this.Destroy = function () {
      this.UnbindEvents();
      this.DestroyControls();
      if ((this.GetContainer() != null) && (this.FParent != null) && (this.FParent.GetChildContainer() != null)) {
        if (this.FParent.GetChildContainer() === this.GetContainer().parentNode) {
          this.FParent.GetChildContainer().removeChild(this.GetContainer());
        };
        this.FContainer = null;
        this.SetParent(null);
        this.FControlCreated = false;
      };
      rtl.free(this,"FRequiredScripts");
      rtl.free(this,"FMargins");
      rtl.free(this,"FFont");
      if (pas.System.Assigned(this.FToolTip)) {
        FToolTip.dispose();
        this.FToolTip = null;
      };
      pas.Classes.TComponent.Destroy.call(this);
    };
    this.Assign = function (Source) {
    };
    this.DragDrop = function (Source, X, Y) {
      if (this.FOnDragDrop != null) this.FOnDragDrop(this,Source,X,Y);
    };
    this.Resize = function () {
      if (this.FOnResize != null) this.FOnResize(this);
    };
    this.ReleaseCapture = function () {
      var eh = null;
      this.FCaptureDown = false;
      if (this.FCaptured && (this.FLayer != null)) {
        eh = this.FLayer;
        eh.removeEventListener("mouseenter",this.FLayerMouseEnterPtr);
        eh.removeEventListener("mouseleave",this.FLayerMouseLeavePtr);
        eh.removeEventListener("mousedown",this.FMouseDownPtr);
        eh.removeEventListener("mouseup",this.FMouseUpPtr);
        eh.removeEventListener("mousemove",this.FMouseMovePtr);
        eh.removeEventListener("touchstart",this.FTouchStartPtr);
        eh.removeEventListener("touchmove",this.FTouchMovePtr);
        eh.removeEventListener("touchend",this.FTouchEndPtr);
        eh.removeEventListener("touchcancel",this.FTouchEndPtr);
        document.body.removeChild(eh);
        this.FCaptured = false;
        this.FLayer = null;
        this.UpdateElement();
      };
    };
    this.PreventDefault = function () {
      if (this.GetElementEvent() != null) this.GetElementEvent().preventDefault();
    };
    this.StopPropagation = function () {
      if ((this.GetElementEvent() != null) && !this.FEnablePropagation) this.GetElementEvent().stopPropagation();
    };
    this.BeginDrag = function () {
      this.EnableDrag();
    };
    this.BeginUpdate = function () {
      this.FUpdateCount += 1;
    };
    this.EndUpdate = function () {
      if (this.FUpdateCount > 0) {
        this.FUpdateCount -= 1;
        if (this.FUpdateCount === 0) this.UpdateElement();
      };
    };
    this.Invalidate = function () {
    };
    this.SetParentComponent = function (Value) {
      if ((this.FParent !== Value) && $mod.TControl.isPrototypeOf(Value)) this.SetParent(Value);
    };
    this.XYToClient = function (X, Y, AClientX, AClientY) {
      var p = null;
      var cr = null;
      var el = null;
      var OrigX = 0.0;
      var OrigY = 0.0;
      var norel = false;
      var formcont = false;
      var r = pas.Types.TRect.$new();
      var cs = null;
      var csx = 0;
      var csy = 0;
      var scrollx = 0;
      var scrolly = 0;
      norel = true;
      formcont = false;
      scrollx = 0;
      scrolly = 0;
      if (this.FElementPosition === 0) {
        scrollx = document.body.scrollLeft + document.documentElement.scrollLeft;
        scrolly = document.body.scrollTop + document.documentElement.scrollTop;
        OrigX = X - this.GetLeft();
        OrigY = Y - this.GetTop();
      } else {
        norel = false;
        cr = this.GetElementHandle().getBoundingClientRect();
        OrigX = X - cr.left;
        OrigY = Y - cr.top;
        AClientX.set(OrigX);
        AClientY.set(OrigY);
        return;
      };
      AClientX.set(OrigX);
      AClientY.set(OrigY);
      p = this.FParent;
      if (pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(this) && !(p != null) && (this.GetContainer() != null)) {
        cr = this.GetContainer().getBoundingClientRect();
        AClientX.set(AClientX.get() - cr.left);
        AClientY.set(AClientY.get() - cr.top);
      };
      while (p != null) {
        if (p.GetIsLinked()) {
          if (pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(p)) {
            cr = p.GetContainer().getBoundingClientRect()}
           else cr = p.GetElementHandle().getBoundingClientRect();
          AClientX.set(AClientX.get() - cr.left);
          AClientY.set(AClientY.get() - cr.top);
          AClientX.set(AClientX.get() + p.GetElementHandle().scrollLeft);
          AClientY.set(AClientY.get() + p.GetElementHandle().scrollTop);
          scrollx = 0;
          scrolly = 0;
        } else if (pas["WEBLib.Forms"].TCustomForm.isPrototypeOf(p)) {
          if (rtl.as(p,pas["WEBLib.Forms"].TCustomForm).FFormContainer !== "") {
            el = document.getElementById(rtl.as(p,pas["WEBLib.Forms"].TCustomForm).FFormContainer);
            if (el != null) {
              formcont = true;
              cr = el.getBoundingClientRect();
              AClientX.set(AClientX.get() - cr.left);
              AClientY.set(AClientY.get() - cr.top);
            };
          };
          if ((rtl.as(p,pas["WEBLib.Forms"].TCustomForm).GetContainer() != null) && (rtl.as(p,pas["WEBLib.Forms"].TCustomForm).FFormContainer === "") && rtl.as(p,pas["WEBLib.Forms"].TCustomForm).FPopup) {
            cr = rtl.as(p,pas["WEBLib.Forms"].TCustomForm).GetContainer().getBoundingClientRect();
            AClientX.set(AClientX.get() - cr.left);
            AClientY.set(AClientY.get() - cr.top);
            r.$assign(rtl.as(p,pas["WEBLib.Forms"].TCustomForm).GetClientRect());
            AClientY.set(AClientY.get() + r.Top);
            scrollx = 0;
            scrolly = 0;
          };
        } else if (p.FElementPosition in rtl.createSet(1,2)) {
          if (p.GetElementHandle() != null) {
            cr = p.GetElementHandle().getBoundingClientRect();
            AClientX.set(OrigX - cr.left);
            AClientY.set(OrigY - cr.top);
            scrollx = 0;
            scrolly = 0;
            if (norel) {
              cs = window.getComputedStyle(document.documentElement);
              csx = parseInt(cs.marginLeft,10);
              csy = parseInt(cs.marginTop,10);
              AClientX.set(AClientX.get() + csx);
              AClientY.set(AClientY.get() + csy);
            };
            norel = false;
            break;
          };
        } else if ((p.FElementPosition === 0) && norel) {
          AClientX.set(AClientX.get() - p.GetLeft());
          AClientY.set(AClientY.get() - p.GetTop());
          if (p.GetElementHandle() != null) {
            AClientX.set(AClientX.get() + p.GetElementHandle().scrollLeft);
            AClientY.set(AClientY.get() + p.GetElementHandle().scrollTop);
          };
          OrigX = AClientX.get();
          OrigY = AClientY.get();
        };
        p = p.FParent;
      };
      if ((this.FElementPosition === 0) && !formcont) {
        AClientX.set(AClientX.get() + scrollx);
        AClientY.set(AClientY.get() + scrolly);
      };
    };
    this.Captured = function () {
      var Result = false;
      Result = this.FCaptured && (this.FLayer != null);
      return Result;
    };
    this.CanFocus = function () {
      var Result = false;
      Result = true;
      return Result;
    };
    this.HasHorzScrollBar = function () {
      var Result = false;
      Result = false;
      if (this.GetElementHandle() != null) Result = this.GetElementHandle().clientWidth < this.GetElementHandle().scrollWidth;
      return Result;
    };
    this.HasVertScrollBar = function () {
      var Result = false;
      Result = false;
      if (this.GetElementHandle() != null) Result = this.GetElementHandle().clientHeight < this.GetElementHandle().scrollHeight;
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TWinControl",this.TControl,function () {
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Cursor",2,$mod.$rtti["TCursor"],"FCursor","SetControlCursor",{Default: 0});
    $r.addProperty("ElementClassName",2,$mod.$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight");
    $r.addProperty("Hint",2,rtl.string,"FHint","SetHint");
    $r.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft");
    $r.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default: false});
    $r.addProperty("Tag",0,rtl.longint,"FTag$1","FTag$1",{Default: 0});
    $r.addProperty("Top",3,rtl.longint,"GetTop","SetTop");
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth");
    $r.addProperty("OnMouseDown",0,$mod.$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseUp",0,$mod.$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseMove",0,$mod.$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseEnter",0,$mod.$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnMouseLeave",0,$mod.$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnKeyUp",0,$mod.$rtti["TKeyEvent"],"FOnKeyUp","FOnKeyUp");
    $r.addProperty("OnKeyDown",0,$mod.$rtti["TKeyEvent"],"FOnKeyDown","FOnKeyDown");
    $r.addProperty("OnKeyPress",0,$mod.$rtti["TKeyPressEvent"],"FOnKeyPress","FOnKeyPress");
    $r.addProperty("OnEnter",0,$mod.$rtti["TNotifyEvent"],"FOnEnter","FOnEnter");
    $r.addProperty("OnExit",0,$mod.$rtti["TNotifyEvent"],"FOnExit","FOnExit");
  });
  rtl.createClass(this,"TCustomControl",this.TWinControl,function () {
    this.$init = function () {
      $mod.TWinControl.$init.call(this);
      this.FCaption = "";
      this.FPixelRatio = 0.0;
      this.FPainting = false;
      this.FCanvas = null;
      this.FElementCanvas = null;
      this.FBorderStyle = 0;
      this.FBorderColor = 0;
      this.FCustomBorder = false;
    };
    this.$final = function () {
      this.FCanvas = undefined;
      this.FElementCanvas = undefined;
      $mod.TWinControl.$final.call(this);
    };
    this.RenderDesigning = function (ACaption, AElement, AControl, ADisplay, AImage) {
      var LContainer = null;
      var LLabel = null;
      var LDiv = null;
      var LHasLabel = false;
      LContainer = AElement;
      LLabel = LContainer.firstChild;
      LHasLabel = (LLabel != null) && (LLabel.tagName === "DIV") && (LLabel.getAttribute("data-design") === "1");
      if ((4 in AControl.FComponentState) && ADisplay && (this.FElementClassName === "")) {
        LContainer.style.setProperty("border","1px solid gray");
        if (AImage === "") {
          LContainer.style.setProperty("background-color","#F0F0F0")}
         else LContainer.style.setProperty("background-color","white");
        if (LHasLabel) return;
        LContainer.innerHTML = "";
        if (AImage !== "") {
          LDiv = document.createElement("DIV");
          LDiv.style.setProperty("background-color","white");
          LDiv.style.setProperty("background-repeat","no-repeat");
          LDiv.style.setProperty("background-position-y","center");
          LDiv.style.setProperty("background-image","url(" + AImage + ")");
          LDiv.style.setProperty("background-position-x","center");
          LDiv.style.setProperty("background-size","128px");
          LDiv.style.setProperty("top","50%");
          LDiv.style.setProperty("left","50%");
          LDiv.style.setProperty("height","70%");
          LContainer.appendChild(LDiv);
        };
        LLabel = document.createElement("DIV");
        LLabel.setAttribute("data-design","1");
        LLabel.innerHTML = ACaption;
        LLabel.style.setProperty("position","relative");
        LLabel.style.setProperty("top","50%");
        LLabel.style.setProperty("left","50%");
        LLabel.style.setProperty("display","inline-block");
        LLabel.style.setProperty("transform","translateX(-50%)");
        this.FCustomBorder = true;
        LContainer.appendChild(LLabel);
      } else {
        if (LHasLabel) {
          while (LContainer.firstChild != null) LContainer.removeChild(LContainer.firstChild);
          LContainer.style.removeProperty("border");
          LContainer.style.removeProperty("background-color");
        };
      };
    };
    this.GetPixelRatio = function () {
      var Result = 0.0;
      var res = 0.0;
      var ctx = document.createElement("canvas").getContext("2d"),
          dpr = window.devicePixelRatio || 1,
          bsr = ctx.webkitBackingStorePixelRatio ||
                ctx.mozBackingStorePixelRatio ||
                ctx.msBackingStorePixelRatio ||
                ctx.oBackingStorePixelRatio ||
                ctx.backingStorePixelRatio || 1;
      res = dpr / bsr;
      Result = res;
      return Result;
    };
    this.RecreateCanvas = function () {
      var px = 0.0;
      var el = null;
      var h = 0;
      var w = 0;
      if (this.FElementCanvas != null) {
        if (!this.FPainting) {
          if (this.GetIsLinked()) {
            el = this.GetElementHandle();
          } else el = document.getElementById(this.GetID() + "_Canvas");
          if (el != null) {
            this.FElementCanvas = el;
            rtl.free(this,"FCanvas");
            this.FCanvas = null;
          };
          px = this.GetPixelRatio();
          h = this.GetHeight() - this.GetCanvasHeightOffset();
          w = this.GetWidth() - this.GetCanvasWidthOffset();
          if (this.FElementPosition === 1) {
            this.FElementCanvas.style.setProperty("position","relative")}
           else this.FElementCanvas.style.setProperty("position","absolute");
          this.FElementCanvas.style.setProperty("height",pas.SysUtils.IntToStr(h) + "px");
          this.FElementCanvas.style.setProperty("width",pas.SysUtils.IntToStr(w) + "px");
          this.FElementCanvas.height = Math.round(h * px);
          this.FElementCanvas.width = Math.round(w * px);
        };
        if (!(this.FCanvas != null)) {
          this.FCanvas = pas["WEBLib.Graphics"].TCanvas.$create("Create$1",[this.FElementCanvas]);
        };
        this.FCanvas.FApplyPixelRatio = true;
        this.FCanvas.SetTransform(1,0,0,1,0,0);
      };
    };
    this.SetBorderStyle = function (AValue) {
      if (this.FBorderStyle !== AValue) {
        this.FBorderStyle = AValue;
        this.UpdateElement();
      };
    };
    this.SetBorderColor = function (AValue) {
      if (this.FBorderColor !== AValue) {
        this.FBorderColor = AValue;
        this.UpdateElement();
      };
    };
    this.SetName = function (NewName) {
      var cs = {};
      var ownername = "";
      ownername = "";
      if (!((pas["WEBLib.Forms"].VSIDE != null) && (4 in this.FComponentState))) {
        if (pas["WEBLib.Forms"].TFrame.isPrototypeOf(this)) {
          ownername = "F" + $mod.FindUniqueName(this.FName) + "_";
        };
      };
      pas.Classes.TComponent.SetName.call(this,ownername + NewName);
      if ((1 in this.FControlStyle) && (4 in this.FComponentState) && !(0 in this.FComponentState)) {
        if ((this.FOwner != null) && (0 in this.FOwner.FComponentState)) return;
        cs = rtl.refSet(this.FControlStyle);
        this.SetCaption(NewName);
        this.FControlStyle = rtl.refSet(cs);
      };
    };
    this.SetCaption = function (AValue) {
      this.FCaption = AValue;
      this.FControlStyle = rtl.diffSet(this.FControlStyle,rtl.createSet(1));
    };
    this.CreateControl = function () {
      $mod.TControl.CreateControl.call(this);
      this.RecreateCanvas();
    };
    this.Loaded = function () {
      $mod.TControl.Loaded.call(this);
      this.Invalidate();
    };
    this.UpdateElementVisual = function () {
      $mod.TControl.UpdateElementVisual.call(this);
      if (this.GetElementHandle() != null) {
        if (!this.GetIsLinked() && (this.FElementClassName === "")) {
          if (this.FBorderStyle === 1) {
            if (this.FCustomBorder) {
              this.GetElementStyle().setProperty("border-style","solid");
              this.GetElementStyle().setProperty("border-width","1px");
              this.GetElementStyle().setProperty("border-color",pas["WEBLib.Graphics"].ColorToHTML(this.FBorderColor));
            } else this.GetElementStyle().setProperty("border-style","");
          } else this.GetElementStyle().setProperty("border-style","none");
        };
        if (this.FElementClassName !== "") {
          this.GetElementStyle().removeProperty("border-style");
          this.GetElementStyle().removeProperty("border-width");
          this.GetElementStyle().removeProperty("border-color");
        };
      };
    };
    this.CreateElement = function () {
      var Result = null;
      this.FElementCanvas = document.createElement("CANVAS");
      if (0 in this.FControlStyle) {
        Result = document.createElement("SPAN");
        Result.appendChild(this.FElementCanvas);
        if (this.GetID() !== "") this.FElementCanvas.setAttribute("id",this.GetID() + "_Canvas");
        this.FElementCanvas.setAttribute("zindex","-1");
      } else Result = this.FElementCanvas;
      return Result;
    };
    this.GetCanvasHeightOffset = function () {
      var Result = 0;
      Result = 0;
      return Result;
    };
    this.GetCanvasWidthOffset = function () {
      var Result = 0;
      Result = 0;
      return Result;
    };
    this.BindElement = function () {
      if ((this.GetContainer().tagName !== "CANVAS") && !this.FControlCreated) {
        this.FElementCanvas = document.createElement("CANVAS");
        this.GetContainer().appendChild(this.FElementCanvas);
      };
    };
    this.BindEvents = function () {
      $mod.TControl.BindEvents.call(this);
    };
    this.Paint = function () {
    };
    this.CreateInitialize = function () {
      $mod.TControl.CreateInitialize.call(this);
      this.FControlStyle = rtl.unionSet(this.FControlStyle,rtl.createSet(1));
      this.FBorderStyle = 1;
      this.FBorderColor = 12632256;
      this.FPainting = false;
      this.FWidth = 100;
      this.FHeight = 25;
      this.FWidthPercent = 100;
      this.FHeightPercent = 100;
      this.FCustomBorder = false;
    };
    this.Destroy = function () {
      if (this.FCanvas != null) rtl.free(this,"FCanvas");
      $mod.TControl.Destroy.call(this);
    };
    this.Resize = function () {
      $mod.TControl.Resize.call(this);
      this.Invalidate();
    };
    this.Invalidate = function () {
      var px = 0.0;
      var frm = null;
      $mod.TControl.Invalidate.call(this);
      if ((this.FParent === null) || (3 in this.FComponentState)) return;
      if (!this.FVisible) return;
      if (this.FUpdateCount > 0) return;
      frm = pas["WEBLib.Forms"].GetParentForm(this);
      if (frm != null) if (frm.IsUpdating()) return;
      px = this.GetPixelRatio();
      if (px !== this.FPixelRatio) this.RecreateCanvas();
      this.FPixelRatio = this.GetPixelRatio();
      this.FPainting = true;
      if (this.FCanvas != null) this.FCanvas.Clear();
      this.Paint();
      this.FPainting = false;
    };
    this.SetFocus = function () {
      $mod.TControl.SetFocus.call(this);
    };
    this.Focused = function () {
      var Result = false;
      Result = $mod.TControl.Focused.call(this);
      return Result;
    };
    this.EndUpdate = function () {
      $mod.TControl.EndUpdate.call(this);
      if (this.FUpdateCount === 0) this.Invalidate();
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TCustomHTMLDiv",this.TCustomControl,function () {
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("DIV");
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TControlManager",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FInstanceCount = 0;
    };
    this.Create$1 = function (AOwner) {
      pas.Classes.TComponent.Create$1.apply(this,arguments);
      this.FInstanceCount = 0;
      return this;
    };
    this.GetInstanceNumber = function () {
      var Result = 0;
      this.FInstanceCount += 1;
      Result = this.FInstanceCount;
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TCSSCodeFragment",pas.Classes.TCollectionItem,function () {
    this.$init = function () {
      pas.Classes.TCollectionItem.$init.call(this);
      this.FControlClassname = "";
      this.FCSS = null;
    };
    this.$final = function () {
      this.FCSS = undefined;
      pas.Classes.TCollectionItem.$final.call(this);
    };
    this.SetCSS = function (Value) {
      this.FCSS.Assign(Value);
    };
    this.Create$1 = function (Collection) {
      pas.Classes.TCollectionItem.Create$1.apply(this,arguments);
      this.FCSS = pas.Classes.TStringList.$create("Create$1");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FCSS");
      pas.Classes.TCollectionItem.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.addProperty("ControlClassname",0,rtl.string,"FControlClassname","FControlClassname");
    $r.addProperty("CSS",2,pas.Classes.$rtti["TStringList"],"FCSS","SetCSS");
  });
  rtl.createClass(this,"TCSSCodeFragments",pas.Classes.TOwnedCollection,function () {
    this.GetItemEx = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
    this.Create$3 = function (AOwner) {
      pas.Classes.TOwnedCollection.Create$2.call(this,AOwner,$mod.TCSSCodeFragment);
      return this;
    };
  });
  rtl.createClass(this,"TCSSCodeManager",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FCSSFragments = null;
    };
    this.$final = function () {
      this.FCSSFragments = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.SetCSSFragments = function (Value) {
      this.FCSSFragments.Assign(Value);
    };
    this.Create$1 = function (AOwner) {
      pas.Classes.TComponent.Create$1.apply(this,arguments);
      this.FCSSFragments = $mod.TCSSCodeFragments.$create("Create$3",[this]);
      this.FCSSFragments.FPropName = "CSSFragments";
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FCSSFragments");
      pas.Classes.TComponent.Destroy.call(this);
    };
    this.GetClassFragment = function (AClassname) {
      var Result = null;
      var i = 0;
      Result = null;
      for (var $l = 0, $end = this.FCSSFragments.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (this.FCSSFragments.GetItemEx(i).FControlClassname === AClassname) Result = this.FCSSFragments.GetItemEx(i);
      };
      return Result;
    };
    this.GetClassCSS = function (AClassname) {
      var Result = "";
      var CSSCodeFragment = null;
      Result = "";
      CSSCodeFragment = this.GetClassFragment(AClassname);
      if (CSSCodeFragment != null) Result = CSSCodeFragment.FCSS.GetTextStr();
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("CSSFragments",2,$mod.$rtti["TCSSCodeFragments"],"FCSSFragments","SetCSSFragments");
  });
  this.FindUniqueName = function (Name) {
    var Result = "";
    Result = Name + pas.SysUtils.IntToStr($impl.ControlManager.GetInstanceNumber());
    return Result;
  };
  this.GetScrollBarHeight = function () {
    var Result = 0;
    var res = 0;
    res = $impl.ScrollBH;
    if (res === 0) {
      var outer = document.createElement("div");
            outer.style.visibility = "hidden";
            outer.style.height = "100px";
            outer.style.msOverflowStyle = "scrollbar"; // needed for WinJS apps
      
            document.body.appendChild(outer);
      
            var HeightNoScroll = outer.offsetHeight;
            // force scrollbars
            outer.style.overflow = "scroll";
      
            // add innerdiv
            var inner = document.createElement("div");
            inner.style.height = "100%";
            outer.appendChild(inner);
      
            var HeightWithScroll = inner.offsetHeight;
      
            // remove divs
            outer.parentNode.removeChild(outer);
      
            res = HeightNoScroll - HeightWithScroll;
      
            res = 0;
      $impl.ScrollBH = res;
    };
    Result = res;
    return Result;
  };
  this.GetScrollBarWidth = function () {
    var Result = 0;
    var res = 0;
    res = $impl.ScrollBW;
    if (res === 0) {
      var outer = document.createElement("div");
            outer.style.visibility = "hidden";
            outer.style.width = "100px";
            outer.style.msOverflowStyle = "scrollbar"; // needed for WinJS apps
      
            document.body.appendChild(outer);
      
            var widthNoScroll = outer.offsetWidth;
            // force scrollbars
            outer.style.overflow = "scroll";
      
            // add innerdiv
            var inner = document.createElement("div");
            inner.style.width = "100%";
            outer.appendChild(inner);
      
            var widthWithScroll = inner.offsetWidth;
      
            // remove divs
            outer.parentNode.removeChild(outer);
      
            res = widthNoScroll - widthWithScroll;
      $impl.ScrollBW = res;
    };
    Result = res;
    return Result;
  };
  this.SetHTMLElementFont = function (AElement, AFont, UseCSS) {
    var s = "";
    if (UseCSS) {
      AElement.style.removeProperty("font-family");
      AElement.style.removeProperty("font-style");
      AElement.style.removeProperty("font-weight");
      AElement.style.removeProperty("font-size");
      AElement.style.removeProperty("text-decoration");
    } else {
      AElement.style.setProperty("font-family",AFont.FName);
      AElement.style.setProperty("font-style","normal");
      if (0 in AFont.FStyle) {
        AElement.style.setProperty("font-weight","bold")}
       else AElement.style.setProperty("font-weight","");
      if (1 in AFont.FStyle) AElement.style.setProperty("font-style","italic");
      s = "";
      if (3 in AFont.FStyle) s = "underline";
      if (2 in AFont.FStyle) {
        if (s !== "") s = s + " ";
        s = s + "line-through";
      };
      if (s !== "") {
        AElement.style.setProperty("text-decoration",s)}
       else AElement.style.removeProperty("text-decoration");
      if (AFont.FSize !== 0) AElement.style.setProperty("font-size",pas.SysUtils.IntToStr(AFont.FSize) + "pt");
    };
  };
  this.SetHTMLElementColor = function (AElement, AColor, UseCSS) {
    if (UseCSS || (AColor === -1) || (AColor === 16711422)) {
      AElement.style.removeProperty($impl.cStyleBkgColor)}
     else AElement.style.setProperty($impl.cStyleBkgColor,pas["WEBLib.Graphics"].ColorToHTML(AColor));
  };
  this.GetHTMLCursorName = function (ACursor) {
    var Result = "";
    Result = "default";
    var $tmp = ACursor;
    if ($tmp === 0) {
      Result = "default"}
     else if ($tmp === 2) {
      Result = "auto"}
     else if ($tmp === 1) {
      Result = "none"}
     else if ($tmp === 3) {
      Result = "crosshair"}
     else if ($tmp === 4) {
      Result = "text"}
     else if ($tmp === 6) {
      Result = "nesw-resize"}
     else if ($tmp === 7) {
      Result = "ns-resize"}
     else if ($tmp === 8) {
      Result = "nwse-resize"}
     else if ($tmp === 9) {
      Result = "ew-resize"}
     else if ($tmp === 10) {
      Result = "n-resize"}
     else if ($tmp === 11) {
      Result = "wait"}
     else if ($tmp === 12) {
      Result = "copy"}
     else if ($tmp === 13) {
      Result = "no-drop"}
     else if ($tmp === 14) {
      Result = "col-resize"}
     else if ($tmp === 15) {
      Result = "row-resize"}
     else if ($tmp === 16) {
      Result = "copy"}
     else if ($tmp === 17) {
      Result = "progress"}
     else if ($tmp === 18) {
      Result = "not-allowed"}
     else if ($tmp === 19) {
      Result = "progress"}
     else if ($tmp === 20) {
      Result = "help"}
     else if ($tmp === 21) {
      Result = "pointer"}
     else if (($tmp === 22) || ($tmp === 5)) Result = "move";
    return Result;
  };
  this.GetHTMLElementAbsoluteRect = function (AElement) {
    var Result = pas.Types.TRect.$new();
    var s = "";
    function GetInt(AValue) {
      var Result = 0;
      var e = 0;
      AValue = pas.SysUtils.StringReplace(AValue,"px","",rtl.createSet(0));
      pas.System.val$6(AValue,{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }},{get: function () {
          return e;
        }, set: function (v) {
          e = v;
        }});
      return Result;
    };
    s = AElement.style.getPropertyValue("left");
    Result.Left = GetInt(s);
    s = AElement.style.getPropertyValue("top");
    Result.Top = GetInt(s);
    s = AElement.style.getPropertyValue("width");
    Result.Right = Result.Left + GetInt(s);
    s = AElement.style.getPropertyValue("height");
    Result.Bottom = Result.Top + GetInt(s);
    return Result;
  };
  this.IsAndroid = function () {
    var Result = false;
    var sagent = "";
    sagent = navigator.userAgent;
    Result = pas.System.Pos("Android",sagent) > 0;
    return Result;
  };
  this.GetMaterialClass = function (mg) {
    var Result = "";
    Result = "material-icons";
    var $tmp = mg;
    if ($tmp === 1) {
      Result = "material-icons-outlined"}
     else if ($tmp === 2) {
      Result = "material-icons-two-tone"}
     else if ($tmp === 3) {
      Result = "material-icons-round"}
     else if ($tmp === 4) Result = "material-icons-sharp";
    return Result;
  };
  $mod.$implcode = function () {
    $impl.ControlManager = null;
    $impl.FMouseX = 0;
    $impl.FMouseY = 0;
    $impl.FCursorX = 0;
    $impl.FCursorY = 0;
    $impl.ScrollBW = 0;
    $impl.ScrollBH = 0;
    $impl.DragObject = null;
    $impl.cStyleBkgColor = "background-color";
  };
  $mod.$init = function () {
    $impl.ScrollBW = 0;
    $impl.ScrollBH = 0;
    $impl.DragObject = null;
    $impl.ControlManager = $mod.TControlManager.$create("Create$1",[null]);
  };
},["WEBLib.Dialogs","WEBLib.Forms","Math","TypInfo","WEBLib.WebTools","WEBLib.Utils"]);
rtl.module("WEBLib.WebTools",["System","Classes","Web","JS","WEBLib.Controls","WEBLib.Graphics"],function () {
  "use strict";
  var $mod = this;
  this.cBodyTag = "body";
  this.cHTMLExt = ".html";
  this.DoubleToHTML = function (d) {
    var Result = "";
    Result = pas.SysUtils.Format$1("%g",pas.System.VarRecs(3,d),pas.SysUtils.TFormatSettings.Invariant());
    return Result;
  };
  this.GetQueryParam = function (AName) {
    var Result = "";
    var res = "";
    $mod.HasQueryParam(AName,{get: function () {
        return res;
      }, set: function (v) {
        res = v;
      }});
    Result = res;
    return Result;
  };
  this.HasQueryParam = function (AName, AValue) {
    var Result = false;
    var found = false;
    var s = "";
    s = "";
    var query = window.location.search.substring(1);
    var res = "";
    found = false;
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
       var pair = vars[i].split('=');
      if (decodeURIComponent(pair[0]) == AName) {
          res = decodeURIComponent(pair[1]);
          found = true;
       }
    }
    s = res;
    AValue.set(s);
    Result = found;
    return Result;
  };
  this.GetLocaleShortDateFormat = function (ALocale) {
    var Result = "";
    Result = pas.SysUtils.TFormatSettings.Create$1(ALocale).ShortDateFormat;
    return Result;
  };
  this.GetLocaleLongDayName = function (DayOfWeek, ALocale) {
    var Result = "";
    var res = "";
    var baseDate = new Date(2017, 0, 1); // Sunday
        baseDate.setDate(baseDate.getDate() + DayOfWeek - 1);
    
        var loc = "";
        if (ALocale == '') { loc = navigator.language; }
        else { loc = ALocale; }
    
        res = baseDate.toLocaleDateString(loc, { weekday: 'long' });
    Result = res;
    return Result;
  };
  this.GetLocaleShortDayName = function (DayOfWeek, ALocale) {
    var Result = "";
    var res = "";
    var baseDate = new Date(2017, 0, 1); // Sunday
        baseDate.setDate(baseDate.getDate() + DayOfWeek - 1);
    
        var loc = "";
        if (ALocale == '') { loc = navigator.language; }
        else { loc = ALocale; }
    
        res = baseDate.toLocaleDateString(loc, { weekday: 'short' });
    Result = res;
    return Result;
  };
  this.GetLocaleLongMonthName = function (Month, ALocale) {
    var Result = "";
    var res = "";
    var baseDate = new Date(2017, Month - 1, 1);
    
        var loc = "";
        if (ALocale == '') { loc = navigator.language; }
        else { loc = ALocale; }
    
        res = baseDate.toLocaleDateString(loc, { month: 'long' });
    Result = res;
    return Result;
  };
  this.GetLocaleShortMonthName = function (Month, ALocale) {
    var Result = "";
    var res = "";
    var baseDate = new Date(2017, Month - 1, 1);
    
        var loc = "";
        if (ALocale == '') { loc = navigator.language; }
        else { loc = ALocale; }
    
        res = baseDate.toLocaleDateString(loc, { month: 'short' });
    Result = res;
    return Result;
  };
  this.GetLocaleDecimalSeparator = function (ALocale) {
    var Result = "";
    var res = "";
    var n = 1.1;
        var loc = "";
        if (ALocale == '') { loc = navigator.language; }
        else { loc = ALocale; }
    
        n = n.toLocaleString(loc).substring(1, 2);
        res = n;
    Result = res;
    return Result;
  };
  this.GetBrowserLocale = function () {
    var Result = "";
    var res = "";
    res = navigator.language;
    Result = res;
    return Result;
  };
  this.ProcessAccelerator = function (AValue, Accelerator) {
    var Result = "";
    var i = 0;
    var l = 0;
    var res = "";
    l = AValue.length;
    Accelerator.set("");
    res = "";
    i = 1;
    while (i <= l) {
      if (AValue.charAt(i - 1) === "&") {
        if (((i + 1) <= l) && (AValue.charAt((i + 1) - 1) !== "&")) {
          res = res + "<u>" + AValue.charAt((i + 1) - 1) + "</u>";
          Accelerator.set(AValue.charAt((i + 1) - 1));
        } else if (((i + 1) <= l) && (AValue.charAt((i + 1) - 1) === "&")) res = res + "&";
        i += 2;
      } else {
        res = res + AValue.charAt(i - 1);
        i += 1;
      };
    };
    Result = res;
    return Result;
  };
  this.HTMLToString = function (s) {
    var Result = "";
    s = pas.SysUtils.StringReplace(s,"<","&lt;",rtl.createSet(0));
    Result = pas.SysUtils.StringReplace(s,">","&gt;",rtl.createSet(0));
    return Result;
  };
  this.ElementVisible = function (el) {
    var Result = false;
    var p = null;
    Result = false;
    p = el;
    while (p != null) {
      if (pas.SysUtils.LowerCase(p.tagName) === $mod.cBodyTag) Result = true;
      p = p.parentElement;
    };
    if (!Result) return Result;
    while (el != null) {
      if (el.style.getPropertyValue("display") === "none") {
        Result = false;
        return Result;
      };
      p = el.parentElement;
      if (!rtl.isExt(p,HTMLElement)) return Result;
      el = p;
    };
    return Result;
  };
},["SysUtils","WEBLib.Utils"]);
rtl.module("contnrs",["System","SysUtils","Classes"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  rtl.createClass(this,"TFPObjectList",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FFreeObjects = false;
      this.FList = null;
    };
    this.$final = function () {
      this.FList = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.GetCount = function () {
      var Result = 0;
      Result = this.FList.FCount;
      return Result;
    };
    this.GetItem = function (Index) {
      var Result = null;
      Result = rtl.getObject(this.FList.Get(Index));
      return Result;
    };
    this.SetItem = function (Index, AObject) {
      var O = null;
      if (this.FFreeObjects) {
        O = rtl.getObject(this.FList.Get(Index));
        this.FList.Put(Index,AObject);
        O = rtl.freeLoc(O);
      } else this.FList.Put(Index,AObject);
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FList = pas.Classes.TFPList.$create("Create");
      this.FFreeObjects = true;
      return this;
    };
    this.Create$2 = function (FreeObjects) {
      this.Create$1();
      this.FFreeObjects = FreeObjects;
      return this;
    };
    this.Destroy = function () {
      if (this.FList !== null) {
        this.Clear();
        this.FList.$destroy("Destroy");
      };
      pas.System.TObject.Destroy.call(this);
    };
    this.Clear = function () {
      var i = 0;
      var O = null;
      if (this.FFreeObjects) for (var $l = this.FList.FCount - 1; $l >= 0; $l--) {
        i = $l;
        O = rtl.getObject(this.FList.Get(i));
        this.FList.Put(i,null);
        O = rtl.freeLoc(O);
      };
      this.FList.Clear();
    };
    this.Add = function (AObject) {
      var Result = 0;
      Result = this.FList.Add(AObject);
      return Result;
    };
  });
  rtl.createClass(this,"TObjectList",pas.Classes.TList,function () {
    this.$init = function () {
      pas.Classes.TList.$init.call(this);
      this.FFreeObjects = false;
    };
    this.Notify = function (Ptr, Action) {
      var O = null;
      if (this.FFreeObjects) if (Action === 2) {
        O = rtl.getObject(Ptr);
        O = rtl.freeLoc(O);
      };
      pas.Classes.TList.Notify.call(this,Ptr,Action);
    };
    this.GetItem = function (Index) {
      var Result = null;
      Result = rtl.getObject(pas.Classes.TList.Get.call(this,Index));
      return Result;
    };
    this.Create$2 = function () {
      pas.Classes.TList.Create$1.call(this);
      this.FFreeObjects = true;
      return this;
    };
    this.Create$3 = function (FreeObjects) {
      pas.Classes.TList.Create$1.call(this);
      this.FFreeObjects = FreeObjects;
      return this;
    };
    this.Add$1 = function (AObject) {
      var Result = 0;
      Result = pas.Classes.TList.Add.call(this,AObject);
      return Result;
    };
    this.IndexOf$1 = function (AObject) {
      var Result = 0;
      Result = pas.Classes.TList.IndexOf.call(this,AObject);
      return Result;
    };
  });
  rtl.createClass(this,"THTCustomNode",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FKey = "";
    };
    this.CreateWith = function (AString) {
      pas.System.TObject.Create.call(this);
      this.FKey = AString;
      return this;
    };
  });
  rtl.createClass(this,"TFPCustomHashTable",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FHashTable = null;
      this.FHashFunction = null;
      this.FCount = 0;
      this.FHashTableSize = 0;
    };
    this.$final = function () {
      this.FHashTable = undefined;
      this.FHashFunction = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.SetHashTableSize = function (Value) {
      var i = 0;
      var newSize = 0;
      if (Value !== this.FHashTableSize) {
        i = 0;
        while (($impl.PRIMELIST[i] < Value) && (i < 27)) i += 1;
        newSize = $impl.PRIMELIST[i];
        if (this.FCount === 0) {
          this.FHashTableSize = newSize;
          this.InitializeHashTable();
        } else this.ChangeTableSize(newSize);
      };
    };
    this.InitializeHashTable = function () {
      var i = 0;
      if (this.FHashTableSize > 0) for (var $l = 0, $end = this.FHashTableSize - 1; $l <= $end; $l++) {
        i = $l;
        this.FHashTable.Add(null);
      };
      this.FCount = 0;
    };
    this.Chain = function (index) {
      var Result = null;
      Result = this.FHashTable.GetItem(index);
      return Result;
    };
    this.FindChainForAdd = function (aKey) {
      var Result = null;
      var hashCode = 0;
      var i = 0;
      hashCode = this.FHashFunction(aKey,this.FHashTableSize);
      Result = this.Chain(hashCode);
      if (Result != null) {
        if (Result.GetCount() > 0) for (var $l = 0, $end = Result.GetCount() - 1; $l <= $end; $l++) {
          i = $l;
          if (Result.GetItem(i).FKey === aKey) throw $mod.EDuplicate.$create("CreateFmt",[rtl.getResStr($mod,"DuplicateMsg"),pas.System.VarRecs(18,aKey)]);
        };
      } else {
        this.FHashTable.SetItem(hashCode,$mod.TFPObjectList.$create("Create$2",[true]));
        Result = this.Chain(hashCode);
      };
      this.FCount += 1;
      return Result;
    };
    this.Create$1 = function () {
      this.CreateWith(196613,$mod.RSHash);
      return this;
    };
    this.CreateWith = function (AHashTableSize, aHashFunc) {
      pas.System.TObject.Create.call(this);
      this.FHashTable = $mod.TFPObjectList.$create("Create$2",[true]);
      this.SetHashTableSize(AHashTableSize);
      this.FHashFunction = aHashFunc;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHashTable");
      pas.System.TObject.Destroy.call(this);
    };
    this.ChangeTableSize = function (ANewSize) {
      var SavedTable = null;
      var List = null;
      var SavedTableSize = 0;
      var i = 0;
      var j = 0;
      var temp = null;
      SavedTable = this.FHashTable;
      SavedTableSize = this.FHashTableSize;
      this.FHashTableSize = ANewSize;
      this.FHashTable = $mod.TFPObjectList.$create("Create$2",[true]);
      this.InitializeHashTable();
      if (SavedTableSize > 0) for (var $l = 0, $end = SavedTableSize - 1; $l <= $end; $l++) {
        i = $l;
        List = SavedTable.GetItem(i);
        if (List != null) for (var $l1 = 0, $end1 = List.GetCount() - 1; $l1 <= $end1; $l1++) {
          j = $l1;
          temp = List.GetItem(j);
          this.AddNode(temp);
        };
      };
      SavedTable = rtl.freeLoc(SavedTable);
    };
    this.Clear = function () {
      var i = 0;
      if (this.FHashTableSize > 0) for (var $l = 0, $end = this.FHashTableSize - 1; $l <= $end; $l++) {
        i = $l;
        if (this.Chain(i) != null) this.Chain(i).Clear();
      };
      this.FCount = 0;
    };
    this.Find = function (aKey) {
      var Result = null;
      var hashCode = 0;
      var chn = null;
      var i = 0;
      hashCode = this.FHashFunction(aKey,this.FHashTableSize);
      chn = this.Chain(hashCode);
      if (chn != null) if (chn.GetCount() > 0) for (var $l = 0, $end = chn.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (chn.GetItem(i).FKey === aKey) return chn.GetItem(i);
      };
      Result = null;
      return Result;
    };
  });
  rtl.createClass(this,"THTObjectNode",this.THTCustomNode,function () {
    this.$init = function () {
      $mod.THTCustomNode.$init.call(this);
      this.FData = null;
    };
    this.$final = function () {
      this.FData = undefined;
      $mod.THTCustomNode.$final.call(this);
    };
  });
  rtl.createClass(this,"THTOwnedObjectNode",this.THTObjectNode,function () {
    this.Destroy = function () {
      pas.SysUtils.FreeAndNil({p: this, get: function () {
          return this.p.FData;
        }, set: function (v) {
          this.p.FData = v;
        }});
      pas.System.TObject.Destroy.call(this);
    };
  });
  rtl.createClass(this,"TFPObjectHashTable",this.TFPCustomHashTable,function () {
    this.$init = function () {
      $mod.TFPCustomHashTable.$init.call(this);
      this.FOwnsObjects = false;
    };
    this.CreateNewNode = function (aKey) {
      var Result = null;
      if (this.FOwnsObjects) {
        Result = $mod.THTOwnedObjectNode.$create("CreateWith",[aKey])}
       else Result = $mod.THTObjectNode.$create("CreateWith",[aKey]);
      return Result;
    };
    this.AddNode = function (ANode) {
      this.Add(ANode.FKey,ANode.FData);
    };
    this.GetData = function (index) {
      var Result = null;
      var node = null;
      node = this.Find(index);
      if (node != null) {
        Result = node.FData}
       else Result = null;
      return Result;
    };
    this.Create$2 = function (AOwnsObjects) {
      $mod.TFPCustomHashTable.Create$1.call(this);
      this.FOwnsObjects = AOwnsObjects;
      return this;
    };
    this.Add = function (aKey, AItem) {
      var chn = null;
      var NewNode = null;
      chn = this.FindChainForAdd(aKey);
      NewNode = this.CreateNewNode(aKey);
      NewNode.FData = AItem;
      chn.Add(NewNode);
    };
  });
  rtl.createClass(this,"EDuplicate",pas.SysUtils.Exception,function () {
  });
  var b = 378551;
  this.RSHash = function (S, TableSize) {
    var Result = 0;
    var a = 0;
    var i = 0;
    a = 63689;
    Result = 0;
    if (S.length > 0) for (var $l = 1, $end = S.length; $l <= $end; $l++) {
      i = $l;
      Result = (Result * a) + S.charCodeAt(i - 1);
      a = a * 378551;
    };
    Result = rtl.lw(Result & 0x7FFFFFFF) % TableSize;
    return Result;
  };
  $mod.$implcode = function () {
    $impl.NPRIMES = 28;
    $impl.PRIMELIST = [53,97,193,389,769,1543,3079,6151,12289,24593,49157,98317,196613,393241,786433,1572869,3145739,6291469,12582917,25165843,50331653,100663319,201326611,402653189,805306457,1610612741,3221225473,4294967291];
    $mod.$resourcestrings = {DuplicateMsg: {org: "An item with key %0:s already exists"}};
  };
},["JS"]);
rtl.module("WEBLib.Graphics",["System","Classes","Types","Web","JS"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.WEBDEFAULTFONT = "Arial";
  this.clNone = -1;
  this.clBlack = 0x0;
  this.clSilver = 0xC0C0C0;
  this.clWhite = 0xFFFFFF;
  this.clBtnFace = 0xF0F0F0;
  this.clWindowText = 0x10101;
  this.clWindow = 0xFEFEFE;
  this.clHighlight = 0xD77800;
  this.clHighlightText = 0x30303;
  this.DEFAULT_CHARSET = 1;
  this.$rtti.$inherited("TColor",rtl.nativeint,{});
  this.TPenStyle = {"0": "psSolid", psSolid: 0, "1": "psDash", psDash: 1, "2": "psDot", psDot: 2, "3": "psDashDot", psDashDot: 3, "4": "psDashDotDot", psDashDotDot: 4, "5": "psClear", psClear: 5, "6": "psInsideFrame", psInsideFrame: 6, "7": "psUserStyle", psUserStyle: 7, "8": "psAlternate", psAlternate: 8};
  this.$rtti.$Enum("TPenStyle",{minvalue: 0, maxvalue: 8, ordtype: 1, enumtype: this.TPenStyle});
  this.TPenMode = {"0": "pmBlack", pmBlack: 0, "1": "pmWhite", pmWhite: 1, "2": "pmNop", pmNop: 2, "3": "pmNot", pmNot: 3, "4": "pmCopy", pmCopy: 4, "5": "pmNotCopy", pmNotCopy: 5, "6": "pmMergePenNot", pmMergePenNot: 6, "7": "pmMaskPenNot", pmMaskPenNot: 7, "8": "pmMergeNotPen", pmMergeNotPen: 8, "9": "pmMaskNotPen", pmMaskNotPen: 9, "10": "pmMerge", pmMerge: 10, "11": "pmNotMerge", pmNotMerge: 11, "12": "pmMask", pmMask: 12, "13": "pmNotMask", pmNotMask: 13, "14": "pmXor", pmXor: 14, "15": "pmNotXor", pmNotXor: 15};
  this.$rtti.$Enum("TPenMode",{minvalue: 0, maxvalue: 15, ordtype: 1, enumtype: this.TPenMode});
  this.TBrushStyle = {"0": "bsSolid", bsSolid: 0, "1": "bsClear", bsClear: 1, "2": "bsHorizontal", bsHorizontal: 2, "3": "bsVertical", bsVertical: 3, "4": "bsFDiagonal", bsFDiagonal: 4, "5": "bsBDiagonal", bsBDiagonal: 5, "6": "bsCross", bsCross: 6, "7": "bsDiagCross", bsDiagCross: 7};
  this.$rtti.$Enum("TBrushStyle",{minvalue: 0, maxvalue: 7, ordtype: 1, enumtype: this.TBrushStyle});
  this.TBrushGradient = {"0": "bgNone", bgNone: 0, "1": "bgLinearVert", bgLinearVert: 1, "2": "bgLinearHorz", bgLinearHorz: 2, "3": "bgRadial", bgRadial: 3};
  this.$rtti.$Enum("TBrushGradient",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TBrushGradient});
  this.TFontStyle = {"0": "fsBold", fsBold: 0, "1": "fsItalic", fsItalic: 1, "2": "fsStrikeOut", fsStrikeOut: 2, "3": "fsUnderline", fsUnderline: 3};
  this.$rtti.$Enum("TFontStyle",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TFontStyle});
  this.$rtti.$Set("TFontStyles",{comptype: this.$rtti["TFontStyle"]});
  this.$rtti.$Int("TFontCharset",{minvalue: 0, maxvalue: 255, ordtype: 3});
  rtl.createClass(this,"TPen",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FWidth = 0;
      this.FColor = 0;
      this.FStyle = 0;
      this.FMode = 0;
    };
    this.SetColor = function (Value) {
      this.FColor = Value;
    };
    this.Create$1 = function () {
      this.FColor = 0;
      this.FWidth = 1;
      this.FStyle = 0;
      this.FMode = 4;
      return this;
    };
    this.Assign = function (Source) {
      if ($mod.TPen.isPrototypeOf(Source)) {
        this.FColor = rtl.as(Source,$mod.TPen).FColor;
        this.FStyle = rtl.as(Source,$mod.TPen).FStyle;
        this.FWidth = rtl.as(Source,$mod.TPen).FWidth;
      } else pas.Classes.TPersistent.Assign.apply(this,arguments);
    };
    var $r = this.$rtti;
    $r.addProperty("Color",2,$mod.$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("Mode",0,$mod.$rtti["TPenMode"],"FMode","FMode",{Default: $mod.TPenMode.pmCopy});
    $r.addProperty("Width",0,rtl.longint,"FWidth","FWidth",{Default: 1});
    $r.addProperty("Style",0,$mod.$rtti["TPenStyle"],"FStyle","FStyle",{Default: $mod.TPenStyle.psSolid});
  });
  rtl.createClass(this,"TBrush",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FColor = 0;
      this.FStyle = 0;
      this.FGradientColors = null;
      this.FGradient = 0;
    };
    this.$final = function () {
      this.FGradientColors = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.Create$1 = function () {
      this.FColor = 16777215;
      this.FStyle = 0;
      this.FGradient = 0;
      this.FGradientColors = pas.Classes.TList.$create("Create$1");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FGradientColors");
      pas.System.TObject.Destroy.call(this);
    };
    this.Assign = function (Source) {
      if ($mod.TBrush.isPrototypeOf(Source)) {
        this.FColor = rtl.as(Source,$mod.TBrush).FColor;
        this.FStyle = rtl.as(Source,$mod.TBrush).FStyle;
      } else pas.Classes.TPersistent.Assign.apply(this,arguments);
    };
    var $r = this.$rtti;
    $r.addProperty("Gradient",0,$mod.$rtti["TBrushGradient"],"FGradient","FGradient");
    $r.addProperty("Color",0,$mod.$rtti["TColor"],"FColor","FColor");
    $r.addProperty("Style",0,$mod.$rtti["TBrushStyle"],"FStyle","FStyle");
  });
  rtl.createClass(this,"TFont",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FName = "";
      this.FSize = 0;
      this.FColor = 0;
      this.FStyle = {};
      this.FOnChange = null;
      this.FHeight = 0;
      this.FCharset = 0;
    };
    this.$final = function () {
      this.FStyle = undefined;
      this.FOnChange = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.SetHeight = function (Value) {
      var d = 0.0;
      d = (-Value * 72) / 96;
      this.FSize = Math.round(d);
      if (this.FHeight !== Value) {
        this.FHeight = Value;
        this.DoChange();
      };
    };
    this.SetName = function (AName) {
      if (this.FName !== AName) {
        this.FName = AName;
        this.DoChange();
      };
    };
    this.SetSize = function (ASize) {
      if (this.FSize !== ASize) {
        this.FSize = ASize;
        this.DoChange();
      };
    };
    this.SetColor = function (AColor) {
      if (this.FColor !== AColor) {
        this.FColor = AColor;
        this.DoChange();
      };
    };
    this.SetStyle = function (AStyle) {
      if (rtl.neSet(this.FStyle,AStyle)) {
        this.FStyle = rtl.refSet(AStyle);
        this.DoChange();
      };
    };
    this.DoChange = function () {
      if (this.FOnChange != null) this.FOnChange(this);
    };
    this.Assign = function (Source) {
      if ($mod.TFont.isPrototypeOf(Source)) {
        this.FName = rtl.as(Source,$mod.TFont).FName;
        this.FColor = rtl.as(Source,$mod.TFont).FColor;
        this.FSize = rtl.as(Source,$mod.TFont).FSize;
        this.FStyle = rtl.refSet(rtl.as(Source,$mod.TFont).FStyle);
        this.DoChange();
      } else pas.Classes.TPersistent.Assign.apply(this,arguments);
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FName = $mod.WEBDEFAULTFONT;
      this.FSize = 8;
      this.FHeight = -11;
      this.FStyle = {};
      this.FColor = 0;
      return this;
    };
    var $r = this.$rtti;
    $r.addProperty("Charset",0,$mod.$rtti["TFontCharset"],"FCharset","FCharset");
    $r.addProperty("Name",2,rtl.string,"FName","SetName");
    $r.addProperty("Height",2,rtl.longint,"FHeight","SetHeight");
    $r.addProperty("Style",2,$mod.$rtti["TFontStyles"],"FStyle","SetStyle");
    $r.addProperty("Color",2,$mod.$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("Size",2,rtl.longint,"FSize","SetSize");
  });
  rtl.recNewT(this,"TMatrix",function () {
    this.m11 = 0.0;
    this.m12 = 0.0;
    this.m13 = 0.0;
    this.m21 = 0.0;
    this.m22 = 0.0;
    this.m23 = 0.0;
    this.m31 = 0.0;
    this.m32 = 0.0;
    this.m33 = 0.0;
    this.$eq = function (b) {
      return (this.m11 === b.m11) && (this.m12 === b.m12) && (this.m13 === b.m13) && (this.m21 === b.m21) && (this.m22 === b.m22) && (this.m23 === b.m23) && (this.m31 === b.m31) && (this.m32 === b.m32) && (this.m33 === b.m33);
    };
    this.$assign = function (s) {
      this.m11 = s.m11;
      this.m12 = s.m12;
      this.m13 = s.m13;
      this.m21 = s.m21;
      this.m22 = s.m22;
      this.m23 = s.m23;
      this.m31 = s.m31;
      this.m32 = s.m32;
      this.m33 = s.m33;
      return this;
    };
  });
  rtl.createClass(this,"TCanvas",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FElementCanvas = null;
      this.FContext = null;
      this.FPen = null;
      this.FBrush = null;
      this.FFont = null;
      this.FPathOpen = false;
      this.FApplyPixelRatio = false;
    };
    this.$final = function () {
      this.FElementCanvas = undefined;
      this.FContext = undefined;
      this.FPen = undefined;
      this.FBrush = undefined;
      this.FFont = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AControl) {
      this.FElementCanvas = AControl;
      this.FContext = AControl.getContext("2d");
      this.FPen = $mod.TPen.$create("Create$1");
      this.FBrush = $mod.TBrush.$create("Create$1");
      this.FPathOpen = false;
      this.FFont = $mod.TFont.$create("Create$1");
      this.FApplyPixelRatio = false;
      return this;
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    this.SetTransform = function (m11, m12, m21, m22, dx, dy) {
      var m = $mod.TMatrix.$new();
      var px = 0.0;
      if (this.FContext != null) {
        m.$assign($impl.MatrixIdentity());
        m.m11 = m11;
        m.m12 = m12;
        m.m21 = m21;
        m.m22 = m22;
        m.m31 = dx;
        m.m32 = dy;
        if (this.FApplyPixelRatio) {
          px = $impl.GetPixelRatio(this);
          m.$assign($impl.MatrixMultiply(m,$impl.MatrixCreateScaling(px,px)));
        };
        this.FContext.setTransform(m.m11,m.m12,m.m21,m.m22,m.m31,m.m32);
      };
    };
    this.Clear = function () {
      if ((this.FContext != null) && (this.FElementCanvas != null)) this.FContext.clearRect(0,0,this.FElementCanvas.width,this.FElementCanvas.height);
    };
  });
  this.ColorToRGB = function (Color) {
    var Result = 0;
    Result = Color;
    return Result;
  };
  this.ColorToHex = function (c) {
    var Result = "";
    var s = "";
    s = c.toString(16);
    
        while (s.length < 6)
        {
          s = "0" + s;
        };
    Result = pas.System.Copy(s,5,2) + pas.System.Copy(s,3,2) + pas.System.Copy(s,1,2);
    return Result;
  };
  this.ColorToHTML = function (c) {
    var Result = "";
    if ((c & 0xFF000000) !== 0) {
      Result = "#" + $mod.ColorToHex(c & 0xFFFFFF) + pas.SysUtils.IntToHex(Math.floor((c & 0xFF000000) / 16777216) & 0xFF,2);
    } else Result = "#" + $mod.ColorToHex(c);
    return Result;
  };
  this.RGB = function (r, g, b) {
    var Result = 0;
    Result = r | (g << 8) | (b << 16);
    return Result;
  };
  $mod.$implcode = function () {
    rtl.createClass($impl,"TGraphicCacheList",pas.contnrs.TObjectList,function () {
    });
    $impl.FCache = null;
    $impl.FQueue = null;
    $impl.MatrixIdentity = function () {
      var Result = $mod.TMatrix.$new();
      Result.m11 = 1;
      Result.m12 = 0;
      Result.m13 = 0;
      Result.m21 = 0;
      Result.m22 = 1;
      Result.m23 = 0;
      Result.m31 = 0;
      Result.m32 = 0;
      Result.m33 = 1;
      return Result;
    };
    $impl.GetPixelRatio = function (ACanvas) {
      var Result = 0.0;
      var res = 0.0;
      var ca = null;
      ca = ACanvas;
      var ctx = ca.FContext,
          dpr = window.devicePixelRatio || 1,
          bsr = ctx.webkitBackingStorePixelRatio ||
                ctx.mozBackingStorePixelRatio ||
                ctx.msBackingStorePixelRatio ||
                ctx.oBackingStorePixelRatio ||
                ctx.backingStorePixelRatio || 1;
      res = dpr / bsr;
      Result = res;
      return Result;
    };
    $impl.MatrixCreateScaling = function (AScaleX, AScaleY) {
      var Result = $mod.TMatrix.$new();
      Result.$assign($impl.MatrixIdentity());
      Result.m11 = AScaleX;
      Result.m22 = AScaleY;
      return Result;
    };
    $impl.MatrixMultiply = function (AMatrix1, AMatrix2) {
      var Result = $mod.TMatrix.$new();
      Result.m11 = (AMatrix1.m11 * AMatrix2.m11) + (AMatrix1.m12 * AMatrix2.m21) + (AMatrix1.m13 * AMatrix2.m31);
      Result.m12 = (AMatrix1.m11 * AMatrix2.m12) + (AMatrix1.m12 * AMatrix2.m22) + (AMatrix1.m13 * AMatrix2.m32);
      Result.m13 = (AMatrix1.m11 * AMatrix2.m13) + (AMatrix1.m12 * AMatrix2.m23) + (AMatrix1.m13 * AMatrix2.m33);
      Result.m21 = (AMatrix1.m21 * AMatrix2.m11) + (AMatrix1.m22 * AMatrix2.m21) + (AMatrix1.m23 * AMatrix2.m31);
      Result.m22 = (AMatrix1.m21 * AMatrix2.m12) + (AMatrix1.m22 * AMatrix2.m22) + (AMatrix1.m23 * AMatrix2.m32);
      Result.m23 = (AMatrix1.m21 * AMatrix2.m13) + (AMatrix1.m22 * AMatrix2.m23) + (AMatrix1.m23 * AMatrix2.m33);
      Result.m31 = (AMatrix1.m31 * AMatrix2.m11) + (AMatrix1.m32 * AMatrix2.m21) + (AMatrix1.m33 * AMatrix2.m31);
      Result.m32 = (AMatrix1.m31 * AMatrix2.m12) + (AMatrix1.m32 * AMatrix2.m22) + (AMatrix1.m33 * AMatrix2.m32);
      Result.m33 = (AMatrix1.m31 * AMatrix2.m13) + (AMatrix1.m32 * AMatrix2.m23) + (AMatrix1.m33 * AMatrix2.m33);
      return Result;
    };
  };
  $mod.$init = function () {
    $impl.FCache = $impl.TGraphicCacheList.$create("Create$2");
    $impl.FQueue = pas.Classes.TStringList.$create("Create$1");
  };
},["WEBLib.Forms","WEBLib.WebTools","Math","SysUtils","contnrs"]);
rtl.module("WEBLib.Lang",["System"],function () {
  "use strict";
  var $mod = this;
  this.TUILanguage = {"0": "lNone", lNone: 0, "1": "lAfar", lAfar: 1, "2": "lAbkhazian", lAbkhazian: 2, "3": "lAvestan", lAvestan: 3, "4": "lAfrikaans", lAfrikaans: 4, "5": "lAkan", lAkan: 5, "6": "lAmharic", lAmharic: 6, "7": "lAragonese", lAragonese: 7, "8": "lArabic", lArabic: 8, "9": "lAssamese", lAssamese: 9, "10": "lAvaric", lAvaric: 10, "11": "lAymara", lAymara: 11, "12": "lAzerbaijani", lAzerbaijani: 12, "13": "lBashkir", lBashkir: 13, "14": "lBelarusian", lBelarusian: 14, "15": "lBulgarian", lBulgarian: 15, "16": "lBihari", lBihari: 16, "17": "lBislama", lBislama: 17, "18": "lBambara", lBambara: 18, "19": "lBengali", lBengali: 19, "20": "lTibetan", lTibetan: 20, "21": "lBreton", lBreton: 21, "22": "lBosnian", lBosnian: 22, "23": "lCatalan", lCatalan: 23, "24": "lChechen", lChechen: 24, "25": "lChamorro", lChamorro: 25, "26": "lCorsican", lCorsican: 26, "27": "lCree", lCree: 27, "28": "lCzech", lCzech: 28, "29": "lOldSlavic", lOldSlavic: 29, "30": "lChuvash", lChuvash: 30, "31": "lWelsh", lWelsh: 31, "32": "lDanish", lDanish: 32, "33": "lGerman", lGerman: 33, "34": "lDivehi", lDivehi: 34, "35": "lDzongkha", lDzongkha: 35, "36": "lEwe", lEwe: 36, "37": "lEnglish", lEnglish: 37, "38": "lEsperanto", lEsperanto: 38, "39": "lSpanish", lSpanish: 39, "40": "lEstonian", lEstonian: 40, "41": "lBasque", lBasque: 41, "42": "lPersian", lPersian: 42, "43": "lFulah", lFulah: 43, "44": "lFinnish", lFinnish: 44, "45": "lFijian", lFijian: 45, "46": "lFaroese", lFaroese: 46, "47": "lFrench", lFrench: 47, "48": "lWesternFrisian", lWesternFrisian: 48, "49": "lIrish", lIrish: 49, "50": "lGaelic", lGaelic: 50, "51": "lGalician", lGalician: 51, "52": "lGuarani", lGuarani: 52, "53": "lGujarati", lGujarati: 53, "54": "lManx", lManx: 54, "55": "lHausa", lHausa: 55, "56": "lHebrew", lHebrew: 56, "57": "lHindi", lHindi: 57, "58": "lHiriMotu", lHiriMotu: 58, "59": "lCroatian", lCroatian: 59, "60": "lHaitian", lHaitian: 60, "61": "lHungarian", lHungarian: 61, "62": "lArmenian", lArmenian: 62, "63": "lHerero", lHerero: 63, "64": "lInterlingua", lInterlingua: 64, "65": "lIndonesian", lIndonesian: 65, "66": "lInterlingue", lInterlingue: 66, "67": "lIgbo", lIgbo: 67, "68": "lSichuanYi", lSichuanYi: 68, "69": "lInupiaq", lInupiaq: 69, "70": "lIdo", lIdo: 70, "71": "lIcelandic", lIcelandic: 71, "72": "lItalian", lItalian: 72, "73": "lInuktitut", lInuktitut: 73, "74": "lJapanese", lJapanese: 74, "75": "lJavanese", lJavanese: 75, "76": "lGeorgian", lGeorgian: 76, "77": "lKongo", lKongo: 77, "78": "lKikuyu", lKikuyu: 78, "79": "lKuanyama", lKuanyama: 79, "80": "lKazakh", lKazakh: 80, "81": "lKalaallisut", lKalaallisut: 81, "82": "lCentralKhmer", lCentralKhmer: 82, "83": "lKannada", lKannada: 83, "84": "lKorean", lKorean: 84, "85": "lKanuri", lKanuri: 85, "86": "lKashmiri", lKashmiri: 86, "87": "lKurdish", lKurdish: 87, "88": "lKomi", lKomi: 88, "89": "lCornish", lCornish: 89, "90": "lKirghiz", lKirghiz: 90, "91": "lLatin", lLatin: 91, "92": "lLuxembourgish", lLuxembourgish: 92, "93": "lGanda", lGanda: 93, "94": "lLimburgan", lLimburgan: 94, "95": "lLingala", lLingala: 95, "96": "lLao", lLao: 96, "97": "lLithuanian", lLithuanian: 97, "98": "lLubaKatanga", lLubaKatanga: 98, "99": "lLatvian", lLatvian: 99, "100": "lMalagasy", lMalagasy: 100, "101": "lMarshallese", lMarshallese: 101, "102": "lMaori", lMaori: 102, "103": "lMacedonian", lMacedonian: 103, "104": "lMalayalam", lMalayalam: 104, "105": "lMongolian", lMongolian: 105, "106": "lMarathi", lMarathi: 106, "107": "lMalay", lMalay: 107, "108": "lMaltese", lMaltese: 108, "109": "lBurmese", lBurmese: 109, "110": "lNauru", lNauru: 110, "111": "lNdebele", lNdebele: 111, "112": "lNepali", lNepali: 112, "113": "lNdonga", lNdonga: 113, "114": "lDutch", lDutch: 114, "115": "lNorwegian", lNorwegian: 115, "116": "lNavajo", lNavajo: 116, "117": "lChichewa", lChichewa: 117, "118": "lOccitan", lOccitan: 118, "119": "lOjibwa", lOjibwa: 119, "120": "lOromo", lOromo: 120, "121": "lOriya", lOriya: 121, "122": "lOssetian", lOssetian: 122, "123": "lPanjabi", lPanjabi: 123, "124": "lPali", lPali: 124, "125": "lPolish", lPolish: 125, "126": "lPushto", lPushto: 126, "127": "lPortuguese", lPortuguese: 127, "128": "lQuechua", lQuechua: 128, "129": "lRomansh", lRomansh: 129, "130": "lRundi", lRundi: 130, "131": "lRomanian", lRomanian: 131, "132": "lRussian", lRussian: 132, "133": "lKinyarwanda", lKinyarwanda: 133, "134": "lSanskrit", lSanskrit: 134, "135": "lSardinian", lSardinian: 135, "136": "lSindhi", lSindhi: 136, "137": "lNorthernSami", lNorthernSami: 137, "138": "lSango", lSango: 138, "139": "lSinhala", lSinhala: 139, "140": "lSlovak", lSlovak: 140, "141": "lSlovenian", lSlovenian: 141, "142": "lSamoan", lSamoan: 142, "143": "lShona", lShona: 143, "144": "lSomali", lSomali: 144, "145": "lAlbanian", lAlbanian: 145, "146": "lSerbian", lSerbian: 146, "147": "lSwati", lSwati: 147, "148": "lSotho", lSotho: 148, "149": "lSundanese", lSundanese: 149, "150": "lSwedish", lSwedish: 150, "151": "lSwahili", lSwahili: 151, "152": "lTamil", lTamil: 152, "153": "lTelugu", lTelugu: 153, "154": "lTajik", lTajik: 154, "155": "lThai", lThai: 155, "156": "lTigrinya", lTigrinya: 156, "157": "lTurkmen", lTurkmen: 157, "158": "lTagalog", lTagalog: 158, "159": "lTswana", lTswana: 159, "160": "lTonga", lTonga: 160, "161": "lTurkish", lTurkish: 161, "162": "lTsonga", lTsonga: 162, "163": "lTatar", lTatar: 163, "164": "lTwi", lTwi: 164, "165": "lTahitian", lTahitian: 165, "166": "lUighur", lUighur: 166, "167": "lUkrainian", lUkrainian: 167, "168": "lUrdu", lUrdu: 168, "169": "lUzbek", lUzbek: 169, "170": "lVenda", lVenda: 170, "171": "lVietnamese", lVietnamese: 171, "172": "lWalloon", lWalloon: 172, "173": "lWolof", lWolof: 173, "174": "lXhosa", lXhosa: 174, "175": "lYiddish", lYiddish: 175, "176": "lYoruba", lYoruba: 176, "177": "lZhuang", lZhuang: 177, "178": "lChinese", lChinese: 178, "179": "lZulu", lZulu: 179};
  this.GetLanguageISO639_1Code = function (ALang) {
    var Result = "";
    var $tmp = ALang;
    if ($tmp === 0) {
      Result = ""}
     else if ($tmp === 1) {
      Result = "aa"}
     else if ($tmp === 2) {
      Result = "ab"}
     else if ($tmp === 3) {
      Result = "ae"}
     else if ($tmp === 4) {
      Result = "af"}
     else if ($tmp === 5) {
      Result = "ak"}
     else if ($tmp === 6) {
      Result = "am"}
     else if ($tmp === 7) {
      Result = "an"}
     else if ($tmp === 8) {
      Result = "ar"}
     else if ($tmp === 9) {
      Result = "as"}
     else if ($tmp === 10) {
      Result = "av"}
     else if ($tmp === 11) {
      Result = "ay"}
     else if ($tmp === 12) {
      Result = "az"}
     else if ($tmp === 13) {
      Result = "ba"}
     else if ($tmp === 14) {
      Result = "be"}
     else if ($tmp === 15) {
      Result = "bg"}
     else if ($tmp === 16) {
      Result = "bh"}
     else if ($tmp === 17) {
      Result = "bi"}
     else if ($tmp === 18) {
      Result = "bm"}
     else if ($tmp === 19) {
      Result = "bn"}
     else if ($tmp === 20) {
      Result = "bo"}
     else if ($tmp === 21) {
      Result = "br"}
     else if ($tmp === 22) {
      Result = "bd"}
     else if ($tmp === 23) {
      Result = "ca"}
     else if ($tmp === 24) {
      Result = "ce"}
     else if ($tmp === 25) {
      Result = "ch"}
     else if ($tmp === 26) {
      Result = "co"}
     else if ($tmp === 27) {
      Result = "cr"}
     else if ($tmp === 28) {
      Result = "cs"}
     else if ($tmp === 29) {
      Result = "cu"}
     else if ($tmp === 30) {
      Result = "cv"}
     else if ($tmp === 31) {
      Result = "cy"}
     else if ($tmp === 32) {
      Result = "da"}
     else if ($tmp === 33) {
      Result = "de"}
     else if ($tmp === 34) {
      Result = "dv"}
     else if ($tmp === 35) {
      Result = "dz"}
     else if ($tmp === 36) {
      Result = "ee"}
     else if ($tmp === 37) {
      Result = "en"}
     else if ($tmp === 38) {
      Result = "eo"}
     else if ($tmp === 39) {
      Result = "es"}
     else if ($tmp === 40) {
      Result = "et"}
     else if ($tmp === 41) {
      Result = "eu"}
     else if ($tmp === 42) {
      Result = "fa"}
     else if ($tmp === 43) {
      Result = "ff"}
     else if ($tmp === 44) {
      Result = "fi"}
     else if ($tmp === 45) {
      Result = "fj"}
     else if ($tmp === 46) {
      Result = "fo"}
     else if ($tmp === 47) {
      Result = "fr"}
     else if ($tmp === 48) {
      Result = "fy"}
     else if ($tmp === 49) {
      Result = "ga"}
     else if ($tmp === 50) {
      Result = "gd"}
     else if ($tmp === 51) {
      Result = "gl"}
     else if ($tmp === 52) {
      Result = "gn"}
     else if ($tmp === 53) {
      Result = "gu"}
     else if ($tmp === 54) {
      Result = "gv"}
     else if ($tmp === 55) {
      Result = "ha"}
     else if ($tmp === 56) {
      Result = "he"}
     else if ($tmp === 57) {
      Result = "hi"}
     else if ($tmp === 58) {
      Result = "ho"}
     else if ($tmp === 59) {
      Result = "hr"}
     else if ($tmp === 60) {
      Result = "ht"}
     else if ($tmp === 61) {
      Result = "hu"}
     else if ($tmp === 62) {
      Result = "hy"}
     else if ($tmp === 63) {
      Result = "hz"}
     else if ($tmp === 64) {
      Result = "ia"}
     else if ($tmp === 65) {
      Result = "id"}
     else if ($tmp === 66) {
      Result = "ie"}
     else if ($tmp === 67) {
      Result = "ig"}
     else if ($tmp === 68) {
      Result = "ii"}
     else if ($tmp === 69) {
      Result = "ik"}
     else if ($tmp === 70) {
      Result = "id"}
     else if ($tmp === 71) {
      Result = "is"}
     else if ($tmp === 72) {
      Result = "it"}
     else if ($tmp === 73) {
      Result = "iu"}
     else if ($tmp === 74) {
      Result = "ja"}
     else if ($tmp === 75) {
      Result = "jv"}
     else if ($tmp === 76) {
      Result = "ka"}
     else if ($tmp === 77) {
      Result = "kg"}
     else if ($tmp === 78) {
      Result = "ki"}
     else if ($tmp === 79) {
      Result = "kj"}
     else if ($tmp === 80) {
      Result = "kk"}
     else if ($tmp === 81) {
      Result = "kl"}
     else if ($tmp === 82) {
      Result = "km"}
     else if ($tmp === 83) {
      Result = "kn"}
     else if ($tmp === 84) {
      Result = "ko"}
     else if ($tmp === 85) {
      Result = "kr"}
     else if ($tmp === 86) {
      Result = "ks"}
     else if ($tmp === 87) {
      Result = "ku"}
     else if ($tmp === 88) {
      Result = "kv"}
     else if ($tmp === 89) {
      Result = "kw"}
     else if ($tmp === 90) {
      Result = "ky"}
     else if ($tmp === 91) {
      Result = "la"}
     else if ($tmp === 92) {
      Result = "lb"}
     else if ($tmp === 93) {
      Result = "lg"}
     else if ($tmp === 94) {
      Result = "li"}
     else if ($tmp === 95) {
      Result = "ln"}
     else if ($tmp === 96) {
      Result = "lo"}
     else if ($tmp === 97) {
      Result = "lt"}
     else if ($tmp === 98) {
      Result = "lu"}
     else if ($tmp === 99) {
      Result = "lv"}
     else if ($tmp === 100) {
      Result = "mg"}
     else if ($tmp === 101) {
      Result = "mh"}
     else if ($tmp === 102) {
      Result = "mi"}
     else if ($tmp === 103) {
      Result = "mk"}
     else if ($tmp === 104) {
      Result = "ml"}
     else if ($tmp === 105) {
      Result = "mn"}
     else if ($tmp === 106) {
      Result = "mr"}
     else if ($tmp === 107) {
      Result = "ms"}
     else if ($tmp === 108) {
      Result = "mt"}
     else if ($tmp === 109) {
      Result = "my"}
     else if ($tmp === 110) {
      Result = "na"}
     else if ($tmp === 111) {
      Result = "nb"}
     else if ($tmp === 112) {
      Result = "nd"}
     else if ($tmp === 113) {
      Result = "ng"}
     else if ($tmp === 114) {
      Result = "nl"}
     else if ($tmp === 115) {
      Result = "no"}
     else if ($tmp === 116) {
      Result = "nv"}
     else if ($tmp === 117) {
      Result = "ny"}
     else if ($tmp === 118) {
      Result = "oc"}
     else if ($tmp === 119) {
      Result = "oj"}
     else if ($tmp === 120) {
      Result = "om"}
     else if ($tmp === 121) {
      Result = "or"}
     else if ($tmp === 122) {
      Result = "os"}
     else if ($tmp === 123) {
      Result = "pa"}
     else if ($tmp === 124) {
      Result = "pi"}
     else if ($tmp === 125) {
      Result = "pl"}
     else if ($tmp === 126) {
      Result = "ps"}
     else if ($tmp === 127) {
      Result = "pt"}
     else if ($tmp === 128) {
      Result = "qu"}
     else if ($tmp === 129) {
      Result = "rm"}
     else if ($tmp === 130) {
      Result = "rn"}
     else if ($tmp === 131) {
      Result = "ro"}
     else if ($tmp === 132) {
      Result = "ru"}
     else if ($tmp === 133) {
      Result = "rw"}
     else if ($tmp === 134) {
      Result = "sa"}
     else if ($tmp === 135) {
      Result = "sc"}
     else if ($tmp === 136) {
      Result = "sd"}
     else if ($tmp === 137) {
      Result = "se"}
     else if ($tmp === 138) {
      Result = "sg"}
     else if ($tmp === 139) {
      Result = "si"}
     else if ($tmp === 140) {
      Result = "sk"}
     else if ($tmp === 141) {
      Result = "sl"}
     else if ($tmp === 142) {
      Result = "sm"}
     else if ($tmp === 143) {
      Result = "sn"}
     else if ($tmp === 144) {
      Result = "so"}
     else if ($tmp === 145) {
      Result = "sq"}
     else if ($tmp === 146) {
      Result = "sr"}
     else if ($tmp === 147) {
      Result = "ss"}
     else if ($tmp === 148) {
      Result = "st"}
     else if ($tmp === 149) {
      Result = "su"}
     else if ($tmp === 150) {
      Result = "sv"}
     else if ($tmp === 151) {
      Result = "sw"}
     else if ($tmp === 152) {
      Result = "ta"}
     else if ($tmp === 153) {
      Result = "te"}
     else if ($tmp === 154) {
      Result = "tg"}
     else if ($tmp === 155) {
      Result = "th"}
     else if ($tmp === 156) {
      Result = "ti"}
     else if ($tmp === 157) {
      Result = "tk"}
     else if ($tmp === 158) {
      Result = "tl"}
     else if ($tmp === 159) {
      Result = "tn"}
     else if ($tmp === 160) {
      Result = "to"}
     else if ($tmp === 161) {
      Result = "tr"}
     else if ($tmp === 162) {
      Result = "ts"}
     else if ($tmp === 163) {
      Result = "tt"}
     else if ($tmp === 164) {
      Result = "tw"}
     else if ($tmp === 165) {
      Result = "ty"}
     else if ($tmp === 166) {
      Result = "ug"}
     else if ($tmp === 167) {
      Result = "uk"}
     else if ($tmp === 168) {
      Result = "ur"}
     else if ($tmp === 169) {
      Result = "uz"}
     else if ($tmp === 170) {
      Result = "ve"}
     else if ($tmp === 171) {
      Result = "vi"}
     else if ($tmp === 172) {
      Result = "wa"}
     else if ($tmp === 173) {
      Result = "wo"}
     else if ($tmp === 174) {
      Result = "xh"}
     else if ($tmp === 175) {
      Result = "yi"}
     else if ($tmp === 176) {
      Result = "yo"}
     else if ($tmp === 177) {
      Result = "za"}
     else if ($tmp === 178) {
      Result = "zh"}
     else if ($tmp === 179) Result = "zu";
    return Result;
  };
});
rtl.module("Rtl.BrowserLoadHelper",["System","Classes","SysUtils","JS","Web"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TBrowserLoadHelper",pas.Classes.TLoadHelper,function () {
  });
  $mod.$init = function () {
    pas.Classes.SetLoadHelperClass($mod.TBrowserLoadHelper);
  };
});
rtl.module("WEBLib.JSON",["System","Classes","Web","JS","SysUtils"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TJSONAncestor",pas.System.TObject,function () {
    this.GetStrValue = function () {
      var Result = "";
      Result = "";
      return Result;
    };
    this.SetStrValue = function (Value) {
    };
  });
  rtl.createClass(this,"TJSONValue",this.TJSONAncestor,function () {
    this.$init = function () {
      $mod.TJSONAncestor.$init.call(this);
      this.fjv = undefined;
      this.fjo = undefined;
    };
    this.GetStrValue = function () {
      var Result = "";
      Result = "" + this.fjv;
      return Result;
    };
    this.JSONValueFromJS = function (AJSValue) {
      var Result = null;
      var d = 0.0;
      Result = null;
      if (rtl.isArray(AJSValue)) {
        Result = $mod.TJSONArray.$create("Create");
        rtl.as(Result,$mod.TJSONArray).fja = AJSValue;
      } else if (rtl.isObject(AJSValue)) {
        Result = $mod.TJSONObject.$create("Create$2");
        rtl.as(Result,$mod.TJSONObject).fjo$1 = AJSValue;
      } else if (rtl.isString(AJSValue)) {
        Result = $mod.TJSONString.$create("Create");
        rtl.as(Result,$mod.TJSONString).SetStrValue("" + AJSValue);
      } else if (rtl.isNumber(AJSValue)) {
        Result = $mod.TJSONNumber.$create("Create");
        rtl.as(Result,$mod.TJSONNumber).SetStrValue("" + AJSValue);
        d = rtl.getNumber(AJSValue);
        rtl.as(Result,$mod.TJSONNumber).FDouble = d;
        if (pas.System.Frac(d) === 0) rtl.as(Result,$mod.TJSONNumber).FInt = rtl.trunc(AJSValue);
      } else if (pas.JS.isNull(AJSValue)) {
        Result = $mod.TJSONNull.$create("Create")}
       else if (pas.JS.isBoolean(AJSValue)) {
        if (pas.JS.toBoolean(AJSValue)) {
          Result = $mod.TJSONTrue.$create("Create")}
         else Result = $mod.TJSONFalse.$create("Create");
      };
      if (!(Result != null)) Result = $mod.TJSONNull.$create("Create");
      Result.fjv = AJSValue;
      return Result;
    };
    this.ToString = function () {
      var Result = "";
      Result = JSON.stringify(this.fjv);
      return Result;
    };
  });
  rtl.createClass(this,"TJSONPair",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.fjo = undefined;
      this.fjv = null;
      this.fjs = null;
    };
    this.$final = function () {
      this.fjv = undefined;
      this.fjs = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.fjs = $mod.TJSONString.$create("Create");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"fjs");
      pas.System.TObject.Destroy.call(this);
    };
    this.ToString = function () {
      var Result = "";
      if ($mod.TJSONObject.isPrototypeOf(this.fjv)) {
        Result = '"' + this.fjs.GetStrValue() + '":' + rtl.as(this.fjv,$mod.TJSONObject).ToJSON()}
       else {
        if ((this.fjs !== null) && (this.fjv !== null)) {
          Result = '"' + this.fjs.GetStrValue() + '":' + this.fjv.ToString()}
         else Result = "";
      };
      return Result;
    };
  });
  rtl.createClass(this,"TJSONPairList",pas.Classes.TList,function () {
  });
  rtl.createClass(this,"TJSONObject",this.TJSONValue,function () {
    this.$init = function () {
      $mod.TJSONValue.$init.call(this);
      this.fjo$1 = null;
      this.FMembers = null;
    };
    this.$final = function () {
      this.fjo$1 = undefined;
      this.FMembers = undefined;
      $mod.TJSONValue.$final.call(this);
    };
    this.GetCount = function () {
      var Result = 0;
      if (this.fjo$1 != null) {
        Result = rtl.length(Object.keys(this.fjo$1))}
       else if (this.FMembers != null) {
        Result = this.FMembers.GetCount()}
       else Result = 0;
      return Result;
    };
    this.Create$2 = function () {
      pas.System.TObject.Create.call(this);
      this.FMembers = $mod.TJSONPairList.$create("Create$1");
      this.fjo$1 = null;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FMembers");
      pas.System.TObject.Destroy.call(this);
    };
    this.ParseJSONValue = function (data) {
      var Result = null;
      var O = null;
      O = JSON.parse(data);
      Result = this.JSONValueFromJS(O);
      return Result;
    };
    this.Get = function (Name) {
      var Result = null;
      var jv = undefined;
      var jsv = null;
      var i = 0;
      var p = null;
      Result = null;
      if (this.fjo$1 != null) {
        jv = this.fjo$1[Name];
        if ((jv != undefined) || (jv === null)) {
          Result = $mod.TJSONPair.$create("Create$1");
          jsv = this.$class.JSONValueFromJS(jv);
          Result.fjo = this.fjo$1;
          Result.fjs.SetStrValue(Name);
          Result.fjv = jsv;
        };
      } else {
        for (var $l = 0, $end = this.FMembers.GetCount() - 1; $l <= $end; $l++) {
          i = $l;
          p = rtl.getObject(this.FMembers.Get(i));
          if (p.fjs.ToString() === ('"' + Name + '"')) Result = p;
        };
      };
      return Result;
    };
    this.Get$1 = function (Index) {
      var Result = null;
      Result = this.Get(Object.keys(this.fjo$1)[Index]);
      return Result;
    };
    this.GetValue$1 = function (Name) {
      var Result = null;
      var jp = null;
      Result = null;
      jp = this.Get(Name);
      if (jp != null) {
        Result = jp.fjv;
        Result.fjo = jp.fjo;
      };
      return Result;
    };
    this.ToJSON = function () {
      var Result = "";
      var s = "";
      var Size = 0;
      var I = 0;
      var jp = null;
      if (this.fjo$1 != null) {
        Size = this.GetCount()}
       else Size = this.FMembers.GetCount();
      s = "{";
      if (Size > 0) {
        if (this.fjo$1 != null) {
          jp = this.Get$1(0);
          if (jp != null) {
            s = s + jp.ToString()}
           else s = s + '"' + Object.keys(this.fjo$1)[0] + '":null';
        } else s = s + rtl.getObject(this.FMembers.Get(0)).ToString();
      };
      for (var $l = 1, $end = Size - 1; $l <= $end; $l++) {
        I = $l;
        if (this.fjo$1 != null) {
          jp = this.Get$1(I);
          if (jp != null) {
            s = s + "," + jp.ToString()}
           else s = s + "," + '"' + Object.keys(this.fjo$1)[I] + '":null';
        } else s = s + "," + rtl.getObject(this.FMembers.Get(I)).ToString();
      };
      s = s + "}";
      Result = s;
      return Result;
    };
    this.ToString = function () {
      var Result = "";
      Result = this.ToJSON();
      return Result;
    };
  });
  rtl.createClass(this,"TJSONString",this.TJSONValue,function () {
    this.$init = function () {
      $mod.TJSONValue.$init.call(this);
      this.FValue = "";
    };
    this.GetStrValue = function () {
      var Result = "";
      Result = this.FValue;
      return Result;
    };
    this.SetStrValue = function (Value) {
      this.FValue = Value;
      this.fjv = Value;
      if (pas.System.Assigned(this.fjo)) {
        var s = Object.keys(this.fjo)[0];
        this.fjo[s] = Value;
      };
    };
  });
  rtl.createClass(this,"TJSONNumber",this.TJSONString,function () {
    this.$init = function () {
      $mod.TJSONString.$init.call(this);
      this.FInt = 0;
      this.FInt64 = 0;
      this.FDouble = 0.0;
    };
    this.GetStrValue = function () {
      var Result = "";
      Result = pas.SysUtils.FloatToStr$1(this.FDouble,pas.SysUtils.TFormatSettings.Invariant());
      return Result;
    };
    this.SetStrValue = function (Value) {
      this.FDouble = pas.SysUtils.StrToFloat$1(Value,pas.SysUtils.TFormatSettings.Invariant());
      if (pas.System.Frac(this.FDouble) === 0) {
        if (!pas.SysUtils.TryStrToInt64$1(Value,{p: this, get: function () {
            return this.p.FInt64;
          }, set: function (v) {
            this.p.FInt64 = v;
          }},pas.SysUtils.TFormatSettings.Invariant())) this.FInt64 = 0;
        this.FInt = this.FInt64;
        this.fjv = this.FInt64;
      } else this.fjv = this.FDouble;
    };
  });
  rtl.createClass(this,"TJSONBool",this.TJSONValue,function () {
    this.$init = function () {
      $mod.TJSONValue.$init.call(this);
      this.FBool = false;
    };
    this.SetStrValue = function (Value) {
      var s = "";
      s = pas.SysUtils.UpperCase(Value);
      this.FBool = s === "TRUE";
    };
  });
  rtl.createClass(this,"TJSONTrue",this.TJSONBool,function () {
    this.GetStrValue = function () {
      var Result = "";
      Result = "true";
      return Result;
    };
    this.ToString = function () {
      var Result = "";
      Result = this.GetStrValue();
      return Result;
    };
  });
  rtl.createClass(this,"TJSONFalse",this.TJSONBool,function () {
    this.GetStrValue = function () {
      var Result = "";
      Result = "false";
      return Result;
    };
    this.ToString = function () {
      var Result = "";
      Result = this.GetStrValue();
      return Result;
    };
  });
  rtl.createClass(this,"TJSONNull",this.TJSONValue,function () {
    this.GetStrValue = function () {
      var Result = "";
      Result = "null";
      return Result;
    };
    this.ToString = function () {
      var Result = "";
      Result = this.GetStrValue();
      return Result;
    };
  });
  rtl.createClass(this,"TJSONArray",this.TJSONValue,function () {
    this.$init = function () {
      $mod.TJSONValue.$init.call(this);
      this.fja = null;
    };
    this.$final = function () {
      this.fja = undefined;
      $mod.TJSONValue.$final.call(this);
    };
    this.GetItem = function (index) {
      var Result = null;
      var jv = undefined;
      jv = this.GetJA()[index];
      if (rtl.isExt(jv,$mod.TJSONObject,1) || rtl.isExt(jv,$mod.TJSONArray,1)) {
        Result = rtl.getObject(jv)}
       else Result = this.$class.JSONValueFromJS(jv);
      return Result;
    };
    this.GetCount = function () {
      var Result = 0;
      Result = this.GetJA().length;
      return Result;
    };
    this.GetJA = function () {
      var Result = null;
      if (!(this.fja != null)) this.fja = new Array();
      Result = this.fja;
      return Result;
    };
    this.ToString = function () {
      var Result = "";
      var i = 0;
      var jv = null;
      var comma = "";
      Result = "[";
      comma = "";
      for (var $l = 0, $end = this.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        jv = this.GetItem(i);
        if (jv != null) {
          if ($mod.TJSONObject.isPrototypeOf(jv)) {
            Result = Result + comma + rtl.as(jv,$mod.TJSONObject).ToString();
          } else Result = Result + comma + jv.ToString();
          comma = ",";
        };
      };
      Result = Result + "]";
      return Result;
    };
  });
});
rtl.module("WEBLib.Forms",["System","Classes","Types","SysUtils","WEBLib.Graphics","WEBLib.Controls","WEBLib.Lang","WEBLib.Menus","Web","JS","Rtl.BrowserLoadHelper"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.idOK = 1;
  this.idCancel = 2;
  this.idAbort = 3;
  this.idRetry = 4;
  this.idIgnore = 5;
  this.idYes = 6;
  this.idNo = 7;
  this.idClose = 8;
  this.idHelp = 9;
  this.idContinue = 11;
  this.mrNone = 0;
  this.mrOk = 1;
  this.mrCancel = 2;
  this.mrAbort = 3;
  this.mrRetry = 4;
  this.mrIgnore = 5;
  this.mrYes = 6;
  this.mrNo = 7;
  this.mrClose = 8;
  this.mrHelp = 9;
  this.mrContinue = 11;
  this.mrAll = 11 + 1;
  this.mrNoToAll = 12 + 1;
  this.mrYesToAll = 13 + 1;
  this.rgiFirst = -1024;
  this.igiLast = 511;
  this.clTMSBlue = 0xE39E00;
  this.$rtti.$Int("TConstraintSize",{minvalue: 0, maxvalue: 2147483647, ordtype: 5});
  this.TCloseAction = {"0": "caNone", caNone: 0, "1": "caHide", caHide: 1, "2": "caFree", caFree: 2, "3": "caMinimize", caMinimize: 3};
  this.$rtti.$Enum("TCloseAction",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TCloseAction});
  this.TFormStyle = {"0": "fsNormal", fsNormal: 0, "1": "fsStayOnTop", fsStayOnTop: 1};
  this.$rtti.$Enum("TFormStyle",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TFormStyle});
  this.$rtti.$Int("TGestureID",{minvalue: -1024, maxvalue: 511, ordtype: 2});
  this.TInteractiveGestureFlag = {"0": "gfBegin", gfBegin: 0, "1": "gfInertia", gfInertia: 1, "2": "gfEnd", gfEnd: 2};
  this.$rtti.$Enum("TInteractiveGestureFlag",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TInteractiveGestureFlag});
  this.$rtti.$Set("TInteractiveGestureFlags",{comptype: this.$rtti["TInteractiveGestureFlag"]});
  this.TMouseActivate = {"0": "maDefault", maDefault: 0, "1": "maActivate", maActivate: 1, "2": "maActivateAndEat", maActivateAndEat: 2, "3": "maNoActivate", maNoActivate: 3, "4": "maNoActivateAndEat", maNoActivateAndEat: 4};
  this.$rtti.$Enum("TMouseActivate",{minvalue: 0, maxvalue: 4, ordtype: 1, enumtype: this.TMouseActivate});
  this.TScreenOrientation = {"0": "soPortrait", soPortrait: 0, "1": "soLandscape", soLandscape: 1};
  this.$rtti.$Enum("TScreenOrientation",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TScreenOrientation});
  this.TApplicationColorScheme = {"0": "csNoScheme", csNoScheme: 0, "1": "csLight", csLight: 1, "2": "csDark", csDark: 2};
  rtl.recNewT(this,"TSmallPoint",function () {
    this.x = 0;
    this.y = 0;
    this.$eq = function (b) {
      return (this.x === b.x) && (this.y === b.y);
    };
    this.$assign = function (s) {
      this.x = s.x;
      this.y = s.y;
      return this;
    };
    var $r = $mod.$rtti.$Record("TSmallPoint",{});
    $r.addField("x",rtl.smallint);
    $r.addField("y",rtl.smallint);
  });
  rtl.recNewT(this,"TAlignInfo",function () {
    this.AlignList = null;
    this.ControlIndex = 0;
    this.Align = 0;
    this.Scratch = 0;
    this.$eq = function (b) {
      return (this.AlignList === b.AlignList) && (this.ControlIndex === b.ControlIndex) && (this.Align === b.Align) && (this.Scratch === b.Scratch);
    };
    this.$assign = function (s) {
      this.AlignList = s.AlignList;
      this.ControlIndex = s.ControlIndex;
      this.Align = s.Align;
      this.Scratch = s.Scratch;
      return this;
    };
    var $r = $mod.$rtti.$Record("TAlignInfo",{});
    $r.addField("AlignList",pas.Classes.$rtti["TList"]);
    $r.addField("ControlIndex",rtl.longint);
    $r.addField("Align",pas["WEBLib.Controls"].$rtti["TAlign"]);
    $r.addField("Scratch",rtl.longint);
  });
  rtl.recNewT(this,"TGestureEventInfo",function () {
    this.GestureID = 0;
    this.Angle = 0.0;
    this.Distance = 0;
    this.$new = function () {
      var r = Object.create(this);
      r.Location = pas.Types.TPoint.$new();
      r.Flags = {};
      r.InertiaVector = $mod.TSmallPoint.$new();
      r.TapLocation = $mod.TSmallPoint.$new();
      return r;
    };
    this.$eq = function (b) {
      return (this.GestureID === b.GestureID) && this.Location.$eq(b.Location) && rtl.eqSet(this.Flags,b.Flags) && (this.Angle === b.Angle) && this.InertiaVector.$eq(b.InertiaVector) && (this.Distance === b.Distance) && this.TapLocation.$eq(b.TapLocation);
    };
    this.$assign = function (s) {
      this.GestureID = s.GestureID;
      this.Location.$assign(s.Location);
      this.Flags = rtl.refSet(s.Flags);
      this.Angle = s.Angle;
      this.InertiaVector.$assign(s.InertiaVector);
      this.Distance = s.Distance;
      this.TapLocation.$assign(s.TapLocation);
      return this;
    };
    var $r = $mod.$rtti.$Record("TGestureEventInfo",{});
    $r.addField("GestureID",$mod.$rtti["TGestureID"]);
    $r.addField("Location",pas.Types.$rtti["TPoint"]);
    $r.addField("Flags",$mod.$rtti["TInteractiveGestureFlags"]);
    $r.addField("Angle",rtl.double);
    $r.addField("InertiaVector",$mod.$rtti["TSmallPoint"]);
    $r.addField("Distance",rtl.longint);
    $r.addField("TapLocation",$mod.$rtti["TSmallPoint"]);
  });
  this.$rtti.$MethodVar("TCloseEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Action",this.$rtti["TCloseAction"],1]]), methodkind: 0});
  this.$rtti.$MethodVar("TCloseQueryEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["CanClose",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TOrientationChangeEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["AOrientation",this.$rtti["TScreenOrientation"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TBeforeUnloadEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["AMessage",rtl.string,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TAlignInsertBeforeEvent",{procsig: rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti["TWinControl"]],["C1",pas["WEBLib.Controls"].$rtti["TControl"]],["C2",pas["WEBLib.Controls"].$rtti["TControl"]]],rtl.boolean), methodkind: 1});
  this.$rtti.$MethodVar("TAlignPositionEvent",{procsig: rtl.newTIProcSig([["Sender",pas["WEBLib.Controls"].$rtti["TWinControl"]],["Control",pas["WEBLib.Controls"].$rtti["TControl"]],["NewLeft",rtl.longint,1],["NewTop",rtl.longint,1],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["AlignRect",pas.Types.$rtti["TRect"],1],["AlignInfo",this.$rtti["TAlignInfo"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TCanResizeEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["NewWidth",rtl.longint,1],["NewHeight",rtl.longint,1],["Resize",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TConstrainedResizeEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["MinWidth",rtl.longint,1],["MinHeight",rtl.longint,1],["MaxWidth",rtl.longint,1],["MaxHeight",rtl.longint,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TContextPopupEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["MousePos",pas.Types.$rtti["TPoint"]],["Handled",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TDockDropEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Source",this.$rtti["TDragDockObject"]],["X",rtl.longint],["Y",rtl.longint]]), methodkind: 0});
  this.$rtti.$MethodVar("TDockOverEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Source",this.$rtti["TDragDockObject"]],["X",rtl.longint],["Y",rtl.longint],["State",pas["WEBLib.Controls"].$rtti["TDragState"]],["Accept",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TGestureEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["EventInfo",this.$rtti["TGestureEventInfo"],2],["Handled",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TGetSiteInfoEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["DockClient",pas["WEBLib.Controls"].$rtti["TControl"]],["InfluenceRect",pas.Types.$rtti["TRect"],1],["MousePos",pas.Types.$rtti["TPoint"]],["CanDock",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TMouseActivateEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Button",pas["WEBLib.Controls"].$rtti["TMouseButton"]],["Shift",pas.Classes.$rtti["TShiftState"]],["X",rtl.longint],["Y",rtl.longint],["HitTest",rtl.longint],["MouseActivate",this.$rtti["TMouseActivate"],1]]), methodkind: 0});
  this.$rtti.$MethodVar("TMouseWheelUpDownEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Shift",pas.Classes.$rtti["TShiftState"]],["MousePos",pas.Types.$rtti["TPoint"]],["Handled",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("TStartDockEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["DragObject",this.$rtti["TDragDockObject"],1]]), methodkind: 0});
  this.$rtti.$MethodVar("TUnDockEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Client",pas["WEBLib.Controls"].$rtti["TControl"]],["NewTarget",pas["WEBLib.Controls"].$rtti["TWinControl"]],["Allow",rtl.boolean,1]]), methodkind: 0});
  this.$rtti.$MethodVar("THashChangeEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["oldURL",rtl.string],["newURL",rtl.string]]), methodkind: 0});
  this.TPopupMode = {"0": "pmNone", pmNone: 0, "1": "pmAuto", pmAuto: 1, "2": "pmExplicit", pmExplicit: 2};
  this.TPopupClose = {"0": "pcOnDeactivate", pcOnDeactivate: 0, "1": "pcNever", pcNever: 1};
  this.TPosition = {"0": "poDesigned", poDesigned: 0, "1": "poDefault", poDefault: 1, "2": "poDefaultPosOnly", poDefaultPosOnly: 2, "3": "poDefaultSizeOnly", poDefaultSizeOnly: 3, "4": "poScreenCenter", poScreenCenter: 4, "5": "poDesktopCenter", poDesktopCenter: 5, "6": "poMainFormCenter", poMainFormCenter: 6, "7": "poOwnerFormCenter", poOwnerFormCenter: 7};
  this.TApplicationErrorType = {"0": "aeSilent", aeSilent: 0, "1": "aeDialog", aeDialog: 1, "2": "aeAlert", aeAlert: 2, "3": "aeFooter", aeFooter: 3};
  this.TFormBorderStyle = {"0": "fbNone", fbNone: 0, "1": "fbSingle", fbSingle: 1, "2": "fbSizeable", fbSizeable: 2, "3": "fbDialog", fbDialog: 3, "4": "fbDialogSizeable", fbDialogSizeable: 4};
  this.TCSSLibrary = {"0": "cssNone", cssNone: 0, "1": "cssBootstrap", cssBootstrap: 1};
  this.$rtti.$Enum("TCSSLibrary",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TCSSLibrary});
  rtl.createClass(this,"TCustomSizeConstraints",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FControl = null;
      this.FMaxHeight = 0;
      this.FMaxWidth = 0;
      this.FMinHeight = 0;
      this.FMinWidth = 0;
      this.FOnChange = null;
    };
    this.$final = function () {
      this.FControl = undefined;
      this.FOnChange = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.SetConstraints = function (AIndex, AValue) {
      var $tmp = AIndex;
      if ($tmp === 0) {
        if (AValue !== this.FMaxHeight) {
          this.FMaxHeight = AValue;
          if ((AValue > 0) && (AValue < this.FMinHeight)) this.FMinHeight = AValue;
          this.Change();
        }}
       else if ($tmp === 1) {
        if (AValue !== this.FMaxWidth) {
          this.FMaxWidth = AValue;
          if ((AValue > 0) && (AValue < this.FMinWidth)) this.FMinWidth = AValue;
          this.Change();
        }}
       else if ($tmp === 2) {
        if (AValue !== this.FMinHeight) {
          this.FMinHeight = AValue;
          if ((this.FMaxHeight > 0) && (AValue > this.FMaxHeight)) this.FMaxHeight = AValue;
          this.Change();
        }}
       else if ($tmp === 3) if (AValue !== this.FMinWidth) {
        this.FMinWidth = AValue;
        if ((this.FMaxWidth > 0) && (AValue > this.FMaxWidth)) this.FMaxWidth = AValue;
        this.Change();
      };
    };
    this.Change = function () {
      if (this.FOnChange != null) this.FOnChange(this);
    };
    this.AssignTo = function (ADest) {
      if ($mod.TCustomSizeConstraints.isPrototypeOf(ADest)) {
        ADest.FMinHeight = this.FMinHeight;
        ADest.FMaxHeight = this.FMaxHeight;
        ADest.FMinWidth = this.FMinWidth;
        ADest.FMaxWidth = this.FMaxWidth;
        ADest.Change();
      } else pas.Classes.TPersistent.AssignTo.call(this,ADest);
    };
    this.Create$1 = function (AControl) {
      pas.System.TObject.Create.call(this);
      this.FControl = AControl;
      return this;
    };
  });
  rtl.createClass(this,"TSizeConstraints",this.TCustomSizeConstraints,function () {
    var $r = this.$rtti;
    $r.addProperty("MaxHeight",18,$mod.$rtti["TConstraintSize"],"FMaxHeight","SetConstraints",{index: 0, Default: 0});
    $r.addProperty("MaxWidth",18,$mod.$rtti["TConstraintSize"],"FMaxWidth","SetConstraints",{index: 1, Default: 0});
    $r.addProperty("MinHeight",18,$mod.$rtti["TConstraintSize"],"FMinHeight","SetConstraints",{index: 2, Default: 0});
    $r.addProperty("MinWidth",18,$mod.$rtti["TConstraintSize"],"FMinWidth","SetConstraints",{index: 3, Default: 0});
  });
  rtl.createClass(this,"TDragDockObject",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FBrush = null;
    };
    this.$final = function () {
      this.FBrush = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Destroy = function () {
      rtl.free(this,"FBrush");
      pas.System.TObject.Destroy.call(this);
    };
  });
  rtl.createClass(this,"TCustomForm",pas["WEBLib.Controls"].TWinControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TWinControl.$init.call(this);
      this.FDesignContainer = null;
      this.FLayer$1 = null;
      this.FPopup = false;
      this.FPopupElement = null;
      this.FFormFileName = "";
      this.FFormContainer = "";
      this.FFormElement = "";
      this.FFormStyle = 0;
      this.FOnCreate = null;
      this.FOnShow = null;
      this.FModalResult = 0;
      this.FOnPaint = null;
      this.FOnDeactivate = null;
      this.FOnCloseQuery = null;
      this.FOnClose = null;
      this.FModalProc = null;
      this.FCaption = "";
      this.FIsResizing$1 = false;
      this.FOnScroll = null;
      this.FOnUnload = null;
      this.FOnBeforeUnload = null;
      this.FPopupMode = 0;
      this.FPopupClose = 0;
      this.FPosition = 0;
      this.FMdx = 0;
      this.FMdy = 0;
      this.FDlgX = 0;
      this.FDlgY = 0;
      this.FCaptured$1 = false;
      this.FDown = false;
      this.FHasCaption = false;
      this.FMoveSpan = null;
      this.FCaptionElement = null;
      this.FCaptionCloseElement = null;
      this.FBorder = 0;
      this.FShadow = false;
      this.FTimerID = 0;
      this.FOldWidth = 0;
      this.FOldHeight = 0;
      this.FOnDestroy = null;
      this.FPopupOpacity = 0.0;
      this.FCreating = false;
      this.FLoadedPtr = null;
      this.FDOMContentLoadedPtr = null;
      this.FUnloadPtr = null;
      this.FBeforeUnloadPtr = null;
      this.FResizePtr = null;
      this.FScrollPtr = null;
      this.FDocMouseUpPtr = null;
      this.FDocMouseMovePtr = null;
      this.FTitleDownPtr = null;
      this.FDoClickPtr = null;
      this.FKeyDownPtr$1 = null;
      this.FOrientationChangePtr = null;
      this.FHashChangePtr = null;
      this.FCSSLibrary = 0;
      this.FNoHTML = false;
      this.FPrevActiveForm = null;
      this.FElementCaptionClassName = "";
      this.FMenu = null;
      this.FResizeObserver = null;
      this.FOnOrientationChange = null;
      this.FOnDOMContentLoaded = null;
      this.FShowClose = false;
      this.FOnHashChange = null;
    };
    this.$final = function () {
      this.FDesignContainer = undefined;
      this.FLayer$1 = undefined;
      this.FPopupElement = undefined;
      this.FOnCreate = undefined;
      this.FOnShow = undefined;
      this.FOnPaint = undefined;
      this.FOnDeactivate = undefined;
      this.FOnCloseQuery = undefined;
      this.FOnClose = undefined;
      this.FModalProc = undefined;
      this.FOnScroll = undefined;
      this.FOnUnload = undefined;
      this.FOnBeforeUnload = undefined;
      this.FMoveSpan = undefined;
      this.FCaptionElement = undefined;
      this.FCaptionCloseElement = undefined;
      this.FOnDestroy = undefined;
      this.FPrevActiveForm = undefined;
      this.FMenu = undefined;
      this.FResizeObserver = undefined;
      this.FOnOrientationChange = undefined;
      this.FOnDOMContentLoaded = undefined;
      this.FOnHashChange = undefined;
      pas["WEBLib.Controls"].TWinControl.$final.call(this);
    };
    this.SetModalResult = function (Value) {
      this.FModalResult = Value;
      if (this.FModalResult !== 0) this.Close();
    };
    this.GetFormStyle = function () {
      var Result = 0;
      Result = this.FFormStyle;
      return Result;
    };
    this.SetFormStyle = function (Value) {
      this.FFormStyle = Value;
    };
    this.SetCaption = function (AValue) {
      if (this.FCaption !== AValue) {
        this.FCaption = AValue;
        this.UpdateElement();
      };
    };
    this.SetShadow = function (Value) {
      if (this.FShadow !== Value) {
        this.FShadow = Value;
        this.UpdateElement();
      };
    };
    this.SetFormContainer = function (Value) {
      var el = null;
      var old = null;
      var i = 0;
      old = this.GetContainer();
      if (4 in this.FComponentState) {
        this.FFormContainer = Value}
       else {
        if (pas.SysUtils.UpperCase(Value) === "BODY") {
          this.FFormContainer = ""}
         else this.FFormContainer = Value;
      };
      if ((0 in this.FComponentState) && !(4 in this.FComponentState)) return;
      if (this.FLayer$1 != null) {
        el = this.FLayer$1}
       else if (Value === "") {
        el = document.body;
      } else {
        el = document.getElementById(Value);
        if (!(el != null)) el = document.body;
      };
      if (el != null) {
        this.FContainer = el;
        if (old != null) {
          for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
            i = $l;
            if (this.GetControls(i).FParentElement === old) this.GetControls(i).FParentElement = el;
            if ((this.GetControls(i).GetElementHandle() != null) && (this.GetControls(i).GetElementHandle().parentElement === old)) {
              el.appendChild(this.GetControls(i).GetElementHandle());
            };
          };
        };
      };
    };
    this.SetWidth = function (AValue) {
      var eh = null;
      if (((0 in this.FComponentState) && (this.FFormContainer !== "")) || (!this.FPopup && !(this.GetElementHandle() != null))) {
        this.SetWidthInt(AValue);
        return;
      };
      pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments);
      if (this.FPopup) {
        eh = this.FPopupElement;
        if (eh != null) eh.style.setProperty("width",pas.SysUtils.IntToStr(AValue) + "px");
      };
    };
    this.SetHeight = function (AValue) {
      var eh = null;
      if (((0 in this.FComponentState) && (this.FFormContainer !== "")) || (!this.FPopup && !(this.GetElementHandle() != null))) {
        this.SetHeightInt(AValue);
        return;
      };
      pas["WEBLib.Controls"].TControl.SetHeight.apply(this,arguments);
      if (this.FPopup) {
        eh = this.FPopupElement;
        if (eh != null) eh.style.setProperty("height",pas.SysUtils.IntToStr(AValue) + "px");
      };
    };
    this.HandleHashChange = function (Event) {
      var Result = false;
      var oldURL = "";
      var newURL = "";
      var newHash = "";
      var pc = null;
      var newform = null;
      oldURL = Event.oldURL;
      newURL = Event.newURL;
      if (this.FOnHashChange != null) {
        this.FOnHashChange(this,oldURL,newURL);
      };
      if ($mod.Application.FRouting) {
        newHash = pas.System.Copy(newURL,pas.System.Pos("#",newURL) + 1,newURL.length);
        pc = pas.Classes.GetClass("T" + this.FName);
        if (pc != null) {
          if ((pas.System.Pos("#" + this.FName + "_",oldURL + "_") !== 0) && (pas.System.Pos("#" + this.FName + "_",newURL + "_") === 0)) {
            this.Close();
          };
          if (!this.FPopup) {
            pc = pas.Classes.GetClass("T" + newHash);
            if (pc != null) $mod.Application.AutoCreateForm(pc,{get: function () {
                return newform;
              }, set: function (v) {
                newform = v;
              }});
          };
        };
      };
      Result = true;
      return Result;
    };
    this.HandleLoaded = function (Event) {
      var Result = false;
      this.Resize$1();
      this.InitAnchoring();
      Result = true;
      return Result;
    };
    this.HandleDOMContentLoaded = function (Event) {
      var Result = false;
      if (this.FOnDOMContentLoaded != null) this.FOnDOMContentLoaded(this);
      Result = true;
      return Result;
    };
    this.HandleScroll = function (Event) {
      var Result = false;
      if (this.FOnScroll != null) this.FOnScroll(this);
      Result = true;
      return Result;
    };
    this.HandleUnload = function (Event) {
      var Result = false;
      if (this.FOnUnload != null) this.FOnUnload(this);
      Result = true;
      return Result;
    };
    this.HandleBeforeUnload = function (Event) {
      var Result = false;
      var msg = "";
      msg = "";
      if (this.FOnBeforeUnload != null) this.FOnBeforeUnload(this,{get: function () {
          return msg;
        }, set: function (v) {
          msg = v;
        }});
      if (msg !== "") {
        Event.returnValue = msg;
        return msg;
      };
      Result = true;
      return Result;
    };
    this.HandleObserver = function () {
      var Result = false;
      this.Resize$1();
      Result = true;
      return Result;
    };
    this.HandleResize = function (Event) {
      var Result = false;
      if (this.FVisible && !(3 in this.FComponentState)) {
        if (!(this.GetContainer() != null)) this.CreateControl();
        this.Resize$1();
        if (this.GetElementHandle() === document.body) window.setTimeout(rtl.createSafeCallback(this,"Resize$1"),25);
      };
      if (1 < 0) {
        this.HandleObserver();
      };
      Result = true;
      return Result;
    };
    this.HandleDocMouseMove = function (Event) {
      var Result = false;
      var deltax = 0.0;
      var deltay = 0.0;
      var el = null;
      var l = 0;
      var t = 0;
      if (this.FDown && (this.GetContainer() != null)) {
        deltax = Event.screenX - this.FMdx;
        deltay = Event.screenY - this.FMdy;
        if (this.FHasCaption && (this.FFormFileName !== "")) {
          el = this.GetContainer().parentNode}
         else el = this.GetContainer();
        el.style.setProperty("transform","");
        el.style.setProperty("position","absolute");
        l = Math.round(this.FDlgX + deltax);
        t = Math.round(this.FDlgY + deltay);
        el.style.setProperty("left",pas.SysUtils.IntToStr(l) + "px");
        el.style.setProperty("top",pas.SysUtils.IntToStr(t) + "px");
        this.FLeft = l;
        this.FTop = t;
      };
      Result = true;
      return Result;
    };
    this.HandleDocMouseUp = function (Event) {
      var Result = false;
      if (this.FDown) {
        this.FCaptured$1 = false;
        this.FDown = false;
        document.body.removeEventListener("mousemove",this.FDocMouseMovePtr);
        document.body.removeEventListener("mouseup",this.FDocMouseUpPtr);
        if (this.FMoveSpan != null) document.body.removeChild(this.FMoveSpan);
        this.FEventStopPropagation = rtl.unionSet(this.FEventStopPropagation,rtl.createSet(3,2));
        this.FMoveSpan = null;
      };
      Result = true;
      return Result;
    };
    this.HandleTitleDown = function (Event) {
      var Result = false;
      var r = null;
      Event.stopPropagation();
      Event.preventDefault();
      this.FPopupClose = 1;
      this.FMdx = Math.round(Event.screenX);
      this.FMdy = Math.round(Event.screenY);
      if (this.FHasCaption && (this.FFormFileName !== "")) {
        r = this.GetContainer().parentNode.getBoundingClientRect()}
       else r = this.GetContainer().getBoundingClientRect();
      this.FDlgX = Math.round(pas.System.Int(r.left));
      this.FDlgY = Math.round(pas.System.Int(r.top));
      this.FDown = true;
      if (!this.FCaptured$1) {
        this.FCaptured$1 = true;
        this.FMoveSpan = document.createElement("SPAN");
        this.FMoveSpan.style.setProperty("top","0");
        this.FMoveSpan.style.setProperty("left","0");
        this.FMoveSpan.style.setProperty("right","0");
        this.FMoveSpan.style.setProperty("bottom","0");
        this.FMoveSpan.style.setProperty("position","absolute");
        document.body.appendChild(this.FMoveSpan);
        this.FEventStopPropagation = rtl.diffSet(this.FEventStopPropagation,rtl.createSet(3,2));
        document.body.addEventListener("mousemove",this.FDocMouseMovePtr);
        document.body.addEventListener("mouseup",this.FDocMouseUpPtr);
      };
      Result = true;
      return Result;
    };
    this.HandleCloseClick = function (Event) {
      var Result = false;
      var CanClose = false;
      CanClose = true;
      if (this.FOnCloseQuery != null) this.FOnCloseQuery(this,{get: function () {
          return CanClose;
        }, set: function (v) {
          CanClose = v;
        }});
      if (CanClose) this.Close();
      Result = true;
      return Result;
    };
    this.SetLeft = function (AValue) {
      var eh = null;
      pas["WEBLib.Controls"].TControl.SetLeft.apply(this,arguments);
      if (this.FPopup) {
        eh = this.FPopupElement;
        if (eh != null) eh.style.setProperty("left",pas.SysUtils.IntToStr(AValue) + "px");
      };
    };
    this.SetTop = function (AValue) {
      var eh = null;
      pas["WEBLib.Controls"].TControl.SetTop.apply(this,arguments);
      if (this.FPopup) {
        eh = this.FPopupElement;
        if (eh != null) eh.style.setProperty("top",pas.SysUtils.IntToStr(AValue) + "px");
      };
    };
    this.ClearMethodPointers = function () {
      pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this);
      this.FLoadedPtr = null;
      this.FDOMContentLoadedPtr = null;
      this.FUnloadPtr = null;
      this.FBeforeUnloadPtr = null;
      this.FResizePtr = null;
      this.FScrollPtr = null;
      this.FDocMouseUpPtr = null;
      this.FDocMouseMovePtr = null;
      this.FTitleDownPtr = null;
      this.FDoClickPtr = null;
      this.FKeyDownPtr$1 = null;
      this.FOrientationChangePtr = null;
      this.FHashChangePtr = null;
    };
    this.GetMethodPointers = function () {
      pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this);
      if (this.FLoadedPtr === null) {
        this.FLoadedPtr = rtl.createCallback(this,"HandleLoaded");
        this.FDOMContentLoadedPtr = rtl.createCallback(this,"HandleDOMContentLoaded");
        this.FUnloadPtr = rtl.createCallback(this,"HandleUnload");
        this.FBeforeUnloadPtr = rtl.createCallback(this,"HandleBeforeUnload");
        this.FResizePtr = rtl.createCallback(this,"HandleResize");
        this.FScrollPtr = rtl.createCallback(this,"HandleScroll");
        this.FDocMouseUpPtr = rtl.createCallback(this,"HandleDocMouseUp");
        this.FDocMouseMovePtr = rtl.createCallback(this,"HandleDocMouseMove");
        this.FTitleDownPtr = rtl.createCallback(this,"HandleTitleDown");
        this.FDoClickPtr = rtl.createCallback(this,"HandleDoClick$1");
        this.FKeyDownPtr$1 = rtl.createCallback(this,"HandleKeyDown");
        this.FOrientationChangePtr = rtl.createCallback(this,"HandleOrientationChange");
        this.FHashChangePtr = rtl.createCallback(this,"HandleHashChange");
      };
    };
    this.VisibleChanged = function () {
      pas["WEBLib.Controls"].TControl.VisibleChanged.call(this);
      if (this.FLayer$1 != null) {
        if (this.FVisible) {
          this.FLayer$1.style.setProperty("display","")}
         else this.FLayer$1.style.setProperty("display","none");
      } else {
        if ((this.GetContainer() != null) && (this.FFormContainer !== "")) {
          if (this.FVisible) {
            this.GetContainer().style.setProperty("display","")}
           else this.GetContainer().style.setProperty("display","none");
        };
      };
    };
    this.Resize$1 = function () {
      var i = 0;
      var ch = 0;
      var neww = 0;
      var newh = 0;
      var eh = null;
      var dr = null;
      if (3 in this.FComponentState) return;
      this.FIsResizing$1 = true;
      if (this.FPopup && (this.FPopupElement != null)) {
        eh = this.FPopupElement;
        dr = eh.getBoundingClientRect();
        neww = Math.round(dr.right - dr.left - 2);
        if (this.FBorder in rtl.createSet(3,4)) {
          ch = this.GetCaptionHeight();
          newh = Math.round(dr.bottom - dr.top - ch - 2);
        } else newh = Math.round(dr.bottom - dr.top - 2);
      } else {
        neww = window.innerWidth;
        newh = window.innerHeight;
      };
      this.UpdateControlSize(neww,newh);
      if (!(pas["WEBLib.Controls"].IsAndroid() && (document.activeElement.tagName === "INPUT"))) this.AlignControl(this);
      this.DoResize();
      this.FIsResizing$1 = false;
      if (!this.IsUpdating()) {
        if ((this.FOrigRect.Left === -1) && (this.FOrigRect.Top === -1)) this.InitAnchoring();
        for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
          i = $l;
          this.GetControls(i).UpdateAnchoring();
        };
      };
    };
    this.CreateControl = function () {
      if (!this.FVisible && !this.FPopup) return;
      pas["WEBLib.Controls"].TControl.CreateControl.call(this);
      this.UpdateSize();
    };
    this.DoClose = function (CloseAction) {
      if ((this.FModalProc != null) && (CloseAction.get() !== 0)) {
        this.FModalProc(this.FModalResult);
        this.FModalProc = null;
      };
    };
    this.BindEvents = function () {
      var pc = null;
      var hash = "";
      pas["WEBLib.Controls"].TControl.BindEvents.call(this);
      if (document.readyState !== "loading") if (this.FOnDOMContentLoaded != null) this.FOnDOMContentLoaded(this);
      window.addEventListener("resize",this.FResizePtr);
      window.addEventListener("load",this.FLoadedPtr);
      window.addEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr);
      document.addEventListener("scroll",this.FScrollPtr);
      window.addEventListener("unload",this.FUnloadPtr);
      window.addEventListener("beforeunload",this.FBeforeUnloadPtr);
      window.addEventListener("keydown",this.FKeyDownPtr$1);
      window.addEventListener("orientationchange",this.FOrientationChangePtr);
      window.addEventListener("hashchange",this.FHashChangePtr);
      pc = pas.Classes.GetClass(this.$classname);
      if ((pc != null) && !this.FPopup && $mod.Application.FRouting) {
        hash = this.$classname;
        pas.System.Delete({get: function () {
            return hash;
          }, set: function (v) {
            hash = v;
          }},1,1);
        $mod.LastHash = hash;
        window.location.hash = hash;
      };
    };
    this.UnbindEvents = function () {
      pas["WEBLib.Controls"].TControl.UnbindEvents.call(this);
      if ((this.FLayer$1 != null) && (this.FPopupClose === 0)) this.FLayer$1.removeEventListener("click",this.FDoClickPtr);
      if (this.FResizeObserver != null) {
        this.FResizeObserver.disconnect();
      };
      window.removeEventListener("resize",this.FResizePtr);
      window.removeEventListener("load",this.FLoadedPtr);
      window.removeEventListener("DOMContentLoaded",this.FDOMContentLoadedPtr);
      document.removeEventListener("scroll",this.FScrollPtr);
      window.removeEventListener("unload",this.FUnloadPtr);
      window.removeEventListener("beforeunload",this.FBeforeUnloadPtr);
      window.removeEventListener("keydown",this.FKeyDownPtr$1);
      window.removeEventListener("orientationchange",this.FOrientationChangePtr);
      window.removeEventListener("hashchange",this.FHashChangePtr);
    };
    this.DoCreate = function () {
      this.BeginUpdate();
      this.LoadDFMValues();
      this.Loaded();
      if (this.FOnCreate != null) this.FOnCreate(this);
      this.FCreating = false;
      this.EndUpdate();
      this.UpdateChildren(this);
      this.Realign();
      this.DoResize();
    };
    this.Realign = function () {
      var el = null;
      var dr = null;
      var r = pas.Types.TRect.$new();
      if ((this.FFormContainer !== "") && (this.FAlign !== 0)) {
        el = document.getElementById(this.FFormContainer);
        if (el != null) {
          dr = el.getBoundingClientRect();
          if ((dr.width === 0) && (dr.height === 0) && (el.style.getPropertyValue("position") === "absolute")) {
            r.$assign(pas["WEBLib.Controls"].GetHTMLElementAbsoluteRect(el));
          } else {
            r.$assign(pas.Types.Rect(Math.round(dr.left),Math.round(dr.top),Math.round(dr.right),Math.round(dr.bottom)));
          };
          this.SetBoundsInt(r.Left,r.Top,r.Right - r.Left,r.Bottom - r.Top);
        };
      };
      pas["WEBLib.Controls"].TControl.Realign.call(this);
    };
    this.DoResize = function () {
      var w = 0;
      var h = 0;
      w = this.GetWidth();
      h = this.GetHeight();
      if ((w === this.FOldWidth) && (h === this.FOldHeight)) return;
      this.FOldWidth = w;
      this.FOldHeight = h;
      if (this.FOnResize != null) this.FOnResize(this);
    };
    this.DoShow = function () {
      if (this.FOnShow != null) this.FOnShow(this);
    };
    this.HandleDoClick$1 = function (Event) {
      var Result = false;
      Event.stopPropagation();
      if (this.FPopupClose === 0) this.Close();
      Result = true;
      return Result;
    };
    this.HandleKeyDown = function (Event) {
      var Result = false;
      var k = 0;
      k = this.GetKeyCode(Event.key,true);
      if (!pas.System.Assigned(k)) return Result;
      if ((k === 27) && !(4 in this.FComponentState) && this.FPopup) {
        this.Close();
      };
      Result = true;
      return Result;
    };
    this.HandleOrientationChange = function (Event) {
      var Result = false;
      var so = 0;
      var isPortrait = false;
      this.Resize$1();
      this.Realign();
      Result = true;
      if (this.FOnOrientationChange != null) {
        var mql = window.matchMedia("(orientation: portrait)");
        isPortrait = (mql.matches);
        if (isPortrait) {
          so = 1}
         else so = 0;
        this.FOnOrientationChange(this,so);
      };
      if (this.FOnResize != null) this.FOnResize(this);
      return Result;
    };
    this.KeyPreview = function (Key, Shift) {
      var i = 0;
      var lt = 0;
      var ft = 0;
      var lti = 0;
      var fti = 0;
      lt = -1;
      ft = 0xFFFF;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (!this.GetControls(i).FVisible && this.GetControls(i).FEnabled) continue;
        if (this.GetControls(i).FTabOrder < ft) {
          ft = this.GetControls(i).FTabOrder;
          fti = i;
        };
        if (this.GetControls(i).FTabOrder > lt) {
          lt = this.GetControls(i).FTabOrder;
          lti = i;
        };
        if ((Key.get() === 13) || (Key.get() === 27)) this.GetControls(i).HandleKeyPreview(Key.get());
      };
      if ($mod.Application.FMainForm === this) return;
      if ((Key.get() === 9) && !(0 in Shift) && (lti < this.GetControlsCount()) && (fti >= 0) && (fti !== lti)) {
        if (this.GetControls(lti).Focused()) {
          this.GetControls(fti).SetFocus();
          Key.set(0);
        };
      };
      if ((Key.get() === 9) && (0 in Shift) && (fti >= 0) && (lti < this.GetControlsCount()) && (fti !== lti)) {
        if (this.GetControls(fti).Focused()) {
          this.GetControls(lti).SetFocus();
          Key.set(0);
        };
      };
    };
    this.GetWidth = function () {
      var Result = 0;
      var dr = null;
      var el = null;
      if (this.FFormElement !== "") {
        el = document.getElementById(this.FFormElement);
        if (el != null) {
          dr = el.getBoundingClientRect();
          Result = Math.round(dr.right - dr.left);
          return Result;
        };
      };
      if (this.GetElementHandle() === document.body) {
        Result = window.innerWidth;
        dr = document.documentElement.getBoundingClientRect();
        Result = Math.round(dr.width);
        if (Result > window.innerWidth) Result = window.innerWidth;
      } else {
        if (this.FPopup) {
          Result = pas["WEBLib.Controls"].TControl.GetWidth.call(this)}
         else {
          Result = Math.round(this.GetElementHandle().offsetWidth);
          if (Result === 0) {
            if (this.FFormContainer !== "") {
              Result = pas["WEBLib.Controls"].TControl.GetWidth.call(this)}
             else Result = window.innerWidth;
          };
        };
      };
      return Result;
    };
    this.GetHeight = function () {
      var Result = 0;
      var d = 0;
      var s = "";
      var css = null;
      var el = null;
      var dr = null;
      if (this.FFormElement !== "") {
        el = document.getElementById(this.FFormElement);
        if (el != null) {
          dr = el.getBoundingClientRect();
          Result = Math.round(dr.bottom - dr.top);
          return Result;
        };
      };
      if (this.GetElementHandle() === document.body) {
        css = window.getComputedStyle(this.GetElementHandle());
        s = css.getPropertyValue("margin-top");
        s = pas.System.Copy(s,1,s.length - 2);
        d = Math.round(pas.SysUtils.StrToFloat$1(s,pas.SysUtils.TFormatSettings.Invariant()) - 2);
        dr = document.documentElement.getBoundingClientRect();
        Result = Math.round(dr.height);
        if (Result > window.innerHeight) Result = window.innerHeight - Math.max(0,d);
      } else {
        if (this.FPopup) {
          Result = pas["WEBLib.Controls"].TControl.GetHeight.call(this);
        } else {
          Result = Math.round(this.GetElementHandle().offsetHeight);
          if (Result === 0) {
            if (this.FFormContainer !== "") {
              Result = pas["WEBLib.Controls"].TControl.GetHeight.call(this)}
             else Result = window.innerHeight;
          };
        };
      };
      return Result;
    };
    this.GetLeft = function () {
      var Result = 0;
      var el = null;
      var dr = null;
      if (this.FPopup) {
        Result = pas["WEBLib.Controls"].TControl.GetLeft.call(this);
      } else {
        if (this.FFormElement !== "") {
          el = document.getElementById(this.FFormElement);
          if (el != null) {
            dr = el.getBoundingClientRect();
            Result = Math.round(dr.left);
          };
        } else {
          el = null;
          if (this.FFormContainer !== "") el = document.getElementById(this.FFormContainer);
          if (!(el != null)) el = this.GetElementHandle();
          Result = Math.round(el.offsetLeft);
        };
      };
      return Result;
    };
    this.GetTop = function () {
      var Result = 0;
      var el = null;
      var dr = null;
      if (this.FPopup) {
        Result = pas["WEBLib.Controls"].TControl.GetTop.call(this)}
       else {
        if (this.FFormElement !== "") {
          el = document.getElementById(this.FFormElement);
          if (el != null) {
            dr = el.getBoundingClientRect();
            Result = Math.round(dr.top);
          };
        } else {
          el = null;
          if (this.FFormContainer !== "") el = document.getElementById(this.FFormContainer);
          if (!(el != null)) el = this.GetElementHandle();
          Result = Math.round(el.offsetTop);
        };
      };
      return Result;
    };
    this.GetClientRect = function () {
      var Result = pas.Types.TRect.$new();
      Result.$assign(pas["WEBLib.Controls"].TControl.GetClientRect.call(this));
      return Result;
    };
    this.CreateElement = function () {
      var Result = null;
      var eh = null;
      var caph = null;
      if (!this.FPopup && (this.FormContainerElement() != null)) {
        Result = this.FormContainerElement();
        return Result;
      };
      Result = document.createElement("DIV");
      this.FLayer$1 = this.CreateLayer();
      document.body.appendChild(this.FLayer$1);
      eh = this.FLayer$1;
      if (this.FPopupClose === 0) {
        this.GetMethodPointers();
        eh.addEventListener("click",this.FDoClickPtr);
      };
      eh.style.setProperty(pas["WEBLib.Controls"].CSSZIndex,$mod.Application.MaxZIndexStr());
      if (this.FBorder === 2) {
        Result.style.setProperty("resize","both");
        Result.style.setProperty("overflow","auto");
      };
      this.FHasCaption = false;
      if (this.FBorder in rtl.createSet(2,3,4)) {
        caph = this.CreateCaption();
        Result.appendChild(caph);
      };
      return Result;
    };
    this.UpdateElement = function () {
      var clr = "";
      var el = null;
      if (this.FCreating) return;
      pas["WEBLib.Controls"].TControl.UpdateElement.call(this);
      if (this.IsUpdating()) return;
      if ((this.GetElementHandle() != null) || (this.GetContainer() != null)) {
        if (this.FCaption !== "") {
          if (!this.FPopup) {
            window.document.title = this.FCaption}
           else {
            if (this.FCaptionElement != null) {
              el = this.FCaptionElement.childNodes.item(0);
              if (el != null) el.nodeValue = this.FCaption;
              if (this.FShowClose && !(this.FCaptionCloseElement != null)) {
                this.FCaptionCloseElement = document.createElement("SPAN");
                this.FCaptionCloseElement.style.setProperty("float","right");
                this.FCaptionCloseElement.style.setProperty("cursor","default");
                this.FCaptionCloseElement.style.setProperty("margin-right","8px");
                this.FCaptionCloseElement.innerHTML = "&#x2716;";
                this.FCaptionElement.appendChild(this.FCaptionCloseElement);
                this.FCaptionCloseElement.addEventListener("click",rtl.createSafeCallback(this,"HandleCloseClick"));
              };
              pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!((this.FElementCaptionClassName === "") && (this.FElementFont === 0)));
            };
          };
        };
      };
      if (this.GetContainer() != null) {
        clr = pas["WEBLib.Graphics"].ColorToHTML(this.FColor);
        if (this.GetContainer() != null) {
          if ((this.FColor !== -1) && (this.FColor !== 16777215) && !this.FPopup && (this.FElementClassName === "")) this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,clr);
          if ((this.FElementClassName !== "") || (this.FColor === -1) || ((this.FColor === 16777215) && !this.FPopup)) this.GetContainer().style.removeProperty(pas["WEBLib.Controls"].CSSBackground);
          if ((this.FElementClassName === "") && !this.FPopup) {
            document.documentElement.style.setProperty('height','100%');
          };
          pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContainer(),this.FFont,!((this.FElementClassName === "") && (this.FElementFont === 0)));
        };
        if (this.FPopup) {
          if (!(this.FPopupElement != null)) this.FPopupElement = this.GetContainer();
          if (this.FShadow) {
            this.FPopupElement.style.setProperty("box-shadow","3px 3px 3px silver");
          } else {
            this.FPopupElement.style.removeProperty("box-shadow");
          };
          this.FPopupElement.style.setProperty("border","1px solid gray");
        } else {
          this.GetContainer().style.removeProperty("box-shadow");
        };
      };
    };
    this.ContainerElement = function () {
      var Result = null;
      Result = this.FormContainerElement();
      return Result;
    };
    this.FormContainerElement = function () {
      var Result = null;
      if (4 in this.FComponentState) {
        if (this.FDesignContainer != null) Result = this.FDesignContainer;
      };
      if (this.FFormContainer !== "") {
        Result = document.getElementById(this.FFormContainer);
        if (!(Result != null)) Result = document.body;
      } else {
        Result = document.body;
      };
      return Result;
    };
    this.GetElementBindHandle = function () {
      var Result = null;
      if (4 in this.FComponentState) {
        Result = window;
        return Result;
      };
      if (this.FFormContainer !== "") {
        Result = window;
      } else {
        if (!this.FPopup) {
          Result = window;
        } else Result = pas["WEBLib.Controls"].TControl.GetElementBindHandle.call(this);
      };
      return Result;
    };
    this.GetElementHandle = function () {
      var Result = null;
      if (this.FPopup) {
        Result = pas["WEBLib.Controls"].TControl.GetElementHandle.call(this)}
       else Result = this.FormContainerElement();
      return Result;
    };
    this.SetElementClassName = function (AValue) {
      pas["WEBLib.Controls"].TControl.SetElementClassName.apply(this,arguments);
      if (this.FPopup && (this.FPopupElement != null)) {
        this.FPopupElement.setAttribute("class",AValue);
      };
    };
    this.CloseQuery = function () {
      var Result = false;
      Result = true;
      if (this.FOnCloseQuery != null) this.FOnCloseQuery(this,{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }});
      return Result;
    };
    this.LoadDFMValues = function () {
    };
    this.Init = function () {
    };
    this.CreateLayer = function () {
      var Result = null;
      Result = document.createElement("SPAN");
      Result.style.setProperty("top","0");
      Result.style.setProperty("left","0");
      Result.style.setProperty("right","0");
      Result.style.setProperty("bottom","0");
      Result.style.setProperty("webkit-user-select","none");
      Result.style.setProperty("moz-user-select","none");
      Result.style.setProperty("khtml-user-select","none");
      Result.style.setProperty("ms-user-select","none");
      Result.style.setProperty("user-select","none");
      Result.style.setProperty("position","absolute");
      Result.style.setProperty("z-index",$mod.Application.MaxZIndexStr());
      return Result;
    };
    this.CreateCaption = function () {
      var Result = null;
      var BarHeight = "";
      BarHeight = pas.SysUtils.IntToStr($mod.Application.FFormCaptionHeight);
      this.FCaptionElement = document.createElement("DIV");
      this.FCaptionElement.innerHTML = this.FCaption;
      this.FCaptionElement.style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML($mod.Application.FThemeColor));
      this.FCaptionElement.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML($mod.Application.FThemeTextColor));
      this.FCaptionElement.style.setProperty("cursor","move");
      this.FCaptionElement.style.setProperty("height",BarHeight + "px");
      this.FCaptionElement.style.setProperty("line-height",BarHeight + "px");
      this.FCaptionElement.style.setProperty("border-bottom","1px solid black");
      this.FCaptionElement.style.setProperty("padding-left","4px");
      this.FCaptionElement.style.setProperty("-moz-user-select","none");
      this.FCaptionElement.style.setProperty("-webkit-user-select","none");
      this.FCaptionElement.style.setProperty("-ms-user-select","none");
      this.FCaptionElement.style.setProperty("user-select","none");
      this.FCaptionElement.style.setProperty("-o-user-select","none");
      if (this.FElementCaptionClassName !== "") this.FCaptionElement.setAttribute("class",this.FElementCaptionClassName);
      pas["WEBLib.Controls"].SetHTMLElementFont(this.FCaptionElement,this.FFont,!((this.FElementCaptionClassName === "") && (this.FElementFont === 0)));
      if (!(this.FTitleDownPtr != null)) this.GetMethodPointers();
      this.FCaptionElement.innerHTML = this.FCaption;
      this.FCaptionElement.addEventListener("mousedown",this.FTitleDownPtr);
      this.FHasCaption = true;
      Result = this.FCaptionElement;
      return Result;
    };
    this.GetCaptionHeight = function () {
      var Result = 0;
      var r = null;
      Result = 0;
      if ((this.FCaptionElement != null) && (this.FBorder in rtl.createSet(3,4))) {
        r = this.FCaptionElement.getBoundingClientRect();
        Result = Math.round(r.bottom - r.top);
      };
      return Result;
    };
    this.SetColorScheme = function (AScheme) {
      var s = "";
      if (!$mod.Application.FThemed) return;
      var $tmp = AScheme;
      if ($tmp === 2) {
        s = "label,option,td,table,ul,li {background-color: #202124; color: #BEC1C6;}" + "\r\n" + "body,input,textarea,select,fieldset {background-color: #202124; color: #BEC1C6; border: 1px solid gray;}" + "\r\n" + "input:focus, textarea:focus, select:focus, span:focus { border: 1px solid silver; outline: none !important;}";
        this.AddCSS("appscheme",s);
      } else if ($tmp === 1) this.RemoveCSS("appscheme");
    };
    this.GetHTMLFileName = function () {
      var Result = "";
      Result = this.$module.$name + $mod.Application.GetFormExtension();
      return Result;
    };
    this.LoadedDone = function () {
      $mod.Application.TriggerNotification();
    };
    this.Loaded = function () {
      pas["WEBLib.Controls"].TControl.Loaded.call(this);
      this.LoadedDone();
    };
    this.ColorChanging = function () {
      pas["WEBLib.Controls"].TControl.ColorChanging.call(this);
      if (this.GetContainer() != null) {
        this.GetContainer().style.setProperty(pas["WEBLib.Controls"].CSSBackground,pas["WEBLib.Graphics"].ColorToHTML(this.FColor));
      };
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TControl.CreateInitialize.call(this);
      this.FAllowTouch = true;
      this.FModalResult = 0;
      this.FFormStyle = 0;
      this.FBorder = 2;
      this.FShadow = true;
      this.FShowClose = true;
      this.FTimerID = -1;
      this.FCaptionElement = null;
      this.FColor = 16777215;
      window.addEventListener("load",this.FLoadedPtr);
    };
    this.Create$2 = function (id) {
      this.FNoHTML = false;
      this.FCreating = true;
      this.FFormContainer = id;
      if (id === "") {
        pas["WEBLib.Controls"].TControl.Create$2.call(this,pas["WEBLib.WebTools"].cBodyTag)}
       else pas["WEBLib.Controls"].TControl.Create$2.call(this,id);
      this.FFormElement = "";
      this.FModalResult = 0;
      this.FFormStyle = 0;
      this.DoCreate();
      return this;
    };
    this.Create$5 = function (id, AReference) {
      this.FCreating = true;
      this.FFormContainer = id;
      pas["WEBLib.Controls"].TControl.Create$2.call(this,id);
      AReference.set(this);
      this.FFormElement = "";
      this.FModalResult = 0;
      this.FFormStyle = 0;
      this.DoCreate();
      return this;
    };
    this.Create$1 = function (AOwner) {
      this.FNoHTML = false;
      this.FCreating = true;
      this.FResizeObserver = null;
      pas["WEBLib.Controls"].TControl.Create$1.apply(this,arguments);
      this.FBorder = 1;
      this.FFormFileName = "";
      this.FPopupMode = 0;
      this.FPopupClose = 0;
      this.FPopup = true;
      this.FPosition = 4;
      this.FPopupOpacity = 1.0;
      return this;
    };
    this.Destroy = function () {
      if (this.FVisible) this.Close();
      if (this.FOnDestroy != null) this.FOnDestroy(this);
      pas["WEBLib.Controls"].TControl.Destroy.call(this);
      if (this.FLayer$1 != null) {
        if (this.FormContainerElement() === this.FLayer$1.parentNode) this.FormContainerElement().removeChild(this.FLayer$1);
        this.FLayer$1 = null;
      };
    };
    this.Close = function () {
      var lAction = 0;
      var el = null;
      if (this.CloseQuery()) {
        this.UnbindEvents();
        lAction = 1;
        if (this.FTimerID !== -1) {
          window.clearInterval(this.FTimerID);
          this.FTimerID = -1;
        };
        if (this.FOnClose != null) this.FOnClose(this,{get: function () {
            return lAction;
          }, set: function (v) {
            lAction = v;
          }});
        if (lAction !== 0) {
          if (this.FLayer$1 != null) {
            if (this.GetContainer().parentNode === this.FLayer$1) {
              this.FLayer$1.removeChild(this.GetContainer());
            } else {
              if (this.GetContainer().parentNode.parentNode === this.FLayer$1) this.FLayer$1.removeChild(this.GetContainer().parentNode);
            };
            this.FContainer = null;
            if (this.FormContainerElement() === this.FLayer$1.parentNode) {
              this.FormContainerElement().removeChild(this.FLayer$1);
              $mod.Application.ChangeMaxZIndex(-1);
            };
            this.FLayer$1 = null;
          };
          if (this.FFormFileName === "") {
            if ((this.FFormElement !== "") && (this.GetContainer() != null)) {
              this.GetContainer().innerHTML = "";
              this.FContainer = null;
            } else if (this.GetContainer() != null) {
              if (this.FormContainerElement() === this.GetContainer().parentNode) this.FormContainerElement().removeChild(this.GetContainer());
              this.FContainer = null;
            };
          } else {
            if (this.FFormElement !== "") {
              this.GetContainer().innerHTML = "";
              this.FContainer = null;
            };
          };
          if ((this.FFormElement !== this.FFormContainer) && (this.FFormElement !== "")) {
            el = document.getElementById(this.FFormElement);
            if (el != null) el.innerHTML = "";
          };
          this.DoClose({get: function () {
              return lAction;
            }, set: function (v) {
              lAction = v;
            }});
          if ((lAction === 2) && !(3 in this.FComponentState)) {
            this.SetVisible(false);
            $impl.ReleaseForm(this);
            if ($mod.Application.FMainForm === this) $mod.Application.FMainForm = null;
          };
          $mod.Application.FActiveForm = this.FPrevActiveForm;
          this.SetVisible(false);
        };
      };
    };
    this.IsMiletus = function () {
      var Result = false;
      var cl = null;
      cl = this.$class.ClassType();
      Result = false;
      do {
        cl = cl.$ancestor;
        if ((cl != null) && (cl.$classname === "TMiletusForm")) {
          Result = true;
          break;
        };
      } while (!(!(cl != null) || (cl.$classname === "TForm")));
      return Result;
    };
    this.AddCSS = function (id, css) {
      function writeStylesOnce(styleName, cssText) {
          var styleElement = document.getElementById(styleName);
          if (styleElement) {
               styleElement.innerHTML = cssText;
            return;
            }
          styleElement = document.createElement('style');
          styleElement.type = 'text/css';
          styleElement.id = styleName;
          styleElement.innerHTML = cssText;
          document.getElementsByTagName('head')[0].appendChild(styleElement);
      }
      writeStylesOnce(id,css);
    };
    this.RemoveCSS = function (id) {
      var el = null;
      el = document.getElementById(id);
      if (el != null) document.head.removeChild(el);
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TForm",this.TCustomForm,function () {
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("CSSLibrary",0,$mod.$rtti["TCSSLibrary"],"FCSSLibrary","FCSSLibrary",{Default: $mod.TCSSLibrary.cssNone});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("FormContainer",2,pas["WEBLib.Controls"].$rtti["TElementID"],"FFormContainer","SetFormContainer");
    $r.addProperty("FormStyle",3,$mod.$rtti["TFormStyle"],"GetFormStyle","SetFormStyle");
    $r.addProperty("Menu",0,pas["WEBLib.Controls"].$rtti["TCustomControl"],"FMenu","FMenu");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("Shadow",2,rtl.boolean,"FShadow","SetShadow",{Default: true});
    $r.addProperty("ShowClose",0,rtl.boolean,"FShowClose","FShowClose",{Default: true});
    $r.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder");
    $r.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default: true});
    $r.addProperty("OnBeforeUnload",0,$mod.$rtti["TBeforeUnloadEvent"],"FOnBeforeUnload","FOnBeforeUnload");
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnClose",0,$mod.$rtti["TCloseEvent"],"FOnClose","FOnClose");
    $r.addProperty("OnCloseQuery",0,$mod.$rtti["TCloseQueryEvent"],"FOnCloseQuery","FOnCloseQuery");
    $r.addProperty("OnCreate",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnCreate","FOnCreate");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnDeactivate",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDeactivate","FOnDeactivate");
    $r.addProperty("OnDestroy",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDestroy","FOnDestroy");
    $r.addProperty("OnDOMContentLoaded",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDOMContentLoaded","FOnDOMContentLoaded");
    $r.addProperty("OnHashChange",0,$mod.$rtti["THashChangeEvent"],"FOnHashChange","FOnHashChange");
    $r.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnResize","FOnResize");
    $r.addProperty("OnShow",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnShow","FOnShow");
    $r.addProperty("OnScroll",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnScroll","FOnScroll");
    $r.addProperty("OnOrientationChange",0,$mod.$rtti["TOrientationChangeEvent"],"FOnOrientationChange","FOnOrientationChange");
    $r.addProperty("OnPaint",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnPaint","FOnPaint");
    $r.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchStart","FOnTouchStart");
    $r.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchMove","FOnTouchMove");
    $r.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchEnd","FOnTouchEnd");
    $r.addProperty("OnUnload",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnUnload","FOnUnload");
  });
  rtl.createClass(this,"TCustomFrame",pas["WEBLib.Controls"].TCustomHTMLDiv,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TCustomHTMLDiv.$init.call(this);
      this.FAutoScroll = false;
      this.FAutoSize = false;
      this.FBiDiMode$1 = 0;
      this.FConstraints = null;
      this.FCtl3D$1 = false;
      this.FDockSite = false;
      this.FDragCursor = 0;
      this.FDragKind = 0;
      this.FDragMode$1 = 0;
      this.FOnAlignInsertBefore = null;
      this.FOnAlignPosition = null;
      this.FOnCanResize = null;
      this.FOnConstrainedResize = null;
      this.FOnContextPopup = null;
      this.FOnDockDrop = null;
      this.FOnDockOver = null;
      this.FOnEndDock = null;
      this.FOnGesture = null;
      this.FOnGetSiteInfo = null;
      this.FOnMouseActivate = null;
      this.FOnMouseWheelDown$1 = null;
      this.FOnMouseWheelUp$1 = null;
      this.FOnStartDock = null;
      this.FOnUnDock = null;
      this.FPadding = null;
      this.FParentBackground = false;
      this.FParentCtl3D$1 = false;
      this.FPopupMenu = null;
    };
    this.$final = function () {
      this.FConstraints = undefined;
      this.FOnAlignInsertBefore = undefined;
      this.FOnAlignPosition = undefined;
      this.FOnCanResize = undefined;
      this.FOnConstrainedResize = undefined;
      this.FOnContextPopup = undefined;
      this.FOnDockDrop = undefined;
      this.FOnDockOver = undefined;
      this.FOnEndDock = undefined;
      this.FOnGesture = undefined;
      this.FOnGetSiteInfo = undefined;
      this.FOnMouseActivate = undefined;
      this.FOnMouseWheelDown$1 = undefined;
      this.FOnMouseWheelUp$1 = undefined;
      this.FOnStartDock = undefined;
      this.FOnUnDock = undefined;
      this.FPadding = undefined;
      this.FPopupMenu = undefined;
      pas["WEBLib.Controls"].TCustomHTMLDiv.$final.call(this);
    };
    var cMethodGet = "GET";
    var cTypeLoad = "load";
    this.LoadHTMLFile = function (AId) {
      var $Self = this;
      var lFileName = "";
      var lRequest = null;
      function DoStatusCreate(AEvent) {
        var Result = false;
        var lElement = null;
        var lResponse = "";
        if (AEvent === null) return false;
        lResponse = AEvent.target.responseText;
        lElement = document.getElementById(AId);
        lElement.innerHTML = lResponse;
        Result = true;
        return Result;
      };
      lFileName = this.$class.GetHTMLFileName();
      if (lFileName !== "") {
        lRequest = new XMLHttpRequest();
        lRequest.addEventListener(cTypeLoad,rtl.createSafeCallback(null,DoStatusCreate));
        lRequest.open(cMethodGet,lFileName);
        lRequest.send();
      };
    };
    this.SetConstraints = function (AValue) {
      this.FConstraints.Assign(AValue);
    };
    this.SetPopupMenu = function (AValue) {
      this.FPopupMenu = AValue;
    };
    this.GetHTMLFileName = function () {
      var Result = "";
      Result = this.$module.$name + $mod.Application.GetFormExtension();
      return Result;
    };
    this.UpdateElement = function () {
      var nocolor = false;
      pas["WEBLib.Controls"].TControl.UpdateElement.call(this);
      nocolor = this.FColor in rtl.createSet(15790320,-1,16777215,16711422);
      if ((this.GetElementHandle() != null) && !this.IsUpdating() && (4 in this.FComponentState) && nocolor) {
        this.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(0xF0F0F0));
      };
    };
    this.Create$2 = function (AId) {
      pas["WEBLib.Controls"].TControl.Create$2.call(this,AId);
      this.LoadHTMLFile(AId);
      return this;
    };
    this.Create$1 = function (AOwner) {
      pas["WEBLib.Controls"].TControl.Create$1.call(this,AOwner);
      this.FConstraints = $mod.TSizeConstraints.$create("Create$1",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FConstraints");
      pas["WEBLib.Controls"].TCustomControl.Destroy.call(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TFrame",this.TCustomFrame,function () {
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("AutoScroll",0,rtl.boolean,"FAutoScroll","FAutoScroll",{Default: false});
    $r.addProperty("AutoSize",0,rtl.boolean,"FAutoSize","FAutoSize",{Default: false});
    $r.addProperty("BiDiMode",4,pas["WEBLib.Controls"].$rtti["TBiDiMode"],"FBiDiMode$1","FBiDiMode$1");
    $r.addProperty("Constraints",2,$mod.$rtti["TSizeConstraints"],"FConstraints","SetConstraints");
    $r.addProperty("DockSite",0,rtl.boolean,"FDockSite","FDockSite",{Default: false});
    $r.addProperty("DoubleBuffered",0,rtl.boolean,"FDoubleBuffered","FDoubleBuffered",{Default: false});
    $r.addProperty("DragCursor",0,pas["WEBLib.Controls"].$rtti["TCursor"],"FDragCursor","FDragCursor",{Default: 12});
    $r.addProperty("DragKind",0,pas["WEBLib.Controls"].$rtti["TDragKind"],"FDragKind","FDragKind",{Default: pas["WEBLib.Controls"].TDragKind.dkDrag});
    $r.addProperty("DragMode",0,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode$1","FDragMode$1",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("Ctl3D",4,rtl.boolean,"FCtl3D$1","FCtl3D$1");
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("Padding",0,pas["WEBLib.Controls"].$rtti["TPadding"],"FPadding","FPadding");
    $r.addProperty("ParentBackground",0,rtl.boolean,"FParentBackground","FParentBackground",{Default: true});
    $r.addProperty("ParentBiDiMode",0,rtl.boolean,"FParentBiDiMode","FParentBiDiMode",{Default: true});
    $r.addProperty("ParentColor",2,rtl.boolean,"FParentColor","SetParentColor",{Default: false});
    $r.addProperty("ParentCtl3D",0,rtl.boolean,"FParentCtl3D$1","FParentCtl3D$1",{Default: true});
    $r.addProperty("ParentDoubleBuffered",0,rtl.boolean,"FParentDoubleBuffered","FParentDoubleBuffered",{Default: true});
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("ParentShowHint",0,rtl.boolean,"FParentShowHint","FParentShowHint");
    $r.addProperty("PopupMenu",2,pas["WEBLib.Menus"].$rtti["TPopupMenu"],"FPopupMenu","SetPopupMenu");
    $r.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default: false});
    $r.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder");
    $r.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default: true});
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("OnAlignInsertBefore",0,$mod.$rtti["TAlignInsertBeforeEvent"],"FOnAlignInsertBefore","FOnAlignInsertBefore");
    $r.addProperty("OnAlignPosition",0,$mod.$rtti["TAlignPositionEvent"],"FOnAlignPosition","FOnAlignPosition");
    $r.addProperty("OnCanResize",0,$mod.$rtti["TCanResizeEvent"],"FOnCanResize","FOnCanResize");
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnConstrainedResize",0,$mod.$rtti["TConstrainedResizeEvent"],"FOnConstrainedResize","FOnConstrainedResize");
    $r.addProperty("OnContextPopup",0,$mod.$rtti["TContextPopupEvent"],"FOnContextPopup","FOnContextPopup");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnDockDrop",0,$mod.$rtti["TDockDropEvent"],"FOnDockDrop","FOnDockDrop");
    $r.addProperty("OnDockOver",0,$mod.$rtti["TDockOverEvent"],"FOnDockOver","FOnDockOver");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDock",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FOnEndDock","FOnEndDock");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnEnter","FOnEnter");
    $r.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnExit","FOnExit");
    $r.addProperty("OnGesture",0,$mod.$rtti["TGestureEvent"],"FOnGesture","FOnGesture");
    $r.addProperty("OnGetSiteInfo",0,$mod.$rtti["TGetSiteInfoEvent"],"FOnGetSiteInfo","FOnGetSiteInfo");
    $r.addProperty("OnMouseActivate",0,$mod.$rtti["TMouseActivateEvent"],"FOnMouseActivate","FOnMouseActivate");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseWheel",0,pas["WEBLib.Controls"].$rtti["TMouseWheelEvent"],"FOnMouseWheel","FOnMouseWheel");
    $r.addProperty("OnMouseWheelDown",0,$mod.$rtti["TMouseWheelUpDownEvent"],"FOnMouseWheelDown$1","FOnMouseWheelDown$1");
    $r.addProperty("OnMouseWheelUp",0,$mod.$rtti["TMouseWheelUpDownEvent"],"FOnMouseWheelUp$1","FOnMouseWheelUp$1");
    $r.addProperty("OnResize",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnResize","FOnResize");
    $r.addProperty("OnStartDock",0,$mod.$rtti["TStartDockEvent"],"FOnStartDock","FOnStartDock");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
    $r.addProperty("OnUnDock",0,$mod.$rtti["TUnDockEvent"],"FOnUnDock","FOnUnDock");
  });
  rtl.recNewT(this,"TApplicationError",function () {
    this.AMessage = "";
    this.AFile = "";
    this.ALineNumber = 0;
    this.AColNumber = 0;
    this.AStack = "";
    this.AError = null;
    this.$eq = function (b) {
      return (this.AMessage === b.AMessage) && (this.AFile === b.AFile) && (this.ALineNumber === b.ALineNumber) && (this.AColNumber === b.AColNumber) && (this.AStack === b.AStack) && (this.AError === b.AError);
    };
    this.$assign = function (s) {
      this.AMessage = s.AMessage;
      this.AFile = s.AFile;
      this.ALineNumber = s.ALineNumber;
      this.AColNumber = s.AColNumber;
      this.AStack = s.AStack;
      this.AError = s.AError;
      return this;
    };
  });
  this.THintPosition = {"0": "hpLeft", hpLeft: 0, "1": "hpTop", hpTop: 1, "2": "hpRight", hpRight: 2, "3": "hpBottom", hpBottom: 3};
  this.TOnlineStatus = {"0": "osOnline", osOnline: 0, "1": "osOffline", osOffline: 1};
  rtl.createClass(this,"TApplication",pas["WEBLib.Controls"].TControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TControl.$init.call(this);
      this.FAppContainer = "";
      this.FMainFormOnTaskBar = false;
      this.FCanCreateForm = false;
      this.FAppInitializing = false;
      this.FLastReq = null;
      this.FFormCaptionHeight = 0;
      this.FActiveForm = null;
      this.FMainForm = null;
      this.FInitFormClassName = "";
      this.FFormStack = null;
      this.FParameters = null;
      this.FIsRedirect = false;
      this.FLanguage = 0;
      this.FOnError = null;
      this.FOnHashChange = null;
      this.FAutoFormRoute = false;
      this.FErrorType = 0;
      this.FOnOnlineChange = null;
      this.FOnActivate = null;
      this.FThemeTextColor = 0;
      this.FThemeColor = 0;
      this.FThemed = false;
      this.FThemeButtonClassName = "";
      this.FOnOAuthToken = null;
      this.FOnOAuthCallBack = null;
      this.FOnPopState = null;
      this.FMaxZIndex = 0;
      this.FHandleOAuth = false;
      this.FHintPause = 0;
      this.FHintHidePause = 0;
      this.FHintPosition = 0;
      this.FHintClassName = "";
      this.FOnExit$1 = null;
      this.FOnException = null;
      this.FOnAutoCreateForm = null;
      this.FRouting = false;
    };
    this.$final = function () {
      this.FLastReq = undefined;
      this.FActiveForm = undefined;
      this.FMainForm = undefined;
      this.FFormStack = undefined;
      this.FParameters = undefined;
      this.FOnError = undefined;
      this.FOnHashChange = undefined;
      this.FOnOnlineChange = undefined;
      this.FOnActivate = undefined;
      this.FOnOAuthToken = undefined;
      this.FOnOAuthCallBack = undefined;
      this.FOnPopState = undefined;
      this.FOnExit$1 = undefined;
      this.FOnException = undefined;
      this.FOnAutoCreateForm = undefined;
      pas["WEBLib.Controls"].TControl.$final.call(this);
    };
    this.DoHandleError = function (Event) {
      var Result = false;
      var err = $mod.TApplicationError.$new();
      var el = null;
      var sp = null;
      var x = null;
      var msg = "";
      var s = "";
      var isError = false;
      var jserror = undefined;
      var ex = null;
      isError = true;
      if (Event.message == undefined) {
        isError = false;
      };
      if (Event.message === "ResizeObserver loop limit exceeded") return Result;
      if (!isError) {
        err.AMessage = "Undefined JavaScript exception";
        err.AFile = "";
        err.ALineNumber = 0;
        err.AColNumber = 0;
        err.AError = null;
        if (this.FOnError != null) this.FOnError(this,$mod.TApplicationError.$clone(err),{get: function () {
            return Result;
          }, set: function (v) {
            Result = v;
          }});
        return Result;
      };
      err.AMessage = Event.message;
      err.AFile = Event.filename;
      err.ALineNumber = Event.lineno;
      err.AColNumber = Event.colno;
      err.AError = Event.error;
      err.AStack = "";
      s = "";
      jserror = null;
      if (Event.error != null) {
        if (Event.error.stack) {
          err.AStack = Event.error.stack;
        }
        if (Event.error.fMessage) {
          err.AMessage = Event.error.fMessage;
        };
        function objToString (obj) {
              var str = '';
              for (var p in obj) {
                  if (obj.hasOwnProperty(p)) {
                      str += p + '::' + obj[p] + '\n';
                  }
              }
              return str;
              }
        
              // detect if it was an RTL exception
              if (Event.error.hasOwnProperty('FJSError'))
              {
                jserror = Event.error['FJSError'];
              }
        
        
              s = objToString(Event.error);
      };
      if (pas.System.Assigned(jserror)) {
        ex = Event.error;
        if (this.FOnException != null) this.FOnException(this,ex);
      };
      Result = false;
      msg = "ERROR<br>" + err.AMessage + " | " + s + err.AStack + "<BR> at " + err.AFile + " [" + pas.SysUtils.IntToStr(err.ALineNumber) + ":" + pas.SysUtils.IntToStr(err.AColNumber) + "]";
      var $tmp = this.FErrorType;
      if ($tmp === 3) {
        el = document.getElementById("tmserrormessage");
        if (el != null) {
          rtl.asExt(el.firstChild,HTMLElement).innerHTML = msg;
        } else {
          el = document.createElement("DIV");
          el.setAttribute("id","tmserrormessage");
          el.style.setProperty("position","absolute");
          el.style.setProperty("font-family","Courier");
          el.style.setProperty("font-size","8pt");
          el.style.setProperty("bottom","0");
          el.style.setProperty("width","100%");
          el.style.setProperty("height","100px");
          el.style.setProperty("background","#ff0000");
          el.style.setProperty("color","#ffffff");
          document.body.style.setProperty("padding","0");
          document.body.style.setProperty("margin","0");
          sp = document.createElement("SPAN");
          sp.style.setProperty("margin-left","4px");
          sp.style.setProperty("float","left");
          sp.style.setProperty("overflow","hidden");
          sp.style.setProperty("display","block");
          sp.innerHTML = msg;
          el.appendChild(sp);
          x = document.createElement("SPAN");
          x.style.setProperty("font-family","Courier");
          x.style.setProperty("font-size","8pt");
          x.style.setProperty("font-weight","bold");
          x.style.setProperty("position","absolute");
          x.style.setProperty("width","20px");
          x.style.setProperty("vertical-align","top");
          x.style.setProperty("cursor","pointer");
          x.style.setProperty("text-align","right");
          x.style.setProperty("right","4px");
          x.style.setProperty("display","block");
          x.innerHTML = "X";
          x.onclick = rtl.createSafeCallback(this,"DoErrorClose");
          el.appendChild(x);
          document.body.appendChild(el);
        };
      } else if ($tmp === 2) {
        window.alert(msg)}
       else if ($tmp === 1) {
        this.AddControlLink("googlematerial","https://fonts.googleapis.com/icon?family=Material+Icons");
        pas["WEBLib.Dialogs"].MessageDlg(msg,1,rtl.createSet(2),null);
      };
      if (this.FOnError != null) this.FOnError(this,$mod.TApplicationError.$clone(err),{get: function () {
          return Result;
        }, set: function (v) {
          Result = v;
        }});
      return Result;
    };
    this.DoHandleExit = function (Event) {
      var Result = false;
      Result = true;
      if (this.FOnExit$1 != null) this.FOnExit$1(this);
      return Result;
    };
    this.DoHashChange = function (Event) {
      var Result = false;
      var s = "";
      var fc = null;
      var frm = null;
      var bdy = null;
      var Handled = false;
      Result = true;
      if (!this.FAutoFormRoute) return Result;
      s  = location.hash;
      pas.System.Delete({get: function () {
          return s;
        }, set: function (v) {
          s = v;
        }},1,1);
      Handled = false;
      if (this.FOnHashChange != null) this.FOnHashChange(this,s,{get: function () {
          return Handled;
        }, set: function (v) {
          Handled = v;
        }});
      if (Handled) return Result;
      if (s === "") s = this.FInitFormClassName;
      if (s !== "") {
        if (this.FInitFormClassName === "") this.FInitFormClassName = this.FActiveForm.$classname;
        fc = pas.Classes.GetClass(s);
        if (fc != null) {
          bdy = document.body;
          this.CreateForm$6(fc,bdy,{get: function () {
              return frm;
            }, set: function (v) {
              frm = v;
            }});
        };
      };
      return Result;
    };
    this.DoPopState = function (Event) {
      var Result = false;
      if (this.FOnPopState != null) this.FOnPopState(this,Event.state);
      Result = true;
      return Result;
    };
    this.DoErrorClose = function (Event) {
      var Result = false;
      document.body.removeChild(Event.target.parentElement);
      Result = true;
      return Result;
    };
    this.DoUpdateOnlineStatus = function (Event) {
      var Result = false;
      Result = true;
      if (this.FOnOnlineChange != null) {
        if (window.navigator.onLine) {
          this.FOnOnlineChange(this,0)}
         else this.FOnOnlineChange(this,1);
      };
      return Result;
    };
    this.DoVisibilityChange = function (Event) {
      var Result = false;
      var res = false;
      Result = true;
      res = document.visibilityState === "visible";
      if (this.FOnActivate != null) this.FOnActivate(this,res);
      return Result;
    };
    this.GetFormExtension = function () {
      var Result = "";
      if (this.FLanguage !== 0) {
        Result = "_" + pas["WEBLib.Lang"].GetLanguageISO639_1Code(this.FLanguage) + pas["WEBLib.WebTools"].cHTMLExt}
       else Result = pas["WEBLib.WebTools"].cHTMLExt;
      return Result;
    };
    var sExternalBrowserAuthorizationOK = '<div class="text2">Application succesfully authorized</div>You can close this browser window';
    var sExternalBrowserAuthorizationFailed = '<div class="text2">Application authorization failed</div><br/>Please try again.';
    var LB = "\r\n";
    var ImageFail = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeA" + "AAACXBIWXMAAA7DAAAOwwHHb6hkAAABtElEQVR4nO2bUY7CMAxEhz0NB+EgrDjXCg6yB+E4+9NKCAiN" + "7XHcjf1+ED+Z6ahNHScFiqIoBNwvp+v9crpG+3hG6+sgFQFwXv7ejj+/31JBDyy+ugN4ElkJD8Hqqyu" + "AhohYjA3D12YAGyIiMSYsXx8D6BTpFmPB9NUMQCjSJcaA7ettAEqRTTErHr5eAjCKfBSz4OXryzhgiz" + "OzWCJd/Fs8HoFHzHeCtxf2JNgt3MMID8zXoMpAtDarEDIbidJklMJUQ6MDty6GNDSNRdxtluWwhReDU" + "fONKADAx2jkZCsOAOAaXn4pY2let6oAAN/qTIG61lAHAOwmBFO1aQoACA/BXGqbAwDCQqCsOCkBAMND" + "oC23aQEAw0Kg9hqoAQDuIdAbLfQAALcQXFptLgEA9BDc+oxeLbF/Qz0C7AFTT4KpX4OpC6HUpXDqxVD" + "q5fBOLn5lbEMkdUssdVM0dVs89cZI6q2x1JujqbfHUx+Q2MPFj/LidUqsKajB05NXS4y6Zl/GurHGe6" + "QOSpLF5jgqqxSb67C0UGzO4/KdYnN/MLEhluOTmYZY+MWvDPU122dzRVHk5g+X6Lw5aVkK9AAAAABJRU5ErkJggg==";
    var ImageSuccess = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaX" + "HeAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACC0lEQVR4nO2Zv3GDMBSHv+QyQEbICM4EOW+Q9BS4o2QTU" + "9LZBQNkg6zgETyCR0iRkOMIAv3Xk0+/zsiI931nI3iCkpKSkpKSkpKSkpJ7SDN0x2bo3nW//xCymNhp" + "hu4E1MAN2PdVe9k6524ETODHXIHXvmpva+c9BqwpWhbgAV6Ar61zsxeggB+z+x1XJmsBG/Bj6mboWtV" + "gtvcATfhpPvqq/ZwfzFKABTwoVobsBFjCj7kyWxmyugc4wsPCypCNAA/wY/L7C3iEP/dVe5geEC8gJD" + "wIFxAaHgQLiAEPQgXEggeBAmLCgzABseFBkIAU8CBEQCp4ECAgJTwYChibCzYXWpmv9jCVFTwYCJgVa" + "31BxXwucapFS4CiWOsLS4EHDQEbxRoXIAkeNgRoFqtdiDR4WBFgWOxmQRLhQdEQsSi2bobuqBqUCg8L" + "vwDHYg991Z49zjeNd3iYCfBU7J8E6fAAT7PPOw9znpqhA3hDODz8F7Dnp2vqKmJ1O8ogQeFh+R7wjB8" + "JrgkOD4plUICEKPCw/hyQSkI0eNh+EowtISo86L0LxJIQHR703wZDS0gCD2b9gFASksGDeUfIt4Sk8G" + "DRE/QoITk8WDZFPUgQAQ8OXWEHCWLgwbEtbiFBFDx42BcwkCAOHjxtjGhIEAkPHneGViSIhQfPW2MLE" + "kTDQ4C9wYmEi3T4kpKSkm+5ax+YhPsUTQAAAABJRU5ErkJggg==";
    var PlaceHolderImage = "#PLACEHOLDERIMAGE#";
    var PlaceHolderText = "#PLACEHOLDERTEXT#";
    var PlaceHolderColor = "#PLACEHOLDERCOLOR#";
    var AuthHTMLTemplate = "<!doctype html>" + LB + '<html lang="en">' + LB + "<head>" + LB + "  <title>Authentication Result</title>" + LB + '  <meta name="viewport" content="width=device-width, initial-scale=1">' + LB + "</head>" + LB + "<body>" + LB + "<style>" + LB + "  hr" + LB + "  {" + LB + "    border: none;" + LB + "    height: 1px;" + LB + "    background-color: rgb(171, 171, 171);" + LB + "  }" + LB + "  div.container" + LB + "  {" + LB + "    position: fixed;" + LB + "    font-family: Arial;" + LB + "    font-size: 12pt;" + LB + "    max-width: 100%;" + LB + "    max-height: 100%;" + LB + "    top: 50%;" + LB + "    left: 50%;" + LB + "    transform: translate(-50%, -50%);" + LB + "  }" + LB + "  div.section" + LB + "  {" + LB + "    display: inline-block;" + LB + "    margin: 15px;" + LB + "    padding: 5px;" + LB + "    float: left;" + LB + "  }" + LB + "  div.image img" + LB + "  {" + LB + "    height: 100%;" + LB + "  }" + LB + "  div.text" + LB + "  {" + LB + "    padding-top: 15px;" + LB + "  }" + LB + "  div.text2" + LB + "  {" + LB + "    font-size: 18pt;" + LB + "    color: #PLACEHOLDERCOLOR#;" + LB + "  }" + LB + "  span.title" + LB + "  {" + LB + "    font-size: 26px;" + LB + "  }" + LB + "</style>" + LB + '  <div class="container">' + LB + '  <div class="section image">' + LB + '    <img src="#PLACEHOLDERIMAGE#">' + LB + "  </div>" + LB + '  <div class="section text">' + LB + "  #PLACEHOLDERTEXT#" + LB + "  </div>" + LB + "  </div>" + LB + " </body>" + LB + "</html>";
    this.GetAuthorizationPageHTML = function (AAuthorizationSuccess) {
      var $Self = this;
      var Result = "";
      function ReplacePlaceHolders(APlaceHolders, APlaceHolderValues) {
        var Result = "";
        var I = 0;
        var s = "";
        s = AuthHTMLTemplate;
        for (var $l = 0, $end = rtl.length(APlaceHolders) - 1; $l <= $end; $l++) {
          I = $l;
          s = pas.SysUtils.StringReplace(s,APlaceHolders[I],APlaceHolderValues[I],rtl.createSet(0));
        };
        Result = s;
        return Result;
      };
      if (AAuthorizationSuccess) {
        Result = ReplacePlaceHolders([PlaceHolderImage,PlaceHolderText,PlaceHolderColor],[ImageSuccess,sExternalBrowserAuthorizationOK,"rgb(104, 164, 144)"])}
       else Result = ReplacePlaceHolders([PlaceHolderImage,PlaceHolderText,PlaceHolderColor],[ImageFail,sExternalBrowserAuthorizationFailed,"rgb(216, 99, 68)"]);
      return Result;
    };
    this.GetColorScheme = function () {
      var Result = 0;
      Result = 0;
      if (window.matchMedia("(prefers-color-scheme)").media !== "not all") {
        if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
          Result = 2}
         else Result = 1;
      };
      return Result;
    };
    this.ActivateChildScripts = function (AElement) {
      function nodeScriptReplace(node) {
                  if ( nodeScriptIs(node) === true ) {
                          node.parentNode.replaceChild( nodeScriptClone(node) , node );
                  }
                  else {
                          var i        = 0;
                          var children = node.childNodes;
                          while ( i < children.length ) {
                                  nodeScriptReplace( children[i++] );
                          }
                  }
      
                  return node;
          }
          function nodeScriptIs(node) {
                  return node.tagName === 'SCRIPT';
          }
          function nodeScriptClone(node){
                  var script  = document.createElement("script");
                  script.async = false;
                  script.text = node.innerHTML;
                  for( var i = node.attributes.length-1; i >= 0; i-- ) {
                          script.setAttribute( node.attributes[i].name, node.attributes[i].value );
                  }
                  return script;
          }
          nodeScriptReplace(AElement);
    };
    this.ChangeMaxZIndex = function (Delta) {
      this.FMaxZIndex = this.FMaxZIndex + Delta;
    };
    this.TriggerNotification = function () {
    };
    this.AutoCreateForm = function (AInstanceClass, AReference) {
      if (this.FOnAutoCreateForm != null) {
        this.FOnAutoCreateForm(this,AInstanceClass,AReference)}
       else this.CreateForm(AInstanceClass,AReference);
    };
    this.LockForm = function (AForm) {
      var i = 0;
      for (var $l = 0, $end = AForm.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        AForm.GetControls(i).DisableTab();
      };
    };
    this.UnLockForm = function (AForm) {
      var i = 0;
      for (var $l = 0, $end = AForm.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        AForm.GetControls(i).EnableTab();
      };
    };
    this.Create$1 = function (AOwner) {
      this.FFormStack = pas.Classes.TList.$create("Create$1");
      this.FParameters = pas.Classes.TStringList.$create("Create$1");
      this.FAppContainer = pas["WEBLib.WebTools"].cBodyTag;
      this.FMainForm = null;
      this.FActiveForm = null;
      this.FInitFormClassName = "";
      this.FIsRedirect = false;
      this.FAutoFormRoute = false;
      this.FThemed = false;
      this.FThemeColor = 14917120;
      this.FThemeTextColor = 16777215;
      this.FFormCaptionHeight = 22;
      this.FMaxZIndex = 999998;
      this.FHandleOAuth = true;
      this.FHintPause = 200;
      this.FHintHidePause = 250;
      this.FHintPosition = 1;
      this.FHintClassName = "";
      window.addEventListener("error",rtl.createCallback(this,"DoHandleError"));
      window.addEventListener("unhandledrejection",rtl.createCallback(this,"DoHandleError"));
      window.addEventListener("beforeunload",rtl.createSafeCallback(this,"DoHandleExit"));
      this.FErrorType = 0;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FFormStack");
      rtl.free(this,"FParameters");
      pas["WEBLib.Controls"].TControl.Destroy.call(this);
    };
    this.MaxZIndexStr = function () {
      var Result = "";
      Result = pas.SysUtils.IntToStr(this.FMaxZIndex);
      return Result;
    };
    this.CreateForm = function (AInstanceClass, AReference) {
      this.CreateForm$2(AInstanceClass,this.FAppContainer,AReference,null);
    };
    this.CreateForm$2 = function (AInstanceClass, AElementID, AReference, AProc) {
      this.CreateForm$3(AInstanceClass,AElementID,AReference,AProc,true);
    };
    this.CreateForm$3 = function (AInstanceClass, AElementID, AReference, AProc, LoadHTML) {
      var $Self = this;
      var LFileName = "";
      function DoStatusCreate(Event) {
        var Result = false;
        var LElem = null;
        var LForm = null;
        var LResponse = "";
        var LIsBody = false;
        var LisLoaded = false;
        LisLoaded = Event != null;
        if (LisLoaded) {
          LResponse = Event.target.responseText;
          LIsBody = pas.SysUtils.LowerCase(AElementID) === pas["WEBLib.WebTools"].cBodyTag;
          if (LIsBody) {
            LElem = document.body}
           else LElem = document.getElementById(AElementID);
          LElem.innerHTML = LResponse;
        } else {
          LElem = document.body;
        };
        LForm = AInstanceClass.$create("Create$5",[AElementID,AReference]);
        LForm.FFormFileName = LFileName;
        if (LForm.FFormContainer === "") LForm.SetFormContainer(AElementID);
        if (!LIsBody) {
          LForm.FFormElement = AElementID;
          LForm.FContainer = LElem;
        };
        LForm.CreateControl();
        LForm.Init();
        LForm.SetColorScheme($mod.Application.GetColorScheme());
        LForm.FPrevActiveForm = $Self.FActiveForm;
        $Self.FActiveForm = LForm;
        if ($Self.FMainForm === null) $Self.FMainForm = LForm;
        if (AProc != null) AProc(LForm);
        Result = true;
        if (LisLoaded) $Self.ActivateChildScripts(LElem);
        $Self.FActiveForm.DoShow();
        $Self.FActiveForm.Resize$1();
        return Result;
      };
      if (this.FIsRedirect) return;
      if (this.FAppInitializing) {
        if (this.FCanCreateForm) {
          this.FCanCreateForm = false}
         else return;
      };
      LFileName = AInstanceClass.GetHTMLFileName();
      if ((LFileName !== "") && LoadHTML) {
        this.FLastReq = new XMLHttpRequest();
        this.FLastReq.addEventListener("load",rtl.createSafeCallback(null,DoStatusCreate));
        this.FLastReq.open("GET",LFileName);
        this.FLastReq.send();
      } else {
        DoStatusCreate(null);
      };
    };
    this.CreateForm$6 = function (AInstanceClass, AElement, AReference) {
      this.CreateForm$2(AInstanceClass,AElement.id,AReference,null);
    };
    this.CreateFormDirect = function (AInstanceClass, AReference) {
      this.CreateForm$3(AInstanceClass,this.FAppContainer,AReference,null,false);
    };
    this.HasCSS = function (href) {
      var Result = false;
      var els = null;
      var i = 0;
      var s = "";
      Result = false;
      els = document.querySelectorAll("head > link");
      for (var $l = 0, $end = els.length - 1; $l <= $end; $l++) {
        i = $l;
        s = els.item(i).href;
        if (pas.SysUtils.CompareText(s,href) === 0) {
          Result = true;
          break;
        };
      };
      return Result;
    };
    this.Initialize = function () {
      var query = "";
      var token = "";
      var p = 0;
      var b = false;
      this.FCanCreateForm = true;
      this.FAppInitializing = true;
      this.FParameters.Clear();
      query = window.location.href;
      this.InitFormatSettings(pas["WEBLib.WebTools"].GetBrowserLocale());
      this.FParameters.SetDelimiter("&");
      this.FParameters.FStrictDelimiter = true;
      p = pas.System.Pos("?",query);
      if (p > 0) query = pas.System.Copy(query,p + 1,query.length);
      this.FParameters.SetDelimitedText(query);
      b = (window.name == "Authentication");
      if (this.FOnOAuthCallBack != null) {
        if ((this.FParameters.IndexOfName("oauthcallback") !== -1) || b) {
          this.FOnOAuthCallBack(this,query);
          this.FIsRedirect = true;
          document.body.innerHTML = this.GetAuthorizationPageHTML(true);
          return;
        };
      };
      if ((this.FParameters.IndexOfName("code") !== -1) && this.FHandleOAuth) {
        if (this.FOnOAuthToken != null) this.FOnOAuthToken(this,query);
        this.FIsRedirect = true;
        token = this.FParameters.GetValue("code");
        if (window.opener && window.opener.processAuthData){
          window.opener.processAuthData(token);
          window.close();
        };
      };
      window.addEventListener("hashchange",rtl.createSafeCallback(this,"DoHashChange"));
      window.addEventListener("online",rtl.createSafeCallback(this,"DoUpdateOnlineStatus"));
      window.addEventListener("offline",rtl.createSafeCallback(this,"DoUpdateOnlineStatus"));
      window.addEventListener("popstate",rtl.createCallback(this,"DoPopState"));
      document.addEventListener("visibilitychange",rtl.createSafeCallback(this,"DoVisibilityChange"));
      if (window.opener !== null) if (this.FParameters.IndexOfName("access_token") !== -1) {
        this.FIsRedirect = true;
        token = this.FParameters.GetValue("access_token");
        if (window.opener && window.opener.processAuthData){
          window.opener.processAuthData(token);
            window.close();
        };
      };
    };
    this.InitFormatSettings = function (BrowserLocale) {
      var timestr = "";
      var i = 0;
      var locale = "";
      locale = BrowserLocale;
      pas.SysUtils.FormatSettings.ShortDateFormat = pas["WEBLib.WebTools"].GetLocaleShortDateFormat(locale);
      if (pas.System.Pos("/",pas.SysUtils.FormatSettings.ShortDateFormat) > 0) pas.SysUtils.FormatSettings.DateSeparator = "/";
      if (pas.System.Pos(".",pas.SysUtils.FormatSettings.ShortDateFormat) > 0) pas.SysUtils.FormatSettings.DateSeparator = ".";
      if (pas.System.Pos("-",pas.SysUtils.FormatSettings.ShortDateFormat) > 0) pas.SysUtils.FormatSettings.DateSeparator = "-";
      var event = new Date('Jan 1, 1980 06:07:08 GMT+00:00');
      var loc = "";
      if (locale == "") { loc = navigator.language; } else
      { loc = locale; }
      timestr = event.toLocaleTimeString(loc);
      if (pas.System.Pos(":",timestr) > 0) pas.SysUtils.FormatSettings.TimeSeparator = ":";
      if (pas.System.Pos(".",timestr) > 0) pas.SysUtils.FormatSettings.TimeSeparator = ".";
      if (pas.System.Pos("-",timestr) > 0) pas.SysUtils.FormatSettings.TimeSeparator = "-";
      for (i = 1; i <= 7; i++) {
        pas.SysUtils.FormatSettings.ShortDayNames[i - 1] = pas["WEBLib.WebTools"].GetLocaleShortDayName(i,locale);
        pas.SysUtils.FormatSettings.LongDayNames[i - 1] = pas["WEBLib.WebTools"].GetLocaleLongDayName(i,locale);
      };
      for (i = 1; i <= 12; i++) {
        pas.SysUtils.FormatSettings.ShortMonthNames[i - 1] = pas["WEBLib.WebTools"].GetLocaleShortMonthName(i,locale);
        pas.SysUtils.FormatSettings.LongMonthNames[i - 1] = pas["WEBLib.WebTools"].GetLocaleLongMonthName(i,locale);
      };
      pas.SysUtils.FormatSettings.DecimalSeparator = pas["WEBLib.WebTools"].GetLocaleDecimalSeparator("");
      if (pas.SysUtils.FormatSettings.DecimalSeparator === ".") {
        pas.SysUtils.FormatSettings.ThousandSeparator = ","}
       else pas.SysUtils.FormatSettings.ThousandSeparator = ".";
    };
    this.Run = function () {
      this.FCanCreateForm = true;
      this.FAppInitializing = false;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  this.GetParentForm = function (AControl) {
    var Result = null;
    var FOwner = null;
    Result = null;
    FOwner = AControl;
    while ((FOwner != null) && !$mod.TCustomForm.isPrototypeOf(FOwner)) {
      if ((FOwner === AControl) && (FOwner.FOwner === null)) {
        FOwner = AControl.FParent}
       else FOwner = FOwner.FOwner;
    };
    if ((FOwner != null) && $mod.TCustomForm.isPrototypeOf(FOwner)) Result = rtl.as(FOwner,$mod.TCustomForm);
    return Result;
  };
  this.WinWidth = function () {
    var Result = 0;
    var w = 0;
    if ($mod.VSIDE != null) {
      w = pas["WEBLib.Forms"].VSIDE.clientWidth();
    } else w = window.innerWidth;
    Result = w;
    return Result;
  };
  this.WinHeight = function () {
    var Result = 0;
    var h = 0;
    if ($mod.VSIDE != null) {
      h = pas["WEBLib.Forms"].VSIDE.clientHeight();
    } else h = window.innerHeight;
    Result = h;
    return Result;
  };
  this.Application = null;
  this.HandShakeScript = null;
  this.VSIDE = null;
  this.LastHash = "";
  $mod.$implcode = function () {
    $impl.ReleaseForm = function (AForm) {
      AForm = rtl.freeLoc(AForm);
      AForm = null;
    };
  };
  $mod.$init = function () {
    $mod.HandShakeScript = document.createElement("script");
    $mod.HandShakeScript.id = "HandShakeScript";
    $mod.HandShakeScript.type = "text/javascript";
    $mod.HandShakeScript.innerHTML = "var IDE = null;" + "\r\n" + 'var TMSWEBCoreClientIdentifier = "unknown";' + "\r\n" + 'var TMSWEBCoreOAuthCallback = "unknown";' + "\r\n" + "function HandShake(cid){" + "\r\n" + "  TMSWEBCoreClientIdentifier = cid;" + "\r\n" + "}";
    document.body.appendChild($mod.HandShakeScript);
    $mod.Application = $mod.TApplication.$create("Create$1",[null]);
  };
},["WEBLib.Dialogs","WEBLib.WebTools","WEBLib.JSON","WEBLib.Utils","Math"]);
rtl.module("DateUtils",["System","SysUtils","Math"],function () {
  "use strict";
  var $mod = this;
  this.DateOf = function (AValue) {
    var Result = 0.0;
    Result = pas.System.Trunc(AValue);
    return Result;
  };
  this.YearOf = function (AValue) {
    var Result = 0;
    var D = 0;
    var M = 0;
    pas.SysUtils.DecodeDate(AValue,{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},{get: function () {
        return D;
      }, set: function (v) {
        D = v;
      }},{get: function () {
        return M;
      }, set: function (v) {
        M = v;
      }});
    return Result;
  };
  this.MonthOf = function (AValue) {
    var Result = 0;
    var Y = 0;
    var D = 0;
    pas.SysUtils.DecodeDate(AValue,{get: function () {
        return Y;
      }, set: function (v) {
        Y = v;
      }},{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }},{get: function () {
        return D;
      }, set: function (v) {
        D = v;
      }});
    return Result;
  };
  this.StartOfTheYear = function (AValue) {
    var Result = 0.0;
    Result = pas.SysUtils.EncodeDate($mod.YearOf(AValue),1,1);
    return Result;
  };
  this.MonthOfTheYear = function (AValue) {
    var Result = 0;
    Result = $mod.MonthOf(AValue);
    return Result;
  };
  this.DayOfTheYear = function (AValue) {
    var Result = 0;
    Result = pas.System.Trunc((AValue - $mod.StartOfTheYear(AValue)) + 1);
    return Result;
  };
  this.DayOfTheMonth = function (AValue) {
    var Result = 0;
    var Y = 0;
    var M = 0;
    pas.SysUtils.DecodeDate(AValue,{get: function () {
        return Y;
      }, set: function (v) {
        Y = v;
      }},{get: function () {
        return M;
      }, set: function (v) {
        M = v;
      }},{get: function () {
        return Result;
      }, set: function (v) {
        Result = v;
      }});
    return Result;
  };
  this.DecodeDateTime = function (AValue, AYear, AMonth, ADay, AHour, AMinute, ASecond, AMilliSecond) {
    pas.SysUtils.DecodeTime(AValue,AHour,AMinute,ASecond,AMilliSecond);
    if (AHour.get() === 24) {
      AHour.set(0);
      pas.SysUtils.DecodeDate(Math.round(AValue),AYear,AMonth,ADay);
    } else pas.SysUtils.DecodeDate(AValue,AYear,AMonth,ADay);
  };
},["JS","RTLConsts"]);
rtl.module("StrUtils",["System","SysUtils","Types"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.Soundex = function (AText, ALength) {
    var Result = "";
    var S = "";
    var PS = "";
    var I = 0;
    var L = 0;
    Result = "";
    PS = "\x00";
    if (AText.length > 0) {
      Result = pas.System.upcase(AText.charAt(0));
      I = 2;
      L = AText.length;
      while ((I <= L) && (Result.length < ALength)) {
        S = $impl.SScore.charAt(AText.charCodeAt(I - 1) - 1);
        if (!(S.charCodeAt() in rtl.createSet(48,105,PS.charCodeAt()))) Result = Result + S;
        if (S !== "i") PS = S;
        I += 1;
      };
    };
    L = Result.length;
    if (L < ALength) Result = Result + pas.System.StringOfChar("0",ALength - L);
    return Result;
  };
  this.SoundexSimilar = function (AText, AOther, ALength) {
    var Result = false;
    Result = $mod.Soundex(AText,ALength) === $mod.Soundex(AOther,ALength);
    return Result;
  };
  this.SoundexSimilar$1 = function (AText, AOther) {
    var Result = false;
    Result = $mod.SoundexSimilar(AText,AOther,4);
    return Result;
  };
  this.SoundexProc = function (AText, AOther) {
    var Result = false;
    Result = $mod.SoundexSimilar$1(AText,AOther);
    return Result;
  };
  this.AnsiResemblesProc = null;
  this.ResemblesProc = null;
  $mod.$implcode = function () {
    $impl.SScore = "00000000000000000000000000000000" + "00000000000000000000000000000000" + "0123012i02245501262301i2i2" + "000000" + "0123012i02245501262301i2i2" + "00000000000000000000000000000000" + "00000000000000000000000000000000" + "00000000000000000000000000000000" + "00000000000000000000000000000000" + "00000";
  };
  $mod.$init = function () {
    $mod.AnsiResemblesProc = $mod.SoundexProc;
    $mod.ResemblesProc = $mod.SoundexProc;
  };
},["JS"]);
rtl.module("WEBLib.REST",["System","Classes","Web","JS","SysUtils","WEBLib.Controls","WEBLib.JSON"],function () {
  "use strict";
  var $mod = this;
  this.THTTPCommand = {"0": "httpGET", httpGET: 0, "1": "httpPOST", httpPOST: 1, "2": "httpPUT", httpPUT: 2, "3": "httpDELETE", httpDELETE: 3, "4": "httpHEAD", httpHEAD: 4, "5": "httpPATCH", httpPATCH: 5, "6": "httpCUSTOM", httpCUSTOM: 6};
  this.$rtti.$Enum("THTTPCommand",{minvalue: 0, maxvalue: 6, ordtype: 1, enumtype: this.THTTPCommand});
  this.THTTPRequestResponseType = {"0": "rtDefault", rtDefault: 0, "1": "rtText", rtText: 1, "2": "rtBlob", rtBlob: 2, "3": "rtJSON", rtJSON: 3, "4": "rtDocument", rtDocument: 4, "5": "rtArrayBuffer", rtArrayBuffer: 5};
  this.$rtti.$Enum("THTTPRequestResponseType",{minvalue: 0, maxvalue: 5, ordtype: 1, enumtype: this.THTTPRequestResponseType});
  this.$rtti.$MethodVar("THTTPProgressEvent",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["Position",rtl.nativeint],["Total",rtl.nativeint]]), methodkind: 0});
  rtl.createClass(this,"THttpRequest",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FURL = "";
      this.FOnResponse = null;
      this.FOnAbort = null;
      this.FHeaders = null;
      this.FCommand = 0;
      this.FCustomCommand = "";
      this.FPostData = "";
      this.FOnRequestResponse = null;
      this.FPassword = "";
      this.FUser = "";
      this.FTimeout = 0;
      this.FOnTimeout = null;
      this.FOnError = null;
      this.FResponse = null;
      this.FErrorProc = null;
      this.FTimeOutProc = null;
      this.FResponseType = 0;
      this.FOnProgress = null;
    };
    this.$final = function () {
      this.FOnResponse = undefined;
      this.FOnAbort = undefined;
      this.FHeaders = undefined;
      this.FOnRequestResponse = undefined;
      this.FOnTimeout = undefined;
      this.FOnError = undefined;
      this.FResponse = undefined;
      this.FErrorProc = undefined;
      this.FTimeOutProc = undefined;
      this.FOnProgress = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.HandleResponse = function (Event) {
      var Result = false;
      var s = "";
      var LRequestRec = pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new();
      LRequestRec.req = Event.target;
      s = "";
      if (this.FResponseType in rtl.createSet(1,0)) {
        s = Event.target.responseText;
      };
      if (this.FOnRequestResponse != null) {
        this.FOnRequestResponse(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(LRequestRec),s);
      };
      if (this.FOnResponse != null) this.FOnResponse(this,s);
      if (this.FResponse != null) {
        this.FResponse(s,LRequestRec.req);
      };
      Result = true;
      return Result;
    };
    this.HandleAbort = function (Event) {
      var Result = false;
      if (this.FOnAbort != null) this.FOnAbort(this);
      Result = true;
      return Result;
    };
    this.HandleTimeout = function (Event) {
      var Result = false;
      if (this.FOnTimeout != null) this.FOnTimeout(this);
      if (this.FTimeOutProc != null) this.FTimeOutProc(Event.target);
      Result = true;
      return Result;
    };
    this.HandleError = function (Event) {
      var Result = false;
      var Handled = false;
      var LEventRec = pas["WEBLib.Controls"].TJSEventRecord.$new();
      var LRequestRec = pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$new();
      Result = true;
      Handled = false;
      if (this.FOnError != null) {
        LEventRec.event = Event;
        LRequestRec.req = Event.target;
        this.FOnError(this,pas["WEBLib.Controls"].TJSXMLHttpRequestRecord.$clone(LRequestRec),pas["WEBLib.Controls"].TJSEventRecord.$clone(LEventRec),{get: function () {
            return Handled;
          }, set: function (v) {
            Handled = v;
          }});
      };
      if (this.FErrorProc != null) this.FErrorProc(LRequestRec.req);
      if (!Handled) throw pas.SysUtils.Exception.$create("Create$1",["HTTP request error @" + this.FURL]);
      return Result;
    };
    this.HandleProgress = function (Event) {
      var Result = false;
      var position = 0;
      var total = 0;
      Result = true;
      position = Event.loaded;
      total = Event.total;
      if (this.FOnProgress != null) this.FOnProgress(this,position,total);
      return Result;
    };
    this.SetHeaders = function (AValue) {
      this.FHeaders.Assign(AValue);
    };
    this.Create$1 = function (AOwner) {
      pas.Classes.TComponent.Create$1.apply(this,arguments);
      this.FHeaders = pas.Classes.TStringList.$create("Create$1");
      this.FResponseType = 0;
      this.FCommand = 0;
      this.FTimeout = 0;
      this.FResponse = null;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHeaders");
      pas.Classes.TComponent.Destroy.call(this);
    };
    this.GetResponseType = function (AResponseType) {
      var Result = "";
      Result = "";
      var $tmp = AResponseType;
      if ($tmp === 1) {
        Result = "text"}
       else if ($tmp === 2) {
        Result = "blob"}
       else if ($tmp === 4) {
        Result = "document"}
       else if ($tmp === 3) {
        Result = "json"}
       else if ($tmp === 5) Result = "arraybuffer";
      return Result;
    };
    this.Execute$2 = function (AResponse, AError, ATimeOut) {
      var i = 0;
      var cmd = "";
      var req = null;
      var headname = "";
      var headvalue = "";
      this.FResponse = AResponse;
      this.FErrorProc = AError;
      this.FTimeOutProc = ATimeOut;
      req = new XMLHttpRequest();
      req.addEventListener("load",rtl.createSafeCallback(this,"HandleResponse"));
      req.addEventListener("abort",rtl.createSafeCallback(this,"HandleAbort"));
      req.addEventListener("timeout",rtl.createSafeCallback(this,"HandleTimeout"));
      req.addEventListener("error",rtl.createSafeCallback(this,"HandleError"));
      req.addEventListener("progress",rtl.createSafeCallback(this,"HandleProgress"));
      req.responseType = $mod.THttpRequest.GetResponseType(this.FResponseType);
      cmd = $mod.HTTPCommand(this.FCommand,this.FCustomCommand);
      if (this.FTimeout !== 0) req.timeout = this.FTimeout;
      if (this.FUser !== "") {
        req.open(cmd,this.FURL,true);
        req.setRequestHeader("X-Requested-With","XMLHttpRequest");
      } else req.open(cmd,this.FURL);
      for (var $l = 0, $end = this.FHeaders.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        this.FHeaders.GetNameValue(i,{get: function () {
            return headname;
          }, set: function (v) {
            headname = v;
          }},{get: function () {
            return headvalue;
          }, set: function (v) {
            headvalue = v;
          }});
        req.setRequestHeader(headname,headvalue);
      };
      if (this.FUser !== "") req.setRequestHeader("Authorization","Basic " + window.btoa(this.FUser + ":" + this.FPassword));
      if (this.FPostData !== "") {
        req.send(this.FPostData)}
       else req.send();
    };
    this.Perform = function () {
      var $Self = this;
      var Result = null;
      Result = new Promise(function (ASuccess, AFailed) {
        $Self.Execute$2(function (AResponse, ARequest) {
          ASuccess(ARequest);
        },function (ARequest) {
          AFailed(ARequest);
        },function (ARequest) {
          AFailed(ARequest);
        });
      });
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Command",0,$mod.$rtti["THTTPCommand"],"FCommand","FCommand");
    $r.addProperty("CustomCommand",0,rtl.string,"FCustomCommand","FCustomCommand");
    $r.addProperty("Headers",2,pas.Classes.$rtti["TStringList"],"FHeaders","SetHeaders");
    $r.addProperty("Password",0,rtl.string,"FPassword","FPassword");
    $r.addProperty("PostData",0,rtl.string,"FPostData","FPostData");
    $r.addProperty("ResponseType",0,$mod.$rtti["THTTPRequestResponseType"],"FResponseType","FResponseType",{Default: $mod.THTTPRequestResponseType.rtDefault});
    $r.addProperty("Timeout",0,rtl.longint,"FTimeout","FTimeout",{Default: 0});
    $r.addProperty("URL",0,rtl.string,"FURL","FURL");
    $r.addProperty("User",0,rtl.string,"FUser","FUser");
    $r.addProperty("OnError",0,pas["WEBLib.Controls"].$rtti["THTTPErrorEvent"],"FOnError","FOnError");
    $r.addProperty("OnAbort",0,pas["WEBLib.Controls"].$rtti["THTTPAbortEvent"],"FOnAbort","FOnAbort");
    $r.addProperty("OnProgress",0,$mod.$rtti["THTTPProgressEvent"],"FOnProgress","FOnProgress");
    $r.addProperty("OnRequestResponse",0,pas["WEBLib.Controls"].$rtti["THTTPRequestResponseEvent"],"FOnRequestResponse","FOnRequestResponse");
    $r.addProperty("OnResponse",0,pas["WEBLib.Controls"].$rtti["THTTPResponseEvent"],"FOnResponse","FOnResponse");
    $r.addProperty("OnTimeout",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnTimeout","FOnTimeout");
  });
  this.$rtti.$MethodVar("THttpResponse",{procsig: rtl.newTIProcSig([["Sender",pas.System.$rtti["TObject"]],["AResponse",rtl.string]]), methodkind: 0});
  rtl.createClass(this,"TPersistTokens",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FKey = "";
      this.FEnabled = false;
    };
    this.Create$1 = function () {
      this.FEnabled = false;
      this.FKey = "";
      return this;
    };
    this.Assign = function (Source) {
      if ($mod.TPersistTokens.isPrototypeOf(Source)) {
        this.FKey = rtl.as(Source,$mod.TPersistTokens).FKey;
        this.FEnabled = rtl.as(Source,$mod.TPersistTokens).FEnabled;
      };
    };
    var $r = this.$rtti;
    $r.addProperty("Key",0,rtl.string,"FKey","FKey");
    $r.addProperty("Enabled",0,rtl.boolean,"FEnabled","FEnabled",{Default: false});
  });
  rtl.createClass(this,"TRESTApp",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FKey = "";
      this.FCallbackURL = "";
      this.FSecret = "";
      this.FAuthURL = "";
    };
    this.Assign = function (Source) {
      if ($mod.TRESTApp.isPrototypeOf(Source)) {
        this.FKey = rtl.as(Source,$mod.TRESTApp).FKey;
        this.FCallbackURL = rtl.as(Source,$mod.TRESTApp).FCallbackURL;
        this.FSecret = rtl.as(Source,$mod.TRESTApp).FSecret;
        this.FAuthURL = rtl.as(Source,$mod.TRESTApp).FAuthURL;
      };
    };
    var $r = this.$rtti;
    $r.addProperty("AuthURL",0,rtl.string,"FAuthURL","FAuthURL");
    $r.addProperty("Key",0,rtl.string,"FKey","FKey");
    $r.addProperty("CallbackURL",0,rtl.string,"FCallbackURL","FCallbackURL");
    $r.addProperty("Secret",0,rtl.string,"FSecret","FSecret");
  });
  this.TAuthLocale = {"0": "lcDefault", lcDefault: 0, "1": "lcEnglish", lcEnglish: 1, "2": "lcDutch", lcDutch: 2, "3": "lcGerman", lcGerman: 3, "4": "lcFrench", lcFrench: 4, "5": "lcSpanish", lcSpanish: 5, "6": "lcItalian", lcItalian: 6, "7": "lcPortuguese", lcPortuguese: 7, "8": "lcGreek", lcGreek: 8, "9": "lcDanish", lcDanish: 9, "10": "lcRussian", lcRussian: 10, "11": "lcRomanian", lcRomanian: 11, "12": "lcSwedish", lcSwedish: 12, "13": "lcFinnish", lcFinnish: 13, "14": "lcTurkish", lcTurkish: 14, "15": "lcJapanese", lcJapanese: 15};
  rtl.createClass(this,"TRESTClient",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FOnAccessToken = null;
      this.FOnResponse = null;
      this.FPersistTokens = null;
      this.FApp = null;
      this.FScopes = null;
      this.FLocale = 0;
      this.FOnRequestResponse = null;
      this.FOnError = null;
      this.FResponseType = 0;
      this.FLoginWidth = 0;
      this.FLoginHeight = 0;
    };
    this.$final = function () {
      this.FOnAccessToken = undefined;
      this.FOnResponse = undefined;
      this.FPersistTokens = undefined;
      this.FApp = undefined;
      this.FScopes = undefined;
      this.FOnRequestResponse = undefined;
      this.FOnError = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.SetPersistTokens = function (Value) {
      this.FPersistTokens.Assign(Value);
    };
    this.SetApp = function (Value) {
      this.FApp.Assign(Value);
    };
    this.SetScopes = function (Value) {
      this.FScopes.Assign(Value);
    };
    this.InstallCallback = function () {
      var Result = false;
      var scriptsrc = "";
      scriptsrc = " function processAuthData(access_token) {" + 'var event = new CustomEvent("oauthcallback", {\r' + "            detail: {\r" + "                 message: access_token\r" + "            },\r" + "  bubbles: true,\r" + "  cancelable: true});\r" + "  document.dispatchEvent(event);" + "}";
      var script = document.createElement("script");
          script.innerHTML = scriptsrc;
          document.head.appendChild(script);
      
          var scr = document.createElement('script');
          scr.async = true;
          scr.defer = true;
          scr.type = 'text/javascript';
          document.body.appendChild(scr);
      Result = true;
      return Result;
    };
    this.Create$1 = function (AOwner) {
      pas.Classes.TComponent.Create$1.apply(this,arguments);
      this.FPersistTokens = $mod.TPersistTokens.$create("Create$1");
      this.FApp = $mod.TRESTApp.$create("Create");
      this.FScopes = pas.Classes.TStringList.$create("Create$1");
      this.FLocale = 0;
      this.FResponseType = 0;
      this.FLoginWidth = 800;
      this.FLoginHeight = 600;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FApp");
      rtl.free(this,"FScopes");
      rtl.free(this,"FPersistTokens");
      pas.Classes.TComponent.Destroy.call(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("App",2,$mod.$rtti["TRESTApp"],"FApp","SetApp");
    $r.addProperty("LoginHeight",0,rtl.longint,"FLoginHeight","FLoginHeight",{Default: 600});
    $r.addProperty("LoginWidth",0,rtl.longint,"FLoginWidth","FLoginWidth",{Default: 800});
    $r.addProperty("PersistTokens",2,$mod.$rtti["TPersistTokens"],"FPersistTokens","SetPersistTokens");
    $r.addProperty("ResponseType",0,$mod.$rtti["THTTPRequestResponseType"],"FResponseType","FResponseType",{Default: $mod.THTTPRequestResponseType.rtDefault});
    $r.addProperty("Scopes",2,pas.Classes.$rtti["TStrings"],"FScopes","SetScopes");
    $r.addProperty("OnAccessToken",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnAccessToken","FOnAccessToken");
    $r.addProperty("OnRequestResponse",0,pas["WEBLib.Controls"].$rtti["THTTPRequestResponseEvent"],"FOnRequestResponse","FOnRequestResponse");
    $r.addProperty("OnResponse",0,$mod.$rtti["THttpResponse"],"FOnResponse","FOnResponse");
    $r.addProperty("OnError",0,pas["WEBLib.Controls"].$rtti["THTTPErrorEvent"],"FOnError","FOnError");
  });
  this.HTTPCommand = function (ACommand, ACustomCommand) {
    var Result = "";
    var cmd = "";
    var $tmp = ACommand;
    if ($tmp === 0) {
      cmd = "GET"}
     else if ($tmp === 1) {
      cmd = "POST"}
     else if ($tmp === 2) {
      cmd = "PUT"}
     else if ($tmp === 3) {
      cmd = "DELETE"}
     else if ($tmp === 4) {
      cmd = "HEAD"}
     else if ($tmp === 5) {
      cmd = "PATCH"}
     else if ($tmp === 6) cmd = ACustomCommand;
    Result = cmd;
    return Result;
  };
  $mod.$init = function () {
    $mod.TRESTClient.InstallCallback();
  };
},[]);
rtl.module("Bcl.Json.Common",["System","Types","JS"],function () {
  "use strict";
  var $mod = this;
  this.JToInt = function (Value) {
    var Result = 0;
    Result = rtl.trunc(Value);
    return Result;
  };
  this.JToStr = function (Value) {
    var Result = "";
    Result = "" + Value;
    return Result;
  };
  this.JToBool = function (Value) {
    var Result = false;
    Result = !(Value == false);
    return Result;
  };
  this.AsJObject = function (Value) {
    var Result = null;
    Result = Value;
    return Result;
  };
  this.AsJArray = function (Value) {
    var Result = null;
    Result = Value;
    return Result;
  };
  this.JObjectKeys = function (Value) {
    var Result = [];
    Result = Object.keys(Value);
    return Result;
  };
});
rtl.module("Bcl.Collections.Common",["System","Types","Bcl.Json.Common","JS","SysUtils"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TStringMap",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FMap = null;
    };
    this.$final = function () {
      this.FMap = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.GetItem = function (Key) {
      var Result = null;
      Result = rtl.getObject(this.FMap[Key]);
      return Result;
    };
    this.GetKeys = function () {
      var Result = [];
      Result = Object.keys(this.FMap);
      return Result;
    };
    this.Create$1 = function (AOwnsObjects) {
      this.FMap = new Object();
      return this;
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    this.Clear = function () {
      var I = 0;
      for (var $l = rtl.length(this.GetKeys()) - 1; $l >= 0; $l--) {
        I = $l;
        this.Remove(this.GetKeys()[I]);
      };
    };
    this.Add = function (Key, Value) {
      this.FMap[Key] = Value;
    };
    this.AddOrSetValue = function (Key, Value) {
      this.FMap[Key] = Value;
    };
    this.ContainsKey = function (Key) {
      var Result = false;
      Result = this.FMap.hasOwnProperty(Key);
      return Result;
    };
    this.Remove = function (Key) {
      delete this.FMap[Key];
    };
  });
});
rtl.module("XData.Web.Headers",["System","Types","SysUtils","Bcl.Collections.Common"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"THttpHeaderInfo",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FName = "";
      this.FValue = "";
    };
    this.Create$1 = function (AName, AValue) {
      this.FName = AName;
      this.FValue = AValue;
      return this;
    };
  });
  rtl.createClass(this,"THttpHeaders",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FHeaders = null;
    };
    this.$final = function () {
      this.FHeaders = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.GetHeaderNames = function () {
      var Result = [];
      Result = this.FHeaders.GetKeys();
      return Result;
    };
    this.Create$1 = function () {
      this.FHeaders = pas["Bcl.Collections.Common"].TStringMap.$create("Create$1",[true]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHeaders");
      pas.System.TObject.Destroy.call(this);
    };
    this.SetValue = function (HeaderName, HeaderValue) {
      if (HeaderName !== "") this.FHeaders.AddOrSetValue(pas.SysUtils.LowerCase(HeaderName),$mod.THttpHeaderInfo.$create("Create$1",[pas.SysUtils.LowerCase(HeaderName),pas.SysUtils.Trim(HeaderValue)]));
    };
    this.Get = function (HeaderName) {
      var Result = "";
      if (this.FHeaders.ContainsKey(pas.SysUtils.LowerCase(HeaderName))) {
        Result = this.FHeaders.GetItem(pas.SysUtils.LowerCase(HeaderName)).FValue}
       else Result = "";
      return Result;
    };
    this.Clear = function () {
      this.FHeaders.Clear();
    };
  });
});
rtl.module("XData.Web.Request",["System","XData.Web.Headers"],function () {
  "use strict";
  var $mod = this;
  rtl.createInterface(this,"IHttpRequest","{782AF543-EFEB-4DA5-AC25-842DF76723A0}",["GetMethod","SetMethod","GetUri","SetUri","GetTimeout","GetHeaders","GetContent","SetContent","GetResponseType","SetResponseType"],pas.System.IUnknown);
  rtl.createClass(this,"THttpRequest",pas.System.TInterfacedObject,function () {
    this.$init = function () {
      pas.System.TInterfacedObject.$init.call(this);
      this.FMethod = "";
      this.FUri = "";
      this.FHeaders = null;
      this.FContent = undefined;
      this.FTimeout = 0;
      this.FResponseType = "";
    };
    this.$final = function () {
      this.FHeaders = undefined;
      pas.System.TInterfacedObject.$final.call(this);
    };
    this.GetMethod = function () {
      var Result = "";
      Result = this.FMethod;
      return Result;
    };
    this.SetMethod = function (Value) {
      this.FMethod = pas.SysUtils.UpperCase(Value);
    };
    this.GetUri = function () {
      var Result = "";
      Result = this.FUri;
      return Result;
    };
    this.SetUri = function (Value) {
      this.FUri = Value;
    };
    this.GetTimeout = function () {
      var Result = 0;
      Result = this.FTimeout;
      return Result;
    };
    this.GetHeaders = function () {
      var Result = null;
      Result = this.FHeaders;
      return Result;
    };
    this.GetContent = function () {
      var Result = undefined;
      Result = this.FContent;
      return Result;
    };
    this.SetContent = function (Value) {
      this.FContent = Value;
    };
    this.GetResponseType = function () {
      var Result = "";
      Result = this.FResponseType;
      return Result;
    };
    this.SetResponseType = function (Value) {
      this.FResponseType = Value;
    };
    this.Create$1 = function () {
      this.Create$3("","GET");
      return this;
    };
    this.Create$2 = function (AUri) {
      this.Create$3(AUri,"GET");
      return this;
    };
    this.Create$3 = function (AUri, AMethod) {
      this.FHeaders = pas["XData.Web.Headers"].THttpHeaders.$create("Create$1");
      this.FUri = AUri;
      this.FMethod = AMethod;
      this.FTimeout = 0;
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHeaders");
      pas.System.TObject.Destroy.call(this);
    };
    rtl.addIntf(this,$mod.IHttpRequest);
    rtl.addIntf(this,pas.System.IUnknown);
  });
},["SysUtils"]);
rtl.module("XData.Web.Response",["System","XData.Web.Headers","Web"],function () {
  "use strict";
  var $mod = this;
  rtl.createInterface(this,"IHttpResponse","{4F5FBBEB-2D03-446F-AD75-FFF8DB09B0B0}",["GetStatusCode","GetStatusReason","GetHeaders","GetContentAsText","GetContent"],pas.System.IUnknown);
  rtl.createClass(this,"THttpResponse",pas.System.TInterfacedObject,function () {
    this.$init = function () {
      pas.System.TInterfacedObject.$init.call(this);
      this.FPrepared = false;
      this.FHeaders = null;
    };
    this.$final = function () {
      this.FHeaders = undefined;
      pas.System.TInterfacedObject.$final.call(this);
    };
    this.GetHeaders = function () {
      var Result = null;
      this.PrepareResponse();
      Result = this.FHeaders;
      return Result;
    };
    this.PrepareResponse = function () {
      if (this.FPrepared) return;
      this.FPrepared = true;
      this.UpdateHeaders(this.FHeaders);
    };
    this.Create$1 = function () {
      this.FHeaders = pas["XData.Web.Headers"].THttpHeaders.$create("Create$1");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHeaders");
      pas.System.TObject.Destroy.call(this);
    };
    rtl.addIntf(this,$mod.IHttpResponse);
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TXhrHttpResponse",this.THttpResponse,function () {
    this.$init = function () {
      $mod.THttpResponse.$init.call(this);
      this.FXhr = null;
    };
    this.$final = function () {
      this.FXhr = undefined;
      $mod.THttpResponse.$final.call(this);
    };
    this.GetStatusCode = function () {
      var Result = 0;
      Result = this.FXhr.status;
      return Result;
    };
    this.GetStatusReason = function () {
      var Result = "";
      Result = this.FXhr.statusText;
      return Result;
    };
    this.UpdateHeaders = function (AHeaders) {
      var I = 0;
      var SplitHeaders = [];
      var HeaderPair = [];
      SplitHeaders = pas.SysUtils.Trim(this.FXhr.getAllResponseHeaders()).split("\r\n");
      this.FHeaders.Clear();
      for (var $l = 0, $end = rtl.length(SplitHeaders) - 1; $l <= $end; $l++) {
        I = $l;
        HeaderPair = SplitHeaders[I].split(":");
        this.FHeaders.SetValue(pas.SysUtils.Trim(HeaderPair[0]),pas.SysUtils.Trim(HeaderPair[1]));
      };
    };
    this.GetContentAsText = function () {
      var Result = "";
      Result = this.FXhr.responseText;
      return Result;
    };
    this.GetContent = function () {
      var Result = undefined;
      Result = this.FXhr.response;
      return Result;
    };
    this.Create$2 = function (AXhr) {
      $mod.THttpResponse.Create$1.call(this);
      this.FXhr = AXhr;
      return this;
    };
    rtl.addIntf(this,$mod.IHttpResponse);
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TDummyHttpResponse",this.THttpResponse,function () {
    this.GetStatusCode = function () {
      var Result = 0;
      Result = 0;
      return Result;
    };
    this.GetStatusReason = function () {
      var Result = "";
      Result = "";
      return Result;
    };
    this.UpdateHeaders = function (AHeaders) {
    };
    this.GetContentAsText = function () {
      var Result = "";
      Result = "";
      return Result;
    };
    this.GetContent = function () {
      var Result = undefined;
      Result = undefined;
      return Result;
    };
    rtl.addIntf(this,$mod.IHttpResponse);
    rtl.addIntf(this,pas.System.IUnknown);
  });
},["Types","SysUtils","JS"]);
rtl.module("Generics.Strings",["System"],function () {
  "use strict";
  var $mod = this;
  $mod.$resourcestrings = {SArgumentOutOfRange: {org: "Argument out of range"}};
});
rtl.module("Generics.Collections",["System","Classes","SysUtils","RTLConsts","Types","JS","Generics.Strings"],function () {
  "use strict";
  var $mod = this;
  this.TCollectionNotification = {"0": "cnAdded", cnAdded: 0, "1": "cnRemoved", cnRemoved: 1, "2": "cnExtracted", cnExtracted: 2};
  rtl.createClass(this,"TEnumerable$G21",pas.System.TObject,function () {
  },"TEnumerable<XData.Model.Types.TXDataPrimitiveType>");
  rtl.createClass(this,"TCustomList$G11",this.TEnumerable$G21,function () {
    this.$init = function () {
      $mod.TEnumerable$G21.$init.call(this);
      this.FOnNotify = null;
      this.FLength = 0;
      this.FItems = [];
    };
    this.$final = function () {
      this.FOnNotify = undefined;
      this.FItems = undefined;
      $mod.TEnumerable$G21.$final.call(this);
    };
    this.GetCapacity = function () {
      var Result = 0;
      Result = rtl.length(this.FItems);
      return Result;
    };
    this.PrepareAddingItem = function () {
      var Result = 0;
      if (this.FLength === rtl.length(this.FItems)) this.FItems.push(null);
      Result = this.FLength;
      this.FLength += 1;
      return Result;
    };
    this.Notify = function (AValue, ACollectionNotification) {
      if (this.FOnNotify != null) this.FOnNotify(this,AValue,ACollectionNotification);
    };
  },"TCustomList<XData.Model.Types.TXDataPrimitiveType>");
  rtl.createClass(this,"TList$G4",this.TCustomList$G11,function () {
    this.SetCapacity = function (AValue) {
      if (AValue < this.FLength) this.SetCount(AValue);
      this.FItems = rtl.arraySetLength(this.FItems,null,AValue);
    };
    this.SetCount = function (AValue) {
      if (AValue < 0) throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);
      if (AValue > this.GetCapacity()) {
        this.SetCapacity(AValue)}
       else if (AValue < this.FLength) this.DeleteRange(AValue,this.FLength - AValue);
      this.FLength = AValue;
    };
    this.InitializeList = function () {
    };
    this.GetItem = function (AIndex) {
      var Result = null;
      if ((AIndex < 0) || (AIndex >= this.FLength)) throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);
      Result = this.FItems[AIndex];
      return Result;
    };
    this.Create$1 = function () {
      this.InitializeList();
      return this;
    };
    this.Destroy = function () {
      this.SetCapacity(0);
    };
    this.Add = function (AValue) {
      var Result = 0;
      Result = this.PrepareAddingItem();
      this.FItems[Result] = AValue;
      this.Notify(AValue,0);
      return Result;
    };
    this.DeleteRange = function (AIndex, ACount) {
      var LDeleted = [];
      var i = 0;
      if (ACount === 0) return;
      if ((ACount < 0) || (AIndex < 0) || ((AIndex + ACount) > this.FLength)) throw pas.SysUtils.EArgumentOutOfRangeException.$create("Create$1",[rtl.getResStr(pas["Generics.Strings"],"SArgumentOutOfRange")]);
      LDeleted = this.FItems.splice(AIndex,this.FLength);
      this.FLength -= ACount;
      for (var $l = 0, $end = rtl.length(LDeleted) - 1; $l <= $end; $l++) {
        i = $l;
        this.Notify(LDeleted[i],1);
      };
    };
  },"TList<XData.Model.Types.TXDataPrimitiveType>");
});
rtl.module("Bcl.Json.Attributes",["System","Generics.Collections","Classes"],function () {
  "use strict";
  var $mod = this;
  this.TInclusionMode = {"0": "Always", Always: 0, "1": "NonDefault", NonDefault: 1};
  rtl.createClass(this,"JsonIncludeAttribute",pas.System.TCustomAttribute,function () {
    this.$init = function () {
      pas.System.TCustomAttribute.$init.call(this);
      this.FInclusionMode = 0;
    };
    this.Create$1 = function (AInclusionMode) {
      this.FInclusionMode = AInclusionMode;
      return this;
    };
  });
});
rtl.module("Bcl.Rtti.Common",["System","SysUtils","JS"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"EInvalidJSCast",pas.SysUtils.Exception,function () {
    this.Create$2 = function (Value, TypeName) {
      pas.SysUtils.Exception.CreateFmt.call(this,"Cannot cast value %s to type %s",pas.System.VarRecs(18,$mod.TValue_ToString(Value),18,TypeName));
      return this;
    };
  });
  this.TValue_AsString = function (Value) {
    var Result = "";
    if (!rtl.isString(Value)) throw $mod.EInvalidJSCast.$create("Create$2",[Value,"String"]);
    Result = "" + Value;
    return Result;
  };
  this.TValue_AsInteger = function (Value) {
    var Result = 0;
    Result = 0;
    Result = Math.floor(Value);
    if ((Result != Value) || (typeof(Value) !== "number")) throw $mod.EInvalidJSCast.$create("Create$2",[Value,"Integer"]);
    return Result;
  };
  this.TValue_AsOrdinal = function (Value) {
    var Result = 0;
    Result = $mod.TValue_AsInteger(Value);
    return Result;
  };
  this.TValue_AsBoolean = function (Value) {
    var Result = false;
    Result = false;
    if (!pas.JS.isBoolean(Value)) throw $mod.EInvalidJSCast.$create("Create$2",[Value,"Boolean"]);
    Result = !(Value == false);
    return Result;
  };
  this.TValue_AsExtended = function (Value) {
    var Result = 0.0;
    Result = 0.0;
    if (!rtl.isNumber(Value)) throw $mod.EInvalidJSCast.$create("Create$2",[Value,"Number"]);
    Result = rtl.getNumber(Value);
    return Result;
  };
  this.TValue_AsDouble = function (Value) {
    var Result = 0.0;
    Result = $mod.TValue_AsExtended(Value);
    return Result;
  };
  this.TValue_AsBytes = function (Value) {
    var Result = [];
    Result = Value;
    return Result;
  };
  this.TValue_ToString = function (Value) {
    Result = "" + Value;
  };
});
rtl.module("Bcl.SysUtils",["System"],function () {
  "use strict";
  var $mod = this;
  this.NumberToStr = function (Value) {
    return Value.toString();
  };
},["JS"]);
rtl.module("Bcl.Utils",["System","SysUtils","Classes","JS","WEBLib.Utils"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.TTimeZoneMode = {"0": "Error", Error: 0, "1": "Ignore", Ignore: 1, "2": "AsUTC", AsUTC: 2, "3": "AsLocal", AsLocal: 3};
  rtl.createClass(this,"TBclUtils",pas.System.TObject,function () {
    this.DateTimeToISO = function (Value, FullNotation) {
      var Result = "";
      var Year = 0;
      var Month = 0;
      var Day = 0;
      var Hour = 0;
      var Minute = 0;
      var Second = 0;
      var MS = 0;
      if (!FullNotation && (Value === pas.DateUtils.DateOf(Value))) {
        Result = this.DateToISO(Value)}
       else {
        pas.DateUtils.DecodeDateTime(Value,{get: function () {
            return Year;
          }, set: function (v) {
            Year = v;
          }},{get: function () {
            return Month;
          }, set: function (v) {
            Month = v;
          }},{get: function () {
            return Day;
          }, set: function (v) {
            Day = v;
          }},{get: function () {
            return Hour;
          }, set: function (v) {
            Hour = v;
          }},{get: function () {
            return Minute;
          }, set: function (v) {
            Minute = v;
          }},{get: function () {
            return Second;
          }, set: function (v) {
            Second = v;
          }},{get: function () {
            return MS;
          }, set: function (v) {
            MS = v;
          }});
        if (FullNotation || (pas.DateUtils.DateOf(Value) !== 0)) {
          Result = pas.SysUtils.Format("%sT%s",pas.System.VarRecs(18,this.DateToISO(Value),18,this.TimeToISO(Value)))}
         else Result = pas.SysUtils.Format("%s",pas.System.VarRecs(18,this.TimeToISO(Value)));
      };
      return Result;
    };
    this.TimeToISO = function (Value) {
      var Result = "";
      var Year = 0;
      var Month = 0;
      var Day = 0;
      var Hour = 0;
      var Minute = 0;
      var Second = 0;
      var MS = 0;
      pas.DateUtils.DecodeDateTime(Value,{get: function () {
          return Year;
        }, set: function (v) {
          Year = v;
        }},{get: function () {
          return Month;
        }, set: function (v) {
          Month = v;
        }},{get: function () {
          return Day;
        }, set: function (v) {
          Day = v;
        }},{get: function () {
          return Hour;
        }, set: function (v) {
          Hour = v;
        }},{get: function () {
          return Minute;
        }, set: function (v) {
          Minute = v;
        }},{get: function () {
          return Second;
        }, set: function (v) {
          Second = v;
        }},{get: function () {
          return MS;
        }, set: function (v) {
          MS = v;
        }});
      if ((MS !== 0) || $mod.FullISOTimeNotation) {
        Result = pas.SysUtils.Format("%.2d:%.2d:%.2d.%.3d",pas.System.VarRecs(0,Hour,0,Minute,0,Second,0,MS))}
       else if (Second !== 0) {
        Result = pas.SysUtils.Format("%.2d:%.2d:%.2d",pas.System.VarRecs(0,Hour,0,Minute,0,Second))}
       else Result = pas.SysUtils.Format("%.2d:%.2d",pas.System.VarRecs(0,Hour,0,Minute));
      return Result;
    };
    this.DateToISO = function (Value) {
      var Result = "";
      var Year = 0;
      var Month = 0;
      var Day = 0;
      pas.SysUtils.DecodeDate(Value,{get: function () {
          return Year;
        }, set: function (v) {
          Year = v;
        }},{get: function () {
          return Month;
        }, set: function (v) {
          Month = v;
        }},{get: function () {
          return Day;
        }, set: function (v) {
          Day = v;
        }});
      Result = pas.SysUtils.Format("%.4d-%.2d-%.2d",pas.System.VarRecs(0,Year,0,Month,0,Day));
      return Result;
    };
    var EncodeTable = ["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];
    this.EncodeBase64 = function (Input) {
      var Result = "";
      Result = this.InternalEncodeBase64(Input,EncodeTable.slice(0),true);
      return Result;
    };
    this.CombineUrlFast = function (AbsoluteUrl, RelativeUrl) {
      var Result = "";
      Result = AbsoluteUrl;
      if ((Result.length > 0) && (Result.charAt(Result.length - 1) !== "/")) Result = Result + "/";
      Result = Result + RelativeUrl;
      return Result;
    };
    this.InternalEncodeBase64 = function (Input, EncodeTable, Padding) {
      var $Self = this;
      var Result = "";
      var Output = "";
      function EncodePacket(Packet, NumChars, Idx) {
        Output = rtl.setCharAt(Output,(Idx + 0) - 1,EncodeTable[Packet.a[0] >>> 2]);
        Output = rtl.setCharAt(Output,(Idx + 1) - 1,EncodeTable[((Packet.a[0] << 4) | (Packet.a[1] >>> 4)) & 0x3f]);
        if (NumChars < 2) {
          Output = rtl.setCharAt(Output,(Idx + 2) - 1,"=")}
         else Output = rtl.setCharAt(Output,(Idx + 2) - 1,EncodeTable[((Packet.a[1] << 2) | (Packet.a[2] >>> 6)) & 0x3f]);
        if (NumChars < 3) {
          Output = rtl.setCharAt(Output,(Idx + 3) - 1,"=")}
         else Output = rtl.setCharAt(Output,(Idx + 3) - 1,EncodeTable[Packet.a[2] & 0x3f]);
      };
      var I = 0;
      var K = 0;
      var J = 0;
      var Packet = $impl.TPacket.$new();
      Output = "";
      I = rtl.trunc(rtl.length(Input) / 3) * 4;
      if ((rtl.length(Input) % 3) > 0) I += 4;
      Output = rtl.strSetLength(Output,I);
      J = 1;
      for (var $l = 1, $end = rtl.trunc(rtl.length(Input) / 3); $l <= $end; $l++) {
        I = $l;
        Packet.a[0] = Input[(I - 1) * 3];
        Packet.a[1] = Input[((I - 1) * 3) + 1];
        Packet.a[2] = Input[((I - 1) * 3) + 2];
        Packet.a[3] = 0;
        EncodePacket(Packet,3,J);
        J += 4;
      };
      K = 0;
      Packet.a[0] = 0;
      Packet.a[1] = 0;
      Packet.a[2] = 0;
      Packet.a[3] = 0;
      for (var $l1 = (rtl.length(Input) - (rtl.length(Input) % 3)) + 1, $end1 = rtl.length(Input); $l1 <= $end1; $l1++) {
        I = $l1;
        Packet.a[K] = Input[I - 1];
        K += 1;
        if (I === rtl.length(Input)) EncodePacket(Packet,rtl.length(Input) % 3,J);
      };
      if (!Padding && (Output.length >= 2)) {
        if (Output.charAt(Output.length - 1 - 1) === "=") {
          Output = rtl.strSetLength(Output,Output.length - 2)}
         else if (Output.charAt(Output.length - 1) === "=") Output = rtl.strSetLength(Output,Output.length - 1);
      };
      Result = Output;
      return Result;
    };
    this.PercentEncode = function (S) {
      var Result = "";
      Result = encodeURIComponent(S);
      return Result;
    };
  });
  this.DefaultTimeZoneMode = 0;
  this.FullISOTimeNotation = false;
  $mod.$implcode = function () {
    rtl.recNewT($impl,"TPacket",function () {
      this.$new = function () {
        var r = Object.create(this);
        r.a = rtl.arraySetLength(null,0,4);
        return r;
      };
      this.$eq = function (b) {
        return rtl.arrayEq(this.a,b.a);
      };
      this.$assign = function (s) {
        this.a = s.a.slice(0);
        return this;
      };
    });
  };
  $mod.$init = function () {
    $mod.DefaultTimeZoneMode = 0;
    $mod.FullISOTimeNotation = false;
  };
},["DateUtils"]);
rtl.module("XData.Model.Types",["System","Generics.Collections","SysUtils","Bcl.SysUtils","Bcl.Collections.Common","XData.Model.Classes"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TXDataPrimitiveType",pas["XData.Model.Classes"].TXDataScalarType,function () {
    this.Destroy = function () {
      pas["XData.Model.Classes"].TXDataScalarType.Destroy.call(this);
    };
  });
  rtl.createClass(this,"TXDataBinaryType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Binary";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 12;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Literal.set(pas["Bcl.Utils"].TBclUtils.EncodeBase64(Value));
      Result = true;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataBooleanType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Boolean";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 5;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      if (Value) {
        Literal.set("true")}
       else Literal.set("false");
      Result = true;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataByteType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Byte";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 15;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataDateTimeType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "DateTime";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 6;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Result = true;
      Literal.set(pas["Bcl.Utils"].TBclUtils.DateTimeToISO(Value,false));
      return Result;
    };
  });
  rtl.createClass(this,"TXDataDateType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Date";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 7;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Result = true;
      Literal.set(pas["Bcl.Utils"].TBclUtils.DateToISO(Value));
      return Result;
    };
  });
  rtl.createClass(this,"TXDataCurrencyType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Currency";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 9;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataDoubleType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Double";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 4;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Literal.set(pas["Bcl.SysUtils"].NumberToStr(Value));
      Result = true;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataGuidType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Guid";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 10;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Result = true;
      var $tmp = Value.length;
      if ($tmp === 36) {
        Literal.set(Value)}
       else if ($tmp === 38) {
        Literal.set(pas.System.Copy(Value,2,36))}
       else {
        Result = false;
      };
      return Result;
    };
  });
  rtl.createClass(this,"TXDataVariantType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Variant";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 11;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      var T = null;
      T = $mod.TXDataPrimitiveTypes.Instance();
      Result = true;
      var $tmp = pas.JS.GetValueType(Value);
      if ($tmp === 0) {
        Literal.set("null")}
       else if ($tmp === 1) {
        Result = T.FBooleanType.ValueToLiteral(!(Value == false),Literal)}
       else if ($tmp === 2) {
        Result = T.FInt32Type.ValueToLiteral(rtl.trunc(Value),Literal)}
       else if ($tmp === 3) {
        Result = T.FDoubleType.ValueToLiteral(rtl.getNumber(Value),Literal)}
       else if ($tmp === 4) {
        Result = T.FStringType.ValueToLiteral("" + Value,Literal);
        Literal.set($mod.LiteralQuote(Literal.get()));
      } else {
        Result = false;
      };
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInt16Type",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Int16";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 14;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Literal.set(pas.SysUtils.IntToStr(Value));
      Result = true;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInt32Type",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Int32";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 2;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Literal.set(pas.SysUtils.IntToStr(Value));
      Result = true;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInt64Type",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Int64";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 3;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataSByteType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "SByte";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 16;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataStringType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "String";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 1;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Literal.set(Value);
      Result = true;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataTimeType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Time";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 8;
      return Result;
    };
    this.ValueToLiteral = function (Value, Literal) {
      var Result = false;
      Result = true;
      Literal.set(pas["Bcl.Utils"].TBclUtils.TimeToISO(Value));
      return Result;
    };
  });
  rtl.createClass(this,"TXDataStreamType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Stream";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 13;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataRawType",this.TXDataPrimitiveType,function () {
    this.GetName = function () {
      var Result = "";
      Result = "Raw";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 21;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataPrimitiveTypes",pas.System.TObject,function () {
    this.FInstance = null;
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FTypes = null;
      this.FTypeList = null;
      this.FBinaryType = null;
      this.FBooleanType = null;
      this.FByteType = null;
      this.FDateTimeType = null;
      this.FDateType = null;
      this.FDoubleType = null;
      this.FInt16Type = null;
      this.FInt32Type = null;
      this.FInt64Type = null;
      this.FSByteType = null;
      this.FStringType = null;
      this.FTimeType = null;
      this.FStreamType = null;
      this.FRawType = null;
      this.FGuidType = null;
      this.FCurrencyType = null;
      this.FVariantType = null;
    };
    this.$final = function () {
      this.FTypes = undefined;
      this.FTypeList = undefined;
      this.FBinaryType = undefined;
      this.FBooleanType = undefined;
      this.FByteType = undefined;
      this.FDateTimeType = undefined;
      this.FDateType = undefined;
      this.FDoubleType = undefined;
      this.FInt16Type = undefined;
      this.FInt32Type = undefined;
      this.FInt64Type = undefined;
      this.FSByteType = undefined;
      this.FStringType = undefined;
      this.FTimeType = undefined;
      this.FStreamType = undefined;
      this.FRawType = undefined;
      this.FGuidType = undefined;
      this.FCurrencyType = undefined;
      this.FVariantType = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.PrivateCreate = function () {
      this.FTypes = pas["Bcl.Collections.Common"].TStringMap.$create("Create$1",[false]);
      this.FTypeList = pas["Generics.Collections"].TList$G4.$create("Create$1");
      this.FBinaryType = $mod.TXDataBinaryType.$create("Create");
      this.FBooleanType = $mod.TXDataBooleanType.$create("Create");
      this.FByteType = $mod.TXDataByteType.$create("Create");
      this.FDateTimeType = $mod.TXDataDateTimeType.$create("Create");
      this.FDateType = $mod.TXDataDateType.$create("Create");
      this.FDoubleType = $mod.TXDataDoubleType.$create("Create");
      this.FInt16Type = $mod.TXDataInt16Type.$create("Create");
      this.FInt32Type = $mod.TXDataInt32Type.$create("Create");
      this.FInt64Type = $mod.TXDataInt64Type.$create("Create");
      this.FSByteType = $mod.TXDataSByteType.$create("Create");
      this.FStringType = $mod.TXDataStringType.$create("Create");
      this.FTimeType = $mod.TXDataTimeType.$create("Create");
      this.FStreamType = $mod.TXDataStreamType.$create("Create");
      this.FRawType = $mod.TXDataRawType.$create("Create");
      this.FGuidType = $mod.TXDataGuidType.$create("Create");
      this.FCurrencyType = $mod.TXDataCurrencyType.$create("Create");
      this.FVariantType = $mod.TXDataVariantType.$create("Create");
      this.AddType(pas.SysUtils.LowerCase(this.FBinaryType.GetName()),this.FBinaryType);
      this.AddType(pas.SysUtils.LowerCase(this.FBooleanType.GetName()),this.FBooleanType);
      this.AddType(pas.SysUtils.LowerCase(this.FByteType.GetName()),this.FByteType);
      this.AddType(pas.SysUtils.LowerCase(this.FDateTimeType.GetName()),this.FDateTimeType);
      this.AddType(pas.SysUtils.LowerCase(this.FDateType.GetName()),this.FDateType);
      this.AddType(pas.SysUtils.LowerCase(this.FDoubleType.GetName()),this.FDoubleType);
      this.AddType(pas.SysUtils.LowerCase(this.FInt16Type.GetName()),this.FInt16Type);
      this.AddType(pas.SysUtils.LowerCase(this.FInt32Type.GetName()),this.FInt32Type);
      this.AddType(pas.SysUtils.LowerCase(this.FInt64Type.GetName()),this.FInt64Type);
      this.AddType(pas.SysUtils.LowerCase(this.FSByteType.GetName()),this.FSByteType);
      this.AddType(pas.SysUtils.LowerCase(this.FStringType.GetName()),this.FStringType);
      this.AddType(pas.SysUtils.LowerCase(this.FTimeType.GetName()),this.FTimeType);
      this.AddType(pas.SysUtils.LowerCase(this.FStreamType.GetName()),this.FStreamType);
      this.AddType(pas.SysUtils.LowerCase(this.FRawType.GetName()),this.FRawType);
      this.AddType(pas.SysUtils.LowerCase(this.FGuidType.GetName()),this.FGuidType);
      this.AddType(pas.SysUtils.LowerCase(this.FCurrencyType.GetName()),this.FCurrencyType);
      this.AddType(pas.SysUtils.LowerCase(this.FVariantType.GetName()),this.FVariantType);
    };
    this.PrivateDestroy = function () {
      rtl.free(this,"FTypeList");
      rtl.free(this,"FTypes");
      rtl.free(this,"FVariantType");
      rtl.free(this,"FCurrencyType");
      rtl.free(this,"FGuidType");
      rtl.free(this,"FBinaryType");
      rtl.free(this,"FBooleanType");
      rtl.free(this,"FByteType");
      rtl.free(this,"FDateTimeType");
      rtl.free(this,"FDateType");
      rtl.free(this,"FDoubleType");
      rtl.free(this,"FInt16Type");
      rtl.free(this,"FInt32Type");
      rtl.free(this,"FInt64Type");
      rtl.free(this,"FSByteType");
      rtl.free(this,"FStringType");
      rtl.free(this,"FTimeType");
      rtl.free(this,"FStreamType");
      rtl.free(this,"FRawType");
    };
    this.AddType = function (Key, Value) {
      this.FTypes.Add(Key,Value);
      this.FTypeList.Add(Value);
    };
    this.GetTypes = function () {
      var Result = null;
      Result = this.FTypeList;
      return Result;
    };
    this.Instance = function () {
      var Result = null;
      if (this.FInstance === null) {
        $mod.TXDataPrimitiveTypes.FInstance = $mod.TXDataPrimitiveTypes.$create("Create");
        this.FInstance.PrivateCreate();
      };
      Result = this.FInstance;
      return Result;
    };
    this.Find = function (AName) {
      var Result = null;
      if (this.FTypes.ContainsKey(pas.SysUtils.LowerCase(AName))) {
        Result = this.FTypes.GetItem(pas.SysUtils.LowerCase(AName))}
       else Result = null;
      return Result;
    };
    this.Destroy = function () {
      this.PrivateDestroy();
      pas.System.TObject.Destroy.call(this);
    };
  });
  this.LiteralQuote = function (Str) {
    var Result = "";
    Result = pas.SysUtils.StringReplace(Str,"'","''",rtl.createSet(0));
    Result = "'" + Result + "'";
    return Result;
  };
},["JS","Bcl.Utils"]);
rtl.module("XData.Types.Converters",["System","SysUtils","Bcl.Rtti.Common","JS","XData.Model.Classes"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  rtl.createClass(this,"TXDataTypeBaseConverter",pas["XData.Model.Classes"].TXDataTypeConverter,function () {
  });
  rtl.createClass(this,"TXDataInt32Converter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FInt32Type.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsInteger(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInt16Converter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FInt16Type.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsInteger(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataBooleanConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FBooleanType.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsBoolean(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataDoubleConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FDoubleType.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsExtended(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataDateTimeConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      if (rtl.isString(Value)) {
        Result = true;
        Literal.set("" + Value);
      } else Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FDateTimeType.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsDouble(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataDateConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      if (rtl.isString(Value)) {
        Result = true;
        Literal.set("" + Value);
      } else Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FDateType.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsDouble(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataTimeConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      if (rtl.isString(Value)) {
        Result = true;
        Literal.set("" + Value);
      } else Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FTimeType.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsDouble(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataBinaryConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      var Bytes = [];
      Bytes = pas["Bcl.Rtti.Common"].TValue_AsBytes(Value);
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FBinaryType.ValueToLiteral(rtl.arrayRef(Bytes),Literal);
      Literal.set(pas["XData.Model.Types"].LiteralQuote(Literal.get()));
      return Result;
    };
  });
  rtl.createClass(this,"TXDataStringConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FStringType.ValueToLiteral(pas["XData.Model.Types"].LiteralQuote(pas["Bcl.Rtti.Common"].TValue_AsString(Value)),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataGuidConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FGuidType.ValueToLiteral(pas["Bcl.Rtti.Common"].TValue_AsString(Value),Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataVariantConverter",this.TXDataTypeBaseConverter,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FVariantType.ValueToLiteral(Value,Literal);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataEnumConverter",pas["XData.Model.Classes"].TXDataTypeConverter,function () {
    this.$init = function () {
      pas["XData.Model.Classes"].TXDataTypeConverter.$init.call(this);
      this.FEnumType = null;
    };
    this.$final = function () {
      this.FEnumType = undefined;
      pas["XData.Model.Classes"].TXDataTypeConverter.$final.call(this);
    };
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      var I = 0;
      var EnumValue = 0;
      EnumValue = pas["Bcl.Rtti.Common"].TValue_AsOrdinal(Value);
      Result = false;
      for (var $l = 0, $end = this.FEnumType.FMembers.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if (EnumValue === this.FEnumType.FMembers.GetItem$1(I).FValue) {
          Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().FStringType.ValueToLiteral(this.FEnumType.FMembers.GetItem$1(I).FName,Literal);
          return Result;
        };
      };
      return Result;
    };
    this.Create$1 = function (AEnumType) {
      this.FEnumType = AEnumType;
      return this;
    };
  });
  $mod.$implcode = function () {
    $impl.AddDefaultUrlConverters = function () {
      var Types = null;
      Types = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance();
      Types.FInt32Type.FUrlConverter = $mod.TXDataInt32Converter.$create("Create");
      Types.FInt16Type.FUrlConverter = $mod.TXDataInt16Converter.$create("Create");
      Types.FInt64Type.FUrlConverter = $mod.TXDataInt32Converter.$create("Create");
      Types.FBooleanType.FUrlConverter = $mod.TXDataBooleanConverter.$create("Create");
      Types.FDoubleType.FUrlConverter = $mod.TXDataDoubleConverter.$create("Create");
      Types.FCurrencyType.FUrlConverter = $mod.TXDataDoubleConverter.$create("Create");
      Types.FDateTimeType.FUrlConverter = $mod.TXDataDateTimeConverter.$create("Create");
      Types.FDateType.FUrlConverter = $mod.TXDataDateConverter.$create("Create");
      Types.FTimeType.FUrlConverter = $mod.TXDataTimeConverter.$create("Create");
      Types.FBinaryType.FUrlConverter = $mod.TXDataBinaryConverter.$create("Create");
      Types.FStreamType.FUrlConverter = $mod.TXDataBinaryConverter.$create("Create");
      Types.FStringType.FUrlConverter = $mod.TXDataStringConverter.$create("Create");
      Types.FGuidType.FUrlConverter = $mod.TXDataGuidConverter.$create("Create");
      Types.FVariantType.FUrlConverter = $mod.TXDataVariantConverter.$create("Create");
    };
  };
  $mod.$init = function () {
    $impl.AddDefaultUrlConverters();
  };
},["XData.Model.Types"]);
rtl.module("XData.Utils",["System","SysUtils"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TXDataUtils",pas.System.TObject,function () {
    this.GetNameAndKey = function (Input, Name, Key) {
      var Result = false;
      var P1 = 0;
      var Len = 0;
      var KeyLen = 0;
      P1 = pas.System.Pos("(",Input);
      Len = Input.length;
      KeyLen = Len - P1 - 1;
      Result = (P1 > 1) && (Len >= 4) && (Input.charAt(Len - 1) === ")") && (KeyLen > 0);
      if (Result) {
        Name.set(pas.System.Copy(Input,1,P1 - 1));
        Key.set(pas.System.Copy(Input,P1 + 1,KeyLen));
      };
      return Result;
    };
    this.CombineUrlFast = function (AbsoluteUrl, RelativeUrl) {
      var Result = "";
      Result = AbsoluteUrl;
      if ((Result.length > 0) && (Result.charAt(Result.length - 1) !== "/")) Result = Result + "/";
      Result = Result + RelativeUrl;
      return Result;
    };
  });
});
rtl.module("XData.Model.Classes",["System","Classes","SysUtils","Types","StrUtils","TypInfo","contnrs","Bcl.Json.Attributes","Bcl.Collections.Common","Bcl.Rtti.Common"],function () {
  "use strict";
  var $mod = this;
  var $impl = $mod.$impl;
  this.$rtti.$Class("TXDataEntityType");
  this.$rtti.$Class("TXDataInstanceType");
  this.TXTypeKind = {"0": "xtUndefined", xtUndefined: 0, "1": "xtText", xtText: 1, "2": "xtInt32", xtInt32: 2, "3": "xtInt64", xtInt64: 3, "4": "xtDouble", xtDouble: 4, "5": "xtBoolean", xtBoolean: 5, "6": "xtDateTime", xtDateTime: 6, "7": "xtDate", xtDate: 7, "8": "xtTime", xtTime: 8, "9": "xtCurrency", xtCurrency: 9, "10": "xtGuid", xtGuid: 10, "11": "xtVariant", xtVariant: 11, "12": "xtBinary", xtBinary: 12, "13": "xtStream", xtStream: 13, "14": "xtInt16", xtInt16: 14, "15": "xtByte", xtByte: 15, "16": "xtSByte", xtSByte: 16, "17": "xtEntity", xtEntity: 17, "18": "xtEntityCollection", xtEntityCollection: 18, "19": "xtEnum", xtEnum: 19, "20": "xtScalarCollection", xtScalarCollection: 20, "21": "xtRaw", xtRaw: 21, "22": "xtInstance", xtInstance: 22, "23": "xtInstanceCollection", xtInstanceCollection: 23};
  this.$rtti.$Class("TXDataSchema");
  this.$rtti.$Class("TXDataModel");
  rtl.createClass(this,"TXDataModelObject",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FDescription = "";
      this.FParent = null;
    };
    this.$final = function () {
      this.FParent = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataOwnedList",pas.contnrs.TObjectList,function () {
    this.$init = function () {
      pas.contnrs.TObjectList.$init.call(this);
      this.FOwner = null;
    };
    this.$final = function () {
      this.FOwner = undefined;
      pas.contnrs.TObjectList.$final.call(this);
    };
    this.Notify = function (Ptr, Action) {
      if (this.FOwner === null) return;
      if (Action === 0) {
        rtl.getObject(Ptr).FParent = this.FOwner}
       else rtl.getObject(Ptr).FParent = null;
      pas.contnrs.TObjectList.Notify.apply(this,arguments);
    };
    this.Create$4 = function (AOwner) {
      pas.contnrs.TObjectList.Create$3.call(this,AOwner !== null);
      this.FOwner = AOwner;
      return this;
    };
    this.Create$5 = function () {
      this.Create$4(null);
      return this;
    };
  });
  rtl.createClass(this,"TXDataType",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FUrlConverter = null;
    };
    this.$final = function () {
      this.FUrlConverter = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.GetName = function () {
      var Result = "";
      Result = this.FName;
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 0;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataScalarType",this.TXDataType,function () {
    this.$init = function () {
      $mod.TXDataType.$init.call(this);
      this.FCollection = null;
    };
    this.$final = function () {
      this.FCollection = undefined;
      $mod.TXDataType.$final.call(this);
    };
    this.GetCollection = function () {
      var Result = null;
      if (this.FCollection === null) {
        this.FCollection = $mod.TXDataScalarCollectionType.$create("Create");
        this.FCollection.FItemType = this;
      };
      Result = this.FCollection;
      return Result;
    };
    this.Destroy = function () {
      rtl.free(this,"FCollection");
      $mod.TXDataModelObject.Destroy.call(this);
    };
  });
  rtl.createClass(this,"TXDataEnumMember",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FValue = 0;
    };
  });
  rtl.createClass(this,"TXDataEnumMemberList",pas.contnrs.TObjectList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataEnumType",this.TXDataScalarType,function () {
    this.$init = function () {
      $mod.TXDataScalarType.$init.call(this);
      this.FMembers = null;
    };
    this.$final = function () {
      this.FMembers = undefined;
      $mod.TXDataScalarType.$final.call(this);
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 19;
      return Result;
    };
    this.Create$1 = function () {
      this.FMembers = $mod.TXDataEnumMemberList.$create("Create$2");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FMembers");
      $mod.TXDataScalarType.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataEnumTypeList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataScalarCollectionType",this.TXDataScalarType,function () {
    this.$init = function () {
      $mod.TXDataScalarType.$init.call(this);
      this.FItemType = null;
    };
    this.$final = function () {
      this.FItemType = undefined;
      $mod.TXDataScalarType.$final.call(this);
    };
    this.GetName = function () {
      var Result = "";
      if (this.FItemType !== null) {
        Result = pas.SysUtils.Format("Collection(%s)",pas.System.VarRecs(18,this.FItemType.GetName()))}
       else Result = "Collection()";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 20;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataProperty",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FRequired = false;
    };
    this.GetParent = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      return this;
    };
    this.Destroy = function () {
      $mod.TXDataModelObject.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataPropertyList",pas.contnrs.TObjectList,function () {
  });
  rtl.createClass(this,"TXDataScalarProperty",this.TXDataProperty,function () {
    this.$init = function () {
      $mod.TXDataProperty.$init.call(this);
      this.FType = null;
      this.FLength = 0;
      this.FPrecision = 0;
      this.FScale = 0;
      this.FTypeRef = "";
    };
    this.$final = function () {
      this.FType = undefined;
      $mod.TXDataProperty.$final.call(this);
    };
    this.SetType = function (Value) {
      this.FType = Value;
    };
    this.GetUrlConverter = function () {
      var Result = null;
      if (this.FType !== null) {
        Result = this.FType.FUrlConverter}
       else Result = null;
      return Result;
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataSimpleProperty",this.TXDataScalarProperty,function () {
    this.GetParent$1 = function () {
      var Result = null;
      Result = this.GetParent();
      return Result;
    };
    this.Prepare = function () {
      if (this.FTypeRef !== "") {
        this.SetType(this.GetParent$1().GetSchema().FindScalarType(this.FTypeRef));
        if (this.FType === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["Property type %s not found for property %s.%s",pas.System.VarRecs(18,this.FTypeRef,18,this.GetParent$1().GetName(),18,this.FName)]);
        this.FTypeRef = "";
      };
      if (this.FType.FUrlConverter === null) throw $mod.EUrlConverterNotFound.$create("Create$2",[this.FType]);
    };
  });
  rtl.createClass(this,"TXDataInstanceSimpleProperty",this.TXDataScalarProperty,function () {
    this.GetParent$1 = function () {
      var Result = null;
      Result = this.GetParent();
      return Result;
    };
    this.Prepare = function () {
      if (this.FTypeRef !== "") {
        this.SetType(this.GetParent$1().GetSchema().FindScalarType(this.FTypeRef));
        this.FTypeRef = "";
      };
    };
  });
  rtl.createClass(this,"TXDataSimplePropertyList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInstanceScalarPropertyList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataStructuredProperty",this.TXDataProperty,function () {
    this.$init = function () {
      $mod.TXDataProperty.$init.call(this);
      this.FTargetRef = "";
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataInstanceNavigationProperty",this.TXDataStructuredProperty,function () {
    this.$init = function () {
      $mod.TXDataStructuredProperty.$init.call(this);
      this.FTarget = null;
    };
    this.$final = function () {
      this.FTarget = undefined;
      $mod.TXDataStructuredProperty.$final.call(this);
    };
    this.GetParent$1 = function () {
      var Result = null;
      Result = this.GetParent();
      return Result;
    };
    this.Prepare = function () {
      if (this.FTargetRef !== "") {
        this.FTarget = this.GetParent$1().GetSchema().FindEntityType(this.FTargetRef);
        if (this.FTarget === null) this.FTarget = this.GetParent$1().GetSchema().FindInstanceType(this.FTargetRef);
        this.FTargetRef = "";
      };
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataNavigationProperty",this.TXDataStructuredProperty,function () {
    this.$init = function () {
      $mod.TXDataStructuredProperty.$init.call(this);
      this.FTarget = null;
    };
    this.$final = function () {
      this.FTarget = undefined;
      $mod.TXDataStructuredProperty.$final.call(this);
    };
    this.GetParent$1 = function () {
      var Result = null;
      Result = this.GetParent();
      return Result;
    };
    this.Prepare = function () {
      if (this.FTargetRef !== "") {
        this.FTarget = this.GetParent$1().GetSchema().FindEntityType(this.FTargetRef);
        if (this.FTarget === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["Target %s not found for navigation property %s.%s",pas.System.VarRecs(18,this.FTargetRef,18,this.GetParent$1().GetName(),18,this.FName)]);
        this.FTargetRef = "";
      };
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataNavigationPropertyList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInstanceNavigationPropertyList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataStructuredType",this.TXDataType,function () {
    this.GetSchema = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.FindScalarProperty = function (AName) {
      var Result = null;
      var Prop = null;
      var I = 0;
      for (var $l = 0, $end = this.ScalarPropertyCount() - 1; $l <= $end; $l++) {
        I = $l;
        Prop = this.GetScalarProperty(I);
        if (pas.SysUtils.SameText(AName,Prop.FName)) return Prop;
      };
      Result = null;
      return Result;
    };
    this.FindStructuredProperty = function (AName) {
      var Result = null;
      var Prop = null;
      var I = 0;
      for (var $l = 0, $end = this.StructuredPropertyCount() - 1; $l <= $end; $l++) {
        I = $l;
        Prop = this.GetStructuredProperty(I);
        if (pas.SysUtils.SameText(AName,Prop.FName)) return Prop;
      };
      Result = null;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInstanceType",this.TXDataStructuredType,function () {
    this.$init = function () {
      $mod.TXDataStructuredType.$init.call(this);
      this.FBaseType = null;
      this.FProperties = null;
      this.FNavigationProperties = null;
      this.FCollection = null;
      this.FBaseTypeRef = "";
    };
    this.$final = function () {
      this.FBaseType = undefined;
      this.FProperties = undefined;
      this.FNavigationProperties = undefined;
      this.FCollection = undefined;
      $mod.TXDataStructuredType.$final.call(this);
    };
    this.Prepare = function () {
      var I = 0;
      if (this.FBaseTypeRef !== "") {
        this.FBaseType = this.GetSchema().FindInstanceType(this.FBaseTypeRef);
        if (this.FBaseType === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["BaseType %s not found for instance type %s",pas.System.VarRecs(18,this.FBaseTypeRef,18,this.GetName())]);
        this.FBaseTypeRef = "";
      };
      if (this.FBaseType !== null) this.FBaseType.Prepare();
      for (var $l = 0, $end = this.FProperties.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        this.FProperties.GetItem$1(I).Prepare();
      };
      for (var $l1 = 0, $end1 = this.FNavigationProperties.GetCount() - 1; $l1 <= $end1; $l1++) {
        I = $l1;
        this.FNavigationProperties.GetItem$1(I).Prepare();
      };
    };
    this.GetCollection = function () {
      var Result = null;
      if (this.FCollection === null) {
        this.FCollection = $mod.TXDataInstanceCollectionType.$create("Create$1");
        this.FCollection.FItemType = this;
        this.FCollection.FParent = this.FParent;
      };
      Result = this.FCollection;
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 22;
      return Result;
    };
    this.ScalarPropertyCount = function () {
      var Result = 0;
      Result = this.FProperties.GetCount();
      return Result;
    };
    this.GetScalarProperty = function (Index) {
      var Result = null;
      Result = this.FProperties.GetItem$1(Index);
      return Result;
    };
    this.StructuredPropertyCount = function () {
      var Result = 0;
      Result = this.FNavigationProperties.GetCount();
      return Result;
    };
    this.GetStructuredProperty = function (Index) {
      var Result = null;
      Result = this.FNavigationProperties.GetItem$1(Index);
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FProperties = $mod.TXDataInstanceScalarPropertyList.$create("Create$4",[this]);
      this.FNavigationProperties = $mod.TXDataInstanceNavigationPropertyList.$create("Create$4",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FNavigationProperties");
      rtl.free(this,"FProperties");
      rtl.free(this,"FCollection");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataInstanceCollectionType",this.TXDataInstanceType,function () {
    this.$init = function () {
      $mod.TXDataInstanceType.$init.call(this);
      this.FItemType = null;
    };
    this.$final = function () {
      this.FItemType = undefined;
      $mod.TXDataInstanceType.$final.call(this);
    };
    this.GetName = function () {
      var Result = "";
      if (this.FItemType !== null) {
        Result = pas.SysUtils.Format("Collection(%s)",pas.System.VarRecs(18,this.FItemType.GetName()))}
       else Result = "Collection()";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 23;
      return Result;
    };
  });
  rtl.createClass(this,"TXDataEntityType",this.TXDataStructuredType,function () {
    this.$init = function () {
      $mod.TXDataStructuredType.$init.call(this);
      this.FKey = null;
      this.FBaseType = null;
      this.FProperties = null;
      this.FNavigationProperties = null;
      this.FCollection = null;
      this.FBaseTypeRef = "";
      this.FKeyRef = [];
    };
    this.$final = function () {
      this.FKey = undefined;
      this.FBaseType = undefined;
      this.FProperties = undefined;
      this.FNavigationProperties = undefined;
      this.FCollection = undefined;
      this.FKeyRef = undefined;
      $mod.TXDataStructuredType.$final.call(this);
    };
    this.Prepare = function () {
      var KeyItem = "";
      var TempProp = null;
      var I = 0;
      if (this.FBaseTypeRef !== "") {
        this.FBaseType = this.GetSchema().FindEntityType(this.FBaseTypeRef);
        if (this.FBaseType === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["BaseType %s not found for entity type %s",pas.System.VarRecs(18,this.FBaseTypeRef,18,this.GetName())]);
        this.FBaseTypeRef = "";
      };
      if (this.FBaseType !== null) this.FBaseType.Prepare();
      if (rtl.length(this.FKeyRef) > 0) {
        this.FKey.Clear();
        for (var $l = 0, $end = rtl.length(this.FKeyRef) - 1; $l <= $end; $l++) {
          I = $l;
          KeyItem = this.FKeyRef[I];
          TempProp = this.FindProperty(KeyItem);
          if (TempProp === null) TempProp = this.FindNavigationProperty(KeyItem);
          if (TempProp === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["Key property %s not found on entity type %s",pas.System.VarRecs(18,KeyItem,18,this.GetName())]);
          this.FKey.Add$1(TempProp);
        };
        this.FKeyRef = rtl.arraySetLength(this.FKeyRef,"",0);
      };
      for (var $l1 = 0, $end1 = this.FProperties.GetCount() - 1; $l1 <= $end1; $l1++) {
        I = $l1;
        this.FProperties.GetItem$1(I).Prepare();
      };
      for (var $l2 = 0, $end2 = this.FNavigationProperties.GetCount() - 1; $l2 <= $end2; $l2++) {
        I = $l2;
        this.FNavigationProperties.GetItem$1(I).Prepare();
      };
    };
    this.GetCollection = function () {
      var Result = null;
      if (this.FCollection === null) {
        this.FCollection = $mod.TXDataEntityCollectionType.$create("Create$1");
        this.FCollection.FItemType = this;
        this.FCollection.FParent = this.FParent;
      };
      Result = this.FCollection;
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 17;
      return Result;
    };
    this.ScalarPropertyCount = function () {
      var Result = 0;
      Result = this.FProperties.GetCount();
      return Result;
    };
    this.GetScalarProperty = function (Index) {
      var Result = null;
      Result = this.FProperties.GetItem$1(Index);
      return Result;
    };
    this.StructuredPropertyCount = function () {
      var Result = 0;
      Result = this.FNavigationProperties.GetCount();
      return Result;
    };
    this.GetStructuredProperty = function (Index) {
      var Result = null;
      Result = this.FNavigationProperties.GetItem$1(Index);
      return Result;
    };
    this.FindScalarProperty = function (AName) {
      var Result = null;
      Result = $mod.TXDataStructuredType.FindScalarProperty.call(this,AName);
      if ((Result === null) && (this.FBaseType !== null)) Result = this.FBaseType.FindScalarProperty(AName);
      return Result;
    };
    this.FindStructuredProperty = function (AName) {
      var Result = null;
      Result = $mod.TXDataStructuredType.FindStructuredProperty.call(this,AName);
      if ((Result === null) && (this.FBaseType !== null)) Result = this.FBaseType.FindStructuredProperty(AName);
      return Result;
    };
    this.FindProperty = function (AName) {
      var Result = null;
      Result = this.FindScalarProperty(AName);
      return Result;
    };
    this.FindNavigationProperty = function (AName) {
      var Result = null;
      Result = this.FindStructuredProperty(AName);
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FKey = $mod.TXDataPropertyList.$create("Create$3",[false]);
      this.FProperties = $mod.TXDataSimplePropertyList.$create("Create$4",[this]);
      this.FNavigationProperties = $mod.TXDataNavigationPropertyList.$create("Create$4",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FKey");
      rtl.free(this,"FNavigationProperties");
      rtl.free(this,"FProperties");
      rtl.free(this,"FCollection");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataEntityCollectionType",this.TXDataEntityType,function () {
    this.$init = function () {
      $mod.TXDataEntityType.$init.call(this);
      this.FItemType = null;
    };
    this.$final = function () {
      this.FItemType = undefined;
      $mod.TXDataEntityType.$final.call(this);
    };
    this.GetName = function () {
      var Result = "";
      if (this.FItemType !== null) {
        Result = pas.SysUtils.Format("Collection(%s)",pas.System.VarRecs(18,this.FItemType.GetName()))}
       else Result = "Collection()";
      return Result;
    };
    this.GetTypeKind = function () {
      var Result = 0;
      Result = 18;
      return Result;
    };
  });
  this.$rtti.$Class("TXDataEntityContainer");
  rtl.createClass(this,"TXDataEntitySet",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FEntityType = null;
      this.FEntityTypeRef = "";
    };
    this.$final = function () {
      this.FEntityType = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.GetContainer = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.Prepare = function () {
      if (this.FEntityTypeRef !== "") {
        this.FEntityType = this.GetContainer().GetSchema().FindEntityType(this.FEntityTypeRef);
        if (this.FEntityType === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["EntityType not found: %s",pas.System.VarRecs(18,this.FEntityTypeRef)]);
        this.FEntityTypeRef = "";
      };
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataEntitySetList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataEntityContainer",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FEntitySets = null;
    };
    this.$final = function () {
      this.FEntitySets = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.GetSchema = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FEntitySets = $mod.TXDataEntitySetList.$create("Create$4",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FEntitySets");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataEntityContainerList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  this.$rtti.$Class("TXDataAction");
  this.TBindingMode = {"0": "FromBody", FromBody: 0, "1": "FromURI", FromURI: 1, "2": "FromPath", FromPath: 2};
  this.$rtti.$Enum("TBindingMode",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TBindingMode});
  rtl.createClass(this,"TXDataParamDef",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FTypeRef = "";
      this.FTypeNameRef = "";
      this.FType = null;
      this.FBindingMode = 0;
      this.FOutput = false;
      this.FInput = false;
    };
    this.$final = function () {
      this.FType = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.GetUrlConverter = function () {
      var Result = null;
      if (this.FType !== null) {
        Result = this.FType.FUrlConverter}
       else Result = null;
      return Result;
    };
    this.Prepare = function () {
      if (this.FTypeRef !== "") {
        this.FType = this.GetParent().GetController().GetSchema().FindType(this.FTypeRef);
        if (this.FType === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["Param type %s not found for property %s.%s",pas.System.VarRecs(18,this.FTypeRef,18,this.GetParent().FName,18,this.FName)]);
        this.FTypeRef = "";
      };
      if (this.FTypeNameRef !== "") {
        this.FType = this.GetParent().GetController().GetSchema().FindType(this.FTypeNameRef);
        this.FTypeNameRef = "";
      };
    };
    this.GetParent = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.Index = function () {
      var Result = 0;
      Result = this.GetParent().IndexOf(this);
      return Result;
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataParamDefList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  this.$rtti.$Class("TXDataController");
  rtl.createClass(this,"TXDataRouteSegment",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FParamName = "";
      this.FValue = "";
      this.FParamIndex = 0;
      this.FIsParam = false;
    };
    this.Create$1 = function (AValue) {
      this.FValue = AValue;
      if ((this.FValue.length >= 3) && (this.FValue.charAt(0) === "{") && (this.FValue.charAt(this.FValue.length - 1) === "}")) {
        this.FIsParam = true;
        this.FParamName = pas.System.Copy(this.FValue,2,this.FValue.length - 2);
      };
      return this;
    };
  });
  rtl.createClass(this,"TXDataRouteSegmentList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataRouteInfo",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FSegments = null;
      this.FParamCount = 0;
      this.FPriority = 0;
    };
    this.$final = function () {
      this.FSegments = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.GetSegment = function (Index) {
      var Result = null;
      Result = this.FSegments.GetItem$1(Index);
      return Result;
    };
    this.GetSegmentCount = function () {
      var Result = 0;
      Result = this.FSegments.GetCount();
      return Result;
    };
    this.Create$1 = function () {
      this.FSegments = $mod.TXDataRouteSegmentList.$create("Create$5");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FSegments");
      pas.System.TObject.Destroy.call(this);
    };
    this.Process = function (ARoute) {
      var I = 0;
      var StrSegments = [];
      StrSegments = $impl.SplitString(ARoute,"/");
      for (var $l = 0, $end = rtl.length(StrSegments) - 1; $l <= $end; $l++) {
        I = $l;
        if (StrSegments[I] !== "") this.FSegments.Add$1($mod.TXDataRouteSegment.$create("Create$1",[StrSegments[I]]));
      };
      this.FPriority = 0;
      this.FParamCount = 0;
      for (var $l1 = 0, $end1 = this.GetSegmentCount() - 1; $l1 <= $end1; $l1++) {
        I = $l1;
        if (this.GetSegment(I).FIsParam) {
          this.FParamCount += 1}
         else this.FPriority = this.FPriority | (1 << (16 - I));
      };
    };
  });
  rtl.createClass(this,"TXDataAction",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FParameters = null;
      this.FHttpMethod = "";
      this.FIsParamStream = false;
      this.FIsResultStream = false;
      this.FIsResultCriteria = false;
      this.FIsResultSingleObject = false;
      this.FOperationId = "";
      this.FConsumes = "";
      this.FRouteInfo = null;
      this.FReturnType = null;
      this.FReturnTypeRef = "";
    };
    this.$final = function () {
      this.FParameters = undefined;
      this.FRouteInfo = undefined;
      this.FReturnType = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.ParamCount = function (Binding) {
      var Result = 0;
      var I = 0;
      Result = 0;
      for (var $l = 0, $end = this.FParameters.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if (this.FParameters.GetItem$1(I).FBindingMode === Binding) Result += 1;
      };
      return Result;
    };
    this.GetParam = function (Binding, Index) {
      var Result = null;
      var I = 0;
      var CurIndex = 0;
      Result = null;
      CurIndex = -1;
      for (var $l = 0, $end = this.FParameters.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if (this.FParameters.GetItem$1(I).FBindingMode === Binding) {
          CurIndex += 1;
          if (Index === CurIndex) {
            Result = this.FParameters.GetItem$1(I);
            return Result;
          };
        };
      };
      $impl.ErrorOutOfRange();
      return Result;
    };
    this.Prepare = function () {
      var ParamDefIndex = 0;
      var ParamDef = null;
      var Segment = null;
      var I = 0;
      for (var $l = 0, $end = this.FParameters.GetCount() - 1; $l <= $end; $l++) {
        ParamDefIndex = $l;
        ParamDef = this.FParameters.GetItem$1(ParamDefIndex);
        ParamDef.Prepare();
      };
      if (this.FReturnTypeRef !== "") {
        this.FReturnType = this.GetController().GetSchema().FindType(this.FReturnTypeRef);
        if (this.FReturnType === null) throw $mod.EModelReferenceNotFound.$create("CreateFmt",["Return type %s not found for action %s.%s",pas.System.VarRecs(18,this.FReturnTypeRef,18,this.GetController().FName,18,this.FName)]);
        this.FReturnTypeRef = "";
      };
      pas.SysUtils.FreeAndNil({p: this, get: function () {
          return this.p.FRouteInfo;
        }, set: function (v) {
          this.p.FRouteInfo = v;
        }});
      this.FRouteInfo = $mod.TXDataRouteInfo.$create("Create$1");
      this.FRouteInfo.Process(this.GetController().FName + "/" + this.FName);
      for (var $l1 = 0, $end1 = this.FRouteInfo.GetSegmentCount() - 1; $l1 <= $end1; $l1++) {
        I = $l1;
        Segment = this.FRouteInfo.GetSegment(I);
        if (Segment.FIsParam) {
          Segment.FParamIndex = -1;
          for (var $l2 = 0, $end2 = this.PathParamCount() - 1; $l2 <= $end2; $l2++) {
            ParamDefIndex = $l2;
            if (pas.SysUtils.SameText(this.GetPathParam(ParamDefIndex).FName,Segment.FParamName)) {
              Segment.FParamIndex = ParamDefIndex;
              break;
            };
          };
          if (Segment.FParamIndex === -1) throw $mod.EXDataInvalidRouteParam.$create("Create$2",[this,Segment.FValue]);
        };
      };
    };
    this.GetBodyParam = function (Index) {
      var Result = null;
      Result = this.GetParam(0,Index);
      return Result;
    };
    this.GetPathParam = function (Index) {
      var Result = null;
      Result = this.GetParam(2,Index);
      return Result;
    };
    this.GetController = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.IsFormContent = function () {
      var Result = false;
      Result = pas.SysUtils.SameText(this.FConsumes,"application/x-www-form-urlencoded");
      return Result;
    };
    this.Create$1 = function () {
      this.FHttpMethod = "POST";
      this.FParameters = $mod.TXDataParamDefList.$create("Create$4",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FParameters");
      rtl.free(this,"FRouteInfo");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    this.IndexOf = function (Param) {
      var Result = 0;
      Result = this.FParameters.IndexOf$1(Param);
      return Result;
    };
    this.ParamStreamIndex = function () {
      var Result = 0;
      var I = 0;
      for (var $l = 0, $end = this.FParameters.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if ((this.FParameters.GetItem$1(I).FType != null) && (this.FParameters.GetItem$1(I).FType.GetTypeKind() === 21)) {
          Result = I;
          return Result;
        };
      };
      if (this.FIsParamStream) {
        Result = 0}
       else Result = -1;
      return Result;
    };
    this.BodyParamCount = function () {
      var Result = 0;
      Result = this.ParamCount(0);
      return Result;
    };
    this.PathParamCount = function () {
      var Result = 0;
      Result = this.ParamCount(2);
      return Result;
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataActionList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataController",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FName = "";
      this.FActions = null;
      this.FRouteInfo = null;
    };
    this.$final = function () {
      this.FActions = undefined;
      this.FRouteInfo = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.GetSchema = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.Prepare = function () {
      var ActionIndex = 0;
      var Action = null;
      pas.SysUtils.FreeAndNil({p: this, get: function () {
          return this.p.FRouteInfo;
        }, set: function (v) {
          this.p.FRouteInfo = v;
        }});
      this.FRouteInfo = $mod.TXDataRouteInfo.$create("Create$1");
      this.FRouteInfo.Process(this.FName);
      for (var $l = 0, $end = this.FActions.GetCount() - 1; $l <= $end; $l++) {
        ActionIndex = $l;
        Action = this.FActions.GetItem$1(ActionIndex);
        Action.Prepare();
      };
    };
    this.Create$1 = function () {
      this.FActions = $mod.TXDataActionList.$create("Create$4",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FActions");
      rtl.free(this,"FRouteInfo");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataEntityTypeList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataInstanceTypeList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataControllerList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataSchema",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FNamespace = "";
      this.FAlias = "";
      this.FEntityTypes = null;
      this.FEntityContainers = null;
      this.FEnumTypes = null;
      this.FInstanceTypes = null;
      this.FControllers = null;
    };
    this.$final = function () {
      this.FEntityTypes = undefined;
      this.FEntityContainers = undefined;
      this.FEnumTypes = undefined;
      this.FInstanceTypes = undefined;
      this.FControllers = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.GetModel = function () {
      var Result = null;
      Result = this.FParent;
      return Result;
    };
    this.IsCollectionName = function (Name, SubType) {
      var Result = false;
      var Wrapper = "";
      Result = pas["XData.Utils"].TXDataUtils.GetNameAndKey(Name,{get: function () {
          return Wrapper;
        }, set: function (v) {
          Wrapper = v;
        }},SubType) && (Wrapper === "Collection");
      return Result;
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FEntityTypes = $mod.TXDataEntityTypeList.$create("Create$4",[this]);
      this.FInstanceTypes = $mod.TXDataInstanceTypeList.$create("Create$4",[this]);
      this.FEnumTypes = $mod.TXDataEnumTypeList.$create("Create$4",[this]);
      this.FEntityContainers = $mod.TXDataEntityContainerList.$create("Create$4",[this]);
      this.FControllers = $mod.TXDataControllerList.$create("Create$4",[this]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FEntityTypes");
      rtl.free(this,"FInstanceTypes");
      rtl.free(this,"FEnumTypes");
      rtl.free(this,"FEntityContainers");
      rtl.free(this,"FControllers");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    this.FindOrDefineConverter = function (AType) {
      var Result = null;
      if (AType === null) return null;
      if (AType.FUrlConverter !== null) return AType.FUrlConverter;
      Result = this.GetModel().FUrlConverters.Find(AType.GetName());
      if (Result === null) {
        if ($mod.TXDataEnumType.isPrototypeOf(AType)) {
          Result = pas["XData.Types.Converters"].TXDataEnumConverter.$create("Create$1",[AType]);
          this.GetModel().FUrlConverters.RegisterConverter(AType.GetName(),Result);
        };
      };
      return Result;
    };
    this.FindEntityType = function (AName) {
      var Result = null;
      var EntityType = null;
      var SubType = "";
      var I = 0;
      if (this.IsCollectionName(AName,{get: function () {
          return SubType;
        }, set: function (v) {
          SubType = v;
        }})) {
        EntityType = this.FindEntityType(SubType);
        if (EntityType !== null) {
          Result = EntityType.GetCollection()}
         else Result = null;
      } else {
        for (var $l = 0, $end = this.FEntityTypes.GetCount() - 1; $l <= $end; $l++) {
          I = $l;
          EntityType = this.FEntityTypes.GetItem$1(I);
          if (pas.SysUtils.SameText(EntityType.GetName(),AName)) return EntityType;
        };
        Result = null;
      };
      return Result;
    };
    this.FindInstanceType = function (AName) {
      var Result = null;
      var InstanceType = null;
      var SubType = "";
      var I = 0;
      if (this.IsCollectionName(AName,{get: function () {
          return SubType;
        }, set: function (v) {
          SubType = v;
        }})) {
        InstanceType = this.FindInstanceType(SubType);
        if (InstanceType !== null) {
          Result = InstanceType.GetCollection()}
         else Result = null;
      } else {
        for (var $l = 0, $end = this.FInstanceTypes.GetCount() - 1; $l <= $end; $l++) {
          I = $l;
          InstanceType = this.FInstanceTypes.GetItem$1(I);
          if (pas.SysUtils.SameText(InstanceType.GetName(),AName)) return InstanceType;
        };
        Result = null;
      };
      return Result;
    };
    this.FindEnumType = function (AName) {
      var Result = null;
      var EnumType = null;
      var I = 0;
      for (var $l = 0, $end = this.FEnumTypes.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        EnumType = this.FEnumTypes.GetItem$1(I);
        if (pas.SysUtils.SameText(EnumType.GetName(),AName)) return EnumType;
      };
      Result = null;
      return Result;
    };
    this.FindScalarType = function (Name) {
      var Result = null;
      var SubType = "";
      Result = this.FindEnumType(Name);
      if (Result === null) {
        if (this.IsCollectionName(Name,{get: function () {
            return SubType;
          }, set: function (v) {
            SubType = v;
          }})) {
          Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().Find(SubType);
          if (Result !== null) Result = Result.GetCollection();
        } else Result = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().Find(Name);
      };
      return Result;
    };
    this.FindType = function (Name) {
      var Result = null;
      Result = this.FindScalarType(Name);
      if (Result === null) Result = this.FindEntityType(Name);
      if (Result === null) Result = this.FindInstanceType(Name);
      return Result;
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataSchemaList",this.TXDataOwnedList,function () {
    this.GetItem$1 = function (Index) {
      var Result = null;
      Result = this.GetItem(Index);
      return Result;
    };
  });
  rtl.createClass(this,"TXDataUrlConverters",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FConverterMap = null;
    };
    this.$final = function () {
      this.FConverterMap = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FConverterMap = pas["Bcl.Collections.Common"].TStringMap.$create("Create$1",[true]);
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FConverterMap");
      pas.System.TObject.Destroy.call(this);
    };
    this.Find = function (ATypeName) {
      var Result = null;
      if (this.FConverterMap.ContainsKey(ATypeName)) {
        Result = this.FConverterMap.GetItem(ATypeName)}
       else Result = null;
      return Result;
    };
    this.RegisterConverter = function (ATypeName, AConverter) {
      this.FConverterMap.AddOrSetValue(ATypeName,AConverter);
    };
  });
  rtl.createClass(this,"TXDataBaseModel",this.TXDataModelObject,function () {
    this.$init = function () {
      $mod.TXDataModelObject.$init.call(this);
      this.FTitle = "";
      this.FVersion = "";
      this.FSchemas = null;
      this.FUrlConverters = null;
    };
    this.$final = function () {
      this.FSchemas = undefined;
      this.FUrlConverters = undefined;
      $mod.TXDataModelObject.$final.call(this);
    };
    this.Prepare = function () {
      var Schema = null;
      var Container = null;
      var EntitySet = null;
      var EntityType = null;
      var InstanceType = null;
      var SchemaIndex = 0;
      var ContainerIndex = 0;
      var EntitySetIndex = 0;
      var EntityTypeIndex = 0;
      var InstanceTypeIndex = 0;
      var ControllerIndex = 0;
      var Controller = null;
      var ScalarTypeIndex = 0;
      var ScalarType = null;
      for (var $l = 0, $end = this.FSchemas.GetCount() - 1; $l <= $end; $l++) {
        SchemaIndex = $l;
        Schema = this.FSchemas.GetItem$1(SchemaIndex);
        for (var $l1 = 0, $end1 = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().GetTypes().FLength - 1; $l1 <= $end1; $l1++) {
          ScalarTypeIndex = $l1;
          ScalarType = pas["XData.Model.Types"].TXDataPrimitiveTypes.Instance().GetTypes().GetItem(ScalarTypeIndex);
          ScalarType.FUrlConverter = Schema.FindOrDefineConverter(ScalarType);
          ScalarType.GetCollection().FUrlConverter = Schema.FindOrDefineConverter(ScalarType.GetCollection());
        };
        for (var $l2 = 0, $end2 = Schema.FEnumTypes.GetCount() - 1; $l2 <= $end2; $l2++) {
          ScalarTypeIndex = $l2;
          ScalarType = Schema.FEnumTypes.GetItem$1(ScalarTypeIndex);
          ScalarType.FUrlConverter = Schema.FindOrDefineConverter(ScalarType);
        };
        for (var $l3 = 0, $end3 = Schema.FEntityTypes.GetCount() - 1; $l3 <= $end3; $l3++) {
          EntityTypeIndex = $l3;
          EntityType = Schema.FEntityTypes.GetItem$1(EntityTypeIndex);
          EntityType.FUrlConverter = Schema.FindOrDefineConverter(EntityType);
          EntityType.GetCollection().FUrlConverter = Schema.FindOrDefineConverter(EntityType.GetCollection());
        };
        for (var $l4 = 0, $end4 = Schema.FInstanceTypes.GetCount() - 1; $l4 <= $end4; $l4++) {
          InstanceTypeIndex = $l4;
          InstanceType = Schema.FInstanceTypes.GetItem$1(InstanceTypeIndex);
          InstanceType.FUrlConverter = Schema.FindOrDefineConverter(InstanceType);
          InstanceType.GetCollection().FUrlConverter = Schema.FindOrDefineConverter(InstanceType.GetCollection());
        };
        for (var $l5 = 0, $end5 = Schema.FEntityContainers.GetCount() - 1; $l5 <= $end5; $l5++) {
          ContainerIndex = $l5;
          Container = Schema.FEntityContainers.GetItem$1(ContainerIndex);
          for (var $l6 = 0, $end6 = Container.FEntitySets.GetCount() - 1; $l6 <= $end6; $l6++) {
            EntitySetIndex = $l6;
            EntitySet = Container.FEntitySets.GetItem$1(EntitySetIndex);
            EntitySet.Prepare();
          };
        };
        for (var $l7 = 0, $end7 = Schema.FEntityTypes.GetCount() - 1; $l7 <= $end7; $l7++) {
          EntityTypeIndex = $l7;
          EntityType = Schema.FEntityTypes.GetItem$1(EntityTypeIndex);
          EntityType.Prepare();
        };
        for (var $l8 = 0, $end8 = Schema.FInstanceTypes.GetCount() - 1; $l8 <= $end8; $l8++) {
          InstanceTypeIndex = $l8;
          InstanceType = Schema.FInstanceTypes.GetItem$1(InstanceTypeIndex);
          InstanceType.Prepare();
        };
        for (var $l9 = 0, $end9 = Schema.FControllers.GetCount() - 1; $l9 <= $end9; $l9++) {
          ControllerIndex = $l9;
          Controller = Schema.FControllers.GetItem$1(ControllerIndex);
          Controller.Prepare();
        };
      };
    };
    this.Create$1 = function () {
      this.FTitle = "Server API";
      this.FVersion = "3";
      this.FSchemas = $mod.TXDataSchemaList.$create("Create$4",[this]);
      this.FUrlConverters = $mod.TXDataUrlConverters.$create("Create$1");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FSchemas");
      rtl.free(this,"FUrlConverters");
      $mod.TXDataModelObject.Destroy.call(this);
    };
    this.FindActionByOperationId = function (AOperationId) {
      var Result = null;
      var Schema = null;
      var Controller = null;
      var Action = null;
      var I = 0;
      var J = 0;
      var L = 0;
      Result = null;
      for (var $l = 0, $end = this.FSchemas.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        Schema = this.FSchemas.GetItem$1(I);
        for (var $l1 = 0, $end1 = Schema.FControllers.GetCount() - 1; $l1 <= $end1; $l1++) {
          J = $l1;
          Controller = Schema.FControllers.GetItem$1(J);
          for (var $l2 = 0, $end2 = Controller.FActions.GetCount() - 1; $l2 <= $end2; $l2++) {
            L = $l2;
            Action = Controller.FActions.GetItem$1(L);
            if (pas.SysUtils.SameText(Action.FOperationId,AOperationId)) return Action;
          };
        };
      };
      return Result;
    };
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataModel",this.TXDataBaseModel,function () {
    var $r = this.$rtti;
    $r.attr = [pas["Bcl.Json.Attributes"].JsonIncludeAttribute,"Create$1",[pas["Bcl.Json.Attributes"].TInclusionMode.NonDefault]];
  });
  rtl.createClass(this,"TXDataTypeConverter",pas.System.TObject,function () {
    this.TryValueToUrl = function (Value, Literal) {
      var Result = false;
      Result = false;
      return Result;
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    this.ValueToUrl = function (Value, PropName) {
      var Result = "";
      if (Value == null) {
        return "null"}
       else {
        if (!this.TryValueToUrl(Value,{get: function () {
            return Result;
          }, set: function (v) {
            Result = v;
          }})) throw $mod.EConvertToUrlError.$create("Create$2",[PropName,Value]);
      };
      return Result;
    };
  });
  rtl.createClass(this,"EConvertToUrlError",pas.SysUtils.Exception,function () {
    this.Create$2 = function (PropName, Value) {
      if (PropName !== "") {
        pas.SysUtils.Exception.CreateFmt.call(this,'Cannot serialize value "%s" to Url parameter "%s"',pas.System.VarRecs(18,pas["Bcl.Rtti.Common"].TValue_ToString(Value),18,PropName))}
       else pas.SysUtils.Exception.CreateFmt.call(this,'Cannot serialize value "%s" to Url',pas.System.VarRecs(18,pas["Bcl.Rtti.Common"].TValue_ToString(Value)));
      return this;
    };
  });
  rtl.createClass(this,"EModelReferenceNotFound",pas.SysUtils.Exception,function () {
  });
  rtl.createClass(this,"EUrlConverterNotFound",pas.SysUtils.Exception,function () {
    this.Create$2 = function (AType) {
      var ATypeName = "";
      if (AType === null) {
        ATypeName = "(null)"}
       else ATypeName = AType.GetName();
      pas.SysUtils.Exception.CreateFmt.call(this,'Could not find URL converter for type "%s"',pas.System.VarRecs(18,ATypeName));
      return this;
    };
  });
  rtl.createClass(this,"EIndexOutOfRange",pas.SysUtils.Exception,function () {
  });
  rtl.createClass(this,"EXDataInvalidRouteParam",pas.SysUtils.Exception,function () {
    this.Create$2 = function (Action, ParamName) {
      pas.SysUtils.Exception.CreateFmt.call(this,'Invalid param "%s" in route of action "%s"',pas.System.VarRecs(18,ParamName,18,Action.FOperationId));
      return this;
    };
  });
  $mod.$implcode = function () {
    $impl.ErrorOutOfRange = function () {
      throw $mod.EIndexOutOfRange.$create("Create$1",["Index out of range"]);
    };
    $impl.FindDelimiter = function (S, StartIdx) {
      var Result = 0;
      var Stop = false;
      var Len = 0;
      Result = 0;
      Len = S.length;
      Stop = false;
      while (!Stop && (StartIdx <= Len)) if (S.charAt(StartIdx - 1) === "/") {
        Result = StartIdx;
        Stop = true;
      } else StartIdx += 1;
      return Result;
    };
    $impl.SplitString = function (S, Delimiters) {
      var Result = [];
      var StartIdx = 0;
      var FoundIdx = 0;
      var SplitPoints = 0;
      var CurrentSplit = 0;
      var i = 0;
      Result = [];
      if (S !== "") {
        SplitPoints = 0;
        for (var $l = 1, $end = S.length; $l <= $end; $l++) {
          i = $l;
          if (S.charAt(i - 1) === "/") SplitPoints += 1;
        };
        Result = rtl.arraySetLength(Result,"",SplitPoints + 1);
        StartIdx = 1;
        CurrentSplit = 0;
        do {
          FoundIdx = $impl.FindDelimiter(S,StartIdx);
          if (FoundIdx !== 0) {
            Result[CurrentSplit] = pas.System.Copy(S,StartIdx,FoundIdx - StartIdx);
            CurrentSplit += 1;
            StartIdx = FoundIdx + 1;
          };
        } while (!(CurrentSplit === SplitPoints));
        Result[SplitPoints] = pas.System.Copy(S,StartIdx,(S.length - StartIdx) + 1);
      };
      return Result;
    };
  };
},["XData.Model.Types","XData.Types.Converters","XData.Utils"]);
rtl.module("Bcl.TypInfo.Common",["System","TypInfo"],function () {
  "use strict";
  var $mod = this;
  this.GetEnumValue_ = function (TypeInfo, Name) {
    var Result = 0;
    Result = TypeInfo.enumtype[Name];
    return Result;
  };
});
rtl.module("XData.Model.Deserializer",["System","SysUtils","Types","TypInfo","JS","Bcl.Json.Common","Bcl.TypInfo.Common","XData.Model.Classes"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TXDataModelDeserializer",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FModel = null;
      this.FRoot = null;
    };
    this.$final = function () {
      this.FModel = undefined;
      this.FRoot = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AModel, Json) {
      this.FModel = AModel;
      this.FRoot = JSON.parse(Json);
      return this;
    };
    this.Destroy = function () {
      pas.System.TObject.Destroy.call(this);
    };
    this.Read = function () {
      this.ReadModel(this.FModel,this.FRoot);
      this.FModel.Prepare();
    };
    this.ReadBase = function (Base, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Description") Base.FDescription = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadType = function (XDataType, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(XDataType,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") XDataType.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadStructuredType = function (StructuredType, JObj) {
      this.ReadType(StructuredType,JObj);
    };
    this.ReadScalarType = function (ScalarType, JObj) {
      this.ReadType(ScalarType,JObj);
    };
    this.ReadModel = function (Model, JObj) {
      var Key = "";
      var I = 0;
      var JSchemas = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(Model,JObj);
      Model.FSchemas.Clear();
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Title") {
          Model.FTitle = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Version") {
          Model.FVersion = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Schemas") {
          JSchemas = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JSchemas.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadSchema(Model.FSchemas.GetItem$1(Model.FSchemas.Add$1(pas["XData.Model.Classes"].TXDataSchema.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JSchemas[I]));
          };
        };
      };
    };
    this.ReadSchema = function (Schema, JObj) {
      var Key = "";
      var I = 0;
      var JEntityTypes = null;
      var JInstanceTypes = null;
      var JEntityContainers = null;
      var JEnumTypes = null;
      var JControllers = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(Schema,JObj);
      Schema.FEntityTypes.Clear();
      Schema.FInstanceTypes.Clear();
      Schema.FEntityContainers.Clear();
      Schema.FEnumTypes.Clear();
      Schema.FControllers.Clear();
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Namespace") {
          Schema.FNamespace = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Alias") {
          Schema.FAlias = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "EntityTypes") {
          JEntityTypes = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JEntityTypes.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadEntityType(Schema.FEntityTypes.GetItem$1(Schema.FEntityTypes.Add$1(pas["XData.Model.Classes"].TXDataEntityType.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JEntityTypes[I]));
          };
        } else if (Key === "InstanceTypes") {
          JInstanceTypes = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l2 = 0, $end2 = JInstanceTypes.length - 1; $l2 <= $end2; $l2++) {
            I = $l2;
            this.ReadInstanceType(Schema.FInstanceTypes.GetItem$1(Schema.FInstanceTypes.Add$1(pas["XData.Model.Classes"].TXDataInstanceType.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JInstanceTypes[I]));
          };
        } else if (Key === "EntityContainers") {
          JEntityContainers = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l3 = 0, $end3 = JEntityContainers.length - 1; $l3 <= $end3; $l3++) {
            I = $l3;
            this.ReadEntityContainer(Schema.FEntityContainers.GetItem$1(Schema.FEntityContainers.Add$1(pas["XData.Model.Classes"].TXDataEntityContainer.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JEntityContainers[I]));
          };
        } else if (Key === "EnumTypes") {
          JEnumTypes = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l4 = 0, $end4 = JEnumTypes.length - 1; $l4 <= $end4; $l4++) {
            I = $l4;
            this.ReadEnumType(Schema.FEnumTypes.GetItem$1(Schema.FEnumTypes.Add$1(pas["XData.Model.Classes"].TXDataEnumType.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JEnumTypes[I]));
          };
        } else if (Key === "Controllers") {
          JControllers = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l5 = 0, $end5 = JControllers.length - 1; $l5 <= $end5; $l5++) {
            I = $l5;
            this.ReadController(Schema.FControllers.GetItem$1(Schema.FControllers.Add$1(pas["XData.Model.Classes"].TXDataController.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JControllers[I]));
          };
        };
      };
    };
    this.ReadEntityType = function (EntityType, JObj) {
      var Key = "";
      var I = 0;
      var JProperties = null;
      var JNavigationProperties = null;
      var JKey = null;
      var TempKeyRef = [];
      var Keys = [];
      var KeyIndex = 0;
      this.ReadStructuredType(EntityType,JObj);
      TempKeyRef = rtl.arraySetLength(TempKeyRef,"",0);
      EntityType.FProperties.Clear();
      EntityType.FNavigationProperties.Clear();
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Properties") {
          JProperties = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JProperties.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadSimpleProperty(EntityType.FProperties.GetItem$1(EntityType.FProperties.Add$1(pas["XData.Model.Classes"].TXDataSimpleProperty.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JProperties[I]));
          };
        } else if (Key === "NavigationProperties") {
          JNavigationProperties = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l2 = 0, $end2 = JNavigationProperties.length - 1; $l2 <= $end2; $l2++) {
            I = $l2;
            this.ReadNavigationProperty(EntityType.FNavigationProperties.GetItem$1(EntityType.FNavigationProperties.Add$1(pas["XData.Model.Classes"].TXDataNavigationProperty.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JNavigationProperties[I]));
          };
        } else if (Key === "BaseType") {
          EntityType.FBaseTypeRef = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Key") {
          JKey = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          TempKeyRef = rtl.arraySetLength(TempKeyRef,"",JKey.length);
          for (var $l3 = 0, $end3 = JKey.length - 1; $l3 <= $end3; $l3++) {
            I = $l3;
            TempKeyRef[I] = pas["Bcl.Json.Common"].JToStr(JKey[I]);
          };
          EntityType.FKeyRef = rtl.arrayRef(TempKeyRef);
        };
      };
    };
    this.ReadInstanceType = function (InstanceType, JObj) {
      var Key = "";
      var I = 0;
      var JProperties = null;
      var JNavigationProperties = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadStructuredType(InstanceType,JObj);
      InstanceType.FProperties.Clear();
      InstanceType.FNavigationProperties.Clear();
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Properties") {
          JProperties = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JProperties.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadInstanceSimpleProperty(InstanceType.FProperties.GetItem$1(InstanceType.FProperties.Add$1(pas["XData.Model.Classes"].TXDataInstanceSimpleProperty.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JProperties[I]));
          };
        } else if (Key === "NavigationProperties") {
          JNavigationProperties = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l2 = 0, $end2 = JNavigationProperties.length - 1; $l2 <= $end2; $l2++) {
            I = $l2;
            this.ReadInstanceNavigationProperty(InstanceType.FNavigationProperties.GetItem$1(InstanceType.FNavigationProperties.Add$1(pas["XData.Model.Classes"].TXDataInstanceNavigationProperty.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JNavigationProperties[I]));
          };
        } else if (Key === "BaseType") InstanceType.FBaseTypeRef = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadScalarProperty = function (ScalarProperty, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadProperty(ScalarProperty,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Length") {
          ScalarProperty.FLength = pas["Bcl.Json.Common"].JToInt(JObj[Key])}
         else if (Key === "Precision") {
          ScalarProperty.FPrecision = pas["Bcl.Json.Common"].JToInt(JObj[Key])}
         else if (Key === "Scale") {
          ScalarProperty.FScale = pas["Bcl.Json.Common"].JToInt(JObj[Key])}
         else if (Key === "Type") ScalarProperty.FTypeRef = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadSimpleProperty = function (SimpleProperty, JObj) {
      this.ReadScalarProperty(SimpleProperty,JObj);
    };
    this.ReadInstanceSimpleProperty = function (ScalarProperty, JObj) {
      this.ReadScalarProperty(ScalarProperty,JObj);
    };
    this.ReadStructuredProperty = function (StructuredProperty, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadProperty(StructuredProperty,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Target") StructuredProperty.FTargetRef = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadNavigationProperty = function (NavigationProperty, JObj) {
      this.ReadStructuredProperty(NavigationProperty,JObj);
    };
    this.ReadInstanceNavigationProperty = function (NavigationProperty, JObj) {
      this.ReadStructuredProperty(NavigationProperty,JObj);
    };
    this.ReadProperty = function (Prop, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(Prop,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          Prop.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Required") Prop.FRequired = pas["Bcl.Json.Common"].JToBool(JObj[Key]);
      };
    };
    this.ReadEntityContainer = function (Container, JObj) {
      var Key = "";
      var I = 0;
      var JEntitySets = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(Container,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          Container.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "EntitySets") {
          JEntitySets = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JEntitySets.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadEntitySet(Container.FEntitySets.GetItem$1(Container.FEntitySets.Add$1(pas["XData.Model.Classes"].TXDataEntitySet.$create("Create"))),pas["Bcl.Json.Common"].AsJObject(JEntitySets[I]));
          };
        };
      };
    };
    this.ReadEntitySet = function (EntitySet, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(EntitySet,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          EntitySet.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "EntityType") EntitySet.FEntityTypeRef = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadEnumType = function (EnumType, JObj) {
      var Key = "";
      var I = 0;
      var JMembers = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadScalarType(EnumType,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Members") {
          JMembers = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JMembers.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadEnumMember(EnumType.FMembers.GetItem$1(EnumType.FMembers.Add$1(pas["XData.Model.Classes"].TXDataEnumMember.$create("Create"))),pas["Bcl.Json.Common"].AsJObject(JMembers[I]));
          };
        };
      };
    };
    this.ReadEnumMember = function (EnumMember, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(EnumMember,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          EnumMember.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Value") EnumMember.FValue = pas["Bcl.Json.Common"].JToInt(JObj[Key]);
      };
    };
    this.ReadController = function (Controller, JObj) {
      var Key = "";
      var I = 0;
      var JActions = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(Controller,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          Controller.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Actions") {
          JActions = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JActions.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadAction(Controller.FActions.GetItem$1(Controller.FActions.Add$1(pas["XData.Model.Classes"].TXDataAction.$create("Create$1"))),pas["Bcl.Json.Common"].AsJObject(JActions[I]));
          };
        };
      };
    };
    this.ReadAction = function (Action, JObj) {
      var Key = "";
      var I = 0;
      var JParamDefs = null;
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(Action,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          Action.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Parameters") {
          JParamDefs = pas["Bcl.Json.Common"].AsJArray(JObj[Key]);
          for (var $l1 = 0, $end1 = JParamDefs.length - 1; $l1 <= $end1; $l1++) {
            I = $l1;
            this.ReadParamDef(Action.FParameters.GetItem$1(Action.FParameters.Add$1(pas["XData.Model.Classes"].TXDataParamDef.$create("Create"))),pas["Bcl.Json.Common"].AsJObject(JParamDefs[I]));
          };
        } else if (Key === "HttpMethod") {
          Action.FHttpMethod = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "IsParamStream") {
          Action.FIsParamStream = pas["Bcl.Json.Common"].JToBool(JObj[Key])}
         else if (Key === "IsResultStream") {
          Action.FIsResultStream = pas["Bcl.Json.Common"].JToBool(JObj[Key])}
         else if (Key === "IsResultCriteria") {
          Action.FIsResultCriteria = pas["Bcl.Json.Common"].JToBool(JObj[Key])}
         else if (Key === "IsResultSingleObject") {
          Action.FIsResultSingleObject = pas["Bcl.Json.Common"].JToBool(JObj[Key])}
         else if (Key === "OperationId") {
          Action.FOperationId = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "ReturnType") {
          Action.FReturnTypeRef = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "Consumes") Action.FConsumes = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.ReadParamDef = function (ParamDef, JObj) {
      var Key = "";
      var Keys = [];
      var KeyIndex = 0;
      this.ReadBase(ParamDef,JObj);
      Keys = pas["Bcl.Json.Common"].JObjectKeys(JObj);
      for (var $l = 0, $end = rtl.length(Keys) - 1; $l <= $end; $l++) {
        KeyIndex = $l;
        Key = Keys[KeyIndex];
        if (Key === "Name") {
          ParamDef.FName = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "BindingMode") {
          ParamDef.FBindingMode = pas["Bcl.TypInfo.Common"].GetEnumValue_(pas["XData.Model.Classes"].$rtti["TBindingMode"],pas["Bcl.Json.Common"].JToStr(JObj[Key]))}
         else if (Key === "Output") {
          ParamDef.FOutput = pas["Bcl.Json.Common"].JToBool(JObj[Key])}
         else if (Key === "Input") {
          ParamDef.FInput = pas["Bcl.Json.Common"].JToBool(JObj[Key])}
         else if (Key === "Type") {
          ParamDef.FTypeRef = pas["Bcl.Json.Common"].JToStr(JObj[Key])}
         else if (Key === "TypeName") ParamDef.FTypeNameRef = pas["Bcl.Json.Common"].JToStr(JObj[Key]);
      };
    };
    this.Deserialize = function (AModel, Json) {
      var Deserializer = null;
      Deserializer = $mod.TXDataModelDeserializer.$create("Create$1",[AModel,Json]);
      try {
        Deserializer.Read();
      } finally {
        Deserializer = rtl.freeLoc(Deserializer);
      };
    };
  });
});
rtl.module("XData.Web.Connection",["System","Types","Classes","SysUtils","Web","JS","XData.Web.Request","XData.Web.Response","XData.Model.Classes"],function () {
  "use strict";
  var $mod = this;
  this.$rtti.$Class("TXDataWebConnection");
  this.$rtti.$Class("TXDataWebConnectionDesignData");
  rtl.createClass(this,"TXDataWebConnectionRequest",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FRequest = null;
      this.FConnection = null;
      this.FRequestProc = null;
      this.FAsync = false;
    };
    this.$final = function () {
      rtl.setIntfP(this,"FRequest",null);
      this.FConnection = undefined;
      this.FRequestProc = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AConnection, ARequest) {
      this.FConnection = AConnection;
      rtl.setIntfP(this,"FRequest",ARequest);
      return this;
    };
  });
  rtl.createClass(this,"TXDataWebConnectionResponse",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FRequest = null;
      this.FResponse = null;
      this.FConnection = null;
      this.FSuccessProc = null;
      this.FAsync = false;
    };
    this.$final = function () {
      rtl.setIntfP(this,"FRequest",null);
      rtl.setIntfP(this,"FResponse",null);
      this.FConnection = undefined;
      this.FSuccessProc = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AConnection, ARequest, AResponse) {
      this.FConnection = AConnection;
      rtl.setIntfP(this,"FRequest",ARequest);
      rtl.setIntfP(this,"FResponse",AResponse);
      return this;
    };
  });
  rtl.createClass(this,"TXDataWebConnectionError",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FResponse = null;
      this.FConnection = null;
      this.FErrorMessage = "";
      this.FRequestUrl = "";
    };
    this.$final = function () {
      rtl.setIntfP(this,"FResponse",null);
      this.FConnection = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AConnection, AResponse, ARequestUrl, AErrorMessage) {
      this.FConnection = AConnection;
      rtl.setIntfP(this,"FResponse",AResponse);
      this.FErrorMessage = AErrorMessage;
      this.FRequestUrl = ARequestUrl;
      return this;
    };
  });
  rtl.createClass(this,"EXDataWebConnectionException",pas.SysUtils.Exception,function () {
    this.$init = function () {
      pas.SysUtils.Exception.$init.call(this);
      this.FError = null;
    };
    this.$final = function () {
      this.FError = undefined;
      pas.SysUtils.Exception.$final.call(this);
    };
    this.Create$2 = function (AError) {
      this.FError = AError;
      pas.SysUtils.Exception.CreateFmt.call(this,"Error connecting to %s",pas.System.VarRecs(18,AError.FRequestUrl));
      return this;
    };
  });
  this.$rtti.$MethodVar("TXDataWebConnectionRequestEvent",{procsig: rtl.newTIProcSig([["Args",this.$rtti["TXDataWebConnectionRequest"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TXDataWebConnectionResponseEvent",{procsig: rtl.newTIProcSig([["Args",this.$rtti["TXDataWebConnectionResponse"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TXDataWebConnectionErrorEvent",{procsig: rtl.newTIProcSig([["error",this.$rtti["TXDataWebConnectionError"]]]), methodkind: 0});
  rtl.createClass(this,"TXDataWebConnection",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FURL = "";
      this.FModel = null;
      this.FOnConnect = null;
      this.FStreamedConnected = false;
      this.FOnRequest = null;
      this.FOnResponse = null;
      this.FOnError = null;
      this.FDesignData = null;
    };
    this.$final = function () {
      this.FModel = undefined;
      this.FOnConnect = undefined;
      this.FOnRequest = undefined;
      this.FOnResponse = undefined;
      this.FOnError = undefined;
      this.FDesignData = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.GetConnected = function () {
      var Result = false;
      Result = this.FModel != null;
      return Result;
    };
    this.SetConnected = function (Value) {
      if ((0 in this.FComponentState) && Value) {
        this.FStreamedConnected = true}
       else {
        if (Value === this.GetConnected()) return;
        if (Value) {
          this.DoConnect(null,null);
        } else {
          this.DoDisconnect();
        };
      };
    };
    this.IsDesignDataStored = function () {
      var Result = false;
      Result = this.FDesignData.FPersist;
      return Result;
    };
    this.SetDesignData = function (Value) {
      this.FDesignData.Assign(Value);
    };
    this.DoError = function (Response, RequestUrl, ErrorMessage, ErrorProc) {
      var error = null;
      error = $mod.TXDataWebConnectionError.$create("Create$1",[this,Response,RequestUrl,ErrorMessage]);
      if (ErrorProc != null) {
        ErrorProc(error)}
       else if (this.FOnError != null) {
        this.FOnError(error)}
       else throw pas.SysUtils.Exception.$create("Create$1",["XDataConnectionError: " + ErrorMessage]);
    };
    this.SetURL = function (Value) {
      if (this.FURL !== Value) {
        this.FURL = Value;
        this.DoDisconnect();
      };
    };
    this.DoConnect = function (ConnectProc, ErrorProc) {
      var $Self = this;
      var ModelUrl = "";
      function OnSuccess(Resp) {
        var LocalModel = null;
        if (Resp.GetStatusCode() === 200) {
          LocalModel = pas["XData.Model.Classes"].TXDataModel.$create("Create$1");
          try {
            pas["XData.Model.Deserializer"].TXDataModelDeserializer.Deserialize(LocalModel,Resp.GetContentAsText());
            $Self.FModel = LocalModel;
          } catch ($e) {
            LocalModel = rtl.freeLoc(LocalModel);
            throw $e;
          };
          if (ConnectProc != null) {
            ConnectProc()}
           else if ($Self.FOnConnect != null) $Self.FOnConnect($Self);
        } else $Self.DoError(Resp,ModelUrl,pas.SysUtils.Format("Error %d. Could not connect retrieve XData model from %s",pas.System.VarRecs(0,Resp.GetStatusCode(),18,ModelUrl)),ErrorProc);
      };
      function LocalError() {
        var Resp = null;
        try {
          Resp = rtl.setIntfL(Resp,rtl.queryIntfT(pas["XData.Web.Response"].TDummyHttpResponse.$create("Create$1"),pas["XData.Web.Response"].IHttpResponse),true);
          $Self.DoError(Resp,ModelUrl,"Error connecting to XData server",ErrorProc);
        } finally {
          rtl._Release(Resp);
        };
      };
      var Req = null;
      var I = 0;
      try {
        rtl.free(this,"FModel");
        this.FModel = null;
        ModelUrl = pas["Bcl.Utils"].TBclUtils.CombineUrlFast($Self.FURL,"$model");
        Req = rtl.setIntfL(Req,rtl.queryIntfT(pas["XData.Web.Request"].THttpRequest.$create("Create$2",[ModelUrl]),pas["XData.Web.Request"].IHttpRequest),true);
        for (var $l = 0, $end = this.FDesignData.FHeaders.GetCount() - 1; $l <= $end; $l++) {
          I = $l;
          if (this.FDesignData.FHeaders.GetName(I) !== "") Req.GetHeaders().SetValue(this.FDesignData.FHeaders.GetName(I),this.FDesignData.FHeaders.GetValueFromIndex(I));
        };
        this.SendRequest(Req,OnSuccess,LocalError);
      } finally {
        rtl._Release(Req);
      };
    };
    this.DoDisconnect = function () {
      rtl.free(this,"FModel");
      this.FModel = null;
    };
    this.SendRequest = function (Request, SuccessProc, ErrorProc) {
      var $Self = this;
      function LocalSuccess(Response) {
        var ResponseArgs = null;
        var Async = false;
        rtl._AddRef(Response);
        try {
          Async = false;
          if ($Self.FOnResponse != null) {
            ResponseArgs = $mod.TXDataWebConnectionResponse.$create("Create$1",[$Self,Request,Response]);
            try {
              ResponseArgs.FSuccessProc = function (Response) {
                SuccessProc(Response);
              };
              $Self.FOnResponse(ResponseArgs);
              Async = ResponseArgs.FAsync;
              if (!Async) Response = rtl.setIntfL(Response,ResponseArgs.FResponse);
            } finally {
              if (!Async) ResponseArgs = rtl.freeLoc(ResponseArgs);
            };
          };
          if (!Async) SuccessProc(Response);
        } finally {
          rtl._Release(Response);
        };
      };
      var RequestArgs = null;
      var Async = false;
      Async = false;
      if (this.FOnRequest != null) {
        RequestArgs = $mod.TXDataWebConnectionRequest.$create("Create$1",[$Self,Request]);
        try {
          RequestArgs.FRequestProc = function (Request) {
            $mod.InternalSendRequest(Request,LocalSuccess,function (Event) {
              ErrorProc();
            });
          };
          this.FOnRequest(RequestArgs);
          Async = RequestArgs.FAsync;
        } finally {
          if (!Async) RequestArgs = rtl.freeLoc(RequestArgs);
        };
      };
      if (!Async) $mod.InternalSendRequest(Request,LocalSuccess,function (Event) {
        ErrorProc();
      });
    };
    this.Create$1 = function (AOwner) {
      pas.Classes.TComponent.Create$1.call(this,AOwner);
      this.FDesignData = $mod.TXDataWebConnectionDesignData.$create("Create$1");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FDesignData");
      rtl.free(this,"FModel");
      pas.Classes.TComponent.Destroy.call(this);
    };
    this.OpenAsync = async function () {
      var $Self = this;
      var Result = undefined;
      Result = new Promise(function (resolve, reject) {
        $Self.DoConnect(function () {
          if ($Self.FOnConnect != null) $Self.FOnConnect($Self);
          resolve(null);
        },function (error) {
          reject($mod.EXDataWebConnectionException.$create("Create$2",[error]));
        });
      });
      return Result;
    };
    this.Loaded = function () {
      pas.Classes.TComponent.Loaded.call(this);
      if (this.FStreamedConnected) this.SetConnected(true);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("URL",2,rtl.string,"FURL","SetURL");
    $r.addProperty("DesignData",14,$mod.$rtti["TXDataWebConnectionDesignData"],"FDesignData","SetDesignData",{stored: "IsDesignDataStored"});
    $r.addProperty("Connected",3,rtl.boolean,"GetConnected","SetConnected",{Default: false});
    $r.addProperty("OnConnect",0,pas.Classes.$rtti["TNotifyEvent"],"FOnConnect","FOnConnect");
    $r.addProperty("OnError",0,$mod.$rtti["TXDataWebConnectionErrorEvent"],"FOnError","FOnError");
    $r.addProperty("OnRequest",0,$mod.$rtti["TXDataWebConnectionRequestEvent"],"FOnRequest","FOnRequest");
    $r.addProperty("OnResponse",0,$mod.$rtti["TXDataWebConnectionResponseEvent"],"FOnResponse","FOnResponse");
  });
  rtl.createClass(this,"TXDataWebConnectionDesignData",pas.Classes.TPersistent,function () {
    this.$init = function () {
      pas.Classes.TPersistent.$init.call(this);
      this.FHeaders = null;
      this.FPersist = false;
    };
    this.$final = function () {
      this.FHeaders = undefined;
      pas.Classes.TPersistent.$final.call(this);
    };
    this.IsStored = function () {
      var Result = false;
      Result = this.FPersist;
      return Result;
    };
    this.SetHeaders = function (Value) {
      this.FHeaders.Assign(Value);
    };
    this.Create$1 = function () {
      pas.System.TObject.Create.call(this);
      this.FHeaders = pas.Classes.TStringList.$create("Create$1");
      return this;
    };
    this.Destroy = function () {
      rtl.free(this,"FHeaders");
      pas.System.TObject.Destroy.call(this);
    };
    this.Assign = function (Source) {
      if ($mod.TXDataWebConnectionDesignData.isPrototypeOf(Source)) {
        this.FPersist = Source.FPersist;
        this.SetHeaders(Source.FHeaders);
      } else pas.Classes.TPersistent.Assign.call(this,Source);
    };
    var $r = this.$rtti;
    $r.addProperty("Headers",14,pas.Classes.$rtti["TStrings"],"FHeaders","SetHeaders",{stored: "IsStored"});
    $r.addProperty("Persist",12,rtl.boolean,"FPersist","FPersist",{stored: "IsStored"});
  });
  this.InternalSendRequest = function (Req, SuccessProc, ErrorProc) {
    var Xhr = null;
    function XhrLoad() {
      var Resp = null;
      try {
        Resp = rtl.setIntfL(Resp,rtl.queryIntfT(pas["XData.Web.Response"].TXhrHttpResponse.$create("Create$2",[Xhr]),pas["XData.Web.Response"].IHttpResponse),true);
        if (SuccessProc != null) SuccessProc(Resp);
      } finally {
        rtl._Release(Resp);
      };
    };
    function XhrError(Event) {
      if (ErrorProc != null) ErrorProc(Event);
    };
    var HeaderNames = [];
    var I = 0;
    Xhr = new XMLHttpRequest();
    Xhr.open(Req.GetMethod(),Req.GetUri(),true);
    HeaderNames = Req.GetHeaders().GetHeaderNames();
    for (var $l = 0, $end = rtl.length(HeaderNames) - 1; $l <= $end; $l++) {
      I = $l;
      Xhr.setRequestHeader(HeaderNames[I],Req.GetHeaders().Get(HeaderNames[I]));
    };
    Xhr.addEventListener("load",XhrLoad);
    Xhr.addEventListener("error",XhrError);
    Xhr.addEventListener("timeout",XhrError);
    if (Req.GetTimeout() > 0) Xhr.timeout = Req.GetTimeout();
    if (Req.GetResponseType() !== "") Xhr.responseType = Req.GetResponseType();
    if (!pas.JS.isNull(Req.GetContent())) {
      Xhr.send(Req.GetContent())}
     else Xhr.send();
  };
},["Bcl.Utils","XData.Model.Deserializer"]);
rtl.module("XData.Bind.Converter",["System","TypInfo","SysUtils","XData.Model.Classes"],function () {
  "use strict";
  var $mod = this;
  this.BindValueToUrl = function (Value, PropName, Info, UrlConverter) {
    var Result = "";
    Result = UrlConverter.ValueToUrl(Value,PropName);
    return Result;
  };
});
rtl.module("XData.Web.Client",["System","JS","SysUtils","Classes","Types","Bcl.Rtti.Common","Bcl.Json.Common","XData.Model.Classes","XData.Web.Connection","XData.Web.Request","XData.Web.Response"],function () {
  "use strict";
  var $mod = this;
  this.$rtti.$Class("TXDataWebClient");
  this.TXDataClientRequestType = {"0": "rtGet", rtGet: 0, "1": "rtList", rtList: 1, "2": "rtPut", rtPut: 2, "3": "rtPost", rtPost: 3, "4": "rtDelete", rtDelete: 4, "5": "rtRawInvoke", rtRawInvoke: 5};
  rtl.createClass(this,"TXDataClientResponse",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FResponse = null;
      this.FRequestType = 0;
      this.FResult = undefined;
      this.FRequestId = "";
      this.FCount = 0;
      this.FClient = null;
    };
    this.$final = function () {
      rtl.setIntfP(this,"FResponse",null);
      this.FClient = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AClient, AResponse, AResult, ARequestType, ARequestId, ACount) {
      rtl.setIntfP(this,"FResponse",AResponse);
      this.FResult = AResult;
      this.FRequestType = ARequestType;
      this.FRequestId = ARequestId;
      this.FCount = ACount;
      this.FClient = AClient;
      return this;
    };
  });
  rtl.createClass(this,"TXDataClientRequest",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FRequest = null;
      this.FRequestType = 0;
      this.FRequestId = "";
      this.FClient = null;
    };
    this.$final = function () {
      rtl.setIntfP(this,"FRequest",null);
      this.FClient = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.Create$1 = function (AClient, ARequest, ARequestType, ARequestId) {
      rtl.setIntfP(this,"FRequest",ARequest);
      this.FRequestType = ARequestType;
      this.FRequestId = ARequestId;
      this.FClient = AClient;
      return this;
    };
  });
  rtl.createClass(this,"TXDataClientError",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FResponse = null;
      this.FRequestId = "";
      this.FErrorCode = "";
      this.FErrorMessage = "";
      this.FRequestUrl = "";
      this.FClient = null;
    };
    this.$final = function () {
      rtl.setIntfP(this,"FResponse",null);
      this.FClient = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.GetStatusCode = function () {
      var Result = 0;
      Result = this.FResponse.GetStatusCode();
      return Result;
    };
    this.Create$1 = function (AClient, AResponse, ARequestUrl, AErrorCode, AErrorMessage, ARequestId) {
      rtl.setIntfP(this,"FResponse",AResponse);
      this.FErrorCode = AErrorCode;
      this.FErrorMessage = AErrorMessage;
      this.FRequestId = ARequestId;
      this.FRequestUrl = ARequestUrl;
      this.FClient = AClient;
      return this;
    };
  });
  this.$rtti.$MethodVar("TXDataClientLoadEvent",{procsig: rtl.newTIProcSig([["Response",this.$rtti["TXDataClientResponse"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TXDataClientErrorEvent",{procsig: rtl.newTIProcSig([["error",this.$rtti["TXDataClientError"]]]), methodkind: 0});
  this.$rtti.$MethodVar("TXDataClientRequestEvent",{procsig: rtl.newTIProcSig([["Request",this.$rtti["TXDataClientRequest"]]]), methodkind: 0});
  this.TReferenceSolvingMode = {"0": "rsAll", rsAll: 0, "1": "rsNone", rsNone: 1};
  this.$rtti.$Enum("TReferenceSolvingMode",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TReferenceSolvingMode});
  rtl.createClass(this,"TXDataWebClient",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FOnLoad = null;
      this.FOnError = null;
      this.FOnRequest = null;
      this.FConnection = null;
      this.FReferenceSolvingMode = 0;
    };
    this.$final = function () {
      this.FOnLoad = undefined;
      this.FOnError = undefined;
      this.FOnRequest = undefined;
      this.FConnection = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.SetConnection = function (Value) {
      if (Value !== this.FConnection) {
        if (this.FConnection !== null) this.FConnection.RemoveFreeNotification(this);
        this.FConnection = Value;
        if (this.FConnection !== null) this.FConnection.FreeNotification(this);
      };
    };
    this.Model = function () {
      var Result = null;
      this.CheckConnection();
      if (!(this.FConnection.FModel != null)) throw $mod.EXDataClientException.$create("Create$1",["TXDataWebConnection is not connected"]);
      Result = this.FConnection.FModel;
      return Result;
    };
    this.Url = function () {
      var Result = "";
      this.CheckConnection();
      Result = this.FConnection.FURL;
      return Result;
    };
    this.CheckConnection = function () {
      if (!(this.FConnection != null)) throw $mod.EXDataClientException.$create("Create$1",["Missing XData Connection"]);
    };
    this.ParseError = function (Response, ErrorCode, ErrorMessage) {
      var ErrorResult = undefined;
      var ErrorObject = null;
      ErrorCode.set("");
      ErrorMessage.set(Response.GetStatusReason());
      if (pas.SysUtils.SameText(Response.GetHeaders().Get("content-type"),"application/json")) {
        ErrorResult = null;
        try {
          ErrorResult = JSON.parse(Response.GetContentAsText());
        } catch ($e) {
        };
        if (rtl.isObject(ErrorResult) && rtl.isObject(ErrorResult["error"])) {
          ErrorObject = ErrorResult["error"];
          ErrorCode.set(pas.JS.ToString(ErrorObject["code"]));
          ErrorMessage.set(pas.JS.ToString(ErrorObject["message"]));
        };
      };
    };
    this.SolveReferences = function (json) {
      var byid = {}, // all objects by id
                  refs = []; // references to objects that could not be resolved
          json = (function recurse(obj, prop, parent) {
              if (typeof obj !== 'object' || !obj) // a primitive value
                  return obj;
              if (Object.prototype.toString.call(obj) === '[object Array]') {
                  for (var i = 0; i < obj.length; i++)
                      // check also if the array element is not a primitive value
                      if (typeof obj[i] !== 'object' || !obj[i]) // a primitive value
                          continue;
                      else if ("$ref" in obj[i])
                          obj[i] = recurse(obj[i], i, obj);
                      else
                          obj[i] = recurse(obj[i], prop, obj);
                  return obj;
              }
              if ("$ref" in obj) { // a reference
                  var ref = obj.$ref;
                  if (ref in byid)
                      return byid[ref];
                  // else we have to make it lazy:
                  refs.push([parent, prop, ref]);
                  return;
              } else if ("$id" in obj) {
                  var id = obj.$id;
                  delete obj.$id;
                  if ("$values" in obj) // an array
                      obj = obj.$values.map(recurse);
                  else // a plain object
                      for (var p in obj)
                          obj[p] = recurse(obj[p], p, obj);
                  byid[id] = obj;
              }
              return obj;
          })(json); // run it!
      
          for (var i = 0; i < refs.length; i++) { // resolve previously unknown references
              var ref = refs[i];
              ref[0][ref[1]] = byid[ref[2]];
              // Notice that this throws if you put in a reference at top-level
          };
    };
    this.DoLoad = function (Response, SuccessProc, AsyncMode) {
      try {
        var $tmp = this.FReferenceSolvingMode;
        if ($tmp === 0) this.SolveReferences(Response.FResult);
        if (AsyncMode) {
          if (this.FOnLoad != null) this.FOnLoad(Response);
          if (SuccessProc != null) SuccessProc(Response);
        } else {
          if (SuccessProc != null) {
            SuccessProc(Response);
            return;
          };
          if (this.FOnLoad != null) this.FOnLoad(Response);
        };
      } finally {
        if (!AsyncMode) Response = rtl.freeLoc(Response);
      };
    };
    this.DoError = function (Response, RequestUrl, RequestId, ErrorMessage, ErrorProc, AsyncMode) {
      var ErrorCode = "";
      var ClientError = null;
      rtl._AddRef(Response);
      try {
        if (Response === null) Response = rtl.setIntfL(Response,rtl.queryIntfT(pas["XData.Web.Response"].TDummyHttpResponse.$create("Create$1"),pas["XData.Web.Response"].IHttpResponse),true);
        ErrorCode = "";
        if (ErrorMessage === "") this.ParseError(Response,{get: function () {
            return ErrorCode;
          }, set: function (v) {
            ErrorCode = v;
          }},{get: function () {
            return ErrorMessage;
          }, set: function (v) {
            ErrorMessage = v;
          }});
        ClientError = $mod.TXDataClientError.$create("Create$1",[this,Response,RequestUrl,ErrorCode,ErrorMessage,RequestId]);
        if (AsyncMode) {
          if (this.FOnError != null) this.FOnError(ClientError);
          if (ErrorProc != null) {
            ErrorProc(ClientError)}
           else throw $mod.EXDataClientRequestException.$create("Create$2",[ClientError]);
        } else {
          if (ErrorProc != null) {
            ErrorProc(ClientError);
            return;
          };
          if (this.FOnError != null) {
            this.FOnError(ClientError)}
           else throw $mod.EXDataClientRequestException.$create("Create$2",[ClientError]);
        };
      } finally {
        rtl._Release(Response);
      };
    };
    this.RequestUrl = function (RelativeUrl) {
      var Result = "";
      Result = pas["XData.Utils"].TXDataUtils.CombineUrlFast(this.Url(),RelativeUrl);
      return Result;
    };
    this.InternalRawInvoke = function (OperationId, Args, Query, RequestId, SuccessProc, ErrorProc, AsyncMode) {
      var Invoker = null;
      var Action = null;
      if (RequestId === "") RequestId = OperationId;
      Action = this.Model().FindActionByOperationId(OperationId);
      if (Action === null) throw $mod.EXDataClientException.$create("CreateFmt",['Operation "%s" not found',pas.System.VarRecs(18,OperationId)]);
      Invoker = $mod.TXDataWebInvoker.$create("Create$1",[this,Action,SuccessProc,ErrorProc,AsyncMode]);
      Invoker.FRequestId = RequestId;
      Invoker.Execute(Args,Query);
    };
    this.DoRequest = function (Request) {
      try {
        if (this.FOnRequest != null) this.FOnRequest(Request);
      } finally {
        Request = rtl.freeLoc(Request);
      };
    };
    this.Send = function (Req, SuccessProc, ErrorProc) {
      this.FConnection.SendRequest(Req,SuccessProc,ErrorProc);
    };
    this.Notification = function (AComponent, Operation) {
      pas.Classes.TComponent.Notification.apply(this,arguments);
      if ((Operation === 1) && (AComponent === this.FConnection)) this.SetConnection(null);
    };
    this.RawInvokeAsync = async function (OperationId, Args) {
      var $Self = this;
      var Result = null;
      var promise = null;
      promise = new Promise(function (resolve, reject) {
        $Self.InternalRawInvoke(OperationId,Args,"","",function (Response) {
          resolve(Response);
        },function (error) {
          reject($mod.EXDataClientRequestException.$create("Create$2",[error]));
        },true);
      });
      return promise;
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Connection",2,pas["XData.Web.Connection"].$rtti["TXDataWebConnection"],"FConnection","SetConnection");
    $r.addProperty("OnLoad",0,$mod.$rtti["TXDataClientLoadEvent"],"FOnLoad","FOnLoad");
    $r.addProperty("OnError",0,$mod.$rtti["TXDataClientErrorEvent"],"FOnError","FOnError");
    $r.addProperty("OnRequest",0,$mod.$rtti["TXDataClientRequestEvent"],"FOnRequest","FOnRequest");
    $r.addProperty("ReferenceSolvingMode",0,$mod.$rtti["TReferenceSolvingMode"],"FReferenceSolvingMode","FReferenceSolvingMode",{Default: $mod.TReferenceSolvingMode.rsAll});
  });
  rtl.createClass(this,"TXDataWebInvoker",pas.System.TObject,function () {
    this.$init = function () {
      pas.System.TObject.$init.call(this);
      this.FClient = null;
      this.FAction = null;
      this.FRequestId = "";
      this.FSuccessProc = null;
      this.FErrorProc = null;
      this.FAsyncMode = false;
    };
    this.$final = function () {
      this.FClient = undefined;
      this.FAction = undefined;
      this.FSuccessProc = undefined;
      this.FErrorProc = undefined;
      pas.System.TObject.$final.call(this);
    };
    this.DoLoad = function (Response) {
      this.FClient.DoLoad(Response,this.FSuccessProc,this.FAsyncMode);
    };
    this.DoError = function (Response, RequestUrl, RequestId, ErrorMessage) {
      this.FClient.DoError(Response,RequestUrl,RequestId,ErrorMessage,this.FErrorProc,this.FAsyncMode);
    };
    this.CreateHttpRequest = function () {
      var Result = null;
      var $ok = false;
      try {
        Result = rtl.setIntfL(Result,rtl.queryIntfT(pas["XData.Web.Request"].THttpRequest.$create("Create$1"),pas["XData.Web.Request"].IHttpRequest),true);
        $ok = true;
      } finally {
        if (!$ok) rtl._Release(Result);
      };
      return Result;
    };
    this.RequestUrl = function (RelativeUrl) {
      var Result = "";
      Result = this.FClient.RequestUrl(RelativeUrl);
      return Result;
    };
    this.BuildQueryString = function (Args, BindingModeFilter, Query) {
      var $Self = this;
      var Result = "";
      var QueryString = "";
      function WriteQueryParam(Name, Value) {
        if (QueryString !== "") QueryString = QueryString + "&";
        QueryString = QueryString + pas["Bcl.Utils"].TBclUtils.PercentEncode(Name) + "=" + pas["Bcl.Utils"].TBclUtils.PercentEncode(Value);
      };
      function WriteObjectToQuery(Obj, AType) {
        var I = 0;
        var Prop = null;
        var Value = undefined;
        if (Obj === null) return;
        for (var $l = 0, $end = AType.ScalarPropertyCount() - 1; $l <= $end; $l++) {
          I = $l;
          Prop = AType.GetScalarProperty(I);
          Value = Obj[Prop.FName];
          if (!pas.JS.isUndefined(Value)) WriteQueryParam(Prop.FName,pas["XData.Bind.Converter"].BindValueToUrl(Value,Prop.FName,null,Prop.GetUrlConverter()));
        };
      };
      var I = 0;
      var Param = null;
      QueryString = Query;
      for (var $l = 0, $end = this.FAction.FParameters.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if (this.FAction.FParameters.GetItem$1(I).FBindingMode === BindingModeFilter) {
          Param = this.FAction.FParameters.GetItem$1(I);
          if (Param.FInput && (I <= rtl.length(Args))) {
            if (pas["XData.Model.Classes"].TXDataStructuredType.isPrototypeOf(Param.FType)) {
              WriteObjectToQuery(pas.JS.toObject(Args[I]),Param.FType);
            } else WriteQueryParam(Param.FName,pas["XData.Bind.Converter"].BindValueToUrl(Args[I],Param.FName,null,Param.GetUrlConverter()));
          };
        };
      };
      Result = QueryString;
      return Result;
    };
    this.GetPathParamValues = function (Args) {
      var Result = [];
      var I = 0;
      var Param = null;
      var ParamIndex = 0;
      ParamIndex = 0;
      Result = rtl.arraySetLength(Result,"",this.FAction.FParameters.GetCount());
      for (var $l = 0, $end = this.FAction.FParameters.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if (this.FAction.FParameters.GetItem$1(I).FBindingMode === 2) {
          Param = this.FAction.FParameters.GetItem$1(I);
          if (Param.FInput && (I <= rtl.length(Args))) {
            Result[ParamIndex] = pas["Bcl.Utils"].TBclUtils.PercentEncode(pas["XData.Bind.Converter"].BindValueToUrl(Args[I],Param.FName,null,Param.GetUrlConverter()));
            ParamIndex += 1;
          };
        };
      };
      Result = rtl.arrayCopy(0,Result,0,ParamIndex);
      return Result;
    };
    this.BuildUrlRoute = function (Args) {
      var $Self = this;
      var Result = "";
      var PathParamValues = [];
      var UsedParamValues = [];
      function AddRouteSegments(RouteInfo) {
        var I = 0;
        for (var $l = 0, $end = RouteInfo.GetSegmentCount() - 1; $l <= $end; $l++) {
          I = $l;
          if (RouteInfo.GetSegment(I).FIsParam) {
            if (RouteInfo.GetSegment(I).FParamIndex < rtl.length(PathParamValues)) {
              Result = Result + PathParamValues[RouteInfo.GetSegment(I).FParamIndex]}
             else throw $mod.EXDataWrongRouteParams.$create("Create$2",[$Self.FAction]);
            UsedParamValues[RouteInfo.GetSegment(I).FParamIndex] = true;
          } else Result = Result + RouteInfo.GetSegment(I).FValue;
          Result = Result + "/";
        };
      };
      var I = 0;
      PathParamValues = this.GetPathParamValues(Args);
      UsedParamValues = rtl.arraySetLength(UsedParamValues,false,rtl.length(PathParamValues));
      Result = "";
      AddRouteSegments(this.FAction.FRouteInfo);
      for (var $l = 0, $end = rtl.length(UsedParamValues) - 1; $l <= $end; $l++) {
        I = $l;
        if (!UsedParamValues[I]) Result = Result + PathParamValues[I] + "/";
      };
      return Result;
    };
    this.SetParamStreamBody = function (Req, Args, ArgIndex) {
      if (ArgIndex >= rtl.length(Args)) throw $mod.EXDataWrongParameterCount.$create("Create$2",[this.FAction,ArgIndex + 1]);
      Req.SetContent(Args[ArgIndex]);
    };
    this.SetJsonParamsBody = function (Req, Args) {
      var I = 0;
      var Param = null;
      var ParamObj = null;
      var ParamValue = undefined;
      ParamObj = new Object();
      for (var $l = 0, $end = this.FAction.FParameters.GetCount() - 1; $l <= $end; $l++) {
        I = $l;
        if (this.FAction.FParameters.GetItem$1(I).FBindingMode === 0) {
          Param = this.FAction.FParameters.GetItem$1(I);
          if (Param.FInput && (I < rtl.length(Args))) {
            ParamValue = Args[I];
            this.TransformParam(Param,{get: function () {
                return ParamValue;
              }, set: function (v) {
                ParamValue = v;
              }});
            ParamObj[Param.FName] = ParamValue;
          };
        };
      };
      Req.SetContent(JSON.stringify(ParamObj));
    };
    this.SetJsonObjectBody = function (Req, Args) {
      var ParamIndex = 0;
      ParamIndex = this.FAction.GetBodyParam(0).Index();
      if (rtl.length(Args) <= ParamIndex) throw $mod.EXDataWrongParameterCount.$create("Create$2",[this.FAction,ParamIndex + 1]);
      Req.SetContent(JSON.stringify(Args[ParamIndex]));
    };
    this.SetFormBody = function (Req, Args) {
      Req.SetContent(this.BuildQueryString(Args,0,""));
    };
    this.TransformParam = function (Param, Value) {
    };
    this.Create$1 = function (AClient, AAction, ASuccessProc, AErrorProc, AAsyncMode) {
      this.FClient = AClient;
      this.FAction = AAction;
      this.FSuccessProc = ASuccessProc;
      this.FErrorProc = AErrorProc;
      this.FAsyncMode = AAsyncMode;
      return this;
    };
    this.Execute = function (Args, Query) {
      var $Self = this;
      var RequestUrl = "";
      function OnSuccess(Resp) {
        var ResultValue = undefined;
        var JsonResult = undefined;
        if ((Resp.GetStatusCode() !== 200) && (Resp.GetStatusCode() !== 204) && (Resp.GetStatusCode() !== 404)) {
          $Self.DoError(Resp,RequestUrl,$Self.FRequestId,"");
          return;
        };
        if ($Self.FAction.FIsResultStream) {
          if (Resp.GetStatusCode() === 404) {
            $Self.DoError(Resp,RequestUrl,$Self.FRequestId,"")}
           else {
            ResultValue = Resp.GetContent();
            $Self.DoLoad($mod.TXDataClientResponse.$create("Create$1",[$Self.FClient,Resp,ResultValue,5,$Self.FRequestId,0]));
          };
        } else if ($Self.FAction.FIsResultCriteria) {
          $Self.DoError(Resp,RequestUrl,$Self.FRequestId,"TCriteria result yet not supported in TXDataClient");
        } else {
          if (Resp.GetStatusCode() !== 204) {
            JsonResult = JSON.parse(Resp.GetContentAsText());
          } else JsonResult = null;
          $Self.DoLoad($mod.TXDataClientResponse.$create("Create$1",[$Self.FClient,Resp,JsonResult,5,$Self.FRequestId,0]));
        };
      };
      function LocalError() {
        $Self.DoError(null,RequestUrl,$Self.FRequestId,"");
      };
      var Req = null;
      var QueryString = "";
      var SingleBodyParamIndex = 0;
      try {
        Req = rtl.setIntfL(Req,this.CreateHttpRequest(),true);
        QueryString = this.BuildQueryString(Args,1,Query);
        RequestUrl = this.BuildUrlRoute(Args);
        if (QueryString !== "") RequestUrl = RequestUrl + "?" + QueryString;
        RequestUrl = $Self.RequestUrl(RequestUrl);
        Req.SetUri(RequestUrl);
        Req.SetMethod(this.FAction.FHttpMethod);
        if (this.FAction.FIsResultStream) Req.SetResponseType("blob");
        if (this.FAction.FIsParamStream) {
          this.SetParamStreamBody(Req,Args,this.FAction.ParamStreamIndex())}
         else if (this.FAction.BodyParamCount() > 0) {
          if (this.FAction.IsFormContent()) {
            this.SetFormBody(Req,Args)}
           else {
            SingleBodyParamIndex = this.FAction.GetBodyParam(0).Index();
            if ((this.FAction.BodyParamCount() === 1) && (rtl.length(Args) > SingleBodyParamIndex) && rtl.isObject(Args[SingleBodyParamIndex])) {
              this.SetJsonObjectBody(Req,Args)}
             else this.SetJsonParamsBody(Req,Args);
          };
          if (this.FAction.FConsumes !== "") {
            Req.GetHeaders().SetValue("content-type",this.FAction.FConsumes)}
           else Req.GetHeaders().SetValue("content-type","application/json");
        };
        this.FClient.DoRequest($mod.TXDataClientRequest.$create("Create$1",[this.FClient,Req,5,this.FRequestId]));
        this.FClient.Send(Req,OnSuccess,LocalError);
      } finally {
        rtl._Release(Req);
      };
    };
  });
  rtl.createClass(this,"EXDataClientException",pas.SysUtils.Exception,function () {
  });
  rtl.createClass(this,"EXDataClientRequestException",this.EXDataClientException,function () {
    this.$init = function () {
      $mod.EXDataClientException.$init.call(this);
      this.FErrorResult = null;
    };
    this.$final = function () {
      this.FErrorResult = undefined;
      $mod.EXDataClientException.$final.call(this);
    };
    this.Create$2 = function (AClientError) {
      var Msg = "";
      this.FErrorResult = AClientError;
      Msg = "XData server request error." + pas.System.sLineBreak + "Uri: " + AClientError.FRequestUrl;
      Msg = Msg + pas.System.sLineBreak + "Status code: " + pas.SysUtils.IntToStr(AClientError.GetStatusCode());
      if (AClientError.FErrorCode !== "") Msg = Msg + pas.System.sLineBreak + "Error Code: " + AClientError.FErrorCode;
      if (AClientError.FErrorMessage !== "") Msg = Msg + pas.System.sLineBreak + AClientError.FErrorMessage;
      pas.SysUtils.Exception.Create$1.call(this,Msg);
      return this;
    };
  });
  rtl.createClass(this,"EXDataWrongParameterCount",this.EXDataClientException,function () {
    this.Create$2 = function (Action, PassedParameters) {
      pas.SysUtils.Exception.CreateFmt.call(this,'Incorrect parameter count for Operation "%s". Expected at least: %d, actual: %d',pas.System.VarRecs(18,Action.FOperationId,0,Action.FParameters.GetCount(),0,PassedParameters));
      return this;
    };
  });
  rtl.createClass(this,"EXDataWrongRouteParams",this.EXDataClientException,function () {
    this.Create$2 = function (Action) {
      pas.SysUtils.Exception.CreateFmt.call(this,'Invalid number of route params for Operation "%s". ' + "Route params: %d, Path params: %d",pas.System.VarRecs(18,Action.FOperationId,0,Action.FRouteInfo.FParamCount,0,Action.PathParamCount()));
      return this;
    };
  });
},["Bcl.Utils","XData.Bind.Converter","XData.Utils"]);
rtl.module("WEBLib.StdCtrls",["System","Classes","WEBLib.Controls","SysUtils","Web","WEBLib.Graphics","Types","WEBLib.WebTools","WEBLib.Forms","WEBLib.Menus"],function () {
  "use strict";
  var $mod = this;
  this.TEditCharCase = {"0": "wecLowerCase", wecLowerCase: 0, "1": "wecNormal", wecNormal: 1, "2": "wecMixedCase", wecMixedCase: 2, "3": "wecUpperCase", wecUpperCase: 3};
  this.$rtti.$Enum("TEditCharCase",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TEditCharCase});
  this.TEllipsisPosition = {"0": "epEndEllipsis", epEndEllipsis: 0, "1": "epNone", epNone: 1, "2": "epPathEllipsis", epPathEllipsis: 2, "3": "epWordEllipsis", epWordEllipsis: 3};
  this.$rtti.$Enum("TEllipsisPosition",{minvalue: 0, maxvalue: 3, ordtype: 1, enumtype: this.TEllipsisPosition});
  this.TTextLayout = {"0": "tlTop", tlTop: 0, "1": "tlCenter", tlCenter: 1, "2": "tlBottom", tlBottom: 2};
  this.$rtti.$Enum("TTextLayout",{minvalue: 0, maxvalue: 2, ordtype: 1, enumtype: this.TTextLayout});
  this.TAutoCompletion = {"0": "acOff", acOff: 0, "1": "acHonorificPrefix", acHonorificPrefix: 1, "2": "acGivenName", acGivenName: 2, "3": "acAdditionalName", acAdditionalName: 3, "4": "acFamilyName", acFamilyName: 4, "5": "acHonorificSuffix", acHonorificSuffix: 5, "6": "acNickName", acNickName: 6, "7": "acEmail", acEmail: 7, "8": "acUserName", acUserName: 8, "9": "acNewPassword", acNewPassword: 9, "10": "acCurrentPassword", acCurrentPassword: 10, "11": "acOrganizationTitle", acOrganizationTitle: 11, "12": "acOrganization", acOrganization: 12, "13": "acStreetAddress", acStreetAddress: 13, "14": "acAddressLine1", acAddressLine1: 14, "15": "acAddressLine2", acAddressLine2: 15, "16": "acAddressLine3", acAddressLine3: 16, "17": "acAddressLevel1", acAddressLevel1: 17, "18": "acAddressLevel2", acAddressLevel2: 18, "19": "acAddressLevel3", acAddressLevel3: 19, "20": "acAddressLevel4", acAddressLevel4: 20, "21": "acCountry", acCountry: 21, "22": "acCountryName", acCountryName: 22, "23": "acPostalCode", acPostalCode: 23, "24": "acCCName", acCCName: 24, "25": "acCCGivenName", acCCGivenName: 25, "26": "acCCAdditionalName", acCCAdditionalName: 26, "27": "acCCFamilyName", acCCFamilyName: 27, "28": "acCCNumber", acCCNumber: 28, "29": "acExpiry", acExpiry: 29, "30": "acExpiryMonth", acExpiryMonth: 30, "31": "acExpiryYear", acExpiryYear: 31, "32": "acCSC", acCSC: 32, "33": "acType", acType: 33, "34": "acTransactionCurrency", acTransactionCurrency: 34, "35": "acTransactionAmount", acTransactionAmount: 35, "36": "acLanguage", acLanguage: 36, "37": "acBirthday", acBirthday: 37, "38": "acBirthdayDay", acBirthdayDay: 38, "39": "acBirthDayMonth", acBirthDayMonth: 39, "40": "acBirthDayYear", acBirthDayYear: 40, "41": "acSex", acSex: 41, "42": "acTelephone", acTelephone: 42, "43": "acTelephoneCountryCode", acTelephoneCountryCode: 43, "44": "acTelephoneNational", acTelephoneNational: 44, "45": "acTelephoneAreaCode", acTelephoneAreaCode: 45, "46": "acTelephoneLocal", acTelephoneLocal: 46, "47": "acTelephoneExtension", acTelephoneExtension: 47, "48": "acIMPP", acIMPP: 48, "49": "acURL", acURL: 49, "50": "acPhoto", acPhoto: 50, "51": "acNone", acNone: 51, "52": "acNope", acNope: 52};
  this.$rtti.$Enum("TAutoCompletion",{minvalue: 0, maxvalue: 52, ordtype: 1, enumtype: this.TAutoCompletion});
  this.TEditType = {"0": "weString", weString: 0, "1": "weFloat", weFloat: 1, "2": "weHex", weHex: 2, "3": "weNumeric", weNumeric: 3, "4": "weSignedFloat", weSignedFloat: 4, "5": "weSignedNumeric", weSignedNumeric: 5, "6": "weSearch", weSearch: 6};
  this.$rtti.$Enum("TEditType",{minvalue: 0, maxvalue: 6, ordtype: 1, enumtype: this.TEditType});
  this.THTMLType = {"0": "tLABELTAG", tLABELTAG: 0, "1": "tSPAN", tSPAN: 1, "2": "tDIV", tDIV: 2, "3": "tH1", tH1: 3, "4": "tH2", tH2: 4, "5": "tH3", tH3: 5, "6": "tH4", tH4: 6, "7": "tH5", tH5: 7, "8": "tH6", tH6: 8, "9": "tP", tP: 9};
  this.$rtti.$Enum("THTMLType",{minvalue: 0, maxvalue: 9, ordtype: 1, enumtype: this.THTMLType});
  rtl.createClass(this,"TCustomLabel",pas["WEBLib.Menus"].TWebCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Menus"].TWebCustomControl.$init.call(this);
      this.FContent = null;
      this.FAutoSize = false;
      this.FEllipsisPosition = 0;
      this.FWordWrap = false;
      this.FAlignment = 0;
      this.FLayout = 0;
      this.FTransparent = false;
      this.FHTMLType = 0;
      this.FFocusControl = null;
      this.FShowAccelChar = false;
      this.FColor$1 = 0;
      this.FHasAccel = false;
      this.FHasHTML = false;
      this.FElementLabelClassName = "";
      this.FOrigWidth = 0;
      this.FOldWidth = 0;
      this.FOldHeight = 0;
      this.FHTML = "";
    };
    this.$final = function () {
      this.FContent = undefined;
      this.FFocusControl = undefined;
      pas["WEBLib.Menus"].TWebCustomControl.$final.call(this);
    };
    this.SetLayout = function (Value) {
      if (this.FLayout !== Value) {
        this.FLayout = Value;
        this.UpdateElementVisual();
      };
    };
    this.SetAlignment = function (Value) {
      if (this.FAlignment !== Value) {
        this.FAlignment = Value;
        this.UpdateElementVisual();
      };
    };
    this.GetContentHandle = function () {
      var Result = null;
      Result = this.FContent;
      return Result;
    };
    this.SetTransparent = function (Value) {
      if (this.FTransparent !== Value) {
        this.FTransparent = Value;
        this.UpdateElementVisual();
      };
    };
    this.SetHTMLType = function (Value) {
      var el = null;
      if (this.FHTMLType !== Value) {
        this.FHTMLType = Value;
        if (this.FHTMLType in rtl.createSet(null,3,8)) this.SetElementFont(1);
        if ((this.GetElementHandle() != null) && (this.FContent != null)) {
          el = this.GetElementHandle().firstChild;
          if ((el != null) && (el.getAttribute("data-lbl") === "lbl")) {
            this.GetElementHandle().removeChild(this.FContent);
            this.FContent = this.CreateLabelElement();
            this.GetElementHandle().appendChild(this.FContent);
            this.UpdateElement();
          };
        };
      };
    };
    this.SetColorEx = function (Value) {
      this.FColor$1 = Value;
      if ((4 in this.FComponentState) && (this.FColor$1 !== 16777215)) this.SetTransparent(false);
      this.UpdateElement();
    };
    this.SetElementLabelClassName = function (Value) {
      if (this.FElementLabelClassName !== Value) {
        this.FElementLabelClassName = Value;
        this.UpdateElement();
      };
    };
    this.SetHTML = function (Value) {
      if (this.FHTML !== Value) {
        this.FHTML = Value;
        this.UpdateElementData();
      };
    };
    this.SetWidth = function (AValue) {
      if ((AValue !== -1) && (0 in this.FComponentState)) this.FOrigWidth = AValue;
      pas["WEBLib.Controls"].TControl.SetWidth.apply(this,arguments);
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("DIV");
      this.FContent = this.CreateLabelElement();
      Result.appendChild(this.FContent);
      return Result;
    };
    this.CreateLabelElement = function () {
      var Result = null;
      Result = null;
      var $tmp = this.FHTMLType;
      if ($tmp === 1) {
        Result = document.createElement("SPAN")}
       else if ($tmp === 2) {
        Result = document.createElement("DIV")}
       else if ($tmp === 3) {
        Result = document.createElement("H1")}
       else if ($tmp === 4) {
        Result = document.createElement("H2")}
       else if ($tmp === 5) {
        Result = document.createElement("H3")}
       else if ($tmp === 6) {
        Result = document.createElement("H4")}
       else if ($tmp === 7) {
        Result = document.createElement("H5")}
       else if ($tmp === 8) {
        Result = document.createElement("H6")}
       else if ($tmp === 0) {
        Result = document.createElement("LABEL")}
       else if ($tmp === 9) Result = document.createElement("P");
      Result.setAttribute("data-lbl","lbl");
      return Result;
    };
    this.GetDisplayText = function () {
      var Result = "";
      Result = this.FCaption;
      return Result;
    };
    this.CanShowFocus = function () {
      var Result = false;
      Result = false;
      return Result;
    };
    this.SetParent = function (AValue) {
      pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments);
      if (this.FAutoSize && (this.FAlignment !== 0) && (this.FOrigWidth !== -1)) {
        this.SetLeft((this.GetLeft() + this.FOrigWidth) - this.GetWidth());
        this.FOrigWidth = -1;
      };
    };
    this.BindElement = function () {
      this.FContent = this.GetContainer().firstElementChild;
    };
    this.Loaded = function () {
      pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);
      if (this.FShowAccelChar && (this.FFocusControl != null)) this.UpdateElementData();
    };
    this.UpdateAutoSize = function () {
      if (this.FAutoSize && (this.FAlign === 0)) {
        if ((this.GetElementHandle() != null) && pas["WEBLib.WebTools"].ElementVisible(this.GetElementHandle())) {
          this.SetWidth(-1);
          this.SetHeight(-1);
        };
        this.FEllipsisPosition = 1;
      };
    };
    this.UpdateElementData = function () {
      var lTxt = "";
      var acc = "";
      var contentelement = null;
      pas["WEBLib.Controls"].TControl.UpdateElementData.call(this);
      acc = "";
      if (this.FShowAccelChar) {
        lTxt = pas["WEBLib.WebTools"].ProcessAccelerator(this.GetDisplayText(),{get: function () {
            return acc;
          }, set: function (v) {
            acc = v;
          }})}
       else lTxt = this.GetDisplayText();
      if (this.FHTML === "") {
        lTxt = pas["WEBLib.WebTools"].HTMLToString(lTxt)}
       else lTxt = this.FHTML;
      if (this.GetIsLinked() && (lTxt === "") && (0 in this.FComponentState)) return;
      if (this.GetContentHandle() != null) {
        if (this.GetIsLinked()) {
          contentelement = this.GetContentHandle();
          if (this.GetID() !== "") {
            contentelement = document.getElementById(this.GetID());
          };
          if (contentelement != null) {
            if (pas.System.Assigned(this.GetContentHandle().nodeValue)) {
              contentelement.nodeValue = lTxt}
             else if (contentelement.childElementCount === 0) contentelement.innerHTML = lTxt;
          };
        } else {
          if ((this.GetContentHandle().childElementCount > 0) && !this.FHasAccel && !this.FHasHTML) {
            this.GetContentHandle().nodeValue = lTxt}
           else this.GetContentHandle().innerHTML = lTxt;
        };
      } else this.GetElementHandle().innerHTML = lTxt;
      this.FHasHTML = pas.System.Pos("</",lTxt) > 0;
      this.FHasAccel = acc !== "";
      if ((acc !== "") && (this.FFocusControl != null)) {
        this.GetContentHandle().setAttribute("accesskey",acc);
        this.GetContentHandle().setAttribute("for",this.FFocusControl.GetID());
      };
    };
    this.UpdateElementVisual = function () {
      var ow = 0;
      var oh = 0;
      pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this);
      if (this.IsUpdating()) return;
      if (this.GetElementHandle() != null) {
        oh = Math.round(this.GetElementHandle().offsetHeight);
        ow = Math.round(this.GetElementHandle().offsetWidth);
        if (oh > 0) this.FOldHeight = oh;
        if (ow > 0) this.FOldWidth = ow;
        if (this.FVisible && (!this.FAutoSize || (this.FAlign !== 0)) && (this.FAlignment !== 0)) this.GetElementHandle().style.setProperty("display","table");
        this.GetElementHandle().setAttribute("zindex","1");
        if (this.FAutoSize && (this.FAlign === 0) && !(4 in this.FComponentState)) {
          this.GetElementHandle().style.setProperty("overflow","")}
         else this.GetElementHandle().style.setProperty("overflow","hidden");
      };
      if (this.GetContentHandle() != null) {
        var $tmp = this.FLayout;
        if ($tmp === 0) {
          this.GetContentHandle().style.setProperty("vertical-align","top")}
         else if ($tmp === 1) {
          this.GetContentHandle().style.setProperty("vertical-align","middle")}
         else if ($tmp === 2) this.GetContentHandle().style.setProperty("vertical-align","bottom");
        var $tmp1 = this.FAlignment;
        if ($tmp1 === 0) {
          this.GetContentHandle().style.removeProperty("text-align")}
         else if ($tmp1 === 2) {
          this.GetContentHandle().style.setProperty("text-align","center")}
         else if ($tmp1 === 1) this.GetContentHandle().style.setProperty("text-align","right");
        pas["WEBLib.Controls"].SetHTMLElementColor(this.GetElementHandle(),this.FColor$1,this.FTransparent || (this.FColor$1 === -1) || (this.FColor$1 === 16711422));
        pas["WEBLib.Controls"].SetHTMLElementColor(this.GetContentHandle(),this.FColor$1,this.FTransparent || (this.FColor$1 === -1) || (this.FColor$1 === 16711422));
        this.GetContentHandle().style.setProperty("display","table-cell");
        if (this.FElementClassName === "") {
          if (this.FEnabled && (this.FElementFont === 0) && !this.GetIsLinked()) {
            this.GetContentHandle().style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FFont.FColor))}
           else this.GetContentHandle().style.removeProperty("color");
          this.SetElementPointer(this.GetContentHandle(),this.FCursor);
          pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,!((this.FElementFont === 0) && !this.GetIsLinked()));
        } else {
          this.GetContentHandle().style.removeProperty("color");
          pas["WEBLib.Controls"].SetHTMLElementFont(this.GetContentHandle(),this.FFont,true);
        };
        if (this.FElementLabelClassName !== "") {
          this.GetContentHandle().setAttribute("class",this.FElementLabelClassName)}
         else this.GetContentHandle().removeAttribute("class");
        if ((this.FElementPosition === 0) || (this.FWidthStyle === 1)) {
          if (this.FEllipsisPosition === 1) {
            this.GetContentHandle().style.setProperty("text-overflow","clip")}
           else this.GetContentHandle().style.setProperty("text-overflow","ellipsis");
        } else this.GetContentHandle().style.removeProperty("text-overflow");
        if (this.FWordWrap) {
          this.GetContentHandle().style.setProperty("white-space","normal")}
         else this.GetContentHandle().style.setProperty("white-space","nowrap");
        this.GetElementHandle().style.setProperty("user-select","");
        if (this.FCursor === 0) this.GetElementHandle().style.setProperty("cursor","");
        if (this.FAutoSize && (this.FAlign === 0) && !(4 in this.FComponentState)) {
          this.GetElementHandle().style.removeProperty("width");
          this.GetElementHandle().style.removeProperty("height");
        };
      };
    };
    this.UpdateElementSize = function () {
      pas["WEBLib.Controls"].TControl.UpdateElementSize.call(this);
      if (this.FAutoSize && (this.FAlign === 0) && (this.GetElementHandle() != null)) {
        if (!(4 in this.FComponentState)) {
          this.GetElementHandle().style.removeProperty("width");
          this.GetElementHandle().style.removeProperty("height");
        };
      };
      if ((this.GetContentHandle() != null) && (this.FAlign in rtl.createSet(3,4,5)) && !this.FAutoSize && (this.FLayout in rtl.createSet(1,2))) {
        this.GetContentHandle().style.setProperty("height",pas.SysUtils.TIntegerHelper.ToString$1.call({p: this.GetHeight(), get: function () {
            return this.p;
          }, set: function (v) {
            this.p = v;
          }}) + "px");
      };
    };
    this.SetAutoSize = function (AValue) {
      if (this.FAutoSize !== AValue) {
        this.FAutoSize = AValue;
        this.UpdateAutoSize();
        this.UpdateElement();
      };
    };
    this.SetCaption = function (AValue) {
      var dw = 0;
      if (this.FCaption !== AValue) {
        dw = this.GetWidth();
        pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,AValue);
        this.UpdateAutoSize();
        this.UpdateElement();
        dw = dw - this.GetWidth();
        if (this.FAutoSize && (this.FAlignment !== 0) && (dw !== 0) && (2 in this.FAnchors) && !this.IsUpdating()) this.SetLeft(this.GetLeft() + dw);
      };
    };
    this.SetControlCursor = function (Value) {
      pas["WEBLib.Controls"].TControl.SetControlCursor.apply(this,arguments);
      if ((this.FElementClassName === "") && (this.GetContentHandle() != null)) this.SetElementPointer(this.GetContentHandle(),this.FCursor);
    };
    this.SetEllipsisPosition = function (AValue) {
      if (this.FEllipsisPosition !== AValue) {
        this.FEllipsisPosition = AValue;
        if (this.FEllipsisPosition !== 1) this.FAutoSize = false;
        this.UpdateElement();
      };
    };
    this.GetWidth = function () {
      var Result = 0;
      if (this.FAutoSize && (this.GetElementHandle() != null) && (this.FParent != null)) {
        Result = Math.round(this.GetElementHandle().offsetWidth);
        if (Result === 0) Result = pas["WEBLib.Controls"].TControl.GetWidth.call(this);
        if ((Result === 0) && (this.FCaption !== "") && (4 in this.FComponentState)) Result = this.FOldWidth;
      } else Result = pas["WEBLib.Controls"].TControl.GetWidth.call(this);
      return Result;
    };
    this.GetHeight = function () {
      var Result = 0;
      if (this.FAutoSize && (this.GetElementHandle() != null) && (this.FParent != null)) {
        Result = Math.round(this.GetElementHandle().offsetHeight);
        if (Result === 0) Result = pas["WEBLib.Controls"].TControl.GetHeight.call(this);
        if ((Result === 0) && (this.FCaption !== "") && (4 in this.FComponentState)) Result = this.FOldHeight;
      } else Result = pas["WEBLib.Controls"].TControl.GetHeight.call(this);
      return Result;
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      this.FAutoSize = true;
      this.FLayout = 0;
      this.FEllipsisPosition = 1;
      this.FColor$1 = 16777215;
      this.FTransparent = true;
      this.FAlignment = 0;
      this.SetTabStop(false);
      this.FShowAccelChar = true;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TLabel",this.TCustomLabel,function () {
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("Alignment",2,pas.Classes.$rtti["TAlignment"],"FAlignment","SetAlignment",{Default: pas.Classes.TAlignment.taLeftJustify});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default: true});
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default: 0});
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor$1","SetColorEx",{Default: 16777215});
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("EllipsisPosition",2,$mod.$rtti["TEllipsisPosition"],"FEllipsisPosition","SetEllipsisPosition",{Default: $mod.TEllipsisPosition.epNone});
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementLabelClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementLabelClassName","SetElementLabelClassName");
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("FocusControl",0,pas["WEBLib.Controls"].$rtti["TWinControl"],"FFocusControl","FFocusControl");
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight");
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("Hint",2,rtl.string,"FHint","SetHint");
    $r.addProperty("HTML",2,rtl.string,"FHTML","SetHTML");
    $r.addProperty("HTMLType",2,$mod.$rtti["THTMLType"],"FHTMLType","SetHTMLType",{Default: $mod.THTMLType.tLABELTAG});
    $r.addProperty("Layout",2,$mod.$rtti["TTextLayout"],"FLayout","SetLayout",{Default: $mod.TTextLayout.tlTop});
    $r.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft");
    $r.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti["TMargins"],"FMargins","SetMargins");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti["TPopupMenu"],"FPopupMenu","FPopupMenu");
    $r.addProperty("ShowAccelChar",0,rtl.boolean,"FShowAccelChar","FShowAccelChar",{Default: true});
    $r.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default: false});
    $r.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti["TTextDirection"],"FTextDirection","FTextDirection",{Default: pas["WEBLib.Controls"].TTextDirection.tdDefault});
    $r.addProperty("Top",3,rtl.longint,"GetTop","SetTop");
    $r.addProperty("Transparent",2,rtl.boolean,"FTransparent","SetTransparent",{Default: true});
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth");
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("WordWrap",0,rtl.boolean,"FWordWrap","FWordWrap",{Default: false});
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnTouchStart",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchStart","FOnTouchStart");
    $r.addProperty("OnTouchEnd",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchEnd","FOnTouchEnd");
    $r.addProperty("OnTouchMove",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchMove","FOnTouchMove");
    $r.addProperty("OnTouchCancel",0,pas["WEBLib.Controls"].$rtti["TTouchEvent"],"FOnTouchCancel","FOnTouchCancel");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
  });
  rtl.createClass(this,"TCustomInput",pas["WEBLib.Menus"].TWebCustomControl,function () {
    this.IsInputControl = function () {
      var Result = false;
      Result = true;
      return Result;
    };
    this.GetInputType = function () {
      var Result = "";
      Result = "EDIT";
      return Result;
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("INPUT");
      Result.setAttribute("type",this.GetInputType());
      return Result;
    };
    this.UpdateElementVisual = function () {
      pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this);
      if ((this.GetContainer() != null) && !this.GetIsLinked()) {
        this.GetContainer().style.setProperty("-moz-box-sizing","border-box");
        this.GetContainer().style.setProperty("-webkit-box-sizing","border-box");
        this.GetContainer().style.setProperty("box-sizing","border-box");
      };
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      this.SetShowFocus(true);
      this.FNoUserSelect = false;
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TCustomEdit",this.TCustomInput,function () {
    this.$init = function () {
      $mod.TCustomInput.$init.call(this);
      this.FCharCase = 0;
      this.FMaxLength = 0;
      this.FReadOnly = false;
      this.FText = "";
      this.FTextHint = "";
      this.FSelStart = 0;
      this.FAlignment = 0;
      this.FHideSelection = false;
      this.FPasswordChar = "";
      this.FOnChange = null;
      this.FAutoSize = false;
      this.FAutoSelect = false;
      this.FSelLength = 0;
      this.FNumeric = false;
      this.FAutoCompletion = 0;
      this.FEditType = 0;
      this.FRequired = false;
      this.FAutoFocus = false;
      this.FPattern = "";
      this.FHandlePastePtr = null;
      this.FHandleCutPtr = null;
      this.FHandleChangePtr = null;
      this.FHandleInvalidPtr = null;
      this.FSpellCheck = false;
      this.FRequiredText = "";
    };
    this.$final = function () {
      this.FOnChange = undefined;
      $mod.TCustomInput.$final.call(this);
    };
    this.SetAlignment = function (Value) {
      this.FAlignment = Value;
      this.UpdateElement();
    };
    this.SetHideSelection = function (Value) {
      if (this.FHideSelection !== Value) {
        this.FHideSelection = Value;
        this.UpdateElement();
      };
    };
    this.SetAutoSelect = function (Value) {
      if (this.FAutoSelect !== Value) {
        this.FAutoSelect = Value;
        this.UpdateElement();
      };
    };
    this.SetAutoSize = function (Value) {
      if (this.FAutoSize !== Value) {
        this.FAutoSize = Value;
        this.UpdateElement();
      };
    };
    this.SetPasswordChar = function (Value) {
      this.FPasswordChar = Value;
      this.UpdateElement();
    };
    this.SetAutoCompletion = function (Value) {
      if (this.FAutoCompletion !== Value) {
        this.FAutoCompletion = Value;
        this.UpdateElement();
      };
    };
    this.SetAutoFocus = function (Value) {
      if (this.FAutoFocus !== Value) {
        this.FAutoFocus = Value;
        this.UpdateElement();
      };
    };
    this.SetRequired = function (Value) {
      this.FRequired = Value;
      this.UpdateElement();
    };
    this.SetPattern = function (Value) {
      if (this.FPattern !== Value) {
        this.FPattern = Value;
        this.UpdateElement();
      };
    };
    this.SetEditType = function (Value) {
      if (this.FEditType !== Value) {
        this.FEditType = Value;
        this.UpdateElement();
      };
    };
    this.SetSpellCheck = function (Value) {
      if (this.FSpellCheck !== Value) {
        this.FSpellCheck = Value;
        this.UpdateElement();
      };
    };
    this.GetElementInputHandle = function () {
      var Result = null;
      Result = this.GetContainer();
      return Result;
    };
    this.DoHandlePaste = function (Event) {
      var Result = false;
      var s = "";
      var clipboardData = Event.clipboardData || window.clipboardData;
      s = clipboardData.getData('Text');
      if (!this.CanPaste(s) || !this.Validate(s)) {
        Event.preventDefault();
        Event.stopPropagation();
      };
      Result = false;
      return Result;
    };
    this.DoHandleCut = function (Event) {
      var Result = false;
      if (!this.CanCut()) {
        Event.preventDefault();
        Event.stopPropagation();
      };
      Result = false;
      return Result;
    };
    this.DoHandleChange = function (Event) {
      var Result = false;
      this.Change();
      Result = true;
      if (this.FRequiredText !== "") {
        this.GetElementInputHandle().setCustomValidity("");
      };
      return Result;
    };
    this.DoHandleInvalid = function (Event) {
      var Result = false;
      this.GetElementInputHandle().setCustomValidity(this.FRequiredText);
      Result = true;
      return Result;
    };
    this.IsCustomEditor = function () {
      var Result = false;
      Result = false;
      return Result;
    };
    this.KeyPress = function (Key) {
      var isValid = false;
      pas["WEBLib.Controls"].TControl.KeyPress.call(this,Key);
      isValid = true;
      var $tmp = this.FEditType;
      if ($tmp === 3) {
        isValid = Key.get().charCodeAt() in rtl.createSet(null,48,57)}
       else if ($tmp === 5) {
        isValid = Key.get().charCodeAt() in rtl.createSet(null,48,57,43,45)}
       else if ($tmp === 1) {
        isValid = Key.get().charCodeAt() in rtl.createSet(null,48,57,44,46)}
       else if ($tmp === 4) {
        isValid = Key.get().charCodeAt() in rtl.createSet(null,48,57,44,46,43,45)}
       else if ($tmp === 2) isValid = Key.get().charCodeAt() in rtl.createSet(null,48,57,null,65,70);
      if (!isValid) Key.set("\x00");
    };
    this.DoEnter = function () {
      var el = null;
      pas["WEBLib.Controls"].TControl.DoEnter.call(this);
      if (this.FAutoSelect && (this.GetElementInputHandle() != null)) {
        el = this.GetElementInputHandle();
        el.select();
      };
    };
    this.GetInputType = function () {
      var Result = "";
      if (this.FPasswordChar !== "\x00") {
        Result = "PASSWORD"}
       else if (this.FNumeric) {
        Result = "NUMBER"}
       else if (this.FEditType in rtl.createSet(1,3)) {
        Result = "TEL"}
       else if (this.FEditType === 6) {
        Result = "SEARCH"}
       else Result = "TEXT";
      return Result;
    };
    this.GetText = function () {
      var Result = "";
      Result = this.FText;
      if (this.GetElementInputHandle() != null) Result = this.GetElementInputHandle().value;
      if (this.FCharCase === 3) Result = pas.SysUtils.UpperCase(Result);
      if (this.FCharCase === 0) Result = pas.SysUtils.LowerCase(Result);
      return Result;
    };
    this.GetDisplayText = function () {
      var Result = "";
      Result = this.FText;
      return Result;
    };
    this.IsReadOnly = function () {
      var Result = false;
      Result = this.FReadOnly;
      return Result;
    };
    this.Validate = function (AValue) {
      var Result = false;
      var i = 0;
      var Key = "";
      var isvalid = false;
      Result = true;
      for (var $l = 1, $end = AValue.length; $l <= $end; $l++) {
        i = $l;
        Key = AValue.charAt(i - 1);
        isvalid = true;
        var $tmp = this.FEditType;
        if ($tmp === 3) {
          isvalid = Key.charCodeAt() in rtl.createSet(null,48,57)}
         else if ($tmp === 5) {
          isvalid = Key.charCodeAt() in rtl.createSet(null,48,57,43,45)}
         else if ($tmp === 1) {
          isvalid = Key.charCodeAt() in rtl.createSet(null,48,57,44,46)}
         else if ($tmp === 4) {
          isvalid = Key.charCodeAt() in rtl.createSet(null,48,57,44,46,43,45)}
         else if ($tmp === 2) isvalid = Key.charCodeAt() in rtl.createSet(null,48,57,null,65,70);
        if (!isvalid) {
          Result = false;
          break;
        };
      };
      return Result;
    };
    this.ClearMethodPointers = function () {
      pas["WEBLib.Controls"].TControl.ClearMethodPointers.call(this);
      this.FHandlePastePtr = null;
      this.FHandleCutPtr = null;
      this.FHandleChangePtr = null;
      this.FHandleInvalidPtr = null;
    };
    this.GetMethodPointers = function () {
      pas["WEBLib.Controls"].TControl.GetMethodPointers.call(this);
      this.FHandlePastePtr = rtl.createCallback(this,"DoHandlePaste");
      this.FHandleCutPtr = rtl.createCallback(this,"DoHandleCut");
      this.FHandleChangePtr = rtl.createCallback(this,"DoHandleChange");
      this.FHandleInvalidPtr = rtl.createCallback(this,"DoHandleInvalid");
    };
    this.BindEvents = function () {
      pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this);
      if (this.GetElementInputHandle() != null) {
        this.GetElementInputHandle().addEventListener("input",this.FHandleChangePtr);
        this.GetElementInputHandle().addEventListener("paste",this.FHandlePastePtr);
        this.GetElementInputHandle().addEventListener("cut",this.FHandleCutPtr);
        this.GetElementInputHandle().addEventListener("invalid",this.FHandleInvalidPtr);
      };
    };
    this.UnbindEvents = function () {
      pas["WEBLib.Controls"].TControl.UnbindEvents.call(this);
      if (this.GetElementInputHandle() != null) {
        this.GetElementInputHandle().removeEventListener("input",this.FHandleChangePtr);
        this.GetElementInputHandle().removeEventListener("paste",this.FHandlePastePtr);
        this.GetElementInputHandle().removeEventListener("cut",this.FHandleCutPtr);
        this.GetElementInputHandle().removeEventListener("invalid",this.FHandleInvalidPtr);
      };
    };
    this.UpdateElementData = function () {
      var eh = null;
      var ss = 0;
      var sl = 0;
      var isNum = false;
      var doAc = false;
      pas["WEBLib.Controls"].TControl.UpdateElementData.call(this);
      if (this.GetElementInputHandle() != null) {
        if (!this.GetIsLinked()) {
          var $tmp = this.FCharCase;
          if ($tmp === 3) {
            this.GetElementInputHandle().style.setProperty("text-transform","uppercase")}
           else if ($tmp === 0) {
            this.GetElementInputHandle().style.setProperty("text-transform","lowercase")}
           else if ($tmp === 2) {
            this.GetElementInputHandle().style.setProperty("text-transform","capitalize")}
           else if ($tmp === 1) this.GetElementInputHandle().style.setProperty("text-transform","initial");
        };
        this.GetElementInputHandle().readOnly = this.IsReadOnly();
        if (this.FTextHint !== "") this.GetElementInputHandle().placeholder = this.FTextHint;
        doAc = true;
        if (this.GetIsLinked()) {
          doAc = !this.GetElementInputHandle().hasAttribute("autocomplete");
        };
        if (doAc) {
          if (this.FAutoCompletion === 52) {
            this.GetElementInputHandle().setAttribute("autocomplete","nope");
            if (!this.GetIsLinked()) this.GetElementInputHandle().removeAttribute("name");
          } else if (this.FAutoCompletion === 51) {
            this.GetElementInputHandle().setAttribute("autocomplete","off");
            if (!this.GetIsLinked()) this.GetElementInputHandle().removeAttribute("name");
          } else if (this.FAutoCompletion !== 0) {
            this.GetElementInputHandle().setAttribute("autocomplete","on");
            if (!this.GetIsLinked()) this.GetElementInputHandle().setAttribute("name",$mod.GetAutoCompletionName(this.FAutoCompletion));
          } else {
            this.GetElementInputHandle().removeAttribute("autocomplete");
            if (!this.GetIsLinked()) this.GetElementInputHandle().removeAttribute("name");
          };
        };
        if (!this.GetIsLinked()) {
          this.GetElementInputHandle().setAttribute("type",this.GetInputType());
          this.GetElementInputHandle().setAttribute("role","textbox");
          var $tmp1 = this.FAlignment;
          if ($tmp1 === 0) {
            this.GetElementInputHandle().style.removeProperty("text-align")}
           else if ($tmp1 === 2) {
            this.GetElementInputHandle().style.setProperty("text-align","center")}
           else if ($tmp1 === 1) this.GetElementInputHandle().style.setProperty("text-align","right");
        };
        if (this.FAutoFocus) {
          this.GetElementInputHandle().setAttribute("autofocus","")}
         else this.GetElementInputHandle().removeAttribute("autofocus");
        if (this.FRequired) {
          this.GetElementInputHandle().setAttribute("required","")}
         else this.GetElementInputHandle().removeAttribute("required");
        if (this.FPattern !== "") {
          this.GetElementInputHandle().setAttribute("pattern",this.FPattern)}
         else this.GetElementInputHandle().removeAttribute("pattern");
        if (this.FMaxLength <= 0) {
          this.GetElementInputHandle().removeAttribute("maxLength")}
         else this.GetElementInputHandle().maxLength = this.FMaxLength;
        this.GetElementInputHandle().value = this.GetDisplayText();
        isNum = pas.SysUtils.UpperCase(this.GetInputType()) === "NUMBER";
        if (!this.FSpellCheck) {
          this.GetElementInputHandle().setAttribute("spellcheck","false")}
         else this.GetElementInputHandle().removeAttribute("spellcheck");
        if (!isNum && !this.GetIsLinked() && !this.IsCustomEditor()) {
          ss = this.FSelStart;
          sl = this.FSelStart + this.FSelLength;
          eh = this.GetElementInputHandle();
          setTimeout(function() {
            eh.setSelectionRange(ss, sl);
          }, 1);
        };
      };
    };
    this.SetCharCase = function (AValue) {
      if (this.FCharCase !== AValue) {
        this.FCharCase = AValue;
        this.UpdateElement();
      };
    };
    this.SetMaxLength = function (AValue) {
      if (this.FMaxLength !== AValue) {
        this.FMaxLength = AValue;
        this.UpdateElementData();
      };
    };
    this.SetReadOnly = function (AValue) {
      if (this.FReadOnly !== AValue) {
        this.FReadOnly = AValue;
        this.UpdateElement();
      };
    };
    this.SetText = function (AValue) {
      this.FText = AValue;
      if (this.GetElementInputHandle() != null) {
        this.GetElementInputHandle().value = this.GetDisplayText();
        this.GetElementInputHandle().readOnly = this.IsReadOnly();
      };
    };
    this.SetTextHint = function (AValue) {
      this.FTextHint = AValue;
      this.UpdateElement();
    };
    this.CanPaste = function (AValue) {
      var Result = false;
      Result = true;
      return Result;
    };
    this.CanCut = function () {
      var Result = false;
      Result = true;
      return Result;
    };
    this.CreateInitialize = function () {
      $mod.TCustomInput.CreateInitialize.call(this);
      this.FAutoCompletion = 0;
      this.FEditType = 0;
      this.FText = "";
      this.FCharCase = 1;
      this.FMaxLength = 0;
      this.FReadOnly = false;
      this.FTextHint = "";
      this.FPasswordChar = "\x00";
      this.FSpellCheck = true;
      this.FAutoSelect = true;
      this.SetHeight(25);
    };
    this.Change = function () {
      if (this.GetElementHandle() != null) this.FText = this.GetElementInputHandle().value;
      if (this.FOnChange != null) this.FOnChange(this);
    };
    this.SelectAll = function () {
      if (this.GetElementInputHandle() != null) this.GetElementInputHandle().select();
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TEdit",this.TCustomEdit,function () {
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Alignment",2,pas.Classes.$rtti["TAlignment"],"FAlignment","SetAlignment");
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("AutoCompletion",2,$mod.$rtti["TAutoCompletion"],"FAutoCompletion","SetAutoCompletion",{Default: $mod.TAutoCompletion.acOff});
    $r.addProperty("AutoFocus",2,rtl.boolean,"FAutoFocus","SetAutoFocus",{Default: false});
    $r.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default: false});
    $r.addProperty("AutoSelect",2,rtl.boolean,"FAutoSelect","SetAutoSelect",{Default: true});
    $r.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti["TBiDiMode"],"FBiDiMode","SetBiDiMode",{Default: pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight});
    $r.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti["TBorderStyle"],"FBorderStyle","SetBorderStyle",{Default: pas["WEBLib.Controls"].TBorderStyle.bsSingle});
    $r.addProperty("CharCase",2,$mod.$rtti["TEditCharCase"],"FCharCase","SetCharCase",{Default: $mod.TEditCharCase.wecNormal});
    $r.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default: 0});
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("EditType",2,$mod.$rtti["TEditType"],"FEditType","SetEditType",{Default: $mod.TEditType.weString});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight");
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("Hint",2,rtl.string,"FHint","SetHint");
    $r.addProperty("HideSelection",2,rtl.boolean,"FHideSelection","SetHideSelection");
    $r.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("PasswordChar",2,rtl.char,"FPasswordChar","SetPasswordChar",{Default: "\x00"});
    $r.addProperty("Pattern",2,rtl.string,"FPattern","SetPattern");
    $r.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti["TMargins"],"FMargins","SetMargins");
    $r.addProperty("MaxLength",2,rtl.longint,"FMaxLength","SetMaxLength",{Default: 0});
    $r.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti["TPopupMenu"],"FPopupMenu","FPopupMenu");
    $r.addProperty("ReadOnly",2,rtl.boolean,"FReadOnly","SetReadOnly",{Default: false});
    $r.addProperty("Required",2,rtl.boolean,"FRequired","SetRequired",{Default: false});
    $r.addProperty("RequiredText",0,rtl.string,"FRequiredText","FRequiredText");
    $r.addProperty("ShowFocus",2,rtl.boolean,"FShowFocus","SetShowFocus",{Default: false});
    $r.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default: false});
    $r.addProperty("SpellCheck",2,rtl.boolean,"FSpellCheck","SetSpellCheck",{Default: true});
    $r.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder");
    $r.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default: true});
    $r.addProperty("Text",3,rtl.string,"GetText","SetText");
    $r.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti["TTextDirection"],"FTextDirection","FTextDirection",{Default: pas["WEBLib.Controls"].TTextDirection.tdDefault});
    $r.addProperty("TextHint",2,rtl.string,"FTextHint","SetTextHint");
    $r.addProperty("Top",3,rtl.longint,"GetTop","SetTop");
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth");
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnChange","FOnChange");
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti["TKeyEvent"],"FOnKeyDown","FOnKeyDown");
    $r.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti["TKeyPressEvent"],"FOnKeyPress","FOnKeyPress");
    $r.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti["TKeyEvent"],"FOnKeyUp","FOnKeyUp");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnEnter","FOnEnter");
    $r.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnExit","FOnExit");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
  rtl.createClass(this,"TButton",pas["WEBLib.Menus"].TWebCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Menus"].TWebCustomControl.$init.call(this);
      this.FModalResult = 0;
      this.FDefault = false;
      this.FCancel = false;
      this.FButtonType = "";
    };
    this.SetButtonType = function (Value) {
      this.FButtonType = Value;
      this.UpdateElementData();
    };
    this.SetDefault = function (Value) {
      this.FDefault = Value;
      if (this.FDefault) this.SetFocus();
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("BUTTON");
      Result.setAttribute("type","BUTTON");
      return Result;
    };
    this.SetCaption = function (AValue) {
      if (this.FCaption !== AValue) {
        pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,AValue);
        this.UpdateElementData();
      };
    };
    this.UpdateElementData = function () {
      var acc = "";
      pas["WEBLib.Controls"].TControl.UpdateElementData.call(this);
      if (this.GetIsLinked() && (this.FCaption === "")) return;
      if (this.GetElementHandle() != null) {
        if ((this.GetElementHandle().childElementCount === 0) || (pas.System.Pos("</",this.FCaption) > 0) || !this.GetIsLinked()) {
          this.GetElementHandle().innerHTML = pas["WEBLib.WebTools"].ProcessAccelerator(this.FCaption,{get: function () {
              return acc;
            }, set: function (v) {
              acc = v;
            }});
        };
        if (acc !== "") this.GetElementHandle().setAttribute("accesskey",acc);
        this.GetElementHandle().setAttribute("role","button");
        this.GetElementHandle().setAttribute("aria-label",this.FCaption);
        if (this.FButtonType !== "") {
          this.GetElementHandle().setAttribute("type",this.FButtonType)}
         else this.GetElementHandle().setAttribute("type","BUTTON");
      };
    };
    this.UpdateElementVisual = function () {
      var ecn = "";
      pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this);
      if (this.GetElementHandle() != null) {
        this.GetElementHandle().style.removeProperty("outline");
        this.GetElementHandle().style.removeProperty("user-select");
        ecn = pas.SysUtils.UpperCase(this.FElementClassName);
        if ((ecn === "BTN") || (pas.System.Pos("BTN ",ecn) > 0)) ;
      };
    };
    this.HandleKeyPreview = function (Key) {
      pas["WEBLib.Controls"].TControl.HandleKeyPreview.apply(this,arguments);
      if (this.FDefault && (Key === 13)) {
        this.Click();
      };
      if (this.FCancel && (Key === 27)) {
        this.Click();
      };
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      if ((4 in this.FComponentState) && (this.FCaption === "")) this.SetCaption(this.FName);
      this.SetColor(-1);
      this.FModalResult = 0;
    };
    this.Click = function () {
      var frm = null;
      pas["WEBLib.Controls"].TControl.Click.call(this);
      if (this.FModalResult !== 0) {
        frm = pas["WEBLib.Forms"].GetParentForm(this);
        if (frm != null) frm.SetModalResult(this.FModalResult);
      };
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("BiDiMode",2,pas["WEBLib.Controls"].$rtti["TBiDiMode"],"FBiDiMode","SetBiDiMode",{Default: pas["WEBLib.Controls"].TBiDiMode.bdLeftToRight});
    $r.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti["TBorderStyle"],"FBorderStyle","SetBorderStyle",{Default: pas["WEBLib.Controls"].TBorderStyle.bsSingle});
    $r.addProperty("ButtonType",2,rtl.string,"FButtonType","SetButtonType");
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("Cancel",0,rtl.boolean,"FCancel","FCancel",{Default: false});
    $r.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default: 0});
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("Default",2,rtl.boolean,"FDefault","SetDefault",{Default: false});
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight");
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("Hint",2,rtl.string,"FHint","SetHint");
    $r.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft");
    $r.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti["TMargins"],"FMargins","SetMargins");
    $r.addProperty("ModalResult",0,rtl.longint,"FModalResult","FModalResult",{Default: 0});
    $r.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti["TPopupMenu"],"FPopupMenu","FPopupMenu");
    $r.addProperty("Role",3,rtl.string,"GetRole","SetRole");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default: false});
    $r.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder");
    $r.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default: true});
    $r.addProperty("TextDirection",0,pas["WEBLib.Controls"].$rtti["TTextDirection"],"FTextDirection","FTextDirection",{Default: pas["WEBLib.Controls"].TTextDirection.tdDefault});
    $r.addProperty("Top",3,rtl.longint,"GetTop","SetTop");
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth");
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti["TKeyEvent"],"FOnKeyDown","FOnKeyDown");
    $r.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti["TKeyPressEvent"],"FOnKeyPress","FOnKeyPress");
    $r.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti["TKeyEvent"],"FOnKeyUp","FOnKeyUp");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnEnter","FOnEnter");
    $r.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnExit","FOnExit");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
  this.GetAutoCompletionName = function (aAutoCompletion) {
    var Result = "";
    var $tmp = aAutoCompletion;
    if ($tmp === 0) {
      Result = ""}
     else if ($tmp === 1) {
      Result = "honorific-prefix"}
     else if ($tmp === 2) {
      Result = "given-name"}
     else if ($tmp === 3) {
      Result = "additional-name"}
     else if ($tmp === 4) {
      Result = "family-name"}
     else if ($tmp === 5) {
      Result = "honorific-suffix"}
     else if ($tmp === 6) {
      Result = "nickname"}
     else if ($tmp === 7) {
      Result = "email"}
     else if ($tmp === 8) {
      Result = "username"}
     else if ($tmp === 9) {
      Result = "new-password"}
     else if ($tmp === 10) {
      Result = "current-password"}
     else if ($tmp === 11) {
      Result = "organization-title"}
     else if ($tmp === 12) {
      Result = "organization"}
     else if ($tmp === 13) {
      Result = "street-address"}
     else if ($tmp === 14) {
      Result = "address-line1"}
     else if ($tmp === 15) {
      Result = "address-line2"}
     else if ($tmp === 16) {
      Result = "address-line3"}
     else if ($tmp === 17) {
      Result = "address-level1"}
     else if ($tmp === 18) {
      Result = "address-level2"}
     else if ($tmp === 19) {
      Result = "address-level3"}
     else if ($tmp === 20) {
      Result = "address-level4"}
     else if ($tmp === 21) {
      Result = "country"}
     else if ($tmp === 22) {
      Result = "country-name"}
     else if ($tmp === 23) {
      Result = "postal-code"}
     else if ($tmp === 24) {
      Result = "cc-name"}
     else if ($tmp === 25) {
      Result = "cc-given-name"}
     else if ($tmp === 26) {
      Result = "cc-additional-name"}
     else if ($tmp === 27) {
      Result = "cc-family-name"}
     else if ($tmp === 28) {
      Result = "cc-number"}
     else if ($tmp === 29) {
      Result = "cc-exp"}
     else if ($tmp === 30) {
      Result = "cc-exp-month"}
     else if ($tmp === 31) {
      Result = "cc-exp-year"}
     else if ($tmp === 32) {
      Result = "cc-csc"}
     else if ($tmp === 33) {
      Result = "cc-type"}
     else if ($tmp === 34) {
      Result = "transaction-currency"}
     else if ($tmp === 35) {
      Result = "transaction-amount"}
     else if ($tmp === 36) {
      Result = "language"}
     else if ($tmp === 37) {
      Result = "bday"}
     else if ($tmp === 38) {
      Result = "bday-day"}
     else if ($tmp === 39) {
      Result = "bday-month"}
     else if ($tmp === 40) {
      Result = "bday-year"}
     else if ($tmp === 41) {
      Result = "sex"}
     else if ($tmp === 42) {
      Result = "tel"}
     else if ($tmp === 43) {
      Result = "tel-country-code"}
     else if ($tmp === 44) {
      Result = "tel-national"}
     else if ($tmp === 45) {
      Result = "tel-area-code"}
     else if ($tmp === 46) {
      Result = "tel-local"}
     else if ($tmp === 47) {
      Result = "tel-extension"}
     else if ($tmp === 48) {
      Result = "impp"}
     else if ($tmp === 49) {
      Result = "url"}
     else if ($tmp === 50) {
      Result = "photo"}
     else if ($tmp === 52) Result = "nope";
    return Result;
  };
});
rtl.module("WEBLib.ExtCtrls",["System","Classes","SysUtils","Types","WEBLib.Controls","WEBLib.StdCtrls","WEBLib.Graphics","Web","JS","WEBLib.WebTools","WEBLib.Menus","WEBLib.REST"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TTimer",pas.Classes.TComponent,function () {
    this.$init = function () {
      pas.Classes.TComponent.$init.call(this);
      this.FInterval = 0;
      this.FTimerID = 0;
      this.FOnTimer = null;
      this.FEnabled = false;
    };
    this.$final = function () {
      this.FOnTimer = undefined;
      pas.Classes.TComponent.$final.call(this);
    };
    this.SetEnabled = function (Value) {
      this.FEnabled = Value;
      this.DoUpdateTimer();
    };
    this.SetInterval = function (AValue) {
      this.FInterval = AValue;
      this.DoUpdateTimer();
    };
    this.DoTimer = function () {
      if (this.FOnTimer != null) this.FOnTimer(this);
    };
    this.DoUpdateTimer = function () {
      this.DoClearTimer();
      if (this.FEnabled) this.FTimerID = window.setInterval(rtl.createSafeCallback(this,"DoTimer"),this.FInterval);
    };
    this.DoClearTimer = function () {
      if (this.FTimerID !== -1) {
        window.clearInterval(this.FTimerID);
        this.FTimerID = -1;
      };
    };
    this.Create$1 = function (AOwner) {
      pas.Classes.TComponent.Create$1.apply(this,arguments);
      this.FInterval = 1000;
      this.FTimerID = -1;
      this.SetEnabled(true);
      return this;
    };
    this.Destroy = function () {
      this.DoClearTimer();
      pas.Classes.TComponent.Destroy.call(this);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("Interval",2,rtl.longint,"FInterval","SetInterval",{Default: 1000});
    $r.addProperty("OnTimer",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnTimer","FOnTimer");
  });
  rtl.createClass(this,"TCustomPanel",pas["WEBLib.Menus"].TWebCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Menus"].TWebCustomControl.$init.call(this);
      this.FAutoSize = false;
      this.FIsSizing = false;
      this.FPadding = null;
      this.FShowCaption = false;
      this.FLabel = null;
      this.FPanelBody = null;
      this.FElementBodyClassName = "";
      this.FAlignment = 0;
    };
    this.$final = function () {
      this.FPadding = undefined;
      this.FLabel = undefined;
      this.FPanelBody = undefined;
      pas["WEBLib.Menus"].TWebCustomControl.$final.call(this);
    };
    this.SetShowCaption = function (Value) {
      if (this.FShowCaption !== Value) {
        this.FShowCaption = Value;
        this.UpdateElementVisual();
      };
    };
    this.SetPadding = function (Value) {
      this.FPadding.Assign(Value);
    };
    this.SetAlignment = function (Value) {
      if (this.FAlignment !== Value) {
        this.FAlignment = Value;
        this.UpdateElement();
      };
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("SPAN");
      this.FPanelBody = document.createElement("DIV");
      this.FPanelBody.setAttribute("class","card-body");
      Result.appendChild(this.FPanelBody);
      return Result;
    };
    this.SetCaption = function (AValue) {
      pas["WEBLib.Controls"].TCustomControl.SetCaption.call(this,AValue);
      if ((this.GetElementHandle() != null) && this.FShowCaption) {
        if (!(this.FLabel != null)) {
          this.FLabel = document.createElement("SPAN");
          this.FLabel.innerHTML = this.FCaption;
          if (this.GetChildContainer() != null) {
            this.GetChildContainer().appendChild(this.FLabel)}
           else this.GetElementHandle().appendChild(this.FLabel);
          this.UpdateElementVisual();
        } else {
          this.FLabel.innerHTML = this.FCaption;
        };
      };
    };
    this.SetBorderStyle = function (AValue) {
      pas["WEBLib.Controls"].TCustomControl.SetBorderStyle.apply(this,arguments);
      this.UpdateElement();
    };
    this.SetAutoSize = function (AValue) {
      this.FAutoSize = AValue;
      if (this.FAutoSize && !this.IsUpdating()) {
        this.DoAutoSize();
      };
    };
    this.UpdateElementVisual = function () {
      pas["WEBLib.Controls"].TCustomControl.UpdateElementVisual.call(this);
      if (this.GetElementHandle() != null) {
        if (!this.GetIsLinked()) {
          if (this.FAutoSize) {
            this.GetElementHandle().style.setProperty("overflow","");
            this.GetElementHandle().style.setProperty("white-space","normal");
            if (this.FVisible) this.GetElementHandle().style.setProperty("display","inline");
          } else {
            this.GetElementHandle().style.setProperty("overflow","hidden");
            this.GetElementHandle().style.setProperty("white-space","nowrap");
            if (this.FVisible) this.GetElementHandle().style.setProperty("display","inline-block");
          };
          this.GetElementHandle().style.setProperty("padding-left",pas.SysUtils.IntToStr(this.FPadding.FLeft) + "px");
          this.GetElementHandle().style.setProperty("padding-right",pas.SysUtils.IntToStr(this.FPadding.FRight) + "px");
          this.GetElementHandle().style.setProperty("padding-top",pas.SysUtils.IntToStr(this.FPadding.FTop) + "px");
          this.GetElementHandle().style.setProperty("padding-bottom",pas.SysUtils.IntToStr(this.FPadding.FBottom) + "px");
          this.GetElementHandle().style.setProperty("box-sizing","border-box");
          if (this.FElementBodyClassName !== "") {
            this.GetChildContainer().setAttribute("class",this.FElementBodyClassName)}
           else this.GetChildContainer().removeAttribute("class");
        };
        if (this.FLabel != null) {
          if (this.FShowCaption) {
            this.FLabel.innerHTML = this.FCaption}
           else this.FLabel.innerHTML = "";
          if (this.FVisible) {
            this.GetElementHandle().style.setProperty("display","flex");
            var $tmp = this.FAlignment;
            if ($tmp === 0) {
              this.GetElementHandle().style.setProperty("justify-content","flex-start")}
             else if ($tmp === 2) {
              this.GetElementHandle().style.setProperty("justify-content","center")}
             else if ($tmp === 1) this.GetElementHandle().style.setProperty("justify-content","flex-end");
            this.GetElementHandle().style.setProperty("align-items","center");
          };
        };
        this.GetElementHandle().style.setProperty("user-select","");
        if (this.FCursor === 0) this.GetElementHandle().style.setProperty("cursor","");
      };
    };
    this.GetOuterWidth = function () {
      var Result = 0;
      Result = pas["WEBLib.Controls"].TControl.GetOuterWidth.call(this);
      return Result;
    };
    this.GetOuterHeight = function () {
      var Result = 0;
      Result = pas["WEBLib.Controls"].TControl.GetOuterHeight.call(this);
      return Result;
    };
    this.GetChildContainer = function () {
      var Result = null;
      if (this.FPanelBody != null) {
        Result = this.FPanelBody}
       else Result = pas["WEBLib.Controls"].TControl.GetChildContainer.call(this);
      return Result;
    };
    this.RegisterParent = function (AValue) {
      pas["WEBLib.Controls"].TControl.RegisterParent.apply(this,arguments);
      if (this.FAutoSize) this.DoAutoSize();
    };
    this.UnRegisterParent = function (AValue) {
      pas["WEBLib.Controls"].TControl.UnRegisterParent.apply(this,arguments);
      if (this.FAutoSize) this.DoAutoSize();
    };
    this.DoAutoSize = function () {
      var i = 0;
      var minx = 0;
      var miny = 0;
      var maxx = 0;
      var maxy = 0;
      var r = null;
      var el = null;
      if (this.FIsSizing) return;
      this.FIsSizing = true;
      if ((this.FWidthStyle === 1) && (this.FHeightStyle === 1)) {
        maxx = 0;
        maxy = 0;
        minx = 0xFFFF;
        miny = 0xFFFF;
        for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
          i = $l;
          if (this.GetControls(i).FWidthStyle === 1) {
            if ((this.GetControls(i).GetLeft() + this.GetControls(i).GetWidth()) > maxx) maxx = this.GetControls(i).GetLeft() + this.GetControls(i).GetWidth();
            if (this.GetControls(i).GetLeft() < minx) minx = this.GetControls(i).GetLeft();
          } else {
            el = this.GetControls(i).GetElementHandle();
            if (el != null) {
              r = el.getBoundingClientRect();
              if (((r.x - this.GetLeft()) + r.width) > maxx) maxx = Math.round((r.x - this.GetLeft()) + r.width);
              minx = 0;
            };
          };
          if (this.GetControls(i).FHeightStyle === 1) {
            if ((this.GetControls(i).GetTop() + this.GetControls(i).GetHeight()) > maxy) maxy = this.GetControls(i).GetTop() + this.GetControls(i).GetHeight();
            if (this.GetControls(i).GetTop() < miny) miny = this.GetControls(i).GetTop();
          } else {
            el = this.GetControls(i).GetElementHandle();
            if (el != null) {
              r = el.getBoundingClientRect();
              if (((r.y - this.GetTop()) + r.height) > maxy) maxy = Math.round((r.y - this.GetTop()) + r.height);
              miny = 0;
            };
          };
        };
        if (4 in this.FComponentState) {
          if ((this.GetControlsCount() === 0) || (maxx === 0) || (maxy === 0)) return;
        };
        if (this.FBorderStyle === 1) {
          maxx += 1;
          maxy += 1;
        };
        for (var $l1 = 0, $end1 = this.GetControlsCount() - 1; $l1 <= $end1; $l1++) {
          i = $l1;
          this.GetControls(i).SetLeft(this.GetControls(i).GetLeft() - minx);
          this.GetControls(i).SetTop(this.GetControls(i).GetTop() - miny);
        };
        this.SetWidth(maxx - minx);
        this.SetHeight(maxy - miny);
      } else {
        this.SetWidth(-1);
        this.SetHeight(-1);
      };
      this.UpdateElement();
      this.FIsSizing = false;
    };
    this.AlignControl = function (AControl) {
      pas["WEBLib.Controls"].TControl.AlignControl.apply(this,arguments);
      if (this.FAutoSize) this.DoAutoSize();
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      if (4 in this.FComponentState) this.FEnablePropagation = true;
      this.FAutoSize = false;
      this.FAlignment = 2;
      this.SetColor(15790320);
      this.SetTabStop(false);
      this.FCustomBorder = true;
      this.SetShowCaption(true);
      this.FControlStyle = rtl.unionSet(this.FControlStyle,rtl.createSet(0));
      this.FLabel = null;
      this.FPadding = pas["WEBLib.Controls"].TPadding.$create("Create$1");
      if (4 in this.FComponentState) {
        this.SetWidth(400);
        this.SetHeight(300);
      };
    };
    this.Destroy = function () {
      rtl.free(this,"FPadding");
      pas["WEBLib.Controls"].TCustomControl.Destroy.call(this);
    };
    this.EndUpdate = function () {
      pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this);
      if (this.FAutoSize) this.SetAutoSize(true);
    };
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TPanel",this.TCustomPanel,function () {
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("Alignment",2,pas.Classes.$rtti["TAlignment"],"FAlignment","SetAlignment",{Default: pas.Classes.TAlignment.taCenter});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("AutoSize",2,rtl.boolean,"FAutoSize","SetAutoSize",{Default: false});
    $r.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FBorderColor","SetBorderColor",{Default: 12632256});
    $r.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti["TBorderStyle"],"FBorderStyle","SetBorderStyle",{Default: pas["WEBLib.Controls"].TBorderStyle.bsSingle});
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default: 0});
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("ElementBodyClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementBodyClassName","FElementBodyClassName");
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti["TMargins"],"FMargins","SetMargins");
    $r.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti["TPadding"],"FPadding","SetPadding");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti["TPopupMenu"],"FPopupMenu","FPopupMenu");
    $r.addProperty("Role",3,rtl.string,"GetRole","SetRole");
    $r.addProperty("ShowCaption",2,rtl.boolean,"FShowCaption","SetShowCaption",{Default: true});
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
},["WEBLib.Utils"]);
rtl.module("WEBLib.Buttons",["System","Classes","SysUtils","WEBLib.Controls","Web","WEBLib.Graphics","WEBLib.StdCtrls","WEBLib.ComCtrls","WEBLib.ExtCtrls","WEBLib.Forms","WEBLib.Menus"],function () {
  "use strict";
  var $mod = this;
  this.TToggleButtonStyle = {"0": "tsRectangular", tsRectangular: 0, "1": "tsRounded", tsRounded: 1};
  this.$rtti.$Enum("TToggleButtonStyle",{minvalue: 0, maxvalue: 1, ordtype: 1, enumtype: this.TToggleButtonStyle});
  rtl.createClass(this,"TToggleButton",pas["WEBLib.Controls"].TCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Controls"].TCustomControl.$init.call(this);
      this.FChecked = false;
      this.FLabel = null;
      this.FInput = null;
      this.FSlider = null;
      this.FStyle = 0;
    };
    this.$final = function () {
      this.FLabel = undefined;
      this.FInput = undefined;
      this.FSlider = undefined;
      pas["WEBLib.Controls"].TCustomControl.$final.call(this);
    };
    this.SetStyle = function (Value) {
      if (this.FStyle !== Value) {
        this.FStyle = Value;
        this.UpdateElement();
      };
    };
    this.GetChecked = function () {
      var Result = false;
      if (this.GetContainer() != null) this.FChecked = this.FInput.checked;
      Result = this.FChecked;
      return Result;
    };
    this.SetChecked = function (Value) {
      this.FChecked = Value;
      this.UpdateElement();
    };
    this.HandleDoClick = function (Event) {
      var Result = false;
      this.FElementEvent = Event;
      this.StopPropagation();
      if (Event.target === this.FInput) {
        if (this.FOnClick != null) this.FOnClick(this);
      };
      Result = true;
      this.FElementEvent = null;
      return Result;
    };
    this.UpdateElement = function () {
      pas["WEBLib.Controls"].TControl.UpdateElement.call(this);
      if (!this.IsUpdating()) {
        this.InjectCSS();
        this.FLabel.setAttribute("class","switch");
        this.FInput.checked = this.FChecked;
        if (this.FStyle === 0) {
          this.FSlider.setAttribute("class","slider")}
         else this.FSlider.setAttribute("class","slider round");
      };
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("span");
      this.FLabel = document.createElement("label");
      this.FInput = document.createElement("input");
      this.FSlider = document.createElement("span");
      this.FInput.setAttribute("type","checkbox");
      Result.appendChild(this.FLabel);
      this.FLabel.appendChild(this.FInput);
      this.FLabel.appendChild(this.FSlider);
      return Result;
    };
    this.Loaded = function () {
      pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);
    };
    this.CreateInitialize = function () {
      var css = "";
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      css = ".switch {" + "position: relative;" + "display: inline-block;" + "width: 44px;" + "height: 22px;" + "}" + ".switch input {display:none;}" + ".slider {" + "position: absolute;" + "cursor: pointer;" + "top: 0;" + "left: 0;" + "right: 0;" + "bottom: 0;" + "background-color: #ccc;" + "-webkit-transition: .4s;" + "transition: .4s;" + "}" + ".slider:before {" + "position: absolute;" + 'content: "";' + "height: 14px;" + "width: 14px;" + "left: 4px;" + "bottom: 4px;" + "background-color: white;" + "-webkit-transition: .4s;" + "transition: .4s;" + "}" + "input:checked + .slider {" + "background-color: #2196F3;" + "}" + "input:focus + .slider {" + "box-shadow: 0 0 1px #2196F3;" + "}" + "input:checked + .slider:before {" + "-webkit-transform: translateX(22px);" + "-ms-transform: translateX(22px);" + "transform: translateX(22px);" + "}" + "/* Rounded sliders */" + ".slider.round {" + "border-radius: 22px;" + "}" + ".slider.round:before {" + "border-radius: 50%;" + "}";
      this.AddControlStyle(css);
      this.SetWidth(48);
      this.SetHeight(24);
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("Checked",3,rtl.boolean,"GetChecked","SetChecked");
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Style",2,$mod.$rtti["TToggleButtonStyle"],"FStyle","SetStyle",{Default: $mod.TToggleButtonStyle.tsRectangular});
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnEnter","FOnEnter");
    $r.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnExit","FOnExit");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
},["WEBLib.WebTools","Math"]);
rtl.module("WEBLib.ComCtrls",["System","Classes","SysUtils","Web","WEBLib.Controls","WEBLib.Graphics","WEBLib.ExtCtrls","WEBLib.Menus"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TTabSheet",pas["WEBLib.ExtCtrls"].TCustomPanel,function () {
    this.$init = function () {
      pas["WEBLib.ExtCtrls"].TCustomPanel.$init.call(this);
      this.FTabVisible = false;
      this.FPosUpdating = false;
      this.FOnShow = null;
      this.FOnHide = null;
      this.FMaterialGlyph = "";
      this.FMaterialGlyphColor = 0;
      this.FMaterialGlyphType = 0;
      this.FMaterialGlyphSize = 0;
    };
    this.$final = function () {
      this.FOnShow = undefined;
      this.FOnHide = undefined;
      pas["WEBLib.ExtCtrls"].TCustomPanel.$final.call(this);
    };
    this.SetTabVisible = function (Value) {
      if (this.FTabVisible !== Value) {
        this.FTabVisible = Value;
        if (this.FParent != null) {
          if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
        };
      };
    };
    this.GetPageIndex = function () {
      var Result = 0;
      var i = 0;
      var j = 0;
      var FPageControl = null;
      Result = -1;
      if ($mod.TPageControl.isPrototypeOf(this.FParent)) {
        FPageControl = rtl.as(this.FParent,$mod.TPageControl);
        j = 0;
        for (var $l = 0, $end = FPageControl.GetControlsCount() - 1; $l <= $end; $l++) {
          i = $l;
          if ($mod.TTabSheet.isPrototypeOf(FPageControl.GetControls(i))) {
            if (FPageControl.GetControls(i) === this) {
              Result = j;
            } else j += 1;
          };
        };
      };
      return Result;
    };
    this.SetPageIndex = function (Value) {
    };
    this.SetMaterialGlyph = function (Value) {
      if (this.FMaterialGlyph !== Value) {
        this.FMaterialGlyph = Value;
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
      };
    };
    this.SetMaterialGlyphColor = function (Value) {
      if (this.FMaterialGlyphColor !== Value) {
        this.FMaterialGlyphColor = Value;
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
      };
    };
    this.SetMaterialGlyphSize = function (Value) {
      if (this.FMaterialGlyphSize !== Value) {
        this.FMaterialGlyphSize = Value;
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
      };
    };
    this.SetMaterialGlyphType = function (Value) {
      if (this.FMaterialGlyphType !== Value) {
        this.FMaterialGlyphType = Value;
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
      };
    };
    this.SetCaption = function (AValue) {
      pas["WEBLib.ExtCtrls"].TCustomPanel.SetCaption.apply(this,arguments);
      if (this.FParent != null) {
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
      };
    };
    this.SetParent = function (AValue) {
      if ($mod.TTabSheet.isPrototypeOf(AValue)) {
        if ($mod.TPageControl.isPrototypeOf(rtl.as(AValue,$mod.TTabSheet).FParent)) AValue = rtl.as(AValue,$mod.TTabSheet).FParent;
      };
      pas["WEBLib.Controls"].TControl.SetParent.call(this,AValue);
      if (this.FParent != null) {
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) {
          rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
        };
      };
    };
    this.ResetUpdate = function () {
      pas["WEBLib.ExtCtrls"].TCustomPanel.EndUpdate.call(this);
    };
    this.CreateInitialize = function () {
      pas["WEBLib.ExtCtrls"].TCustomPanel.CreateInitialize.call(this);
      this.FEnablePropagation = true;
      this.FControlStyle = rtl.unionSet(this.FControlStyle,rtl.createSet(0));
      this.SetColor(16777215);
      this.SetTabVisible(true);
      this.SetShowCaption(false);
      this.FPosUpdating = false;
      this.FMaterialGlyphSize = 18;
      this.FMaterialGlyphType = 0;
      this.FMaterialGlyphColor = -1;
    };
    this.EndUpdate = function () {
      pas["WEBLib.ExtCtrls"].TCustomPanel.EndUpdate.call(this);
      if (this.FParent != null) {
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) rtl.as(this.FParent,$mod.TPageControl).DoUpdateList();
      };
    };
    this.Destroy = function () {
      var p = null;
      p = null;
      if (this.FParent != null) {
        if ($mod.TPageControl.isPrototypeOf(this.FParent)) {
          p = rtl.as(this.FParent,$mod.TPageControl);
        };
      };
      pas["WEBLib.ExtCtrls"].TCustomPanel.Destroy.call(this);
      if (p != null) {
        p.DoUpdateList();
        p.SetTabIndex(0);
      };
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Alignment",2,pas.Classes.$rtti["TAlignment"],"FAlignment","SetAlignment",{Default: pas.Classes.TAlignment.taCenter});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("BorderColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FBorderColor","SetBorderColor",{Default: 12632256});
    $r.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti["TBorderStyle"],"FBorderStyle","SetBorderStyle",{Default: pas["WEBLib.Controls"].TBorderStyle.bsSingle});
    $r.addProperty("Caption",2,rtl.string,"FCaption","SetCaption");
    $r.addProperty("Color",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FColor","SetColor");
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("ElementBodyClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementBodyClassName","FElementBodyClassName");
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti["TMargins"],"FMargins","SetMargins");
    $r.addProperty("MaterialGlyph",2,rtl.string,"FMaterialGlyph","SetMaterialGlyph");
    $r.addProperty("MaterialGlyphColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FMaterialGlyphColor","SetMaterialGlyphColor",{Default: -1});
    $r.addProperty("MaterialGlyphSize",2,rtl.longint,"FMaterialGlyphSize","SetMaterialGlyphSize",{Default: 18});
    $r.addProperty("MaterialGlyphType",2,pas["WEBLib.Controls"].$rtti["TMaterialGlyphType"],"FMaterialGlyphType","SetMaterialGlyphType",{Default: pas["WEBLib.Controls"].TMaterialGlyphType.mgNormal});
    $r.addProperty("Padding",2,pas["WEBLib.Controls"].$rtti["TPadding"],"FPadding","SetPadding");
    $r.addProperty("PageIndex",7,rtl.longint,"GetPageIndex","SetPageIndex");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("Role",3,rtl.string,"GetRole","SetRole");
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("TabVisible",2,rtl.boolean,"FTabVisible","SetTabVisible",{Default: true});
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnHide",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnHide","FOnHide");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnShow",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnShow","FOnShow");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
  rtl.createClass(this,"TWebTabSheet",this.TTabSheet,function () {
    rtl.addIntf(this,pas.System.IUnknown);
  });
  rtl.createClass(this,"TPageControl",pas["WEBLib.Menus"].TWebCustomControl,function () {
    this.$init = function () {
      pas["WEBLib.Menus"].TWebCustomControl.$init.call(this);
      this.FDesignTime = false;
      this.FPrevTabIndex = 0;
      this.FItems = null;
      this.FTabIndex = 0;
      this.FSelectedColor = 0;
      this.FOnChange = null;
      this.FSelectedTextColor = 0;
      this.FShowTabs = false;
      this.FOldVisible = false;
      this.FElementTabActiveClassName = "";
      this.FElementTabClassName = "";
      this.FElementTabItemClassName = "";
    };
    this.$final = function () {
      this.FItems = undefined;
      this.FOnChange = undefined;
      pas["WEBLib.Menus"].TWebCustomControl.$final.call(this);
    };
    this.SetSelectedColor = function (AValue) {
      if (this.FSelectedColor !== AValue) {
        this.FSelectedColor = AValue;
        this.DoUpdateList();
      };
    };
    this.SetTabIndex = function (AIndex) {
      if (0 in this.FComponentState) this.FTabIndex = AIndex;
      if ((this.FTabIndex !== AIndex) && (AIndex >= 0) && (AIndex < this.PageCount())) {
        this.FTabIndex = AIndex;
        this.FPrevTabIndex = this.FTabIndex;
        this.DoUpdateList();
      };
    };
    this.SetActivePageIndex = function (Value) {
      if ((Value >= 0) && (Value < this.PageCount())) this.SetTabIndex(Value);
    };
    this.SetSelectedTextColor = function (Value) {
      if (this.FSelectedTextColor !== Value) {
        this.FSelectedTextColor = Value;
        this.DoUpdateList();
      };
    };
    this.SetActivePage = function (Value) {
      var i = 0;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (this.GetControls(i) === Value) {
          this.SetActivePageIndex(i);
          break;
        };
      };
    };
    this.SetShowTabs = function (Value) {
      if (this.FShowTabs !== Value) {
        this.FShowTabs = Value;
        this.DoUpdateList();
      };
    };
    this.GetPage = function (Index) {
      var Result = null;
      var c = 0;
      var i = 0;
      c = -1;
      Result = null;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i))) c += 1;
        if (c === Index) {
          Result = rtl.as(this.GetControls(i),$mod.TTabSheet);
          break;
        };
      };
      return Result;
    };
    this.CreateElement = function () {
      var Result = null;
      Result = document.createElement("SPAN");
      return Result;
    };
    this.HandleDoClick = function (Event) {
      var Result = false;
      var sid = "";
      var cid = "";
      var i = 0;
      var el = null;
      var ts = null;
      el = Event.target;
      sid = "";
      if (el.hasAttribute("id")) sid = el.getAttribute("id");
      if (sid !== "") {
        cid = this.GetID();
        if (cid === "") cid = this.FName;
        sid = pas.SysUtils.StringReplace(sid,cid + "_","",{});
        if (pas.SysUtils.TryStrToInt(sid,{get: function () {
            return i;
          }, set: function (v) {
            i = v;
          }})) {
          if (this.FTabIndex !== -1) {
            ts = this.GetPage(this.FTabIndex);
            if ((ts != null) && (ts.FOnHide != null)) ts.FOnHide(ts);
          };
          this.FTabIndex = i;
          this.DoUpdateList();
          if (this.FTabIndex !== -1) {
            ts = this.GetPage(this.FTabIndex);
            if ((ts != null) && (ts.FOnShow != null)) ts.FOnShow(ts);
          };
        };
        pas["WEBLib.Controls"].TControl.HandleDoClick.apply(this,arguments);
      };
      Result = true;
      return Result;
    };
    this.HandleDoChange = function (Event) {
      var Result = false;
      if (this.FPrevTabIndex !== this.FTabIndex) {
        this.FPrevTabIndex = this.FTabIndex;
        if (this.FOnChange != null) this.FOnChange(this);
      };
      Result = true;
      return Result;
    };
    this.CanAcceptChild = function (AValue) {
      var Result = null;
      Result = pas["WEBLib.Controls"].TControl.CanAcceptChild.apply(this,arguments);
      if ((AValue != null) && !$mod.TTabSheet.isPrototypeOf(AValue)) {
        Result = this.FParent;
      };
      return Result;
    };
    this.BindEvents = function () {
      pas["WEBLib.Controls"].TCustomControl.BindEvents.call(this);
      if (this.GetElementHandle() != null) {
        this.GetElementHandle().onclick = rtl.createSafeCallback(this,"HandleDoChange");
      };
    };
    this.UpdateElement = function () {
      pas["WEBLib.Controls"].TControl.UpdateElement.call(this);
    };
    this.DoUpdateList = function () {
      var i = 0;
      var vistabindex = 0;
      var s = "";
      var cid = "";
      var shidden = "";
      var n = null;
      var ul = null;
      var li = null;
      var a = null;
      var tabs = null;
      var tab = null;
      var LLabel = null;
      var LHasLabel = false;
      var matclr = "";
      var icn = "";
      var noptr = "";
      var inactive = "";
      var th = 0;
      if (!(this.GetContainer() != null)) return;
      if (!(this.GetElementHandle() != null) || this.IsUpdating()) return;
      tab = null;
      if (this.GetControlsCount() > 0) {
        this.SetBorderStyle(0);
        LLabel = this.GetElementHandle().firstChild;
        LHasLabel = (LLabel != null) && (LLabel.tagName === "DIV") && (LLabel.getAttribute("data-design") === "1");
        if (LHasLabel) {
          this.GetElementHandle().removeChild(this.GetElementHandle().firstChild);
          this.GetElementHandle().style.removeProperty("border");
        };
        tabs = pas.Classes.TStringList.$create("Create$1");
        shidden = "{#hidden#}";
        vistabindex = this.FTabIndex;
        for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
          i = $l;
          if ((3 in this.GetControls(i).FComponentState) && (i <= this.FTabIndex)) vistabindex += 1;
          if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i)) && !(3 in this.GetControls(i).FComponentState)) {
            tab = this.GetControls(i);
            icn = "";
            if (tab.FTabVisible) {
              if (tab.FMaterialGlyph !== "") {
                matclr = "";
                inactive = "";
                if (!tab.FEnabled) inactive = " md-light md-inactive";
                if (tab.FMaterialGlyphColor !== -1) matclr = ";color:" + pas["WEBLib.Graphics"].ColorToHTML(tab.FMaterialGlyphColor);
                noptr = "pointer-events:none";
                icn = '<i class="' + pas["WEBLib.Controls"].GetMaterialClass(tab.FMaterialGlyphType) + inactive + '" style="' + noptr + ";font-size:" + pas.SysUtils.IntToStr(tab.FMaterialGlyphSize) + "px" + matclr + '">' + tab.FMaterialGlyph + "</i>&nbsp;";
              };
              tabs.Add(icn + tab.FCaption);
            } else tabs.Add(shidden);
            tab.BeginUpdate();
            if (vistabindex === i) {
              tab.SetAlign(5)}
             else tab.SetAlign(0);
            tab.SetAlignWithMargins(true);
            tab.FMargins.SetLeft(0);
            tab.FMargins.SetRight(0);
            tab.FMargins.SetBottom(0);
            tab.SetBorderStyle(1);
            tab.SetVisible(vistabindex === i);
            tab.ResetUpdate();
            if (vistabindex === i) tab.GetElementHandle().parentElement.insertBefore(tab.GetElementHandle(),null);
            tab.GetElementHandle().style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(tab.FColor));
          };
        };
        cid = this.GetID();
        if (cid === "") cid = this.FName;
        for (var $l1 = 0, $end1 = this.GetContainer().childNodes.length - 1; $l1 <= $end1; $l1++) {
          i = $l1;
          n = this.GetContainer().childNodes.item(i);
          if ((n != null) && (n.getAttribute("id") === (cid + "_UL"))) this.GetContainer().removeChild(n);
        };
        this.GetContainer().setAttribute("class","");
        if (!this.FEnabled) {
          this.GetElementHandle().style.setProperty("pointer-events","none")}
         else this.GetElementHandle().style.setProperty("pointer-events","auto");
        ul = document.createElement("UL");
        ul.setAttribute("class",this.FElementClassName);
        ul.setAttribute("id",cid + "_UL");
        if (this.FElementClassName !== "") {
          ul.setAttribute("role","tablist")}
         else {
          ul.style.setProperty("list-style-type","none");
          ul.style.setProperty("margin","0");
          ul.style.setProperty("padding","0");
          ul.style.setProperty("display","inline-block");
        };
        if (!this.FShowTabs) ul.style.setProperty("display","none");
        this.GetContainer().appendChild(ul);
        for (var $l2 = 0, $end2 = tabs.GetCount() - 1; $l2 <= $end2; $l2++) {
          i = $l2;
          s = tabs.Get(i);
          if (s !== shidden) {
            if (s === "") s = "tab" + pas.SysUtils.IntToStr(i);
            li = document.createElement("LI");
            if (this.FElementClassName !== "") {
              if (this.FElementTabItemClassName === "") {
                li.setAttribute("class","nav-item")}
               else li.setAttribute("class",this.FElementTabItemClassName);
            } else {
              li.style.setProperty("float","left");
              if (this.FBorderStyle !== 0) li.style.setProperty("border-bottom","1px solid lightgray");
            };
            if (this.FDragMode === 1) li.setAttribute("draggable","true");
            pas["WEBLib.Controls"].SetHTMLElementFont(li,this.FFont,!((this.FElementClassName === "") && (this.FElementFont === 0)));
            ul.appendChild(li);
            if (!this.FEnabled) {
              a = document.createElement("SPAN")}
             else {
              a = document.createElement("A");
              a.setAttribute("href","#" + s);
            };
            if (this.FDragMode === 1) a.setAttribute("draggable","false");
            a.innerHTML = s;
            a.setAttribute("id",cid + "_" + pas.SysUtils.IntToStr(i));
            if (this.FElementClassName !== "") {
              if (this.FTabIndex === i) {
                if (this.FElementTabActiveClassName === "") {
                  a.setAttribute("class","nav-link active")}
                 else a.setAttribute("class",this.FElementTabActiveClassName);
              } else {
                if (this.FElementTabClassName === "") {
                  a.setAttribute("class","nav-link")}
                 else a.setAttribute("class",this.FElementTabClassName);
              };
              a.setAttribute("role","tab");
              a.setAttribute("data-toggle","tab");
              a.setAttribute("aria-controls",s);
              if (this.FTabIndex === i) {
                a.setAttribute("aria-selected","true")}
               else a.setAttribute("aria-selected","false");
            } else {
              a.style.setProperty("display","block");
              a.style.setProperty("text-align","center");
              a.style.setProperty("padding","3px 15px");
              a.style.setProperty("text-decoration","none");
              a.style.setProperty("min-width","50px");
              a.style.setProperty("color","inherit");
              a.style.setProperty("font-family","inherit");
              a.style.setProperty("font-style","inherit");
              a.style.setProperty("font-size","inherit");
              if (!this.FEnabled) a.style.setProperty("pointer-events","none");
              if (this.FTabIndex === i) {
                if (this.FSelectedColor !== -1) a.style.setProperty("background-color",pas["WEBLib.Graphics"].ColorToHTML(this.FSelectedColor));
                if (this.FSelectedTextColor !== -1) a.style.setProperty("color",pas["WEBLib.Graphics"].ColorToHTML(this.FSelectedTextColor));
              };
            };
            li.appendChild(a);
          };
        };
        for (var $l3 = 0, $end3 = this.GetControlsCount() - 1; $l3 <= $end3; $l3++) {
          i = $l3;
          if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i))) {
            th = Math.round(ul.offsetHeight) - 1;
            this.GetControls(i).FMargins.SetTop(th);
            this.GetControls(i).GetElementHandle().style.setProperty("white-space","");
          };
        };
        tabs = rtl.freeLoc(tabs);
      } else {
        if (!this.GetIsLinked()) {
          this.ClearChildElements();
          if (4 in this.FComponentState) {
            this.RenderDesigning("TWebPageControl",this.GetContainer(),this,true,"");
          };
        };
      };
      this.DoUpdateResize();
      if (tab != null) {
        tab.SetAlign(0);
        tab.SetAlign(5);
      };
      this.UpdateElement();
      if (!this.GetIsLinked() && (this.GetControlsCount() === 0)) {
        this.GetElementHandle().style.setProperty("border","1px solid lightgray");
      };
    };
    this.DoUpdateResize = function () {
      var i = 0;
      var vistabindex = 0;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i))) this.GetControls(i).SetVisible(false);
      };
      for (var $l1 = 0, $end1 = this.GetControlsCount() - 1; $l1 <= $end1; $l1++) {
        i = $l1;
        if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i))) {
          this.GetControls(i).SetVisible(true);
          this.GetControls(i).SetAlign(0);
          this.GetControls(i).SetAlign(5);
          this.GetControls(i).SetVisible(false);
        };
      };
      vistabindex = this.FTabIndex;
      for (var $l2 = 0, $end2 = this.GetControlsCount() - 1; $l2 <= $end2; $l2++) {
        i = $l2;
        if ((3 in this.GetControls(i).FComponentState) && (i <= this.FTabIndex)) vistabindex += 1;
        if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i))) {
          this.GetControls(i).SetVisible(vistabindex === i);
        };
      };
    };
    this.Loaded = function () {
      pas["WEBLib.Controls"].TCustomControl.Loaded.call(this);
      this.DoUpdateList();
      this.SetTabIndex(this.FTabIndex);
      this.FOldVisible = this.FVisible;
    };
    this.VisibleChanged = function () {
      pas["WEBLib.Controls"].TControl.VisibleChanged.call(this);
      if (this.FOldVisible !== this.FVisible) {
        this.DoUpdateList();
        this.FOldVisible = this.FVisible;
      };
    };
    this.ItemsChanged = function (Sender) {
      var i = 0;
      var ts = null;
      if ((this.PageCount() === 0) && (this.FItems.GetCount() > 0) && (this.GetElementHandle().childElementCount > 0)) {
        this.GetElementHandle().removeChild(this.GetElementHandle().firstChild);
      };
      for (var $l = 0, $end = this.FItems.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (this.PageCount() <= i) {
          ts = $mod.TTabSheet.$create("Create$1",[this.FOwner]);
          ts.SetParent(this);
          ts.SetName(this.FName + "sheet" + pas.SysUtils.IntToStr(i + 1));
        };
        this.GetPage(i).SetCaption(this.FItems.Get(i));
      };
      for (var $l1 = this.PageCount() - 1; $l1 >= 0; $l1--) {
        i = $l1;
        if (i >= this.FItems.GetCount()) {
          ts = this.GetPage(i);
          ts = rtl.freeLoc(ts);
        };
      };
      this.DoUpdateList();
    };
    this.SetParent = function (AValue) {
      var ts = null;
      var frm = null;
      pas["WEBLib.Controls"].TControl.SetParent.apply(this,arguments);
      if (this.FDesignTime) {
        frm = pas["WEBLib.Forms"].GetParentForm(this);
        this.FDesignTime = false;
        ts = $mod.TWebTabSheet.$create("Create$1",[frm]);
        ts.SetParent(this);
        ts.SetCaption("Page1");
        ts.SetName(this.GetUniqueName());
        ts = $mod.TWebTabSheet.$create("Create$1",[frm]);
        ts.SetParent(this);
        ts.SetCaption("Page2");
        ts.SetName(this.GetUniqueName());
      };
      this.DoUpdateList();
    };
    this.GetUniqueName = function () {
      var Result = "";
      var i = 0;
      var id = 0;
      var found = false;
      var AName = "";
      id = 1;
      AName = this.FName + "sheet";
      do {
        Result = AName + pas.SysUtils.IntToStr(id);
        found = true;
        for (var $l = 0, $end = this.FOwner.GetComponentCount() - 1; $l <= $end; $l++) {
          i = $l;
          if (this.FOwner.GetComponent(i).FName === Result) {
            found = false;
            id += 1;
            break;
          };
        };
      } while (!found);
      return Result;
    };
    this.EnableDrag = function () {
      var $Self = this;
      function AddDraggableAttribute(AElement) {
        var I = 0;
        var tn = "";
        for (var $l = 0, $end = AElement.children.length - 1; $l <= $end; $l++) {
          I = $l;
          tn = AElement.children.item(I).tagName;
          if (tn === "LI") {
            AElement.children.item(I).setAttribute("draggable","true");
            AddDraggableAttribute(AElement.children.item(I));
          } else if (tn === "A") {
            AElement.children.item(I).setAttribute("draggable","false")}
           else if (tn === "UL") AddDraggableAttribute(AElement.children.item(I));
        };
      };
      if (!(this.GetContainer() != null)) return;
      AddDraggableAttribute(this.GetContainer());
    };
    this.DisableDrag = function () {
      var $Self = this;
      function RemoveDraggableAttribute(AElement) {
        var I = 0;
        var tn = "";
        for (var $l = 0, $end = AElement.children.length - 1; $l <= $end; $l++) {
          I = $l;
          tn = AElement.children.item(I).tagName;
          if (tn === "LI") {
            AElement.children.item(I).removeAttribute("draggable");
            RemoveDraggableAttribute(AElement.children.item(I));
          } else if (tn === "A") {
            AElement.children.item(I).removeAttribute("draggable")}
           else if (tn === "UL") RemoveDraggableAttribute(AElement.children.item(I));
        };
      };
      if (!(this.GetContainer() != null)) return;
      RemoveDraggableAttribute(this.GetContainer());
    };
    this.CreateInitialize = function () {
      pas["WEBLib.Controls"].TCustomControl.CreateInitialize.call(this);
      this.FDesignTime = (4 in this.FComponentState) && !((1 in this.FOwner.FComponentState) || (0 in this.FOwner.FComponentState));
      this.FControlStyle = rtl.unionSet(this.FControlStyle,rtl.createSet(0));
      this.SetBorderStyle(0);
      this.FItems = pas.Classes.TStringList.$create("Create$1");
      this.FItems.FOnChange = rtl.createCallback(this,"ItemsChanged");
      this.FTabIndex = 0;
      this.FPrevTabIndex = this.FTabIndex;
      this.FShowTabs = true;
      this.SetTabStop(false);
      this.FSelectedColor = 12632256;
      this.FSelectedTextColor = 0;
      if (4 in this.FComponentState) {
        this.SetWidth(400);
        this.SetHeight(300);
      };
      this.FEnablePropagation = true;
      this.FOldVisible = true;
    };
    this.Destroy = function () {
      rtl.free(this,"FItems");
      pas["WEBLib.Controls"].TCustomControl.Destroy.call(this);
    };
    this.EndUpdate = function () {
      pas["WEBLib.Controls"].TCustomControl.EndUpdate.call(this);
      this.DoUpdateList();
    };
    this.PageCount = function () {
      var Result = 0;
      var i = 0;
      Result = 0;
      for (var $l = 0, $end = this.GetControlsCount() - 1; $l <= $end; $l++) {
        i = $l;
        if ($mod.TTabSheet.isPrototypeOf(this.GetControls(i))) Result += 1;
      };
      return Result;
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addProperty("Align",2,pas["WEBLib.Controls"].$rtti["TAlign"],"FAlign","SetAlign",{Default: pas["WEBLib.Controls"].TAlign.alNone});
    $r.addProperty("AlignWithMargins",2,rtl.boolean,"FAlignWithMargins","SetAlignWithMargins",{Default: false});
    $r.addProperty("Anchors",2,pas["WEBLib.Controls"].$rtti["TAnchors"],"FAnchors","SetAnchors",{Default: rtl.createSet(0,1)});
    $r.addProperty("BorderStyle",2,pas["WEBLib.Controls"].$rtti["TBorderStyle"],"FBorderStyle","SetBorderStyle",{Default: pas["WEBLib.Controls"].TBorderStyle.bsNone});
    $r.addProperty("ChildOrder",2,rtl.longint,"FChildOrder","SetChildOrderEx",{Default: 0});
    $r.addProperty("DragMode",2,pas["WEBLib.Controls"].$rtti["TDragMode"],"FDragMode","SetDragMode",{Default: pas["WEBLib.Controls"].TDragMode.dmManual});
    $r.addProperty("ElementClassName",2,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementClassName","SetElementClassName");
    $r.addProperty("ElementTabClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementTabClassName","FElementTabClassName");
    $r.addProperty("ElementTabActiveClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementTabActiveClassName","FElementTabActiveClassName");
    $r.addProperty("ElementTabItemClassName",0,pas["WEBLib.Controls"].$rtti["TElementClassName"],"FElementTabItemClassName","FElementTabItemClassName");
    $r.addProperty("ElementFont",2,pas["WEBLib.Controls"].$rtti["TElementFont"],"FElementFont","SetElementFont",{Default: pas["WEBLib.Controls"].TElementFont.efProperty});
    $r.addProperty("ElementID",3,pas["WEBLib.Controls"].$rtti["TElementID"],"GetID","SetID");
    $r.addProperty("ElementPosition",2,pas["WEBLib.Controls"].$rtti["TElementPosition"],"FElementPosition","SetElementPosition",{Default: pas["WEBLib.Controls"].TElementPosition.epAbsolute});
    $r.addProperty("Enabled",2,rtl.boolean,"FEnabled","SetEnabled",{Default: true});
    $r.addProperty("Font",2,pas["WEBLib.Graphics"].$rtti["TFont"],"FFont","SetFont");
    $r.addProperty("Height",3,rtl.longint,"GetHeight","SetHeight");
    $r.addProperty("HeightPercent",2,rtl.double,"FHeightPercent","SetHeightPercent",{Default: 100});
    $r.addProperty("HeightStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FHeightStyle","SetHeightStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("Hint",2,rtl.string,"FHint","SetHint");
    $r.addProperty("TabIndex",2,rtl.longint,"FTabIndex","SetTabIndex");
    $r.addProperty("Left",3,rtl.longint,"GetLeft","SetLeft");
    $r.addProperty("Margins",2,pas["WEBLib.Controls"].$rtti["TMargins"],"FMargins","SetMargins");
    $r.addProperty("ParentFont",2,rtl.boolean,"FParentFont","SetParentFont",{Default: true});
    $r.addProperty("PopupMenu",0,pas["WEBLib.Menus"].$rtti["TPopupMenu"],"FPopupMenu","FPopupMenu");
    $r.addProperty("ShowHint",2,rtl.boolean,"FShowHint","SetShowHint",{Default: false});
    $r.addProperty("ShowTabs",2,rtl.boolean,"FShowTabs","SetShowTabs",{Default: true});
    $r.addProperty("SelectedColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FSelectedColor","SetSelectedColor",{Default: 12632256});
    $r.addProperty("SelectedTextColor",2,pas["WEBLib.Graphics"].$rtti["TColor"],"FSelectedTextColor","SetSelectedTextColor",{Default: 0});
    $r.addProperty("TabOrder",2,rtl.longint,"FTabOrder","SetTabOrder");
    $r.addProperty("TabStop",2,rtl.boolean,"FTabStop","SetTabStop",{Default: true});
    $r.addProperty("Top",3,rtl.longint,"GetTop","SetTop");
    $r.addProperty("Visible",2,rtl.boolean,"FVisible","SetVisible",{Default: true});
    $r.addProperty("Width",3,rtl.longint,"GetWidth","SetWidth");
    $r.addProperty("WidthPercent",2,rtl.double,"FWidthPercent","SetWidthPercent",{Default: 100});
    $r.addProperty("WidthStyle",2,pas["WEBLib.Controls"].$rtti["TSizeStyle"],"FWidthStyle","SetWidthStyle",{Default: pas["WEBLib.Controls"].TSizeStyle.ssAbsolute});
    $r.addProperty("OnChange",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnChange","FOnChange");
    $r.addProperty("OnClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnClick","FOnClick");
    $r.addProperty("OnDblClick",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnDblClick","FOnDblClick");
    $r.addProperty("OnKeyDown",0,pas["WEBLib.Controls"].$rtti["TKeyEvent"],"FOnKeyDown","FOnKeyDown");
    $r.addProperty("OnKeyPress",0,pas["WEBLib.Controls"].$rtti["TKeyPressEvent"],"FOnKeyPress","FOnKeyPress");
    $r.addProperty("OnKeyUp",0,pas["WEBLib.Controls"].$rtti["TKeyEvent"],"FOnKeyUp","FOnKeyUp");
    $r.addProperty("OnMouseDown",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseDown","FOnMouseDown");
    $r.addProperty("OnMouseUp",0,pas["WEBLib.Controls"].$rtti["TMouseEvent"],"FOnMouseUp","FOnMouseUp");
    $r.addProperty("OnMouseMove",0,pas["WEBLib.Controls"].$rtti["TMouseMoveEvent"],"FOnMouseMove","FOnMouseMove");
    $r.addProperty("OnMouseLeave",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseLeave","FOnMouseLeave");
    $r.addProperty("OnMouseEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnMouseEnter","FOnMouseEnter");
    $r.addProperty("OnEnter",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnEnter","FOnEnter");
    $r.addProperty("OnExit",0,pas["WEBLib.Controls"].$rtti["TNotifyEvent"],"FOnExit","FOnExit");
    $r.addProperty("OnDragDrop",0,pas["WEBLib.Controls"].$rtti["TDragDropEvent"],"FOnDragDrop","FOnDragDrop");
    $r.addProperty("OnDragOver",0,pas["WEBLib.Controls"].$rtti["TDragOverEvent"],"FOnDragOver","FOnDragOver");
    $r.addProperty("OnEndDrag",0,pas["WEBLib.Controls"].$rtti["TEndDragEvent"],"FonEndDrag","FonEndDrag");
    $r.addProperty("OnStartDrag",0,pas["WEBLib.Controls"].$rtti["TStartDragEvent"],"FOnStartDrag","FOnStartDrag");
  });
},["WEBLib.Buttons","WEBLib.Forms","WEBLib.Utils"]);
rtl.module("Main",["System","SysUtils","Classes","Math","DateUtils","StrUtils","JS","Web","WEBLib.REST","WEBLib.JSON","XData.Web.Connection","XData.Web.Client","WEBLib.Graphics","WEBLib.Controls","WEBLib.Forms","WEBLib.Dialogs","WEBLib.Controls","WEBLib.WebCtrls","WEBLib.StdCtrls","WEBLib.StdCtrls","WEBLib.ComCtrls","WEBLib.WebTools","WEBLib.Buttons","WEBLib.ExtCtrls"],function () {
  "use strict";
  var $mod = this;
  rtl.createClass(this,"TMainForm",pas["WEBLib.Forms"].TForm,function () {
    this.$init = function () {
      pas["WEBLib.Forms"].TForm.$init.call(this);
      this.divTop = null;
      this.divMain = null;
      this.divInfo = null;
      this.divInfoPages = null;
      this.pageBio = null;
      this.divBiography = null;
      this.divBottom = null;
      this.divActorTabulatorHolder = null;
      this.divRoleTabulatorHolder = null;
      this.divButtons = null;
      this.divButtonHolder = null;
      this.btnBio = null;
      this.btnPhoto = null;
      this.btnVideo = null;
      this.btnConnect = null;
      this.divMainHolder = null;
      this.divViewerHolder = null;
      this.divLogo = null;
      this.divBirthdayNav = null;
      this.divBirthDay = null;
      this.divPrevBirthDay = null;
      this.divNextBirthDay = null;
      this.divBlock = null;
      this.btnBackground = null;
      this.divAttribution = null;
      this.pageAbout = null;
      this.divAbout = null;
      this.pagePhotos = null;
      this.pageVideos = null;
      this.pageBackgrounds = null;
      this.pageConnect = null;
      this.divDepartedNav = null;
      this.divDeathDay = null;
      this.divPrevDeathDay = null;
      this.divNextDeathDay = null;
      this.divReleaseNav = null;
      this.divReleaseDay = null;
      this.divPrevReleaseDay = null;
      this.divNextReleaseDay = null;
      this.divTop100Nav = null;
      this.btnTop1000 = null;
      this.divPeopleNav = null;
      this.btnActors = null;
      this.btnDirectors = null;
      this.btnWriters = null;
      this.btnSettings = null;
      this.btnAbout = null;
      this.divSearchNav = null;
      this.edtSearch = null;
      this.tmrFocus = null;
      this.tmrStart = null;
      this.btnDiscord = null;
      this.pageDiscord = null;
      this.btnDiscordLaunch = null;
      this.lblSupport = null;
      this.pageSettings = null;
      this.divSettings = null;
      this.divSettingsPersonRequests = null;
      this.lblLimitData = null;
      this.switchLimitData = null;
      this.divSettingsTopRequests = null;
      this.lblLimitDataTop = null;
      this.switchLimitDataTop = null;
      this.tmrSearch = null;
      this.divSettingsSearch = null;
      this.lblQuickSearch = null;
      this.switchSearch = null;
      this.btnSearch = null;
      this.tmrImageCheck = null;
      this.divPhotoSlider = null;
      this.btnRelatives = null;
      this.WebHttpRequest1 = null;
      this.divBlockControls = null;
      this.btnBlockClose = null;
      this.btnBlockZoomReset = null;
      this.btnBlockZoomPlus = null;
      this.btnBlockZoomMinus = null;
      this.btnBlockPrevious = null;
      this.btnBlockNext = null;
      this.divVideoSlider = null;
      this.divBackgroundSlider = null;
      this.divBlockData = null;
      this.btnBlockCount = null;
      this.btnBlockLine = null;
      this.btnBlockTotal = null;
      this.divTopButtons = null;
      this.divLinkSet1 = null;
      this.WebHTMLDiv4 = null;
      this.WebHTMLDiv5 = null;
      this.linkFavourite = null;
      this.WebHTMLDiv7 = null;
      this.linkLoading = null;
      this.linkLogin = null;
      this.WebHTMLDiv12 = null;
      this.WebHTMLDiv13 = null;
      this.divLinkSet2 = null;
      this.linkList4 = null;
      this.linkList3 = null;
      this.linkList2 = null;
      this.linkTour = null;
      this.linkLink = null;
      this.linkList1 = null;
      this.linkEMail = null;
      this.linkRating = null;
      this.divLinkSet4 = null;
      this.linkWikiData = null;
      this.linkScore = null;
      this.linkTMDb = null;
      this.linkRottenTomatoes = null;
      this.linkMetaCritic = null;
      this.linkIMDb = null;
      this.linkWeb = null;
      this.linkGoogleImageSearch = null;
      this.divLinkSet5 = null;
      this.linkTwitter = null;
      this.linkInstagram = null;
      this.linkFacebook = null;
      this.linkModels = null;
      this.linkWikipedia = null;
      this.linkHeight = null;
      this.linkCitizenship = null;
      this.linkShare = null;
      this.divPhotoHolder = null;
      this.divPhoto = null;
      this.divProgressSpinner = null;
      this.divPhotoBorder = null;
      this.divProgress = null;
      this.divLinkSet3 = null;
      this.WebHTMLDiv3 = null;
      this.WebHTMLDiv6 = null;
      this.WebHTMLDiv8 = null;
      this.WebHTMLDiv9 = null;
      this.WebHTMLDiv10 = null;
      this.WebHTMLDiv11 = null;
      this.WebHTMLDiv14 = null;
      this.linkPizza = null;
      this.Startup = false;
      this.StartupMode = "";
      this.TablesReady = 0;
      this.Server = "";
      this.Carnival = null;
      this.Client = null;
      this.Version = "";
      this.Release = "";
      this.VersionNum = "";
      this.VersionCheck = false;
      this.Pending = null;
      this.AdultContent = false;
      this.CurrentBirthDate = "";
      this.CurrentDeathDate = "";
      this.CurrentReleaseDate = "";
      this.CurrentPerson = 0;
      this.CurrentRole = 0;
      this.ViewerVisible = false;
      this.ViewerMode = "";
      this.ViewerURL1 = "";
      this.ViewerURL2 = "";
      this.ViewerURLA = "";
      this.ViewerURLC = 0;
      this.ViewerURLT = 0;
      this.Photo1 = "";
      this.Photo2 = "";
      this.PhotoA = "";
      this.TopTitle = "";
      this.NowSearching = false;
      this.QuickSearch = false;
      this.DataLimited = false;
      this.DataLimitedTop = false;
      this.Top1000CacheDate = 0.0;
      this.Top1000CacheData = "";
      this.Top5000CacheDate = 0.0;
      this.Top5000CacheData = "";
      this.BirthdayCacheDate = rtl.arraySetLength(null,0.0,366);
      this.BirthdayCacheData = rtl.arraySetLength(null,"",366);
      this.DeathdayCacheDate = rtl.arraySetLength(null,0.0,366);
      this.DeathdayCacheData = rtl.arraySetLength(null,"",366);
      this.ReleasedayCacheDate = rtl.arraySetLength(null,0.0,366);
      this.ReleasedayCacheData = rtl.arraySetLength(null,"",366);
    };
    this.$final = function () {
      this.divTop = undefined;
      this.divMain = undefined;
      this.divInfo = undefined;
      this.divInfoPages = undefined;
      this.pageBio = undefined;
      this.divBiography = undefined;
      this.divBottom = undefined;
      this.divActorTabulatorHolder = undefined;
      this.divRoleTabulatorHolder = undefined;
      this.divButtons = undefined;
      this.divButtonHolder = undefined;
      this.btnBio = undefined;
      this.btnPhoto = undefined;
      this.btnVideo = undefined;
      this.btnConnect = undefined;
      this.divMainHolder = undefined;
      this.divViewerHolder = undefined;
      this.divLogo = undefined;
      this.divBirthdayNav = undefined;
      this.divBirthDay = undefined;
      this.divPrevBirthDay = undefined;
      this.divNextBirthDay = undefined;
      this.divBlock = undefined;
      this.btnBackground = undefined;
      this.divAttribution = undefined;
      this.pageAbout = undefined;
      this.divAbout = undefined;
      this.pagePhotos = undefined;
      this.pageVideos = undefined;
      this.pageBackgrounds = undefined;
      this.pageConnect = undefined;
      this.divDepartedNav = undefined;
      this.divDeathDay = undefined;
      this.divPrevDeathDay = undefined;
      this.divNextDeathDay = undefined;
      this.divReleaseNav = undefined;
      this.divReleaseDay = undefined;
      this.divPrevReleaseDay = undefined;
      this.divNextReleaseDay = undefined;
      this.divTop100Nav = undefined;
      this.btnTop1000 = undefined;
      this.divPeopleNav = undefined;
      this.btnActors = undefined;
      this.btnDirectors = undefined;
      this.btnWriters = undefined;
      this.btnSettings = undefined;
      this.btnAbout = undefined;
      this.divSearchNav = undefined;
      this.edtSearch = undefined;
      this.tmrFocus = undefined;
      this.tmrStart = undefined;
      this.btnDiscord = undefined;
      this.pageDiscord = undefined;
      this.btnDiscordLaunch = undefined;
      this.lblSupport = undefined;
      this.pageSettings = undefined;
      this.divSettings = undefined;
      this.divSettingsPersonRequests = undefined;
      this.lblLimitData = undefined;
      this.switchLimitData = undefined;
      this.divSettingsTopRequests = undefined;
      this.lblLimitDataTop = undefined;
      this.switchLimitDataTop = undefined;
      this.tmrSearch = undefined;
      this.divSettingsSearch = undefined;
      this.lblQuickSearch = undefined;
      this.switchSearch = undefined;
      this.btnSearch = undefined;
      this.tmrImageCheck = undefined;
      this.divPhotoSlider = undefined;
      this.btnRelatives = undefined;
      this.WebHttpRequest1 = undefined;
      this.divBlockControls = undefined;
      this.btnBlockClose = undefined;
      this.btnBlockZoomReset = undefined;
      this.btnBlockZoomPlus = undefined;
      this.btnBlockZoomMinus = undefined;
      this.btnBlockPrevious = undefined;
      this.btnBlockNext = undefined;
      this.divVideoSlider = undefined;
      this.divBackgroundSlider = undefined;
      this.divBlockData = undefined;
      this.btnBlockCount = undefined;
      this.btnBlockLine = undefined;
      this.btnBlockTotal = undefined;
      this.divTopButtons = undefined;
      this.divLinkSet1 = undefined;
      this.WebHTMLDiv4 = undefined;
      this.WebHTMLDiv5 = undefined;
      this.linkFavourite = undefined;
      this.WebHTMLDiv7 = undefined;
      this.linkLoading = undefined;
      this.linkLogin = undefined;
      this.WebHTMLDiv12 = undefined;
      this.WebHTMLDiv13 = undefined;
      this.divLinkSet2 = undefined;
      this.linkList4 = undefined;
      this.linkList3 = undefined;
      this.linkList2 = undefined;
      this.linkTour = undefined;
      this.linkLink = undefined;
      this.linkList1 = undefined;
      this.linkEMail = undefined;
      this.linkRating = undefined;
      this.divLinkSet4 = undefined;
      this.linkWikiData = undefined;
      this.linkScore = undefined;
      this.linkTMDb = undefined;
      this.linkRottenTomatoes = undefined;
      this.linkMetaCritic = undefined;
      this.linkIMDb = undefined;
      this.linkWeb = undefined;
      this.linkGoogleImageSearch = undefined;
      this.divLinkSet5 = undefined;
      this.linkTwitter = undefined;
      this.linkInstagram = undefined;
      this.linkFacebook = undefined;
      this.linkModels = undefined;
      this.linkWikipedia = undefined;
      this.linkHeight = undefined;
      this.linkCitizenship = undefined;
      this.linkShare = undefined;
      this.divPhotoHolder = undefined;
      this.divPhoto = undefined;
      this.divProgressSpinner = undefined;
      this.divPhotoBorder = undefined;
      this.divProgress = undefined;
      this.divLinkSet3 = undefined;
      this.WebHTMLDiv3 = undefined;
      this.WebHTMLDiv6 = undefined;
      this.WebHTMLDiv8 = undefined;
      this.WebHTMLDiv9 = undefined;
      this.WebHTMLDiv10 = undefined;
      this.WebHTMLDiv11 = undefined;
      this.WebHTMLDiv14 = undefined;
      this.linkPizza = undefined;
      this.Carnival = undefined;
      this.Client = undefined;
      this.Pending = undefined;
      this.BirthdayCacheDate = undefined;
      this.BirthdayCacheData = undefined;
      this.DeathdayCacheDate = undefined;
      this.DeathdayCacheData = undefined;
      this.ReleasedayCacheDate = undefined;
      this.ReleasedayCacheData = undefined;
      pas["WEBLib.Forms"].TForm.$final.call(this);
    };
    this.tmrImageCheckEnable = function () {
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
    };
    this.WebFormCreate = function (Sender) {
      var i = 0;
      this.PreventCompilerHint(1);
      this.Startup = true;
      this.ViewerVisible = false;
      this.CurrentPerson = -1;
      this.CurrentRole = -1;
      this.TopTitle = "";
      if (pas.System.Pos("actorious.com",pas.SysUtils.LowerCase(window.location.href)) > 0) {
        $mod.MainForm.Server = "https://carnival.500foods.com:10999/tms/xdata"}
       else $mod.MainForm.Server = "http://localhost:2001/tms/xdata";
      this.StartupMode = "today";
      if (pas["WEBLib.WebTools"].GetQueryParam("R") !== "") {
        this.StartupMode = "reference";
      };
      this.AdultContent = false;
      if (pas["WEBLib.WebTools"].GetQueryParam("X") !== "") {
        if (pas["WEBLib.WebTools"].GetQueryParam("X") === "XXX") {
          this.AdultContent = true;
          this.StartupMode = "adult";
        };
      };
      this.Version = window.ProjectName;
      this.Release = new luxon.DateTime.fromISO(new Date(document.lastModified).toISOString()).toFormat('yyyy-MMM-dd');
      this.VersionNum = pas.SysUtils.StringReplace(pas.System.Copy(this.Version,pas.System.Pos("ActoriousClient",this.Version) + 16,this.Version.length),"_",".",rtl.createSet(0));
      this.VersionCheck = true;
      this.lblSupport.SetHTML("Support and discussions about Actorious are managed through Discord, a free service." + "<br />" + "<br />" + pas.System.Copy(this.Version,1,pas.System.Pos("_",this.Version) - 1) + "<br />" + "Version: " + this.VersionNum + "<br />" + " Released: " + this.Release);
      this.CheckVersion();
      this.DataLimited = true;
      this.DataLimitedTop = true;
      this.QuickSearch = true;
      this.NowSearching = false;
      if (this.AdultContent) {
        this.switchLimitData.SetChecked(false);
        this.switchLimitDataTop.SetChecked(false);
        this.switchSearch.SetChecked(false);
        this.switchLimitDataClick(null);
        this.switchLimitDataTopClick(null);
        this.switchSearchClick(null);
      };
      this.TablesReady = 0;
      this.divProgress.SetHeight(0);
      this.Pending = pas.Classes.TStringList.$create("Create$1");
      this.divInfoPages.SetActivePage(this.pageBio);
      this.CurrentBirthDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      this.CurrentDeathDate = "";
      this.CurrentReleaseDate = "";
      this.edtSearch.SetFocus();
      this.Top1000CacheDate = pas.SysUtils.Now() - 1;
      this.Top1000CacheData = "[]";
      this.Top5000CacheDate = pas.SysUtils.Now() - 1;
      this.Top5000CacheData = "[]";
      for (i = 1; i <= 366; i++) {
        this.BirthdayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.BirthdayCacheData[i - 1] = "[]";
        this.DeathdayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.DeathdayCacheData[i - 1] = "[]";
        this.ReleasedayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.ReleasedayCacheData[i - 1] = "[]";
      };
      this.SetBootstrapTooltip(this.btnSearch,"top");
      this.SetBootstrapTooltip(this.btnBio,"bottom");
      this.SetBootstrapTooltip(this.btnPhoto,"bottom");
      this.SetBootstrapTooltip(this.btnVideo,"bottom");
      this.SetBootstrapTooltip(this.btnBackground,"bottom");
      this.SetBootstrapTooltip(this.btnConnect,"bottom");
      this.SetBootstrapTooltip(this.btnSettings,"bottom");
      this.SetBootstrapTooltip(this.btnDiscord,"bottom");
      this.SetBootstrapTooltip(this.btnAbout,"bottom");
      this.SetBootstrapTooltipDiv(this.linkLogin,"Login to TMDb Account","left");
      this.SetBootstrapTooltipDiv(this.linkFavourite,"Mark as Favorite","left");
      this.SetBootstrapTooltipDiv(this.linkTMDb,"The Movie Database","left");
      this.SetBootstrapTooltipDiv(this.linkScore,"Actorious Points","left");
      this.SetBootstrapTooltipDiv(this.linkWikiData,"WikiData","left");
      this.SetBootstrapTooltipDiv(this.linkGoogleImageSearch,"Google Image Search","left");
      this.SetBootstrapTooltipDiv(this.linkIMDb,"IMDb","left");
      this.SetBootstrapTooltipDiv(this.linkMetaCritic,"MetaCritic","left");
      this.SetBootstrapTooltipDiv(this.linkRottenTomatoes,"Rotten Tomatoes","left");
      this.SetBootstrapTooltipDiv(this.linkWeb,"Website","left");
      this.SetBootstrapTooltipDiv(this.linkCitizenship,"Country/Citizenship Country/Production","right");
      this.SetBootstrapTooltipDiv(this.linkHeight,"Height","right");
      this.SetBootstrapTooltipDiv(this.linkWikipedia,"Wikipedia","right");
      this.SetBootstrapTooltipDiv(this.linkFacebook,"Facebook","right");
      this.SetBootstrapTooltipDiv(this.linkInstagram,"Instagram","right");
      this.SetBootstrapTooltipDiv(this.linkTwitter,"Twitter","right");
      this.SetBootstrapTooltipDiv(this.linkModels,"Models.com","right");
      this.SetBootstrapTooltipDiv(this.linkShare,"Share","right");
      this.SetBootstrapTooltipDiv(this.linkRating,"Rating","Right");
      this.SetBootstrapTooltipDiv(this.linkEMail,"Subscribe to Daily E-Mail","right");
      this.SetBootstrapTooltipDiv(this.linkTour,"Take a Tour of Actorious and Explore its Features","right");
      this.SetBootstrapTooltipDiv(this.linkPizza,"Donate to the Actiorious Project via Buy Me a Pizza","right");
      this.linkLogin.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkFavourite.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkTMDb.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkScore.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkWikiData.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkRating.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkIMDb.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkRottenTomatoes.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkMetaCritic.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkWeb.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkCitizenship.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkHeight.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkWikipedia.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkFacebook.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkInstagram.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkTwitter.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkModels.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkShare.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkGoogleImageSearch.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkLink.GetElementHandle().style.setProperty("opacity","0.25");
      this.linkEMail.GetElementHandle().style.setProperty("opacity",".25");
      this.linkTour.GetElementHandle().style.setProperty("opacity","1.0");
      // FlatPickr Navigation Icons
          divPrevBirthDay.innerHTML = window.icon_chveron_left;
          divPrevDeathDay.innerHTML = window.icon_chveron_left;
          divPrevReleaseDay.innerHTML = window.icon_chveron_left;
      
          divNextBirthDay.innerHTML = window.icon_chveron_right;
          divNextDeathDay.innerHTML = window.icon_chveron_right;
          divNextReleaseDay.innerHTML = window.icon_chveron_right;
      
          // FlatPickr Input fields
          divBirthDay.innerHTML =
            '<div id="divFlatPickr" class="d-flex align-items-center overflow-hidden" style="width: 100%; height:100%; border:none; cursor: pointer !important;">'+
              '<input type="text" class="bg-light px-1 border border-0" data-input placeholder="Birthday..." >'+
              '<div '+
                'onclick="window.birthdate_today(event)" '+
                'class="input-button bg-none" '+
                'style="margin: 0px 0px 0px -25px; '+
                'title="Toggle Birthday Calendar" '+
                'data-toggle '+
                'data-bs-toggle="tooltip" '+
                'data-bs-placement="top" '+
                'data-bs-delay={"show":1000,"hide":100}'+
                '>'+
                window.icon_birthday_cake+
              '</div>'+
            '</div>';
      
          divDeathDay.innerHTML =
            '<div id="divFlatPickr2" class="d-flex align-items-center overflow-hidden" style="width: 100%; height:100%; border:none; cursor: pointer !important;">'+
              '<input type="text" class="bg-light px-1 border border-0" data-input placeholder="Departed...">'+
              '<div '+
                'onclick="window.deathdate_today(event)" '+
                'class="input-button bg-none" '+
                'style="margin: 0px 0px 0px -25px;" '+
                'title="Toggle Departed Calendar" '+
                'data-toggle '+
                'data-bs-toggle="tooltip" '+
                'data-bs-placement="top" '+
                'data-bs-delay={"show":1000,"hide":100}'+
                '>'+
                window.icon_tombstone+
              '</div>'+
            '</div>';
      
          divReleaseDay.innerHTML =
            '<div id="divFlatPickr3" class="d-flex align-items-center overflow-hidden" style="width: 100%; height:100%; border:none; cursor: pointer !important;">'+
              '<input type="text" class="bg-light px-1 border border-0" data-input placeholder="Released...">'+
              '<div '+
                'onclick="window.releasedate_today(event)" '+
                'class="input-button bg-none" '+
                'style="margin: 0px 0px 0px -27px;" '+
                'title="Toggle Release Calendar" '+
                'data-toggle '+
                'data-bs-toggle="tooltip" '+
                'data-bs-placement="top" '+
                'data-bs-delay={"show":1000,"hide":100}'+
                '>'+
                window.icon_film+
              '</div>'+
            '</div>';
      
          btnSearch.innerHTML = window.icon_magnifying_glass;
          linkLink.innerHTML = '<div style="padding:2px 2px; fill:var(--bs-gray-200);">'+window.icon_link+'</div>';
          linkEMail.innerHTML = window.icon_envelope_open_text;
          linkTour.innerHTML = window.icon_signs_post;
      
      
          ////////////////////////////////////////////////////////////////////////////
          // JS: RefreshMenu()
          //
          // Update the top Menu with whatever we know.  There are seven buttons, four
          // of which may have an optional number shown (Bio, Photo, Video, Backdrop)
          ////////////////////////////////////////////////////////////////////////////
      
          function RefreshMenu(force) {
      
            if (force == true) {
              // First official run-through, we want to setup a few other things
              btnBio.classList.replace('btn-secondary','btn-primary');
              btnActors.classList.replace('btn-secondary','btn-primary');
              btnTop1000.classList.replace('btn-secondary','btn-primary');
      
              btnActors.innerHTML = 'Actors';
              btnWriters.innerHTML = 'Writers';
              btnDirectors.innerHTML = 'Directors';
              btnTop1000.innerHTML = 'TMDb Top 1,000 Actors';
      
              linkEMail.style.opacity = 1.0;
      
            }
            else if (pas.Main.MainForm.Startup == true) {
              return;
            }
      
            if (pas.Main.MainForm.MenuType == 0) {
              // Drawing the top menu for the selected Person
      
              btnBio.setAttribute('aria-label', 'Biography');
              btnPhoto.setAttribute('aria-label', 'Photos');
              btnVideo.setAttribute('aria-label', 'Videos');
              btnBackground.setAttribute('aria-label', 'Backgrounds');
              btnConnect.setAttribute('aria-label', 'Connections');
              btnSettings.setAttribute('aria-label', 'Settings');
              btnDiscord.setAttribute('aria-label', 'Support');
              btnAbout.setAttribute('aria-label', 'About');
      
              if (divInfo.getBoundingClientRect().width > 800) {
                btnConnect.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_people_arrows_swap+'Connections</div>';
                btnSettings.innerHTML   = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_sliders+'Settings</div>';
                btnDiscord.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_bell_concierge+'Support</div>';
                btnAbout.innerHTML      = '<div class="d-flex align-items-center justify-content-center"><div style="margin-top:-2px;""><img style="height:24px; width:24px; margin-right:6px;" src="img/actorious-logo-100x100.svg" alt="Actorious Icon"></div>About Actorious</div>';
      
                if (pas.Main.MainForm.BioWords > 1) { btnBio.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_book_user+'Biography ('+pas.Main.MainForm.BioWords+' words)</div>'; }
                else { btnBio.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_book_user+'Biography (none)</div>'; }
      
                if (pas.Main.MainForm.PhotoCount > 0) { btnPhoto.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_polaroid_user+'Photos ('+pas.Main.MainForm.PhotoCount+')</div>'; }
                else { btnPhoto.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_polaroid_user+'Photos (none)</div>'; }
              }
              else {
                // Just draw the Icons
                btnBio.innerHTML        = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_book_user+'</div>';
                btnPhoto.innerHTML      = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_polaroid_user+'</div>';
                btnConnect.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_people_arrows_swap+'</div>';
                btnSettings.innerHTML   = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_sliders+'</div>';
                btnDiscord.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_bell_concierge+'</div>';
                btnAbout.innerHTML      = '<div class="d-flex align-items-center justify-content-center"><div style="margin-top:-2px;""><img style="height:24px; width:24px; margin-right:6px;" src="img/actorious-logo-100x100.svg" alt="Actorious Icon"></div></div>';
              }
      
              btnVideo.classList.add('d-none');
              btnBackground.classList.add('d-none');
              btnConnect.classList.remove('d-none');
      
            }
            else if (pas.Main.MainForm.MenuType == 1) {
              // Drawing the top menu for the selected Movie
      
              if (window.innerWidth > 1800) {
                btnSettings.innerHTML   = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_sliders+'Settings</div>';
                btnDiscord.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_bell_concierge+'Support</div>';
                btnAbout.innerHTML      = '<div class="d-flex align-items-center justify-content-center"><div style="margin-top:-2px;""><img style="height:24px; width:24px; margin-right:6px;" src="img/actorious-logo-100x100.svg" alt="Actorious Icon"></div>About Actorious</div>';
      
                if (pas.Main.MainForm.BioWords > 1) { btnBio.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_film_swap+'Overview ('+pas.Main.MainForm.BioWords+' words)</div>'; }
                else { btnBio.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_film_swap+'Overview (none)</div>'; }
      
                if (pas.Main.MainForm.PhotoCount > 0) { btnPhoto.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_users_rectangle+'Posters ('+pas.Main.MainForm.PhotoCount+')</div>'; }
                else { btnPhoto.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_users_rectangle+'Posters (none)</div>'; }
      
                if (pas.Main.MainForm.VideoCount > 0) { btnVideo.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_clapperboard_play+'Videos ('+pas.Main.MainForm.VideoCount+')</div>'; }
                else { btnVideo.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_clapperboard_play+'Videos (none)</div>'; }
      
                if (pas.Main.MainForm.BackgroundCount > 0) { btnBackground.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_photo_film+'Backdrops ('+pas.Main.MainForm.BackgroundCount+')</div>'; }
                else { btnBackground.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_photo_film+'Backdrops (none)</div>'; }
              }
              else {
                // Just draw the Icons
                btnBio.innerHTML        = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_film_swap+'</div>';
                btnPhoto.innerHTML      = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_users_rectangle+'</div>';
                btnVideo.innerHTML      = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_clapperboard_play+'</div>';
                btnBackground.innerHTML = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_photo_film+'</div>';
                btnSettings.innerHTML   = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_sliders+'</div>';
                btnDiscord.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_bell_concierge+'</div>';
                btnAbout.innerHTML      = '<div class="d-flex align-items-center justify-content-center"><div style="margin-top:-2px;""><img style="height:24px; width:24px; margin-right:6px;" src="img/actorious-logo-100x100.svg" alt="Actorious Icon"></div></div>';
              }
      
              btnVideo.classList.remove('d-none');
              btnBackground.classList.remove('d-none');
              btnConnect.classList.add('d-none');
      
            }
            else if (pas.Main.MainForm.MenuType == 2) {
              // Drawing the top menu for the selected TV Show
      
              if (window.innerWidth > 1800) {
                btnSettings.innerHTML   = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_sliders+'Settings</div>';
                btnDiscord.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_bell_concierge+'Support</div>';
                btnAbout.innerHTML      = '<div class="d-flex align-items-center justify-content-center"><div style="margin-top:-2px;""><img style="height:24px; width:24px; margin-right:6px;" src="img/actorious-logo-100x100.svg" alt="Actorious Icon"></div>About Actorious</div>';
      
                if (pas.Main.MainForm.BioWords > 1) { btnBio.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_tv_swap+'Overview ('+pas.Main.MainForm.BioWords+' words)</div>'; }
                else { btnBio.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_tv_swap+'Overview (none)</div>'; }
      
                if (pas.Main.MainForm.PhotoCount > 0) { btnPhoto.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_users_rectangle+'Posters ('+pas.Main.MainForm.PhotoCount+')</div>'; }
                else { btnPhoto.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_users_rectangle+'Posters (none)</div>'; }
      
                if (pas.Main.MainForm.VideoCount > 0) { btnVideo.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_clapperboard_play+'Videos ('+pas.Main.MainForm.VideoCount+')</div>'; }
                else { btnVideo.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_clapperboard_play+'Videos (none)</div>'; }
      
                if (pas.Main.MainForm.BackgroundCount > 0) { btnBackground.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_photo_film+'Backdrops ('+pas.Main.MainForm.BackgroundCount+')</div>'; }
                else { btnBackground.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; margin-right:6px;">'+window.icon_photo_film+'Backdrops (none)</div>'; }
              }
              else {
                // Just draw the Icons
                btnBio.innerHTML        = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_tv_swap+'</div>';
                btnPhoto.innerHTML      = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_users_rectangle+'</div>';
                btnVideo.innerHTML      = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_clapperboard_play+'</div>';
                btnBackground.innerHTML = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_photo_film+'</div>';
                btnSettings.innerHTML   = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_sliders+'</div>';
                btnDiscord.innerHTML    = '<div style="display:flex; justify-content:center; align-items:center;">'+window.icon_bell_concierge+'</div>';
                btnAbout.innerHTML      = '<div class="d-flex align-items-center justify-content-center"><div style="margin-top:-2px;""><img style="height:24px; width:24px; margin-right:6px;" src="img/actorious-logo-100x100.svg" alt="Actorious Icon"></div></div>';
              }
      
              btnVideo.classList.remove('d-none');
              btnBackground.classList.remove('d-none');
              btnConnect.classList.add('d-none');
      
            }
          }
          window.RefreshMenu = RefreshMenu;
      window.lazyLoadInstance = new LazyLoad({
            callback_error: (img) => {
      
              // RetryA - hourglass
              // RetryB -
              // RetryC -
              // RetryD -
      
              if (img.classList.contains('RetryA')) {
                img.classList.remove("error");
                img.removeAttribute("data-was-processed");
                img.removeAttribute("data-ll-status");
      
                img.classList.replace('RetryA','RetryB');
              }
              else if (img.classList.contains('RetryB')) {
                img.classList.remove("error");
                img.removeAttribute("data-was-processed");
                img.removeAttribute("data-ll-status");
      
                img.classList.replace('RetryB','RetryC');
              }
              else if (img.classList.contains('RetryC')) {
                img.classList.remove("error");
                img.removeAttribute("data-was-processed");
                img.removeAttribute("data-ll-status");
      
                img.classList.replace('RetryC','RetryD');
              }
              else if (img.classList.contains('RetryD')) {
               // End of the line - don't do anything here.
              }
              else {
                img.classList.remove("error");
                img.removeAttribute("data-was-processed");
                img.removeAttribute("data-ll-status");
      
                img.classList.add('RetryA');
      
                if (img.classList.contains('PriorityA')) {
                  // don't want to replace the initial image in this case
                }
                else {
                  if (img.classList.contains('portrait')) {
                    img.setAttribute("src", "img/hourglass.png");
                  }
                  else {
                    img.setAttribute("src", "img/hourglass_wide.png");
                  }
                }
              }
      
              if (img.classList.contains('PriorityA')) {
                setTimeout(function() {
                  window.lazyLoadInstance.update();
                },750);
              }
              else if (img.classList.contains('PriorityB')) {
                setTimeout(function() {
                  window.lazyLoadInstance.update();
                },750+Math.random()*500);
              }
              else {
                setTimeout(function() {
                  window.lazyLoadInstance.update();
                },1250+Math.random()*500);
              }
            }
            });
      
          var observer = new MutationObserver(function(mutations) {
            var image_count = 0;
            mutations.forEach(
              function(mutation) {
                for (var i = 0; i < mutation.addedNodes.length; i++) {
                    if (typeof mutation.addedNodes[i].getElementsByClassName !== 'function') {return;}
                      image_count += mutation.addedNodes[i].getElementsByClassName('lazy').length;
            }});
            if (image_count > 0) {
              window.lazyLoadInstance.update();
          }});
          var config = { childList: true, subtree: true };
          observer.observe(document.documentElement, config);
      window.swiper = new Swiper('.swiper', {
            slidesPerView: 'auto',
            preLoadImages: false,
            spaceBetween: 6,
            slidesOffsetBefore: 4,
            slidesOffsetAfter: 6,
            speed: 200,
            slidesPerGroupAuto: true,
            mousewheel: {},
          });
          window.swiper.on('click', function () {
            var clickedslide = swiper.clickedSlide;
            pas.Main.MainForm.ViewerMode = 'PersonPhotos';
            pas.Main.MainForm.ViewerURL1 = clickedslide.firstElementChild.getAttribute('src');
            pas.Main.MainForm.ViewerURL2 = clickedslide.firstElementChild.getAttribute('src').replace('/w45/','/original/');
            pas.Main.MainForm.ViewerURL2 = pas.Main.MainForm.ViewerURL2.replace('/w185/','/original/');
            pas.Main.MainForm.ViewerURLA = pas.Main.MainForm.PhotoA;
            pas.Main.MainForm.ViewerURLN = swiper.clickedIndex;
            pas.Main.MainForm.ViewerURLC = swiper.clickedIndex+1;
            pas.Main.MainForm.ViewerURLT = pas.Main.MainForm.PhotoCount;
            pas.Main.MainForm.ShowViewer();
          });
      
          // This sets up the main video image slider, visible when looking at roles
          // onClick is handled by <a> launching new tab with URL for video
          window.swiper2 = new Swiper('.swiper2', {
            slidesPerView: 'auto',
            watchOverflow: false,
            preLoadImages: false,
            spaceBetween: 3,
            slidesOffsetBefore: 4,
            slidesOffsetAfter: 6,
            slidesPerGroupAuto: true,
            grid: { rows: 2},
            mousewheel: {},
          });
      
          // This sets up the main backdrop image slider, visible when looking at roles
          window.swiper3 = new Swiper('.swiper3', {
            slidesPerView: 'auto',
            watchOverflow: false,
            preLoadImages: false,
            spaceBetween: 3,
            slidesOffsetBefore: 4,
            slidesOffsetAfter: 6,
            slidesPerGroupAuto: true,
            grid: { rows: 2},
            mousewheel: {},
          });
          window.swiper3.on('click', function () {
            var clickedslide = swiper3.clickedSlide;
            pas.Main.MainForm.ViewerMode = 'Backdrops';
            pas.Main.MainForm.ViewerURL1 = clickedslide.firstElementChild.getAttribute('data-src');
            pas.Main.MainForm.ViewerURL2 = clickedslide.firstElementChild.getAttribute('data-src').replace('/w300/','/original/');
            pas.Main.MainForm.ViewerURL2 = pas.Main.MainForm.ViewerURL2.replace('/w780/','/original/');
            pas.Main.MainForm.ViewerURLA = pas.Main.MainForm.PhotoA;
            pas.Main.MainForm.ViewerURLN = swiper3.clickedIndex;
            pas.Main.MainForm.ViewerURLC = swiper3.clickedIndex+1;
            pas.Main.MainForm.ViewerURLT = pas.Main.MainForm.BackgroundCount;
            pas.Main.MainForm.ShowViewer();
          });
      var GetBirthDays = this.GetBirthDays;
          this.Birthdate = flatpickr("#divFlatPickr", {
            altFormat: "F d",
            altInput: true,
            wrap: true,
            weekNumbers: true,
            defaultDate: new Date(),
            onChange: function(selectedDates, dateStr, instance) {
              if (dateStr !== '') {
                // Only using one at a time, so picking one clears the others
                document.querySelector("#divFlatPickr2")._flatpickr.clear();
                document.querySelector("#divFlatPickr3")._flatpickr.clear();
                GetBirthDays(parseInt(dateStr.substr(5,2)), parseInt(dateStr.substr(8,2)));
                pas.Main.MainForm.CurrentBirthDate = dateStr;
              }
            }
          });
          var birthdate_today = function(e) {
            e.stopPropagation();
            e.preventDefault();
            pas.Main.MainForm.Birthdate.setDate(new Date(),true);
          }
          window.birthdate_today = birthdate_today;
      
          var GetDeathDays = this.GetDeathDays;
          this.Deathdate = flatpickr("#divFlatPickr2", {
            altFormat: "F d",
            altInput: true,
            wrap: true,
            weekNumbers: true,
            onChange: function(selectedDates, dateStr, instance) {
              if (dateStr !== '') {
                // Only using one at a time, so picking one clears the others
                document.querySelector("#divFlatPickr")._flatpickr.clear();
                document.querySelector("#divFlatPickr3")._flatpickr.clear();
                GetDeathDays(parseInt(dateStr.substr(5,2)), parseInt(dateStr.substr(8,2)));
                pas.Main.MainForm.CurrentDeathDate = dateStr;
              }
            }
          });
          var deathdate_today = function(e) {
            e.stopPropagation();
            e.preventDefault();
            pas.Main.MainForm.Deathdate.setDate(new Date(),true);
          }
          window.deathdate_today = deathdate_today;
      
          var GetReleaseDays = this.GetReleaseDays;
          this.Releasedate = flatpickr("#divFlatPickr3", {
            altFormat: "F d",
            altInput: true,
            wrap: true,
            weekNumbers: true,
            onChange: function(selectedDates, dateStr, instance) {
              if (dateStr !== '') {
                // Only using one at a time, so picking one clears the others
                document.querySelector("#divFlatPickr")._flatpickr.clear();
                document.querySelector("#divFlatPickr2")._flatpickr.clear();
                pas.Main.MainForm.CurrentReleaseDate = dateStr;
              }
            }
          });
          var releasedate_today = function(e) {
            e.stopPropagation();
            e.preventDefault();
            pas.Main.MainForm.Releasedate.setDate(new Date(),true);
          }
          window.releasedate_today = releasedate_today;
      var headerMenu = function(){
            var menu = [];
            var columns = this.getColumns();
            var groups = this.getGroups();
            var table = this;
      
            for (let column of columns){
      
              if (!(column.getDefinition().title == null)) {
      
                // Build menu item
                var label = document.createElement("div");
                label.classList.add("d-flex", "flex-fill");
      
                // Create checkbox element using font awesome icons
                var icon = document.createElement("i");
                if (column.isVisible()) {
                  icon.classList.add("flex-grow-0", "ColVis", "fa-solid", "fa-check-square");
                }
                else
                {
                  icon.classList.add("flex-grow-0", "ColVis", "fa-solid", "fa-square");
                }
      
                // Menu Title
                let title = document.createElement("div");
                title.classList.add("ps-1", "ColVis", "flex-grow-1");
      
                if      (column.getDefinition().field == 'PIC'   ) { title.innerText = 'Image'; }
                else if (column.getDefinition().field == 'POP'   ) { title.innerText = 'Popularity'; }
                else if (column.getDefinition().field == 'HT1'   ) { title.innerText = 'Height'; }
                else if (column.getDefinition().field == 'CTZ'   ) { title.innerHTML = '<div style="display:flex; position:absolute; top: 3px; left: 12px;">'+window.icon_flag_special+'<div style="margin-top:2px;">Citizenship</div></div>'; }
                else if (column.getDefinition().field == 'CTG'   ) { title.innerHTML = '<div style="display:flex; position:absolute; top: 3px; left: 12px;">'+window.icon_flag_special+'<div style="margin-top:2px;">Production</div></div>'; }
                else if (column.getDefinition().field == 'IMC'   ) { title.innerText = 'Photos (Count)'; }
                else if (column.getDefinition().field == 'PopInt') { title.innerHTML = '<div style="position:absolute; top: 4px; left: 12px;">'+window.icon_star_sharp+'</div>'; }
                else if (column.getDefinition().field == 'TYP'   ) { title.innerHTML = '<div style="margin-top:-3px; margin-left: 1px; display:flex; fill:#fff !important;">'+window.icon_film+'<div style="margin-left:6px; margin-right:6px; margin-top:3px;">or</div>'+window.icon_tv+'</div>'; }
                else { title.innerText = column.getDefinition().title; }
      
                var grpAllow = false;
                if      (column.getDefinition().field == 'DOB')    { grpAllow = true; }
                else if (column.getDefinition().field == 'DOD')    { grpAllow = true; }
                else if (column.getDefinition().field == 'NUM')    { grpAllow = true; }
                else if (column.getDefinition().field == 'PopInt') { grpAllow = true; }
                else if (column.getDefinition().field == 'TYP')    { grpAllow = true; }
                else if (column.getDefinition().field == 'CTZ')    { grpAllow = true; }
      
                var groupicon = document.createElement("div");
                var group = document.createElement("div");
                if (grpAllow) {
                  groupicon.classList.add("flex-grow-0", "GroupVis", "fa-duotone", "fa-layer-group", "ps-3", "user-select-none");
                  group.classList.add("GroupVis", "flex-grow-0","ps-1", "fa-solid", "fa-circle");
                }
                else {
                  groupicon.classList.add("flex-grow-0", "px-3","user-select-none");
                }
      
                label.append(icon, title, groupicon, group);
      
                //create menu item
                menu.push({
                  label: label,
                  action: function(e){
                    e.stopPropagation();
      
                    var colchg = false;
                    var grpchg = false;
      
                    if (e.target.classList.contains('ColVis'))                      { colchg = true; }
                    else if (e.target.classList.contains('GroupVis'))               { grpchg = true; }
                    else if (e.target.parentElement.classList.contains('ColVis'))   { colchg = true; }
                    else if (e.target.parentElement.classList.contains('GroupVis')) { grpchg = true; }
      
                    // Toggle current column visibility
                    if (colchg) {
                      column.toggle();
                      if (column.isVisible()) {
                        e.currentTarget.firstElementChild.firstElementChild.classList.replace("fa-square","fa-check-square");
                      }
                      else {
                        e.currentTarget.firstElementChild.firstElementChild.classList.replace("fa-check-square","fa-square");
                      }
                    }
      
                    // toggle current column grouping
                    if (grpchg) {
                      column.getTable().setGroupBy(column.getField());
                    }
      
                  }
                });
      
                // Add a few separators
                if (   (column.getDefinition().field == 'HT1')
                    || (column.getDefinition().field == 'OVR')
                    || (column.getDefinition().field == 'PopInt')
                    || (column.getDefinition().title == 'Top TV Shows')) {
                  var sep = document.createElement("div");
                  sep.innerHTML = '<hr class="w-100 p-0 m-0 border-1 border-top border-secondary pe-none">';
                  menu.push({
                    label: sep
                  });
                }
      
                if ((column.getDefinition().field == 'OVR')  || (column.getDefinition().title == 'Top TV Shows')) {
                  let clrgroup = document.createElement("div");
                  clrgroup.innerHTML = '<div style="display:flex;">'+window.icon_xmark_left+'<div>Clear All Groups</div></div>';
                  menu.push({
                    label: clrgroup,
                    action: function(e){
                      e.stopPropagation();
                      column.getTable().setGroupBy(false);
                      column.getTable().redraw(true);
                    }
                  })
                }
              }
            }
      
            return menu;
          };
      if (divTop.parentNode.childNodes[1].nodeType == 3) {
          divTop.parentNode.childNodes[1].remove()
      };
      var headerNameFilter = function(e, column, onRendered){
            var container = document.createElement("div");
            container.classList.add("rounded", "border-2", "bg-dark", "mt-2");
      
            var label = document.createElement("label");
            label.innerHTML = "Filter By Name";
            label.style.display = "block";
            label.classList.add("text-white", "mb-2", "ms-1", "d-flex", "flex-fill", "align-items-center", "justify-content-between");
            label.style.height = "18px";
      
            var input = document.createElement("input");
            input.placeholder = "Name...";
            input.value = column.getHeaderFilterValue() || "";
            input.classList.add("rounded", "border-0", "ps-2", "m-1");
            input.autocomplete = "off";
            input.setAttribute('spellcheck', 'false');
            input.addEventListener("keyup", (e) => {
                column.setHeaderFilterValue(input.value);
                if (input.value.length > 0) { column.getElement().classList.add("FilterActive");}
                else {column.getElement().classList.remove("FilterActive");}
                if (event.keyCode === 13) { // key code of the keybord key
                  container.classList.add("d-none");
                }
            });
      
            var label2 = document.createElement("label");
            label2.innerHTML = "Filter By Birthplace";
            label2.style.display = "block";
            label2.classList.add("text-white","mt-2", "mb-2", "ms-1", "d-flex", "flex-fill", "align-items-center", "justify-content-between");
            label2.style.height = "18px";
      
            var input2 = document.createElement("input");
            input2.placeholder = "City/Region/Country...";
            input2.value = column.getTable().getColumn('BPL').getHeaderFilterValue() || "";
            input2.classList.add("rounded", "border-0", "ps-2", "m-1");
            input2.autocomplete = "off";
            input2.setAttribute('spellcheck', 'false');
            input2.addEventListener("keyup", (e) => {
                column.getTable().getColumn('BPL').setHeaderFilterValue(input2.value);
                if (input2.value.length > 0) { column.getElement().classList.add("FilterActive");}
                else {column.getElement().classList.remove("FilterActive");}
                if (event.keyCode === 13) { // key code of the keybord key
                  container.classList.add("d-none");
                }
            });
      
            var button = document.createElement("button");
            button.classList.add("btn", "pe-1", "btn-link","text-decoration-none");
            button.innerHTML = window.icon_xmark_right;
            button.addEventListener("click", (e) => {
              column.setHeaderFilterValue('');
              column.getTable().getColumn('BPL').setHeaderFilterValue('');
              column.getElement().classList.remove("FilterActive");
              input.value = '';
              input2.value = '';
              container.classList.add("d-none");
            });
      
            label.appendChild(button);
            container.appendChild(label);
            container.appendChild(input);
            container.appendChild(label2);
            container.appendChild(input2);
            setTimeout(function (){
              input.focus();
              input.select();
            },50);
      
            return container;
          };
      var nameHeaderFilter = function(){
        return document.createElement("span");
      };
      Tabulator.defaultOptions.rowHeight = 68;
      Tabulator.defaultOptions.initialSort = [{column:"PopInt", dir:"desc"}],
      Tabulator.defaultOptions.index = "ID";
      Tabulator.defaultOptions.height = "100%";
      Tabulator.defaultOptions.layout = "fitColumns";
      Tabulator.defaultOptions.movableColumns = true;
      Tabulator.defaultOptions.selectable = 1;
      Tabulator.defaultOptions.columnHeaderSortMulti = true,
      Tabulator.defaultOptions.clipboard = "copy";
      Tabulator.defaultOptions.placeholder = '<div style="justify-content: center; align-items: center;">No Records Found.</small></div>'+
                                             '<div style="justify-content: center; align-items: center;">'+window.icon_star_sharp_special+'<div>Searching.... Please Wait.</div></div>'+
                                             '<div style="justify-content: center; align-items: center;">'+window.icon_star_sharp_special+'<div>Preparing.... Please Wait.</div></div>'+
                                             '<div style="justify-content: center; align-items: center;">'+window.icon_star_sharp_special+'<div>Loading.... Please Wait.</div></div>'+
                                             '<div style="justify-content: center; align-items: center;"><i class="fa-duotone fa-cloud-exclamation fa-xl me-3"></i>Error.... Please retry later.</div></div>';
      Tabulator.defaultOptions.headerSortElement = window.icon_sort+window.icon_sort_up+window.icon_sort_down;
      Tabulator.defaultOptions.columnDefaults = {
        headerHozAlign: "left",
        hozAlign: "left",
        headerSortStartingDir:"desc",
        headerSortTristate:true
      };
      var checkImage = function(value, data, type, params, component){
        if ((value == null) || (value == '') || (value == '""')) {
          if      (params.imgtype == "person")   { return 'img/person-placeholder.png'; }
          else if (params.imgtype == "movie")    { return 'img/movie-placeholder.png';  }
          else if (params.imgtype == "tv")       { return 'img/tv-placeholder.png';     }
          else if (params.imgtype == "video")    { return 'img/movie-placeholder.png';  }
          else if (params.imgtype == "backdrop") { return 'img/movie-placeholder.png';  }
          else {
            if (data !== null) {
             if (data.TYP == 'tv') {
                return 'img/tv-placeholder.png'
              }
              else {
               return 'img/movie-placeholder.png';
              }
            }
            else if (type !== null) {
             if (type == 'tv') {
                return 'img/tv-placeholder.png'
              }
              else {
               return 'img/movie-placeholder.png';
              }
            }
          }
        }
        else if ((value.substr(0,4) == 'img/') || (value.substr(0,22) == 'https://image.tmdb.org')) {
          return value;
        }
        else {
          // Pick the smallest size available, and upsize them later if warranted
          if      (params.imgtype == "person"  ) { return "https://image.tmdb.org/t/p/w45" +value; }
          else if (params.imgtype == "movie"   ) { return "https://image.tmdb.org/t/p/w92" +value; }
          else if (params.imgtype == "tv"      ) { return "https://image.tmdb.org/t/p/w92" +value; }
          else if (params.imgtype == "tvmovie" ) { return "https://image.tmdb.org/t/p/w92" +value; }
          else if (params.imgtype == "video"   ) { return "https://image.tmdb.org/t/p/w300"+value; }
          else if (params.imgtype == "backdrop") { return "https://image.tmdb.org/t/p/w300"+value; }
          else {
            return 'img/movie-placeholder.png';
          }
        }
      };
      function PopularityInt(value, data, type, params, component) {
        // This isn't actually a field, so we pull in data from an actual field
        var starcount = parseInt(data.POP);
        if      ( starcount <=  2) { return 0;                 }
        else if ( starcount <=  5) { return 1+(data.POP/5);    }
        else if ( starcount <= 10) { return 2+(data.POP/10);   }
        else if ( starcount <= 20) { return 3+(data.POP/20);   }
        else if ( starcount <= 40) { return 4+(data.POP/40);   }
        else                       { return 5+(data.POP/1000); }
      };
      // Enable/populate the links at the top based on whatever external links we've been able
      // to cobble together from both TMDb and WikiData.  Got to do some basic checking as well
      // as sometimes there are links without data.  Something similar is done with the Links
      // field in ActorTabulator.
      function SetLNK(row,key,prefix,button,icon,alt){
        if (row.getCell(key) !== false) {
          var LNK = row.getCell(key).getValue();
          if ((LNK == null) || (LNK == "")) {
            button.style.opacity = 0.25;
            button.innerHTML = '<img style="padding:2px;" src='+icon+' height=100% width=100% alt="'+alt+'">';
          }
          else {
            button.style.opacity = 1.0;
            button.innerHTML = '<a aria-label="'+alt+'" target=_blank href='+prefix+LNK+'><img style="padding:2px;" src='+icon+' height=100% width=100% alt="'+alt+'">';
          }
        }
        else {
          button.style.opacity = 0.25;
          button.innerHTML = '<img style="padding:2px;" src='+icon+' height=100% width=100% alt="'+alt+'">';
        }
      }
      window.SetLNK = SetLNK;
      function SetTableLNK(cell,key,prefix,icon,alt){
        if (cell.getRow().getCell(key) !== false) {
          var LNK = cell.getRow().getCell(key).getValue();
          if (!((LNK == null) || (LNK == ""))) {
            return '<a aria-label="'+alt+'" target=_blank href='+prefix+LNK+'><img src='+icon+' height=34 width=34 style="margin-left:2px; margin-right:2px;" alt="'+alt+'"></a>';
          }
          else {
            return '';
          }
        }
        else {
          return '';
        }
      };
      function Role_Selected(e, row) {
            if ((!(row.getCell('ID').getValue() == pas.Main.MainForm.CurrentRole)) || (pas.Main.MainForm.MenuType == 0)) {
      
              // Track this so we don't have to do this update if the role hasn't changed
              pas.Main.MainForm.CurrentRole = row.getCell('TID').getValue();
      //        pas.Main.MainForm.CurrentPerson = -1;
      
              // Change Title to reflect what we're looking at
              // document.title = 'Actorious-'+row.getCell('NAM').getValue();
      
              // Load photo from RoleTabulator into DIV
              // Swap the w92 size for the h632
              // Changing innerHTML isn't enough to trigger MutationObserver, so we create an element and add it.
              let poster = checkImage(row.getCell('PIC').getValue(),null,row.getCell('TYP').getValue(),{imgtype:"tvmovie"})
              divPhoto.innerHTML =
                '<div style="width:185px; height:278px;">'+
                  '<img '+
                    'alt="Photo of '+row.getCell('NAM').getValue()+'" '+
                    'class="lazy portrait PriorityA" '+
                    'style="width:185px; height:auto;" '+
                    'src='+poster+' '+
                    'data-src='+poster.replace('/w92/','/w185/')+' '+
                    'onerror="this.onerror=null;this.src=\'img/hourglass.png\'"'+
                  '/>'+
                '</div>';
              pas.Main.MainForm.Photo1 = poster;
              pas.Main.MainForm.Photo2 = poster.replace('/w92/','/original/');
              pas.Main.MainForm.PhotoA = row.getCell('NAM').getValue();
      
              // Load biography from ActorTabulator into DIV
              // Convert \n characters into paragraphs
              // Add word count just for fun
              pas.Main.MainForm.BioWords = 0;
              if (row.getCell('OVR').getValue()) {
                try {
                  var biotext = decodeURIComponent(row.getCell('OVR').getValue());
                } catch {
                  var biotext = (row.getCell('OVR').getValue());
                }
                if ((biotext == 'undefined') || (biotext == '')) {
                  biotext = '<h5>No summary information was found.<h5>';
                  pas.Main.MainForm.BioWords = 0;
                }
                else {
                  pas.Main.MainForm.BioWords = biotext.trim().split(/\s+/).length;
                }
              divBiography.innerHTML = '<div class="w-100 h-100 ps-2 pe-2 pb-4" style="white-space:normal; overflow-y:auto;">'+
                  '<h4>'+row.getCell('NAM').getValue()+'</h4>'+
                  '<h5>'+(row.getCell('TGL').getValue() || '')+'</h5>'+
                  '<p>'+biotext.replace("\n","</p><p>")+'</p></div>';
              }
      
              // Populate some buttons
              window.SetLNK(row,'TID','https://www.themoviedb.org/'+row.getCell('TYP').getValue()+'/', linkTMDb,     'img/tmdb_icon.svg',           'TMDb Link');
              window.SetLNK(row,'WID','',                                   linkWikiData,                            'img/wikidata_icon.png',       'WikiData Link');
              window.SetLNK(row,'IID','https://www.imdb.com/name/',         linkIMDb,                                'img/imdb_icon.png',           'IMDb Link');
              window.SetLNK(row,'RID','https://www.rottentomatoes.com/',    linkRottenTomatoes,                      'img/rottentomatoes_icon.png', 'Rotten Tomatoes Link');
              window.SetLNK(row,'MET','https://www.metacritic.com/',        linkMetaCritic,                          'img/metacritic_icon.png',     'MetaCritic Link');
              window.SetLNK(row,'WWW','',                                   linkWeb,                                 'img/web_icon.png',            'Website Link');
      
              window.SetLNK(row,'WIK','',                                   linkWikipedia,                           'img/wikipedia_icon.png',      'Wikipedia Link');
              window.SetLNK(row,'FID','https://www.facebook.com/',          linkFacebook,                            'img/facebook_icon.png',       'Facebook Link');
              window.SetLNK(row,'INS','https://www.instagram.com/',         linkInstagram,                           'img/instagram_icon.png',      'Instagram Link');
              window.SetLNK(row,'TWT','https://www.twitter.com/',           linkTwitter,                             'img/twitter_icon.png',        'Twitter Link');
              window.SetLNK(row,'MID','https://www.models.com/people/',     linkModels,                              'img/models_icon.png',         'Models.com Link');
      
              // Populate the Pop button
              // This fills in the Pop figure, in amongst the other buttons above
              var pop = row.getCell('POP').getValue();
              var LNK = row.getCell('TID').getValue();
              linkScore.style.opacity = 1.0;
              linkScore.innerHTML = '<div style="margin-top:1px; width:100%; height:100%; text-align:center; vertical-align:middle;"><a aria-label="Link Score on TMDb" style="text-decoration:none; font-size:12px; color:#01b4e4;" target=_blank href=https://www.themoviedb.org/person/'+LNK+'><strong>'+pop.toFixed(0)+'</strong></a></div>';
      
              // Populate the linkLINK button
              linkLink.style.opacity = 1.0;
              pas.Main.MainForm.SetBootstrapTooltipDiv(pas.Main.MainForm.linkLink, 'PermaLink to '+row.getCell('NAM').getValue(), 'right');
              linkLink.innerHTML = '<div style="padding:2px 2px;"><a aria-label="PermaLink" target=_blank style="fill:var(--bs-gray-200); text-decoration:none;" href="'+window.location.href.split('?')[0]+'?R='+row.getCell('TYP').getValue().slice(0,1).toUpperCase()+window.to29(row.getCell('TID').getValue())+'-'+row.getCell('NAM').getValue().replaceAll(' ','-')+'">'+window.icon_link+'</a></div>';
      
              // Populate the linkGoogleImageSearch button
              linkGoogleImageSearch.style.opacity = 1.0;
              linkGoogleImageSearch.innerHTML = '<a target=_blank aria-label="Google Image Search" style="text-decoration:none;" href="https://www.google.com/search?q='+row.getCell('NAM').getValue().replaceAll(' ','+')+'+'+row.getCell('TYP').getValue()+'&tbm=isch"><img style="padding:3px; width:100%; height:100%;" alt="Google Images Logo" src="img/google_icon.png"></a>';
      
              // This fills in the Height/Runtime figure, in amongst the other buttons above
              var runtime = '';
              if (row.getCell('RTM').getValue() !== undefined) {
                runtime = row.getCell('RTM').getValue();
                if (runtime == 0) {
                  runtime = '';
                }
                else {
                  runtime = Math.floor(runtime/60)+' h<br />'+(runtime - (60*Math.floor(runtime/60)))+' m';
                }
              }
              if (runtime == '') {
                linkHeight.style.opacity = 0.25;
                linkHeight.innerHTML = '';
              }
              else {
                linkHeight.style.opacity = 1.0;
                linkHeight.innerHTML = '<div style="margin-top:3px; width:100%; height:100%; font-size:10px; color:var(--bs-light); line-height:1.2; text-align:center; vertical-align:middle;">'+runtime+'</div>';
              }
      
      
              // This fills in the Citizenship/Country flag
              var country = row.getCell('CTG').getValue();
              if (country !== undefined) {
                if (country.length > 0) {
                  linkCitizenship.style.opacity = 1.0;
                  linkCitizenship.innerHTML = '<div style="font-size:15px;" class="border border-0 fp fp-lg fp-square '+country[0].toLowerCase()+'"></div>';
                }
                else {
                  linkCitizenship.style.opacity = 0.25;
                  linkCitizenship.innerHTML = '<div style="font-size:16px;" class="rounded bg-dark border border-secondary fp fp-lg fp-square lgbt"></div>';
                }
              }
              else {
                linkCitizenship.style.opacity = 0.25;
                linkCitizenship.innerHTML = '<div style="font-size:16px;" class="rounded bg-dark border border-secondary fp fp-lg fp-square lgbt"></div>';
              }
      
      
              // Load up the Photo/Poster Slider
              var imagecount = 0;
              var slides = '';
              if (row.getCell('PSC') !== undefined) {
                if (row.getCell('PSC').getValue() > 0) {
                  var imagelist = row.getCell('PSG').getValue();
                  var altphoto = '"Poster of '+row.getCell('NAM').getValue()+'" ';
                  imagecount = imagelist.length;
                  for (var i = imagecount-1; i >= 0; i--) {
                    var image = checkImage(imagelist[i],null,row.getCell('TYP').getValue(),{imgtype:"tvmovie"});
                    slides = slides+'<div class="swiper-slide" style="width:154px !important; height:234px;">'+
                                       '<img '+
                                         'class="rounded lazy portrait" '+
                                         'style="cursor: pointer; width: 156px; height: auto;"'+
                                         'src='+image+' '+
                                         'data-src='+image.replace('/w92/','/w185/')+' '+
                                         'alt='+altphoto+
                                         'onerror="this.onerror=null;this.src=\'img/hourglass.png\'"'+
                                       '/>'+
                                     '</div>';
                  }
                }
              }
              divPhotoSlider.firstElementChild.firstElementChild.firstElementChild.innerHTML = slides;
              pas.Main.MainForm.PhotoCount = imagecount;
              window.swiper.update();
              window.swiper.slideTo(0,0,true);
      
      
              // Load up the Videos slider
              var imagecount = 0;
              var slides = '';
              if (row.getCell('VDC') !== undefined) {
                if (row.getCell('VDC').getValue() > 0) {
                  var imagelist = row.getCell('VDS').getValue();
                  var altvideo = '"Video for '+row.getCell('NAM').getValue()+'" ';
                  imagecount = imagelist.length;
                  for (var i = 0; i < imagecount; i++) {
                    if (imagelist[i].indexOf('YouTube:') !== -1) {
                      var image = imagelist[i].substr(8,50);
                      slides = slides+'<div class="swiper-slide" style="width:208px !important; height:117px !important;">'+
                                        '<a href="https://www.youtube.com/watch?v='+image+'" target=_blank aria-label='+altvideo+'>'+
                                          '<img '+
                                            'class="rounded lazy landscape" '+
                                            'style="cursor: pointer; width: 206px; height: auto;"'+
                                            'src="https://img.youtube.com/vi/'+image+'/default.jpg" '+
                                            'data-src="https://img.youtube.com/vi/'+image+'/mqdefault.jpg" '+
                                            'alt='+altvideo+
                                            'onerror="this.onerror=null;this.src=\'img/hourglass_wide.png\'"'+
                                          '/>'+
                                        '</a>'+
                                      '</div>';
                    }
                  }
                }
              }
              divVideoSlider.firstElementChild.firstElementChild.firstElementChild.innerHTML = slides;
              pas.Main.MainForm.VideoCount = imagecount;
              window.swiper2.update();
              window.swiper2.slideTo(0,0,true);
      
              // Load up the Backdrop slider
              var imagecount = 0;
              var slides = '';
              if (row.getCell('BDC') !== undefined) {
                if (row.getCell('BDC').getValue() > 0) {
                  var imagelist = row.getCell('BDS').getValue();
                  var altphoto = '"Backdrop from '+row.getCell('NAM').getValue()+'" ';
                  imagecount = imagelist.length;
                  for (var i = 0; i < imagecount; i++) {
                    var image = checkImage(imagelist[i],null,null,{imgtype:"backdrop"});
                    slides = slides+'<div class="swiper-slide" style="width:208px height:117px !important;">'+
                                       '<img '+
                                         'class="rounded lazy landscape" '+
                                         'style="cursor: pointer; width:208px; height:auto"'+
                                         'src='+image+' '+
                                         'data-src='+image+' '+
                                         'alt='+altphoto+
                                         'onerror="this.onerror=null;this.src=\'img/hourglass_wide.png\'"'+
                                       '/>'+
                                     '</div>';
                  }
                }
              }
              divBackgroundSlider.firstElementChild.firstElementChild.firstElementChild.innerHTML = slides;
              pas.Main.MainForm.BackgroundCount = imagecount;
              window.swiper3.update();
              window.swiper3.slideTo(0,0,true);
      
      
      
              // Update the top menu with the Role values
              if (row.getCell('TYP').getValue() == 'movie') { pas.Main.MainForm.MenuType = 1; }
              else { pas.Main.MainForm.MenuType = 2 };
              window.RefreshMenu();
      
              // We've potentially added some images (via the Photo slider at least)
              // so let's make sure they're all loaded
              pas.Main.MainForm.tmrImageCheckEnable();
            }
          };
          window.Role_Selected = Role_Selected;
      function Actor_Selected(e, row){
      
            if ((!(row.getCell('TID').getValue() == pas.Main.MainForm.CurrentPerson)) || !(pas.Main.MainForm.MenuType == 0)) {
      
              // Not in startup if we don't have any startup data
              if (pas.Main.MainForm.PhotoA == 'Unknown') {
                pas.Main.MainForm.Startup = false;
              }
      
      
              // Load photo from ActorTabulator into DIV
              // Swap the w45 size for the h632
              // Changing innerHTML isn't enough to trigger MutationObserver, so we create an element and add it.
              if (!(pas.Main.MainForm.Startup)) {
                let portrait = checkImage(row.getCell('PIC').getValue(),null,null,{imgtype:"person"})
                divPhoto.innerHTML =
                  '<div style="width:185px; height:278px;">'+
                    '<img '+
                      'alt="Photo of '+row.getCell('NAM').getValue()+'" '+
                      'class="lazy portrait PriorityA" '+
                      'style="width:185px; height:auto;" '+
                      'src='+portrait+' '+
                      'data-src='+portrait.replace('/w45/','/w185/')+' '+
                      'onerror="this.onerror=null;this.src=\'img/hourglass.png\'"'+
                    '/>'+
                  '</div>';
                pas.Main.MainForm.Photo1 = portrait;
                pas.Main.MainForm.Photo2 = portrait.replace('/w45/','/original/');
                pas.Main.MainForm.PhotoA = row.getCell('NAM').getValue();
              }
      
      
              // Connections
              var relatives = row.getCell('WID').getValue();
              if (relatives !== undefined) {
                relatives = parseInt(relatives.split('Q')[1]);
                pas.Main.MainForm.btnSetRelatives(relatives, row.getCell('NAM').getValue())
              }
              else {
                pas.Main.MainForm.btnSetRelatives(-1, row.getCell('NAM').getValue())
              }
      
      
              // Load biography from ActorTabulator into DIV
              // Convert \n characters into paragraphs
              // Add word count just for fun
              pas.Main.MainForm.BioWords = 0;
              try {
                var biotext = decodeURIComponent(row.getCell('BIO').getValue());
              } catch {
               var biotext = row.getCell('BIO').getValue();
              }
              if ((biotext == 'undefined') || (biotext == '')) {
                biotext = '<h5>No biographical information was found.<h5>';
                pas.Main.MainForm.BioWords = 0;
              }
              else {
                pas.Main.MainForm.BioWords = biotext.trim().split(/\s+/).length;
              }
              divBiography.innerHTML = '<div class="w-100 h-100 ps-2 pe-2 pb-4" style="white-space:normal; overflow-y:auto;">'+
                '<h4>'+row.getCell('NAM').getValue()+'</h4>'+
                '<p>'+biotext.replace("\n","</p><p>")+'</p></div>';
      
      
              // Set Links
              window.SetLNK(row,'TID','https://www.themoviedb.org/person/', linkTMDb,           'img/tmdb_icon.svg',           'TMDb Link');
              window.SetLNK(row,'WID','',                                   linkWikiData,       'img/wikidata_icon.png',       'WikiData Link');
              window.SetLNK(row,'IID','https://www.imdb.com/name/',         linkIMDb,           'img/imdb_icon.png',           'IMDb Link');
              window.SetLNK(row,'RID','https://www.rottentomatoes.com/',    linkRottenTomatoes, 'img/rottentomatoes_icon.png', 'Rotten Tomatoes Link');
              window.SetLNK(row,'MET','https://www.metacritic.com/',        linkMetaCritic,     'img/metacritic_icon.png',     'MetaCritic Link');
              window.SetLNK(row,'WWW','',                                   linkWeb,            'img/web_icon.png',            'Website Link');
      
              window.SetLNK(row,'WIK','',                                   linkWikipedia,      'img/wikipedia_icon.png',      'Wikipedia Link');
              window.SetLNK(row,'FID','https://www.facebook.com/',          linkFacebook,       'img/facebook_icon.png',       'Facebook Link');
              window.SetLNK(row,'INS','https://www.instagram.com/',         linkInstagram,      'img/instagram_icon.png',      'Instagram Link');
              window.SetLNK(row,'TWT','https://www.twitter.com/',           linkTwitter,        'img/twitter_icon.png',        'Twitter Link');
              window.SetLNK(row,'MID','https://www.models.com/people/',     linkModels,         'img/models_icon.png',         'Models.com Link');
      
              // This fills in linkLINK
              linkLink.style.opacity = 1.0;
              pas.Main.MainForm.SetBootstrapTooltipDiv(pas.Main.MainForm.linkLink, 'PermaLink to '+row.getCell('NAM').getValue(), 'right');
              linkLink.innerHTML = '<div style="padding:2px 2px;"><a aria-label="PermaLink" target=_blank style="fill:var(--bs-gray-200); text-decoration:none;" href="'+window.location.href.split('?')[0]+'?R=P'+window.to29(row.getCell('TID').getValue())+'-'+row.getCell('NAM').getValue().replaceAll(' ','-')+'">'+window.icon_link+'</a></div>';
      
              // This fills in linkGoogleImageSearch
              linkGoogleImageSearch.style.opacity = 1.0;
              linkGoogleImageSearch.innerHTML = '<a aria-label="Google Image Search" target=_blank style="text-decoration:none;" href="https://www.google.com/search?q='+row.getCell('NAM').getValue().replaceAll(' ','+')+'&tbm=isch"><img style="padding:3px; width:100%; height:100%;" alt="Google Images Logo" src="img/google_icon.png"></a></div>';
      
      
              // This fills in the Actorious Points figure, in amongst the other buttons above
              var pts = row.getCell('PTS').getValue();
              if (pts !== undefined) {
                if (pts < 100) { linkScore.innerHTML = '<div style="cursor:help; margin-top:6px; width:100%; height:100%; text-align:center; vertical-align:middle; font-size:12px;color:#01b4e4;">'+pts.toFixed(1)+'</strong></div>'; }
                else           { linkScore.innerHTML = '<div style="cursor:help; margin-top:6px; width:100%; height:100%; text-align:center; vertical-align:middle; font-size:12px;color:#01b4e4;">'+pts.toFixed(0)+'</strong></div>'; }
                linkScore.style.opacity = 1.0;
                var ptb = row.getCell('PTB').getValue();
                if (ptb !== undefined) {
                  var breakdown = '<table style="border-collapse: collapse; border: none !important; font-size:12px !important">'+
                                    '<tr><td colspan="2"><strong>Actorious Score</strong></td></tr>'+
                                    '<tr><td style="text-align:left;">Basic Info</td><td style="text-align:right; min-width:50px;">'+ptb["Basic"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">TMDb Score</td><td style="text-align:right;">'+ptb["TMDb"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">Social Media</td><td style="text-align:right;">'+ptb["Social"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">Movies</td><td style="text-align:right;">'+ptb["Movies"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">- Bonus</td><td style="text-align:right;">'+ptb["MoviesBonus"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">- Recent</td><td style="text-align:right;">'+ptb["MoviesRecent"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">TV Shows</td><td style="text-align:right;">'+ptb["TVShows"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">- Bonus</td><td style="text-align:right;">'+ptb["TVBonus"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">- Recent</td><td style="text-align:right;">'+ptb["TVRecent"].toFixed(1)+'</td></tr>'+
                                    '<tr><td style="text-align:left;">Awards</td><td style="text-align:right;">'+ptb["Awards"].toFixed(1)+'</td></tr>'+
                                  '</table>';
                  pas.Main.MainForm.SetBootstrapTooltipDiv(pas.Main.MainForm.linkScore, breakdown, 'left');
                }
                else {
                  pas.Main.MainForm.SetBootstrapTooltipDiv(pas.Main.MainForm.linkScore, '<strong>Actorious Score</strong><br />Not Calculated', 'left');
                }
              }
              else {
                linkScore.innerHTML = ''
                linkScore.style.opacity = 0.25;
                pas.Main.MainForm.SetBootstrapTooltipDiv(pas.Main.MainForm.linkScore, '<strong>Actorious Score</strong><br />Not Calculated', 'left');
              }
      
      
              // This fills in the Citizenship/contry flag
              var country = row.getCell('CTZ').getValue();
              if (country !== undefined) {
                linkCitizenship.style.opacity = 1.0;
                linkCitizenship.innerHTML = '<div style="font-size:15px;" class="border border-0 fp fp-lg fp-square '+country.toLowerCase()+'"></div>';
              }
              else {
                linkCitizenship.style.opacity = 0.25;
                linkCitizenship.innerHTML = '<div style="font-size:16px;" class="rounded bg-dark border border-secondary fp fp-lg fp-square lgbt"></div>';
              }
      
              // This fills in the Height/Runtime figure, in amongst the other buttons above
              var height1 = '';
              var height2 = '';
              if (row.getCell('HT1').getValue() !== undefined) {
                height1 = row.getCell('HT1').getValue();
                height2 = row.getCell('HT2').getValue();
              }
              if (height1 == '') {
                linkHeight.style.opacity = 0.25;
                linkHeight.innerHTML = '';
              }
              else {
                linkHeight.style.opacity = 1.0;
                linkHeight.innerHTML = '<div style="margin-top:3px; width:100%; height:100%; font-size:10px; color:var(--bs-light); line-height:1.2; text-align:center; vertical-align:middle;">'+height1+'<br />'+height2+'</div>';
              }
      
      
              // Load up the Photo/Poster Slider
              var imagecount = 0;
              var slides = '';
              if (row.getCell('IMC') !== undefined) {
                if (row.getCell('IMC').getValue() > 0) {
                  var imagelist = row.getCell('IMG').getValue();
                  var altphoto = '"Photo of '+row.getCell('NAM').getValue()+'" ';
                  imagecount = imagelist.length;
                  for (var i = imagecount-1; i >= 0; i--) {
                    var image = checkImage(imagelist[i],null,null,{imgtype:"person"});
                    slides = slides+'<div class="swiper-slide" style="width:156px !important; height:234px !important">'+
                                       '<img '+
                                         'class="rounded lazy portrait" '+
                                         'style="cursor: pointer; width: 156px; height: auto;"'+
                                         'src='+image+' '+
                                         'data-src='+image.replace('/w45/','/w185/')+' '+
                                         'alt='+altphoto+
                                         'onerror="this.onerror=null;this.src=\'img/hourglass.png\'"'+
                                       '/>'+
                                     '</div>';
                  }
                }
              }
              divPhotoSlider.firstElementChild.firstElementChild.firstElementChild.innerHTML = slides;
              pas.Main.MainForm.PhotoCount = imagecount;
              window.swiper.update();
              window.swiper.slideTo(0,0,true);
      
      
              if (!(pas.Main.MainForm.CurrentPerson == row.getCell('TID').getValue())) {
                pas.Main.MainForm.CurrentPerson = row.getCell('TID').getValue();
      
                // Get data for RoleTabulator from Work field in ActorTabulator
                var roleData = row.getCell('WRK').getValue();
                var RoleTable = pas.Main.MainForm.RoleTabulator;
      
                // Filter out Adult content
                var adult = pas.Main.MainForm.AdultContent;
                var acount = 0;
                if (!adult) {
                  for (var i = roleData.length - 1; i >= 0; i--) {
                    if (roleData[i]['XXX'] == true) {
                      roleData.splice(i,1);
                      acount++;
                    }
                  }
                }
                else {
                  for (var i = roleData.length - 1; i >= 0; i--) {
                    if ((roleData[i]['XXX'] == false) || (roleData[i]['XXX'] == undefined)) {
                      roleData.splice(i,1);
                      acount++;
                    }
                  }
                }
      
                RoleTable.setData(roleData)
                .then(function(){
      
                  // update the first column header to show a count
                  var rowCount = RoleTable.getDataCount("active");
                  if (RoleTable.getDataCount() !== rowCount) {
                    window.rolecount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>';
                  }
                  else {
                    window.rolecount.innerHTML = rowCount;
                  };
      
                  var title = pas.Main.MainForm.TopTitle;
                  if (title !== '') {
                    pas.Main.MainForm.TopTitle = '';
                    RoleTable.deselectRow();
                    var rows = RoleTable.searchRows('NAM',"=",title);
                    if (rows.length > 0) {
                      RoleTable.selectRow(rows[0]);
                      RoleTable.scrollToRow(rows[0],"top",false);
                    }
                  }
                  else {
                    var rows = RoleTable.searchRows('TID',"=", pas.Main.MainForm.CurrentRole);
                    if (rows.length > 0) {
                      RoleTable.selectRow(rows[0]);
                      RoleTable.scrollToRow(rows[0],"top",false);
                    }
                    else if (rowCount > 0) {
                      RoleTable.selectRow(RoleTable.getRowFromPosition(1, true));
                    }
                  }
                });
              }
      
      
              // We've potentially added some images (via the Photo slider at least)
              // so let's make sure they're all loaded
              pas.Main.MainForm.tmrImageCheckEnable();
      
      
              // Update Top Menu
              if (pas.Main.MainForm.Startup == true) {
                pas.Main.MainForm.Startup = false;
              }
              pas.Main.MainForm.MenuType = 0; // Person
              window.RefreshMenu();
      
            }
          };
          window.Actor_Selected = Actor_Selected;
      function tooltip_actor_PIC(e, cell, onRendered) {
            var rect = e.target.getBoundingClientRect();
            var x = e.clientX - rect.left;
            var y = e.clientY - rect.top;
            var el = document.createElement("div");
            var image = checkImage(cell.getValue(),null,null,{imgtype:"person"});
      
            el.classList.add('tooltip','show','imageright');
            el.style.background = "none";
            el.style.border = "0";
            el.style.borderRadius = "0.3rem";
            el.style.transform = "translate("+(25-parseInt(x))+"px,"+(-78-parseInt(y))+"px)";
            el.style.margin = "4px";
            el.innerHTML = '<div class="tooltip-inner">'+cell.getRow().getCell('NAM').getValue()+'<br /><img alt="Photo of "'+cell.getRow().getCell('NAM').getValue()+'" class="lazy" src='+image+' data-src='+image.replace("/w45/","/w185/")+' width=92 height=auto></div>';
            return el;
          };
      function tooltip_role_PIC(e, cell, onRendered) {
            var rect = e.target.getBoundingClientRect();
            var x = e.clientX - rect.left;
            var y = e.clientY - rect.top;
            var el = document.createElement("div");
            var image = checkImage(cell.getValue(),null,cell.getRow().getCell('TYP').getValue(),{imgtype:"tvmovie"});
      
            el.classList.add('tooltip','show','imageright');
            el.style.background = "none";
            el.style.border = "0";
            el.style.borderRadius = "0.3rem";
            el.style.transform = "translate("+(25-parseInt(x))+"px,"+(-78-parseInt(y))+"px)";
            el.style.margin = "4px";
            el.innerHTML = '<div class="tooltip-inner">'+cell.getRow().getCell('NAM').getValue()+'<br /><img alt="Poster of '+cell.getRow().getCell('NAM').getValue()+'" src='+image+' width=92 height=auto></div>';
            return el;
          };
      function tooltip_role_NAM(e, cell, onRendered) {
            var rect = e.target.getBoundingClientRect();
            var x = e.clientX - rect.left;
            var y = e.clientY - rect.top;
            var el = document.createElement("div");
      
            var NAM = cell.getRow().getCell("NAM").getValue();
            var CHX = cell.getRow().getCell("CHX").getValue();
            if (CHX == undefined) {
              CHX = cell.getRow().getCell("CHR").getValue();
            }
      
            el.classList.add('tooltip','show','imageright');
            el.style.background = "none";
            el.style.border = "0";
            el.style.borderRadius = "0.3rem";
            el.style.transform = "translate("+(25-parseInt(x))+"px,"+(-78-parseInt(y))+"px)";
            el.style.margin = "4px";
            el.innerHTML = '<div class="tooltip-inner"><strong>'+NAM+'</strong><br />'+CHX+'</div>';
            return el;
          };
      function tooltip_actor_Top(e, cell, onRendered) {
            var pic = e.target.outerHTML;
            var title = pic.substring(pic.indexOf('atitle')+8,pic.indexOf('src=')-2);
            if (title.length > 0) {
              var rect = e.target.getBoundingClientRect();
              var x = e.clientX - rect.left;
              var y = e.clientY - rect.top;
              var image = pic.substring(pic.indexOf('src')+4,pic.indexOf('width=')-1);
              var el = document.createElement("div");
      
              el.classList.add('tooltip', 'show', 'imageright');
              el.style.background = "none";
              el.style.border = "0";
              el.style.borderRadius = "0.3rem";
              el.style.transform = "translate("+(25-parseInt(x))+"px,"+(-78-parseInt(y))+"px)";
              el.style.margin = "4px";
              el.innerHTML = "<div class='tooltip-inner'>"+title+"<br /><img alt='Top Role' src="+image+" width=92 height=auto></div>";
              return el;
            }
            else {
              return ''
            }
          };
      function tooltip_role_Top(e, cell, onRendered) {
            let pic = e.target.outerHTML;
            if ((pic.indexOf('atitle') > 0) && (pic.indexOf('Missing Person Placeholder') == -1)) {
              let title = pic.substring(pic.indexOf('atitle')+8,pic.indexOf('src=')-2);
              let character = pic.substring(pic.indexOf('acharacter')+12,pic.indexOf('alt=')-2);
              if (character !== '') {
                character = '<br />'+character;
              }
              var rect = e.target.getBoundingClientRect();
              var x = e.clientX - rect.left;
              var y = e.clientY - rect.top;
              var image = pic.substring(pic.indexOf('src')+4,pic.indexOf('data-src=')-1);
              var el = document.createElement("div");
      
              el.classList.add('tooltip', 'show', 'imageright');
              el.style.background = "none";
              el.style.border = "0";
              el.style.borderRadius = "0.3rem";
              el.style.transform = "translate("+(25-parseInt(x))+"px,"+(-78-parseInt(y))+"px)";
              el.style.margin = "4px";
              el.innerHTML = '<div class="tooltip-inner">'+title+'<br /><img alt="Top Role" class="lazy" src='+image+' data-src='+image.replace('/w45/','/w185/')+' width=92 height=auto>'+character+'</div>';
              return el;
            }
            else {
              return ''
            }
          };
      function formatter_actor_PIC(cell, formatterParams, onRendered) {
        let image = checkImage(cell.getValue(),null,null,{imgtype:"person"});
        return '<div style="color:transparent;">'+
                 '<img class="lazy portrait PriorityB" '+
                      'src='+image+' '+
                      'data-src='+image+' '+
                      'alt="Photo of "'+cell.getRow().getCell('NAM')+'" '+
                      'width=45 '+
                      'height=68 '+
                      'onerror="this.onerror=null;this.src=\'img/hourglass.png\';"'+
                    '>'+
                  '</div>';
      };
      function formatter_actor_NAM(cell, formatterParams, onRendered) {
            var actor = '<div style="padding:0px 4px;"><strong>'+cell.getRow().getCell('NAM').getValue()+'</strong>';
            var homepage = cell.getRow().getCell('WWW').getValue();
            var birthplace = cell.getRow().getCell('BPL').getValue();
      
            if (birthplace == null) { birthplace = '<br />'}
            else {birthplace = '<br />'+birthplace };
      
            if (homepage == null) { homepage = '<br /></div>' }
            else {homepage = '<br /><small><strong><a aria-label="Personal Website" style="text-decoration:none;" href="'+decodeURIComponent(homepage)+'" target="_blank">'+decodeURIComponent(homepage)+'</a></strong></small></div>'};
      
            return actor+birthplace+homepage;
          };
      function formatter_actor_DOB(cell, formatterParams, onRendered) {
        var dob = cell.getValue();
        var dod = cell.getRow().getCell('DOD').getValue();
        var age = 0;
        if (dob !== undefined) {
          if (dod == null) {
            return '<div style="padding:0px 4px;">'+luxon.DateTime.fromISO(dob, {zone: "utc"}).toFormat('yyyy-MMM-dd')
                   +'<br />Age '+getage(luxon.DateTime.fromISO(dob, {zone:"utc"}).toFormat('yyyyMMdd'), luxon.DateTime.now().toUTC().toFormat('yyyyMMdd'))+'</div>'
          }
          else  {
            return '<div style="padding:0px 4px;">'+luxon.DateTime.fromISO(dob, {zone: "utc"}).toFormat('yyyy-MMM-dd')
                   +'<br />'+luxon.DateTime.fromISO(dod, {zone: "utc"}).toFormat('yyyy-MMM-dd')
                   +'<br />Age '+getage(luxon.DateTime.fromISO(dob, {zone: "utc"}).toFormat('yyyyMMdd'),luxon.DateTime.fromISO(dod, {zone: "utc"}).toFormat('yyyyMMdd'))+'</div>'
          }
        }
        else {
          return '<div></div>';
        }
      };
      function formatter_actor_DOD(cell, formatterParams, onRendered) {
            var dod = cell.getValue();
            var dob = cell.getRow().getCell('DOB').getValue();
            var age = 0;
      
            if (dob !== undefined) {
              if (dod == null) {
                return '<div></div>'
              }
              else {
                var ya = getage(luxon.DateTime.fromISO(dod, {zone: "utc"}).toFormat('yyyyMMdd'),luxon.DateTime.now().toUTC().toFormat('yyyyMMdd'));
                var yatext = '';
                if (ya > 1) {
                  yatext = ya+' Years Ago'
                }
                else if (ya == 1) {
                  yatext = '1 year ago'
                }
                else if (ya == 0) {
                  yatext = 'This Past Year'
                }
                return '<div style="padding:0px 4px;">'+luxon.DateTime.fromISO(dod, {zone: "utc"}).toFormat('yyyy-MMM-dd')
                       +'<br />Age '+getage(luxon.DateTime.fromISO(dob, {zone: "utc"}).toFormat('yyyyMMdd'),luxon.DateTime.fromISO(dod, {zone: "utc"}).toFormat('yyyyMMdd'))
                       +'<br />'+yatext+'</div>'
              }
            }
            else {
              return '<div></div>';
            }
          };
      function formatter_actor_CTZ(cell, formatterParams, onRendered) {
        var country = cell.getValue();
        if (country !== undefined) {
          return '<div style="font-size:25px; margin-top:9px;" class="fp fp-lg '+country.toLowerCase()+'"></div>';
        }
        else {
          return '';
        }
      };
      function formatter_actor_HT1(cell, formatterParams, onRendered) {
        var ht = cell.getValue();
        if (ht !== undefined) {
          return ht+'<br />'+cell.getRow().getCell('HT2').getValue();
        }
        else {
          return '';
        }
      };
      function formatter_actor_SOC(cell, formatterParams, onRendered) {
            var links = '';
            links += SetTableLNK(cell,'TID','https://www.themoviedb.org/person/', 'img/tmdb_icon.svg',           'TMDb Link');
            links += SetTableLNK(cell,'FID','https://www.facebook.com/',          'img/facebook_icon.png',       'Facebook Link');
            links += SetTableLNK(cell,'TWT','https://www.twitter.com/',           'img/twitter_icon.png',        'Twitter Link');
            links += SetTableLNK(cell,'INS','https://www.instagram.com/',         'img/instagram_icon.png',      'Instagram Link');
            links += SetTableLNK(cell,'WID','',                                   'img/wikidata_icon.png',       'WikiData Link');
            links += SetTableLNK(cell,'WIK','',                                   'img/wikipedia_icon.png',      'Wikipedia Link');
            links += SetTableLNK(cell,'IID','https://www.imdb.com/name/',         'img/imdb_icon.png',           'IMDb Link');
            links += SetTableLNK(cell,'RID','https://www.rottentomatoes.com/',    'img/rottentomatoes_icon.png', 'Rotten Tomatoes Link');
            links += SetTableLNK(cell,'MET','https://www.metacritic.com/',        'img/metacritic_icon.png',     'MetaCritic Link');
            links += SetTableLNK(cell,'MID','https://www.models.com/people/',     'img/models_icon.png',         'Models.com Link');
            links += SetTableLNK(cell,'WWW','',                                   'img/web_icon.png',            'Website Link');
      
      //      links += '<a target=_blank aria-label="Social Media" style="text-decoration:none;" href="https://www.google.com/search?q='+cell.getRow().getCell('NAM').getValue().replaceAll(' ','+')+'&tbm=isch"><img style="margin-left:2px; margin-right:2px; width:34px; height:34px" alt="Google Image Search" src="img/google_icon.png"></a>';              links += SetTableLNK(cell,'FID','https://www.facebook.com/',          'img/facebook_icon.png',       'Facebook Link');
      
            return '<div style="white-space:normal;">'+links+'</div>';
          };
      function addPoster(cell, title, picture, adultpic, type) {
            let adult = pas.Main.MainForm.AdultContent;
            let image = checkImage(cell.getRow().getCell(picture).getValue(),null,type,{imgtype:type});
      
            if ((!cell.getRow().getCell(adultpic).getValue() || adult) && (cell.getRow().getCell(title).getValue())) {
              return '<div style="width:45px; height:68px; display:inline-block; color: var(--bs-dark) !important;">'+
                       '<img class="lazy portrait" '+
                            'atitle="'+cell.getRow().getCell(title).getValue()+'" '+
                            'src="'+image+'" '+
                            'data-src="'+image+'" '+
                            'width=45 '+
                            'height=auto '+
                            'alt="Poster for '+cell.getRow().getCell(title).getValue()+'" '+
                            'onerror="this.onerror=null;this.src=\'img/hourglass.png\';"'+
                          '>'+
                        '</div>';
            }
            else {
              return '<img alt="Missing Poster Placeholder" atitle="" src="img/dark_space.png" width=45 height=68>';
            }
          };
      function addPerson(name, character, photo, adultpic) {
        let adult = pas.Main.MainForm.AdultContent;
        if ((!adultpic || adult) && (name)) {
          return '<div style="width:45px; height:68px; display:inline-block; color: var(--bs-dark) !important;">'+
                   '<img class="lazy portrait" '+
                        'atitle="'+name+'" '+
                        'src="'+photo+'" '+
                        'data-src="'+photo+'" '+
                        'width=45 '+
                        'height=auto '+
                        'acharacter="'+character+'" '+
                        'alt="Photo of '+name+'" '+
                        'onerror="this.onerror=null;this.src=\'img/hourglass.png\';"'+
                      '>'+
                    '</div>';
        }
        else {
          return '<img alt="Missing Person Placeholder" atitle="" src="img/dark_space.png" width=45 height=auto>';
        }
      };
      function formatter_actor_TopMovies(cell, formatterParams, onRendered) {
            cell.getElement().style.background="var(--bs-dark)";
            let posters = '';
      
            posters += addPoster(cell, 'MT1', 'MP1', 'MX1', 'movie');
            posters += addPoster(cell, 'MT2', 'MP2', 'MX2', 'movie');
            posters += addPoster(cell, 'MT3', 'MP3', 'MX3', 'movie');
            posters += addPoster(cell, 'MT4', 'MP4', 'MX4', 'movie');
            posters += addPoster(cell, 'MT5', 'MP5', 'MX5', 'movie');
      
            return posters
          };
      function formatter_actor_TopTVShows(cell, formatterParams, onRendered) {
            cell.getElement().style.background="var(--bs-dark)";
            let posters = '';
      
            posters += addPoster(cell, 'TT1', 'TP1', 'TX1', 'tv');
            posters += addPoster(cell, 'TT2', 'TP2', 'TX2', 'tv');
            posters += addPoster(cell, 'TT3', 'TP3', 'TX3', 'tv');
            posters += addPoster(cell, 'TT4', 'TP4', 'TX4', 'tv');
            posters += addPoster(cell, 'TT5', 'TP5', 'TX5', 'tv');
            return posters
          };
      function formatter_role_TopRoles(cell, formatterParams, onRendered) {
            cell.getElement().style.background="var(--bs-dark)";
            var data = cell.getRow().getCell('ACA').getValue();
            var people = '';
            var peoplecount = 0;
            if ((data !== undefined) && (data.length > 0)) {
              for (var i = 0; i < Math.min(10,data.length); i++) {
      
                var NAM = '';
                var CHR = '';
                var PIC = '';
                var XXX = '';
      
                if (data[i].NAM !== undefined) {
                  NAM = data[i].NAM;
                }
      
                if (data[i].CHR !== undefined) {
                  CHR = data[i].CHR;
                }
      
                if (data[i].PIC !== undefined) {
                  PIC = data[i].PIC;
                }
      
                if (data[i].XXX !== undefined) {
                  XXX = data[i].XXX;
                }
      
                let adult = pas.Main.MainForm.AdultContent;
                if ((!XXX || adult) && (NAM)) {
                  people += addPerson(NAM, CHR, checkImage(PIC,null,null,{imgtype:"person"}), XXX);
                  peoplecount += 1;
                }
              }
            }
      
            for (i = (peoplecount); i < 10; i++) {
              people += addPerson('','','',pas.Main.MainForm.AdultContent);
            }
            return people;
          };
      function formatter_role_PIC(cell, formatterParams, onRendered) {
        var image = checkImage(cell.getValue(),null,cell.getRow().getCell('TYP').getValue(),{imgtype:"tvmovie"});
        return '<div style="color:transparent; width: 45px; height: 68px;">'+
                 '<img class="lazy portrait PriorityB" '+
                      'src='+image+' '+
                      'data-src='+image+' '+
                      'alt="Poster"'+
                      'width=45 '+
                      'height=auto '+
                      'onerror="this.onerror=null;this.src=\'img/hourglass.png\';"'+
                    '>'+
                  '</div>';
      };
      function formatter_role_NAM(cell, formatterParams, onRendered) {
            var title = cell.getValue();
            var character = cell.getRow().getCell('CHX').getValue();
            if ((character == undefined) || (character == null) || (character == '')) {
              character = cell.getRow().getCell('CHR').getValue();
            }
      
            if ((character == undefined) || (character == null)) {
              character = '';
            }
            else {
              character = '<br />'+character;
            }
      
            return '<div style="padding:0px 4px; white-space:normal"><strong>'+title+'</strong>'+character+'</div>';
          };
      function formatter_role_TYP(cell, formatterParams, onRendered) {
        if (cell.getValue() == 'tv') {
          return '<div class="d-flex h-100 align-items-center justify-content-center" style="transform:scale(1.5)">'+window.icon_tv+'</div>';
        }
        else {
          return '<div class="d-flex h-100 align-items-center justify-content-center" style="transform:scale(1.5)">'+window.icon_film+'</div>';
        }
      };
      function formatter_role_REL(cell, formatterParams, onRendered) {
            var rel = cell.getValue();
            var typ = cell.getRow().getCell('TYP').getValue();
            var sts = cell.getRow().getCell('STS').getValue();
            var sns = cell.getRow().getCell('SNS').getValue();
            var eps = cell.getRow().getCell('EPS').getValue();
      
            if (sts == null) {
              sts = '';
            }
            else {
              sts = '[ '+sts+' ]';
            }
      
            if (typ == 'movie') {
              if ((rel == null) || (rel.length < 10)) {
                return '<div style="padding:0px 4px;">'+sts+'</div>';
              }
              else {
                var start = luxon.DateTime.fromISO(rel, {zone:"utc"});
                var finish = luxon.DateTime.now().toUTC();
                var age = getage(start.toFormat('yyyyMMdd'), finish.toFormat('yyyyMMdd'));
      
                if (age >= 2) {
                  return '<div style="padding:0px 4px;">'
                         +start.toFormat('yyyy-MMM-dd')
                         +'<br>'+age+' Years Ago'
                         +'<br>'+sts+'</div>';
                }
                else if (age < 0) {
                  return '<div style="padding:0px 4px;">'
                         +start.toFormat('yyyy-MMM-dd')
                         +'<br>'+sts+'</div>';
                }
                else {
                  if (Math.trunc(finish.diff(start,'months').months) > 1) {
                    return '<div style="padding:0px 4px;">'
                           +start.toFormat('yyyy-MMM-dd')
                           +'<br>'+Math.trunc(finish.diff(start, 'months').months)+' Months Ago'
                           +'<br>'+sts+'</div>';
                  }
                  else {
                    return '<div style="padding:0px 4px;">'
                           +start.toFormat('yyyy-MMM-dd')
                           +'<br>In the past month'
                           +'<br>'+sts+'</div>';
                  }
                }
              }
            }
            else if (typ == 'tv') {
              if ((rel == null) || (rel.length < 10) || (sns == undefined) || (eps == undefined)) {
                return '<div style="padding:0px 4px;">'+sts+'</div>';
              }
              else {
                var start = luxon.DateTime.fromISO(rel, {zone:"utc"});
                if (sns > 1) {
                  return '<div style="padding:0px 4px;">'
                         +start.toFormat('yyyy-MMM-dd')
                         +'<br>'+sns+' Seasons, '+eps.toLocaleString()+' Eps'
                         +'<br>'+sts+'</div>';
                }
                else {
                  return '<div style="padding:0px 4px;">'
                         +start.toFormat('yyyy-MMM-dd')
                         +'<br>'+sns+' Season, '+eps.toLocaleString()+' Eps'
                         +'<br>'+sts+'</div>';
                }
              }
            }
          };
      function formatter_role_REV(cell, formatterParams, onRendered) {
            var revenue = cell.getValue();
            var budget = cell.getRow().getCell('BUD').getValue();
            var profit = revenue - budget;
      
            if (revenue >= 1000000000) {
              revenue = (revenue/1000000000).toFixed(1)+' B';
            }
            else if (revenue >= 1000000) {
              revenue = (revenue/1000000).toFixed(1)+' M';
            }
            else if (revenue >= 1000) {
              revenue = (revenue/1000).toFixed(1)+' K';
            }
            else if (revenue > 0) {
              revenue = revenue
            }
            else {
              revenue = '';
            }
      
            if (budget >= 1000000000) {
              budget = (budget/1000000000).toFixed(1)+' B';
            }
            else if (budget >= 1000000) {
              budget = (budget/1000000).toFixed(1)+' M';
            }
            else if (budget >= 1000) {
              budget = (budget/1000).toFixed(1)+' K';
            }
            else if (budget > 0) {
              budget = budget
            }
            else {
              budget = '';
            }
      
            if (profit >= 1000000000) {
              profit = (profit/1000000000).toFixed(1)+' B';
            }
            else if (profit >= 1000000) {
             profit = (profit/1000000).toFixed(1)+' M';
            }
            else if (profit >= 1000) {
              profit = (profit/1000).toFixed(1)+' K';
            }
            else if (profit <= -1000000000) {
              profit = '('+(-profit/1000000000).toFixed(1)+' B)';
            }
            else if (profit <= -1000000) {
              profit = '('+(-profit/1000000).toFixed(1)+' M)';
            }
            else if (profit <= -1000) {
              profit = '('+(-profit/1000).toFixed(1)+' K)'
            }
            else if (profit <= -1) {
              profit = '('+(-profit).toFixed(1)+' K)'
            }
            else if (profit.isInteger) {
              profit = profit
            }
            else {
              profit = ''
            }
      
            var result = '<div style="padding:0px 4px;">';
            if (revenue !== '') {
              result +='Rev: '+revenue+'<br />';
            }
            if (budget !== '') {
              result +='Bgt: '+budget+'<br />';
            }
            if ((profit !== '') && (revenue !== '') && (budget !== '')) {
              result +='Net: '+profit;
            }
            result += '</div>'
      
            return result;
          };
      function formatter_role_RTM(cell, formatterParams, onRendered) {
        var runtime = cell.getValue();
        if (runtime > 0) {
          return Math.floor(runtime/60)+'h'+(runtime - (60*Math.floor(runtime/60)))+'m'
        }
        else {
          return '';
        }
      };
      function formatter_role_CTG(cell, formatterParams, onRendered) {
        let countries = cell.getValue();
        if (countries !== undefined) {
          let result = '';
          for (let i = 0; i < countries.length; i++) {
            result += '<div style="font-size:25px; margin-top:9px; margin-right:3px;" class="fp fp-lg '+countries[i].toLowerCase()+'"></div>';
          }
          return result;
        }
        else {
          return '';
        }
      };
      function formatter_role_OVR(cell, formatterParams, onRendered) {
        return '<div style="height:68px; white-space:normal; padding: 2px 4px; line-height:1; font-size: 14px; overflow-y:auto;"">'+cell.getValue()+'</div>';
      };
      function cellClick_actor_PIC(e, cell) {
        let image = checkImage(cell.getValue(),null,null,{imgtype:"person"})
        pas.Main.MainForm.ViewerMode = 'Person';
        pas.Main.MainForm.ViewerURL1 = image;
        pas.Main.MainForm.ViewerURL2 = image.replace('/w45/','/original/');
        pas.Main.MainForm.ViewerURLA = cell.getRow().getCell('NAM').getValue();
        pas.Main.MainForm.ViewerURLC = cell.getRow().getPosition();
        pas.Main.MainForm.ViewerURLT = cell.getTable().getDataCount();
        pas.Main.MainForm.ShowViewer();
      };
      function cellClick_actor_Top(e, cell) {
      
            var pic = e.target.outerHTML;
            var image = pic.substring(pic.indexOf('src')+4,pic.indexOf('data-src=')-1);
            var title = pic.substring(pic.indexOf('atitle')+8,pic.indexOf('src=')-2);
      
            if (image.indexOf('"Missing Poster placeholder"') == -1) {
              pas.Main.MainForm.ViewerMode = 'Role';
              pas.Main.MainForm.ViewerURL1 = image;
              pas.Main.MainForm.ViewerURL2 = image.replace('/w92/','/original/');
              pas.Main.MainForm.ViewerURLA = title;
              pas.Main.MainForm.ViewerURLC = 1;
              pas.Main.MainForm.ViewerURLT = 1;
              pas.Main.MainForm.ShowViewer();
      
              pas.Main.MainForm.TopTitle = title;
      
              var table = pas.Main.MainForm.RoleTabulator;
              table.deselectRow();
              var rows = table.searchRows('NAM',"=",title);
              if (rows.length > 0) {
                table.selectRow(rows[0]);
                table.scrollToRow(rows[0],"top",false);
              }
            }
          };
      function cellClick_role_Top(e, cell) {
      
            var pic = e.target.outerHTML;
            var image = pic.substring(pic.indexOf('src')+4,pic.indexOf('data-src=')-1);
            var title = pic.substring(pic.indexOf('atitle')+8,pic.indexOf('src=')-2);
      
            if (image.indexOf('"Missing Person Placeholder"') == -1) {
              pas.Main.MainForm.ViewerMode = 'Person';
              pas.Main.MainForm.ViewerURL1 = image;
              pas.Main.MainForm.ViewerURL2 = image.replace('/w45/','/original/');
              pas.Main.MainForm.ViewerURLA = title;
              pas.Main.MainForm.ViewerURLC = 1;
              pas.Main.MainForm.ViewerURLT = 1;
              pas.Main.MainForm.ShowViewer();
      
              pas.Main.MainForm.TopTitle = title;
            }
          };
      function cellClick_role_PIC(e, cell) {
        let image = checkImage(cell.getValue(),null,cell.getRow().getCell('TYP').getValue(),{imgtype:"tvmovie"})
        pas.Main.MainForm.ViewerMode = 'Role';
        pas.Main.MainForm.ViewerURL1 = image;
        pas.Main.MainForm.ViewerURL2 = image.replace('/w92/','/original/');
        pas.Main.MainForm.ViewerURLA = cell.getRow().getCell('NAM').getValue();
        pas.Main.MainForm.ViewerURLC = cell.getRow().getPosition();
        pas.Main.MainForm.ViewerURLT = cell.getTable().getDataCount();
        pas.Main.MainForm.ShowViewer();
      };
      var getage = pas.Main.MainForm.GetAge;
          pas.Main.MainForm.ActorTabulator = new Tabulator("#divActorTabulator", {
            columns:[
      
              { title: "", field: "PIC", width: 45, headerSort: false, resizable: false, headerHozAlign: "center", hozAlign: "center", cssClass: "ActorRowCount",
                  tooltip:       tooltip_actor_PIC,
                  formatter:     formatter_actor_PIC,
                  cellClick:     cellClick_actor_PIC,
              },
      
              { title: "Person", field: "NAM", minWidth: 230, cssClass: "Name",
                  headerMenu:       headerMenu,
                  headerPopup:      headerNameFilter,
                  headerPopupIcon:  window.icon_filter,
                  headerFilter:     nameHeaderFilter,
                  headerFilterFunc: "like",
                  formatter:        formatter_actor_NAM,
              },
      
              { title: "Birthday", field: "DOB", width: 120,
                  headerMenu: headerMenu,
                  formatter:  formatter_actor_DOB
              },
      
              { title: "Departed", field: "DOD", width: 120, visible:false, resizable: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_actor_DOD
              },
      
              {title: window.icon_flag, field: "CTZ", width: 75, minWidth: 75, maxWidth: 75, hozAlign: "center", visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_actor_CTZ
              },
      
              {title: "Ht", field: "HT1", width:75, minWidth: 75, maxWidth:75, hozAlign: "center", visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_actor_HT1
              },
      
              { title: "Social Media", field: "SOC", width: 200, minWidth: 200, visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_actor_SOC
              },
      
              { title: "<i class='fa-solid fa-image-polaroid-user'></i>", field: "IMC", sorter: "number", width: 75, minWidth: 75, maxWidth: 75, hozAlign: "center", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Rank", field: "ID", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Points", field: "PTS", visible: false, sorter:"number",
                  headerMenu: headerMenu
              },
      
              // Actor Table: Original Popularity Value - now hidden
              { title: "Pop", field: "POP",width:95, sorter:"number", hozAlign: "right",vertAlign:"middle",  visible: false, headerFilter: true,
                  headerMenu: headerMenu,
                  formatter:  "money",
                  formatterParams:{
                    decimal: ".",
                    thousand:",",
                    symbol:"",
                    symbolAfter:"",
                    precision: 3
                  }
              },
      
              { title: window.icon_star_sharp, field:"PopInt", width:75,
                  headerMenu: headerMenu,
                  formatter:  "star", formatterParams: {stars: 5},
                  mutator:    PopularityInt
              },
      
              { title: "Roles", field: "NUM", width:100, visible: false,
                  headerMenu:      headerMenu,
                  formatter:       "progress",
                  formatterParams: {
                    min: 0,
                    max: 100,
                    color: "#212529",
                    legend: "",
                  }
              },
      
              { title: "Top Movies", width: 230, minWidth: 160, maxWidth: 230, headerSort: false,
                  headerMenu: headerMenu,
                  tooltip:    tooltip_actor_Top,
                  formatter:  formatter_actor_TopMovies,
                  cellClick:  cellClick_actor_Top
              },
      
              { title: "Top TV Shows", width: 230, minWidth: 160, maxWidth: 230, headerSort: false,
                  headerMenu: headerMenu,
                  tooltip:    tooltip_actor_Top,
                  formatter:  formatter_actor_TopTVShows,
                  cellClick:  cellClick_actor_Top
              },
      
              // Ensure these are available to Tabulator but otherwise not visible
              { field: "BPL", visible:false, headerFilter:nameHeaderFilter, headerFilterFunc:"like" },  // The birthplace of the actor
      
              { field: "TID", visible: false },  // TMDb
              { field: "WID", visible: false },  // WikiData
              { field: "IID", visible: false },  // IMDb
              { field: "RID", visible: false },  // Rotten Tomatoes
              { field: "MET", visible: false },  // MetaCritic
              { field: "WIK", visible: false },  // Wikipedia
              { field: "FID", visible: false },  // Facebook
              { field: "INS", visible: false },  // Instagram
              { field: "TWT", visible: false },  // Twitter
              { field: "MID", visible: false },  // Models.com
              { field: "WWW", visible: false },  // Website
              { field: "IMG", visible: false },  // Image Array
              { field: "WRK", visible: false },  // JSON for the Roles table
              { field: "BIO", visible: false },  // The biography of the actor
              { field: "DOD", visible: false },  // Date of Death
              { field: "HT2", visible: false },  // HT in Imperial Units
              { field: "PTB", visible: false },  // PTS Breakdown
      
              { field: "MT1", visible: false },  // Most Popular Movie Titles
              { field: "MT2", visible: false },
              { field: "MT3", visible: false },
              { field: "MT4", visible: false },
              { field: "MT5", visible: false },
      
              { field: "TT1", visible: false },  // Most Popular TV Show Titles
              { field: "TT2", visible: false },
              { field: "TT3", visible: false },
              { field: "TT4", visible: false },
              { field: "TT5", visible: false },
      
              { field: "MP1", visible: false },  // Most Popular Movie Posters
              { field: "MP2", visible: false },
              { field: "MP3", visible: false },
              { field: "MP4", visible: false },
              { field: "MP5", visible: false },
      
              { field: "TP1", visible: false },  // Most Popular TV Show Posters
              { field: "TP2", visible: false },
              { field: "TP3", visible: false },
              { field: "TP4", visible: false },
              { field: "TP5", visible: false },
      
              { field: "MX1", visible: false },  // Most Popular Movie Titles - Adult Flag
              { field: "MX2", visible: false },
              { field: "MX3", visible: false },
              { field: "MX4", visible: false },
              { field: "MX5", visible: false },
      
              { field: "TX1", visible: false },  // Most Popular TV Show Titles - Adult Flag
              { field: "TX2", visible: false },
              { field: "TX3", visible: false },
              { field: "TX4", visible: false },
              { field: "TX5", visible: false }
            ]
          });
      
          // This is an event handler - when the table is ready to go, the GetBirthdays function is called.
          pas.Main.MainForm.ActorTabulator.on("tableBuilt", function() {
            // We should only have to look this up this one time
            window.actorcount = document.getElementsByClassName('ActorRowCount')[0].firstElementChild.firstElementChild.firstElementChild;
      
            // Signal the tmrStartup that we are ready to go
            pas.Main.MainForm.TablesReady += 1;
      
            // Here we're creating the record counter in the column header.  Now there are other ways to do
            // this, but Tabulator is particularly sensitive about such things.  Changin column headers is
            // an expensive operation, often redrawing the table at inconvenient times.  So let's just
            // add a little element in the right spot and then we can update that whenever we want, and
            // Tabulator will be none the wiser.
            window.actorcount.innerHTML = "";
          });
      
          // Another event handler, called when the user clicks on row in the table
          pas.Main.MainForm.ActorTabulator.on("rowClick", function(e, row){
            row.select();
            window.Actor_Selected(e, row);
          });
      
          // After filtering the records, update the column header to show the new count
          pas.Main.MainForm.ActorTabulator.on("dataFiltered", function(filters, rows){
            // update the first column header to show a count of records filtered
            if (window.actorcount !== undefined) {
              if (pas.Main.MainForm.ActorTabulator.getDataCount() !== rows.length) {
                window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rows.length+'</span>';
              }
              else {
                window.actorcount.innerHTML = rows.length;
              }
            }
          });
      
          // This makes the menu dividers invisible to the pointer, so they don't get highlighted
          pas.Main.MainForm.ActorTabulator.on("menuOpened", function(component) {
            var seps = document.getElementsByClassName("tabulator-menu-item");
            for (var i = 0; i < seps.length; i++) {
              if (seps[i].firstElementChild.firstElementChild.classList.contains('pe-none')) {
                seps[i].classList.add('pe-none');
              }
            }
          });
      pas.Main.MainForm.RoleTabulator = new Tabulator("#divRoleTabulator", {
              columns:[
      
              { title: "", field: "PIC", width:45, headerSort:false, resizable: false, headerHozAlign: "center", hozAlign:"center", headerMenu: false, cssClass: "RoleRowCount",
                  headerMenu: headerMenu,
                  tooltip:    tooltip_role_PIC,
                  formatter:  formatter_role_PIC,
                  cellClick:  cellClick_role_PIC
              },
      
              { title: "Title", field: "NAM", minWidth: 150,
                  headerMenu: headerMenu,
                  tooltip:    tooltip_role_NAM,
                  formatter:  formatter_role_NAM
              },
      
              { title: "Tagline", field: "TGL", minWidth: 100, visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "", field: "TYP", width: 50, cssClass:"MovieTVColumn",
                  headerMenu: headerMenu,
                  formatter:  formatter_role_TYP,
                  cellClick: function(e, cell){
                    const roles = cell.getRow().getData()['ACA'];
                    let lookuproles = [];
                    lookuproles.push({"ID":pas.Main.MainForm.CurrentPerson});
                    let i = 0;
                    while (i < Math.min(25, roles.length)) {
                      if (roles[i]["ID"] !== pas.Main.MainForm.CurrentPerson) {
                        lookuproles.push({"ID":roles[i]["ID"]})
                      }
                      i += 1;
                    }
                    console.log(lookuproles);
                  }
              },
      
              { title: "Release", field: "REL", width: 145,
                  headerMenu: headerMenu,
                  formatter:  formatter_role_REL,
              },
      
              { title: "Status", field: "STS", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Seasons", field: "SNS", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Episodes", field: "EPS", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: window.icon_flag, field: "CTG", visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_role_CTG
              },
      
              { title: "Posters", field: "PSC", visible: false, sorter: "number",
                  headerMenu: headerMenu
              },
      
              { title: "Backdrops", field: "BDC", visible: false, sorter: "number",
                  headerMenu: headerMenu
              },
      
              { title: "Videos", field: "VDC", visible: false, sorter: "number",
                  headerMenu: headerMenu
              },
      
              { field: "PSG", visible: false },
              { field: "BDS", visible: false },
              { field: "VDS", visible: false },
      
              { title: "BoxOffice", field: "REV", width:120, sorter: "number", visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_role_REV
              },
      
              { title: "Budget", field: "BUD", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Revenue", field: "REV", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Runtime", field: "RTM", visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_role_RTM
              },
      
              { title: "Roles (Count)", field: "ACC", visible: false,
                  headerMenu: headerMenu
              },
      
              { title: "Pop", field: "POP",width:95, sorter:"number", hozAlign: "right",  visible: false,
                  headerMenu:      headerMenu,
                  formatter:       "money",
                  formatterParams: {
                    decimal: ".",
                    thousand:",",
                    symbol:"",
                    symbolAfter:"",
                    precision: 3
                  }
              },
      
              // Pop as Stars
              { title:window.icon_star_sharp, field:"PopInt", width:75,
                  headerMenu:      headerMenu,
                  formatter:       "star",
                  formatterParams: {stars: 5},
                  mutator:         PopularityInt
              },
      
              { title: "Social Media", field: "SOC", width: 200, minWidth: 200, visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_actor_SOC
              },
      
              { title: "Top Roles", field: "ACA", width: 455, minWidth: 160, maxWidth: 455, headerSort: false,
                  headerMenu: headerMenu,
                  tooltip:    tooltip_role_Top,
                  formatter:  formatter_role_TopRoles,
                  cellClick:  cellClick_role_Top
              },
      
              { title: "Overview", field: "OVR",  widthGrow:4, visible: false,
                  headerMenu: headerMenu,
                  formatter:  formatter_role_OVR
              },
      
              { field: "ID", visible: false },
              { field: "CHR", visible: false },
              { field: "ORG", visible: false },
              { field: "CHX", visible: false },
      
              { field: "TID", visible: false },  // TMDb
              { field: "WID", visible: false },  // WikiData
              { field: "IID", visible: false },  // IMDb
              { field: "RID", visible: false },  // Rotten Tomatoes
              { field: "MET", visible: false },  // MetaCritic
              { field: "WIK", visible: false },  // Wikipedia
              { field: "FID", visible: false },  // Facebook
              { field: "INS", visible: false },  // Instagram
              { field: "TWT", visible: false },  // Twitter
              { field: "MID", visible: false },  // Models.com
              { field: "WWW", visible: false }   // Website
      
            ]
          });
      
          pas.Main.MainForm.RoleTabulator.on("tableBuilt", function() {
      
            // We should only have to look this up this one time
            window.rolecount = document.getElementsByClassName('RoleRowCount')[0].firstElementChild.firstElementChild.firstElementChild;
      
            // Setup some fancy Column Header Tooltips
            var collection = document.getElementsByClassName('tabulator-col MovieTVColumn');
            if (collection.length !== 0) {
              for (let i = 0; i < collection.length; i++) {
                var tooltip = new bootstrap.Tooltip(collection[i], {
                  title: "Movie <i class='fa-duotone fa-film mx-1'></i> or TV Show <i class='fa-duotone fa-tv-retro mx-1'></i>",
                  placement: 'top',
                  html: true,
                  customClass: 'custom-tooltip',
                  delay: { "show": 1500, "hide": 100 }
                })
              }
            }
      
            // Signal the tmrStartup that we are ready togo
            pas.Main.MainForm.TablesReady += 1;
          });
      
          // After filtering the records, update the column header to show the new count
          pas.Main.MainForm.RoleTabulator.on("dataFiltered", function(filters, rows){
            // update the first column header to show a count of records filtered
            if (window.rolecount !== undefined) {
              if (pas.Main.MainForm.RoleTabulator.getDataCount() !== rows.length) {
                window.rolecount.innerHTML = '<span style="color: var(--bs-warning);">'+rows.length+'</span>';
              }
              else {
                window.rolecount.innerHTML = rows.length;
              }
            }
          });
      
          // Another event handler, called when the user clicks on row in the table
          pas.Main.MainForm.RoleTabulator.on("rowClick", function(e, row){
            this.selectRow(row);
            window.Role_Selected(e, row);
          });
      
          // This makes the menu dividers invisible to the pointer, so they don't get highlighted
          pas.Main.MainForm.RoleTabulator.on("menuOpened", function(component) {
            var seps = document.getElementsByClassName("tabulator-menu-item");
            for (var i = 0; i < seps.length; i++) {
              if (seps[i].firstElementChild.firstElementChild.classList.contains('pe-none')) {
                seps[i].classList.add('pe-none');
              }
            }
          });
      // https://github.com/marko-36/base29-shortener
          // We don't want the string too short, so we start at 10,000
          // But we do want it short, so we add more than 29 characters to the encoding list
          // characters for encoding
          const c=['B','b','C','c','D','d','F','f','G','g','H','h','J','j','K','k','L','M','m','N','n','P','p','Q','q','R','r','S','s','T','t','V','W','w','X','x','Z','z','0','1','2','3','4','5','6','7','8','9'];
      
          function to29(i){
            i = i + 10000;
            var sLen = Math.floor(Math.log(i)/Math.log(c.length)) +1;
            var s = '';
            for(var ex=sLen-1; ex>-1; --ex){
              s += c[Math.floor(i / Math.pow(c.length,ex))];
              i = [i % Math.pow(c.length,ex)];
            }
            return s;
          }
          window.to29 = to29;
      
          function from29(s){
            var i = 0;
            for (var ex=0; ex<s.length; ++ex){
              i += c.indexOf(s.substring(ex,ex+1))*Math.pow(c.length,s.length-1-ex);
            }
            return i - 10000;
          }
          window.from29 = from29;
      this.tmrStart.SetEnabled(true);
      this.StopLinkerRemoval(rtl.createCallback(this,"PreventCompilerHint$3"));
    };
    this.CheckVersion = async function () {
      var Response = null;
      var Data = null;
      var v1 = "";
      var v2 = "";
      if ($mod.MainForm.VersionCheck) {
        this.WebHttpRequest1.FURL = this.Server + "/ActorInfoService/GetClientVersion?Day=" + pas.SysUtils.FormatDateTime("mmdd",pas.SysUtils.Now());
        try {
          Response = await this.WebHttpRequest1.Perform();
          Data = rtl.as(pas["WEBLib.JSON"].TJSONObject.ParseJSONValue("" + Response.response),pas["WEBLib.JSON"].TJSONObject);
          if ((this.Startup === true) && (this.StartupMode === "today")) {
            v1 = "" + Response.response;
            var FirstData = JSON.parse(v1);
            
                      // Main Image
                      divPhoto.innerHTML =
                        '<div style="width:185px; height:278px;">'+
                          '<img '+
                            'alt="Photo of '+FirstData["NAM"]+'" '+
                            'class="lazy portrait" '+
                            'style="width:185px; height:auto;" '+
                            'src="'+FirstData["IMG"]+'"'+
                          '/>'+
                        '</div>';
                      if (FirstData['PIC'].indexOf('placeholder') == -1) {
                        pas.Main.MainForm.Photo1 = 'https://image.tmdb.org/t/p/w185'+FirstData['PIC'];
                        pas.Main.MainForm.Photo2 = 'https://image.tmdb.org/t/p/original'+FirstData['PIC'];
                      }
                      else {
                        pas.Main.MainForm.Photo1 = FirstData['PIC'];
                        pas.Main.MainForm.Photo2 = FirstData['PIC'];
                      }
                      pas.Main.MainForm.PhotoA = FirstData['NAM'];
            
                      // Biography information
                      try {
                        var biotext = decodeURIComponent(FirstData['BIO']);
                      } catch {
                        var biotext = FirstData['BIO'];
                      }
                      if ((biotext == 'undefined') || (biotext == '')) {
                        biotext = '<h5>No biographical information was found.<h5>';
                        pas.Main.MainForm.BioWords = 0;
                      }
                      else {
                        pas.Main.MainForm.BioWords = biotext.trim().split(/\s+/).length;
                      }
            
                      divBiography.innerHTML = '<div class="w-100 h-100 ps-2 pe-2 pb-4" style="white-space:normal; overflow-y:auto;">'+
                        '<h4>'+FirstData['NAM']+'</h4>'+
                        '<p>'+biotext.replace("\n","</p><p>")+'</p></div>';
            
                      pas.Main.MainForm.MenuType = 0; // Person
                      pas.Main.MainForm.PhotoCount = FirstData['NUM'];
          };
          this.divProgressSpinner.FHTML.SetTextStr("");
          v1 = $mod.MainForm.VersionNum;
          v2 = rtl.as(Data.GetValue$1("VER"),pas["WEBLib.JSON"].TJSONString).GetStrValue();
          window.console.log(pas.System.Copy($mod.MainForm.Version,1,pas.System.Pos("_",$mod.MainForm.Version) - 1) + " Released " + $mod.MainForm.Release + ".");
          window.console.log("Current Version: " + v1 + ". Server Version: " + v2 + ".");
          function compareVersion(v1, v2) {
                    if (typeof v1 !== 'string') return false;
                    if (typeof v2 !== 'string') return false;
                    v1 = v1.split('.');
                    v2 = v2.split('.');
                    const k = Math.min(v1.length, v2.length);
                    for (let i = 0; i < k; ++ i) {
                      v1[i] = parseInt(v1[i], 10);
                      v2[i] = parseInt(v2[i], 10);
                      if (v1[i] > v2[i]) return 1;
                      if (v1[i] < v2[i]) return -1;
                    }
                    return v1.length == v2.length ? 0: (v1.length < v2.length ? -1 : 1);
                  }
          
                  if (compareVersion(v1, v2) == -1) {
                    if ('serviceWorker' in navigator) {
                      navigator.serviceWorker.getRegistrations().then(function (registrations) {
                        for (let registration of registrations) {
                          registration.update()
                    }})}
                    window.location.reload(true);
                  }
                  else {
                    console.log('Application is up to date.');
                  };
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
          } else throw $e
        };
      };
      window.RefreshMenu(true);
      $mod.MainForm.VersionCheck = false;
    };
    this.GetBirthDays = async function (aMonth, aDay) {
      var Response = null;
      var Data = "";
      var Blob = undefined;
      var Progress = "";
      var Endpoint = "";
      var DayNum = 0;
      var CacheData = undefined;
      DayNum = pas.DateUtils.DayOfTheYear(pas.SysUtils.EncodeDate(2020,aMonth,aDay));
      if ($mod.MainForm.BirthdayCacheDate[DayNum - 1] > (pas.SysUtils.Now() - 0.25)) {
        CacheData = $mod.MainForm.BirthdayCacheData[DayNum - 1];
        $mod.MainForm.CurrentPerson = -1;
        var table1 = pas.Main.MainForm.ActorTabulator;
              var table2 = pas.Main.MainForm.RoleTabulator;
              var actorData = CacheData;
        
              // Filter out Adult content
              var adult = pas.Main.MainForm.AdultContent;
              var acount = 0;
              if (!adult) {
                for (var i = actorData.length - 1; i >= 0; i--) {
                  if (actorData[i]['XXX'] == true) {
                    actorData.splice(i,1);
                    acount++;
                  }
                }
              } else {
                for (var i = actorData.length - 1; i >= 0; i--) {
                  if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                    actorData.splice(i,1);
                    acount++;
                  }
                }
              }
        
              pas.Main.MainForm.ActorTabulator.setData(actorData)
              .then(function(){
        
                // update the first column header to show a count
                var rowCount = table1.getDataCount("active");
                if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
                else { window.actorcount.innerHTML = rowCount; };
        
                if (rowCount > 0) {
        
                  // highlight the first row, based on whatever sorting is currently in place
                  table1.selectRow(table1.getRowFromPosition(1, true));
        
                  // Do what we would do if we had directly clicked on that row
                  window.Actor_Selected(null, table1.getRowFromPosition(1,true));
        
                }
                else {
                  table2.clearData();
                }
        
              });
        return;
      };
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
      Progress = rtl.guidrToStr(pas.SysUtils.TGuidHelper.NewGuid());
      $mod.MainForm.Pending.Add(Progress);
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.CurrentRole = -1;
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.Carnival === null) {
        try {
          $mod.MainForm.Carnival = pas["XData.Web.Connection"].TXDataWebConnection.$create("Create$1",[null]);
          $mod.MainForm.Carnival.SetURL(this.Server);
          await $mod.MainForm.Carnival.OpenAsync();
          $mod.MainForm.Client = pas["XData.Web.Client"].TXDataWebClient.$create("Create$1",[null]);
          $mod.MainForm.Client.SetConnection($mod.MainForm.Carnival);
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
            if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
            if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
            $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
            window.console.log("Server Communication Exception Encountered.");
            window.console.log(" -- " + E.$classname);
            window.console.log(" -- " + E.FMessage);
            window.console.log(" -- Automatic retry attempt in 30s");
            $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.tmrStart.SetInterval(30000);
            $mod.MainForm.tmrStart.SetEnabled(true);
            return;
          } else throw $e
        };
      };
      if ($mod.MainForm.VersionCheck) $mod.MainForm.CheckVersion();
      if ($mod.MainForm.DataLimited) {
        Endpoint = "IActorInfoService.ActorBirthDay50"}
       else Endpoint = "IActorInfoService.ActorBirthDay";
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      try {
        Response = await $mod.MainForm.Client.RawInvokeAsync(Endpoint,[window.atob("TGVlbG9vRGFsbGFzTXVsdGlQYXNz"),aMonth,aDay,Progress]);
        Blob = Response.FResult;
        Data = "[]";
        Data = await Blob.text();
        Data = JSON.parse(Data);
      } catch ($e) {
        if (pas.SysUtils.Exception.isPrototypeOf($e)) {
          var E = $e;
          if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
          if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
          $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
          window.console.log("Server Communication Exception Encountered.");
          window.console.log(" -- " + E.$classname);
          window.console.log(" -- " + E.FMessage);
          window.console.log(" -- Automatic retry attempt in 30s");
          $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.tmrStart.SetInterval(30000);
          $mod.MainForm.tmrStart.SetEnabled(true);
          return;
        } else throw $e
      };
      $mod.MainForm.BirthdayCacheDate[DayNum - 1] = pas.SysUtils.Now();
      $mod.MainForm.BirthdayCacheData[DayNum - 1] = Data;
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Preparing");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Preparing");
      var table1 = pas.Main.MainForm.ActorTabulator;
          var table2 = pas.Main.MainForm.RoleTabulator;
          var actorData = Data;
      
          // Filter out Adult content
          var adult = pas.Main.MainForm.AdultContent;
          var acount = 0;
          if (!adult) {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if (actorData[i]['XXX'] == true) {
                actorData.splice(i,1);
                acount++;
              }
            }
          } else {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                actorData.splice(i,1);
                acount++;
              }
            }
          }
      
          pas.Main.MainForm.ActorTabulator.setData(actorData)
            .then(function(){
      
              // update the first column header to show a count
              var rowCount = table1.getDataCount("active");
              if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
              else { window.actorcount.innerHTML = rowCount; };
      
              if (rowCount > 0) {
      
                // highlight the first row, based on whatever sorting is currently in place
                table1.selectRow(table1.getRowFromPosition(1, true));
      
                // Do what we would do if we had directly clicked on that row
                window.Actor_Selected(null, table1.getRowFromPosition(1,true));
      
              }
              else {
                table2.clearData();
              }
      
            });
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
      $mod.MainForm.PreventCompilerHint$2(CacheData);
    };
    this.GetDeathDays = async function (aMonth, aDay) {
      var Response = null;
      var Data = "";
      var Blob = undefined;
      var Progress = "";
      var Endpoint = "";
      var DayNum = 0;
      var CacheData = "";
      DayNum = pas.DateUtils.DayOfTheYear(pas.SysUtils.EncodeDate(2020,aMonth,aDay));
      if ($mod.MainForm.DeathdayCacheDate[DayNum - 1] > (pas.SysUtils.Now() - 0.25)) {
        CacheData = $mod.MainForm.DeathdayCacheData[DayNum - 1];
        $mod.MainForm.CurrentPerson = -1;
        $mod.MainForm.CurrentRole = -1;
        var table1 = pas.Main.MainForm.ActorTabulator;
              var table2 = pas.Main.MainForm.RoleTabulator;
              var actorData = CacheData;
        
              // Filter out Adult content
              var adult = pas.Main.MainForm.AdultContent;
              var acount = 0;
              if (!adult) {
                for (var i = actorData.length - 1; i >= 0; i--) {
                  if (actorData[i]['XXX'] == true) {
                    actorData.splice(i,1);
                    acount++;
                  }
                }
              } else {
                for (var i = actorData.length - 1; i >= 0; i--) {
                  if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                    actorData.splice(i,1);
                    acount++;
                  }
                }
              }
        
              pas.Main.MainForm.ActorTabulator.setData(actorData)
              .then(function(){
        
                // update the first column header to show a count
                var rowCount = table1.getDataCount("active");
                if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
                else { window.actorcount.innerHTML = rowCount; };
        
                if (rowCount > 0) {
        
                  // highlight the first row, based on whatever sorting is currently in place
                  table1.selectRow(table1.getRowFromPosition(1, true));
        
                  // Do what we would do if we had directly clicked on that row
                  window.Actor_Selected(null, table1.getRowFromPosition(1,true));
        
                }
                else {
                  table2.clearData();
                }
        
              });
        return;
      };
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
      Progress = rtl.guidrToStr(pas.SysUtils.TGuidHelper.NewGuid());
      $mod.MainForm.Pending.Add(Progress);
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.CurrentRole = -1;
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.Carnival === null) {
        try {
          $mod.MainForm.Carnival = pas["XData.Web.Connection"].TXDataWebConnection.$create("Create$1",[null]);
          $mod.MainForm.Carnival.SetURL(this.Server);
          await $mod.MainForm.Carnival.OpenAsync();
          $mod.MainForm.Client = pas["XData.Web.Client"].TXDataWebClient.$create("Create$1",[null]);
          $mod.MainForm.Client.SetConnection($mod.MainForm.Carnival);
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
            if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
            if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
            $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
            window.console.log("Server Communication Exception Encountered.");
            window.console.log(" -- " + E.$classname);
            window.console.log(" -- " + E.FMessage);
            window.console.log(" -- Automatic retry attempt in 30s");
            $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.tmrStart.SetInterval(30000);
            $mod.MainForm.tmrStart.SetEnabled(true);
            return;
          } else throw $e
        };
      };
      if ($mod.MainForm.VersionCheck) $mod.MainForm.CheckVersion();
      if ($mod.MainForm.DataLimited) {
        Endpoint = "IActorInfoService.ActorDeathDay50"}
       else Endpoint = "IActorInfoService.ActorDeathDay";
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      try {
        Response = await $mod.MainForm.Client.RawInvokeAsync(Endpoint,[window.atob("TGVlbG9vRGFsbGFzTXVsdGlQYXNz"),aMonth,aDay,Progress]);
        Blob = Response.FResult;
        Data = "[]";
        Data = await Blob.text();
        Data = JSON.parse(Data);
      } catch ($e) {
        if (pas.SysUtils.Exception.isPrototypeOf($e)) {
          var E = $e;
          if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
          if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
          $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
          window.console.log("Server Communication Exception Encountered.");
          window.console.log(" -- " + E.$classname);
          window.console.log(" -- " + E.FMessage);
          window.console.log(" -- Automatic retry attempt in 30s");
          $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.tmrStart.SetInterval(30000);
          $mod.MainForm.tmrStart.SetEnabled(true);
          return;
        } else throw $e
      };
      $mod.MainForm.DeathdayCacheDate[DayNum - 1] = pas.SysUtils.Now();
      $mod.MainForm.DeathdayCacheData[DayNum - 1] = Data;
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Preparing");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Preparing");
      var table1 = pas.Main.MainForm.ActorTabulator;
          var table2 = pas.Main.MainForm.RoleTabulator;
          var actorData = Data;
      
          // Filter out Adult content
          var adult = pas.Main.MainForm.AdultContent;
          var acount = 0;
          if (!adult) {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if (actorData[i]['XXX'] == true) {
                actorData.splice(i,1);
                acount++;
              }
            }
          } else {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                actorData.splice(i,1);
                acount++;
              }
            }
          }
      
          pas.Main.MainForm.ActorTabulator.setData(actorData)
            .then(function(){
      
              // update the first column header to show a count
              var rowCount = table1.getDataCount("active");
              if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
              else { window.actorcount.innerHTML = rowCount; };
      
              if (rowCount > 0) {
      
                // highlight the first row, based on whatever sorting is currently in place
                table1.selectRow(table1.getRowFromPosition(1, true));
      
                // Do what we would do if we had directly clicked on that row
                window.Actor_Selected(null, table1.getRowFromPosition(1,true));
      
              }
              else {
                table2.clearData();
              }
      
            });
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
      $mod.MainForm.PreventCompilerHint$1(CacheData);
    };
    this.GetTop1000 = async function () {
      var Response = null;
      var Data = "";
      var Blob = undefined;
      var Progress = "";
      var Endpoint = "";
      var CacheData = "";
      if ($mod.MainForm.Top1000CacheDate > (pas.SysUtils.Now() - 0.25)) {
        CacheData = $mod.MainForm.Top1000CacheData;
        $mod.MainForm.CurrentPerson = -1;
        $mod.MainForm.CurrentRole = -1;
        var table1 = pas.Main.MainForm.ActorTabulator;
              var table2 = pas.Main.MainForm.RoleTabulator;
              var actorData = CacheData;
        
              // Filter out Adult content
              var adult = pas.Main.MainForm.AdultContent;
              var acount = 0;
              if (!adult) {
                for (var i = actorData.length - 1; i >= 0; i--) {
                  if (actorData[i]['XXX'] == true) {
                    actorData.splice(i,1);
                    acount++;
                  }
                }
              } else {
                for (var i = actorData.length - 1; i >= 0; i--) {
                  if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                    actorData.splice(i,1);
                    acount++;
                  }
                }
              }
        
              pas.Main.MainForm.ActorTabulator.setData(actorData)
              .then(function(){
        
                // update the first column header to show a count
                var rowCount = table1.getDataCount("active");
                if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
                else { window.actorcount.innerHTML = rowCount; };
        
                if (rowCount > 0) {
        
                  // highlight the first row, based on whatever sorting is currently in place
                  table1.selectRow(table1.getRowFromPosition(1, true));
        
                  // Do what we would do if we had directly clicked on that row
                  window.Actor_Selected(null, table1.getRowFromPosition(1,true));
        
                }
                else {
                  table2.clearData();
                }
        
              });
        return;
      };
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
      Progress = rtl.guidrToStr(pas.SysUtils.TGuidHelper.NewGuid());
      if (this.AdultContent) Progress = "[ADULT]" + Progress;
      $mod.MainForm.Pending.Add(Progress);
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.Carnival === null) {
        try {
          $mod.MainForm.Carnival = pas["XData.Web.Connection"].TXDataWebConnection.$create("Create$1",[null]);
          $mod.MainForm.Carnival.SetURL(this.Server);
          await $mod.MainForm.Carnival.OpenAsync();
          $mod.MainForm.Client = pas["XData.Web.Client"].TXDataWebClient.$create("Create$1",[null]);
          $mod.MainForm.Client.SetConnection($mod.MainForm.Carnival);
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
            if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
            if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
            $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
            window.console.log("Server Communication Exception Encountered.");
            window.console.log(" -- " + E.$classname);
            window.console.log(" -- " + E.FMessage);
            window.console.log(" -- Automatic retry attempt in 30s");
            $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.tmrStart.SetInterval(30000);
            $mod.MainForm.tmrStart.SetEnabled(true);
            return;
          } else throw $e
        };
      };
      if ($mod.MainForm.VersionCheck) $mod.MainForm.CheckVersion();
      if (this.DataLimitedTop) {
        Endpoint = "IActorInfoService.TopOneThousand"}
       else Endpoint = "IActorInfoService.TopFiveThousand";
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      try {
        Response = await $mod.MainForm.Client.RawInvokeAsync(Endpoint,[window.atob("TGVlbG9vRGFsbGFzTXVsdGlQYXNz"),Progress]);
        Blob = Response.FResult;
        Data = "[]";
        Data = await Blob.text();
        Data = JSON.parse(Data);
      } catch ($e) {
        if (pas.SysUtils.Exception.isPrototypeOf($e)) {
          var E = $e;
          if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
          if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
          $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
          window.console.log("Server Communication Exception Encountered.");
          window.console.log(" -- " + E.$classname);
          window.console.log(" -- " + E.FMessage);
          window.console.log(" -- Automatic retry attempt in 30s");
          $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.tmrStart.SetInterval(30000);
          $mod.MainForm.tmrStart.SetEnabled(true);
          return;
        } else throw $e
      };
      $mod.MainForm.Top1000CacheDate = pas.SysUtils.Now();
      $mod.MainForm.Top1000CacheData = Data;
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Preparing");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Preparing");
      var table1 = pas.Main.MainForm.ActorTabulator;
          var table2 = pas.Main.MainForm.RoleTabulator;
          var actorData = Data;
      
          // Filter out Adult content
          var adult = pas.Main.MainForm.AdultContent;
          var acount = 0;
          if (!adult) {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if (actorData[i]['XXX'] == true) {
                actorData.splice(i,1);
                acount++;
              }
            }
          } else {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                actorData.splice(i,1);
                acount++;
              }
            }
          }
      
          pas.Main.MainForm.ActorTabulator.setData(actorData)
            .then(function(){
      
              // update the first column header to show a count
              var rowCount = table1.getDataCount("active");
              if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
              else { window.actorcount.innerHTML = rowCount; };
      
              if (rowCount > 0) {
      
                // highlight the first row, based on whatever sorting is currently in place
                table1.selectRow(table1.getRowFromPosition(1, true));
      
                // Do what we would do if we had directly clicked on that row
                window.Actor_Selected(null, table1.getRowFromPosition(1,true));
      
              }
              else {
                table2.clearData();
              }
      
            });
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
      $mod.MainForm.PreventCompilerHint$1(CacheData);
    };
    this.GetReference = async function (Reference) {
      var Response = null;
      var Data = "";
      var Blob = undefined;
      var Progress = "";
      var Endpoint = "";
      var LookupRef = null;
      var ReferenceList = null;
      var i = 0;
      var id = "";
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
      Progress = rtl.guidrToStr(pas.SysUtils.TGuidHelper.NewGuid());
      $mod.MainForm.Pending.Add(Progress);
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.CurrentRole = -1;
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.Carnival === null) {
        try {
          $mod.MainForm.Carnival = pas["XData.Web.Connection"].TXDataWebConnection.$create("Create$1",[null]);
          $mod.MainForm.Carnival.SetURL(this.Server);
          await $mod.MainForm.Carnival.OpenAsync();
          $mod.MainForm.Client = pas["XData.Web.Client"].TXDataWebClient.$create("Create$1",[null]);
          $mod.MainForm.Client.SetConnection($mod.MainForm.Carnival);
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
            if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
            if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
            $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
            window.console.log("Server Communication Exception Encountered.");
            window.console.log(" -- " + E.$classname);
            window.console.log(" -- " + E.FMessage);
            window.console.log(" -- Automatic retry attempt in 30s");
            $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.tmrStart.SetInterval(30000);
            $mod.MainForm.tmrStart.SetEnabled(true);
            return;
          } else throw $e
        };
      };
      if ($mod.MainForm.VersionCheck) $mod.MainForm.CheckVersion();
      Endpoint = "IActorInfoService.Lookup";
      LookupRef = JSON.parse('{"PPL":[]}');
      ReferenceList = pas.Classes.TStringList.$create("Create$1");
      ReferenceList.SetCommaText(Reference);
      for (var $l = 0, $end = ReferenceList.GetCount() - 1; $l <= $end; $l++) {
        i = $l;
        if (pas.SysUtils.UpperCase(pas.System.Copy(ReferenceList.Get(i),1,1)) === "P") {
          id = pas.System.Copy(ReferenceList.Get(i),2,ReferenceList.Get(i).length);
          if (pas.System.Pos("-",id) > 0) id = pas.System.Copy(id,1,pas.System.Pos("-",id) - 1);
          var nid = window.from29(id);
          LookupRef['PPL'].push(JSON.parse('{"ID":'+nid+'}'));
        };
      };
      // https://javascript.plainenglish.io/the-easy-way-to-create-a-unique-array-of-json-objects-in-javascript-5634254b17aa
      LookupRef['PPL'] = [... new Set(LookupRef['PPL'].map(JSON.stringify))].map(JSON.parse);
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      try {
        Response = await $mod.MainForm.Client.RawInvokeAsync(Endpoint,[window.atob("TGVlbG9vRGFsbGFzTXVsdGlQYXNz"),JSON.stringify(LookupRef),Progress]);
        Blob = Response.FResult;
        Data = "[]";
        Data = await Blob.text();
        Data = JSON.parse(Data);
      } catch ($e) {
        if (pas.SysUtils.Exception.isPrototypeOf($e)) {
          var E = $e;
          if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
          if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
          $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
          window.console.log("Server Communication Exception Encountered.");
          window.console.log(" -- " + E.$classname);
          window.console.log(" -- " + E.FMessage);
          window.console.log(" -- Automatic retry attempt in 30s");
          $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.tmrStart.SetInterval(30000);
          $mod.MainForm.tmrStart.SetEnabled(true);
          return;
        } else throw $e
      };
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Preparing");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Preparing");
      var table1 = pas.Main.MainForm.ActorTabulator;
          var table2 = pas.Main.MainForm.RoleTabulator;
          var actorData = Data;
      
          // Filter out Adult content
          var adult = pas.Main.MainForm.AdultContent;
          var acount = 0;
          if (!adult) {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if (actorData[i]['XXX'] == true) {
                actorData.splice(i,1);
                acount++;
              }
            }
          } else {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                actorData.splice(i,1);
                acount++;
              }
            }
          }
      
          pas.Main.MainForm.ActorTabulator.setData(actorData['PPL'])
            .then(function(){
      
              // update the first column header to show a count
              var rowCount = table1.getDataCount("active");
              if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
              else { window.actorcount.innerHTML = rowCount; };
      
              if (rowCount > 0) {
      
                // highlight the first row, based on whatever sorting is currently in place
                table1.selectRow(table1.getRowFromPosition(1, true));
      
                // Do what we would do if we had directly clicked on that row
                window.Actor_Selected(null, table1.getRowFromPosition(1,true));
      
              }
              else {
                table2.clearData();
                pas.Main.MainForm.MenuType = 0;
                window.RefreshMenu();
              }
      
            });
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
      $mod.MainForm.PreventCompilerHint$1(Data);
    };
    this.GetAge = function (BirthDate, CurrentDate) {
      var Result = 0;
      var y1 = 0;
      var m1 = 0;
      var d1 = 0;
      var y2 = 0;
      var m2 = 0;
      var d2 = 0;
      Result = 0;
      y1 = pas.SysUtils.StrToInt(pas.System.Copy(BirthDate,1,4));
      m1 = pas.SysUtils.StrToInt(pas.System.Copy(BirthDate,5,2));
      d1 = pas.SysUtils.StrToInt(pas.System.Copy(BirthDate,7,2));
      y2 = pas.SysUtils.StrToInt(pas.System.Copy(CurrentDate,1,4));
      m2 = pas.SysUtils.StrToInt(pas.System.Copy(CurrentDate,5,2));
      d2 = pas.SysUtils.StrToInt(pas.System.Copy(CurrentDate,7,2));
      if ((m1 === 2) && (d1 === 29) && !pas.SysUtils.IsLeapYear(y2)) {
        d1 = 28;
      };
      Result = y2 - y1;
      if ((m2 < m1) || ((m2 === m1) && (d2 < d1))) Result -= 1;
      return Result;
    };
    this.divPhotoClick = function (Sender) {
      $mod.MainForm.ViewerMode = "PersonPhotos";
      $mod.MainForm.ViewerURL1 = $mod.MainForm.Photo1;
      $mod.MainForm.ViewerURL2 = $mod.MainForm.Photo2;
      $mod.MainForm.ViewerURLA = $mod.MainForm.PhotoA;
      $mod.MainForm.ViewerURLC = 1;
      $mod.MainForm.ViewerURLT = 1;
      $mod.MainForm.ShowViewer();
    };
    this.ShowViewer = function () {
      var direction = "";
      var aspect = 0.0;
      var pagewidth = 0.0;
      var pageheight = 0.0;
      var pagetop = 0.0;
      var pageleft = 0.0;
      var displayable = false;
      displayable = true;
      if (($mod.MainForm.ViewerURL1.length < 10) || ($mod.MainForm.ViewerURL2.length < 10) || (pas.System.Pos("<",$mod.MainForm.ViewerURL1) > 0) || (pas.System.Pos("placeholder",$mod.MainForm.ViewerURL1) > 0) || (pas.System.Pos("img/dark_space",$mod.MainForm.ViewerURL1) > 0) || (pas.System.Pos("img/hourglass",$mod.MainForm.ViewerURL1) > 0) || (pas.System.Pos("<",$mod.MainForm.ViewerURL2) > 0) || (pas.System.Pos("placeholder",$mod.MainForm.ViewerURL2) > 0) || (pas.System.Pos("img/dark_space",$mod.MainForm.ViewerURL2) > 0) || (pas.System.Pos("img/hourglass",$mod.MainForm.ViewerURL2) > 0)) displayable = false;
      if (displayable) {
        if ($mod.MainForm.ViewerMode === "Backdrops") {
          direction = "landscape";
          aspect = 1.77777;
        } else {
          direction = "portrait";
          aspect = 0.66666;
        };
        if ($mod.MainForm.ViewerVisible === false) {
          this.divBlock.SetTop(0);
          this.divBlock.SetLeft(0);
          this.divBlock.GetElementHandle().classList.remove("d-none");
          this.divBlockControls.GetElementHandle().classList.remove("d-none");
          this.divBlockData.GetElementHandle().classList.remove("d-none");
          pagetop = 20.0;
          pageleft = 20.0;
          pagewidth = document.documentElement.clientWidth - 90.0;
          pageheight = document.documentElement.clientHeight - 40.0;
          if ((pagewidth / pageheight) > aspect) {
            $mod.MainForm.divViewerHolder.SetTop(Math.round(pagetop));
            $mod.MainForm.divViewerHolder.SetHeight(Math.round(pageheight));
            $mod.MainForm.divViewerHolder.SetWidth(Math.round(pageheight * aspect));
            $mod.MainForm.divViewerHolder.SetLeft(Math.round(pageleft + ((pagewidth - Math.round(pageheight * aspect)) / 2)));
          } else {
            $mod.MainForm.divViewerHolder.SetLeft(Math.round(pageleft));
            $mod.MainForm.divViewerHolder.SetWidth(Math.round(pagewidth));
            $mod.MainForm.divViewerHolder.SetHeight(Math.round(pagewidth / aspect));
            $mod.MainForm.divViewerHolder.SetTop(Math.round(pagetop + ((pageheight - Math.round(pagewidth / aspect)) / 2)));
          };
          $mod.MainForm.ViewerVisible = true;
        };
        this.divViewerHolder.GetElementHandle().firstElementChild.innerHTML = '<div id="Viewer" style="width:100%;height:100%;background-image:url(' + $mod.MainForm.ViewerURL1 + '); background-size:100% 100%;">' + "<img " + 'class="lazy ' + direction + '" ' + "height=100% width=100%" + 'alt="Photo of ' + $mod.MainForm.ViewerURLA + '" ' + "src=" + $mod.MainForm.ViewerURL1 + " " + "data-src=" + $mod.MainForm.ViewerURL2 + " " + 'onerror="this.onerror=null;this.src=\'img/hourglass.png\'"' + 'onclick="event.stopPropagation()"' + "/>" + "</div>";
        $mod.MainForm.btnBlockCount.SetCaption(pas.SysUtils.IntToStr($mod.MainForm.ViewerURLC));
        $mod.MainForm.btnBlockTotal.SetCaption(pas.SysUtils.IntToStr($mod.MainForm.ViewerURLT));
        if ((this.ViewerMode === "PersonPhotos") || (this.ViewerMode === "Backdrops")) {
          $mod.MainForm.btnBlockPrevious.SetCaption('<i class="fa-duotone fa-circle-arrow-right fa-2x text-white opacity-75"> </i>');
          $mod.MainForm.btnBlockNext.SetCaption('<i class="fa-duotone fa-circle-arrow-left fa-2x text-white opacity-75"> </i>');
          if ($mod.MainForm.ViewerURLC === $mod.MainForm.ViewerURLT) {
            $mod.MainForm.btnBlockPrevious.SetEnabled(false)}
           else $mod.MainForm.btnBlockPrevious.SetEnabled(true);
          if ($mod.MainForm.ViewerURLC === 1) {
            $mod.MainForm.btnBlockNext.SetEnabled(false)}
           else $mod.MainForm.btnBlockNext.SetEnabled(true);
        } else {
          $mod.MainForm.btnBlockPrevious.SetCaption('<i class="fa-duotone fa-circle-arrow-up fa-2x text-white opacity-75"> </i>');
          $mod.MainForm.btnBlockNext.SetCaption('<i class="fa-duotone fa-circle-arrow-down fa-2x text-white opacity-75"> </i>');
          if ($mod.MainForm.ViewerURLC === $mod.MainForm.ViewerURLT) {
            $mod.MainForm.btnBlockNext.SetEnabled(false)}
           else $mod.MainForm.btnBlockNext.SetEnabled(true);
          if ($mod.MainForm.ViewerURLC === 1) {
            $mod.MainForm.btnBlockPrevious.SetEnabled(false)}
           else $mod.MainForm.btnBlockPrevious.SetEnabled(true);
        };
        $mod.MainForm.divViewerHolder.GetElementHandle().classList.remove("d-none");
        $mod.MainForm.tmrFocus.FTag = 1;
        $mod.MainForm.tmrFocus.SetEnabled(true);
        $mod.MainForm.tmrImageCheckEnable();
        var element = divViewer.firstElementChild;
        pas.Main.MainForm.pz = Panzoom(element, {
          maxScale: 100,
          minScale: 0.75
        });
        element.parentElement.addEventListener('wheel',pas.Main.MainForm.pz.zoomWithWheel);
      };
    };
    this.divViewerHolderClick = function (Sender) {
      $mod.MainForm.tmrFocus.FTag = 1;
      $mod.MainForm.tmrFocus.SetEnabled(true);
      this.ViewerVisible = false;
      this.divViewerHolder.GetElementHandle().classList.add("d-none");
      this.divBlock.GetElementHandle().classList.add("d-none");
      this.divBlockControls.GetElementHandle().classList.add("d-none");
      this.divBlockData.GetElementHandle().classList.add("d-none");
      var element = document.querySelector('#Viewer');
      element.parentElement.removeEventListener('wheel',pas.Main.MainForm.pz.zoomWithWheel)
      pas.Main.MainForm.pz.destroy();
    };
    this.divNextBirthDayClick = function (Sender) {
      var NewDate = "";
      if (this.CurrentBirthDate === "") this.CurrentBirthDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      NewDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.EncodeDate(pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentBirthDate,1,4)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentBirthDate,6,2)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentBirthDate,9,2))) + 1);
      this.Birthdate.setDate(NewDate,true);
      $mod.MainForm.PreventCompilerHint$1(NewDate);
    };
    this.btnBioClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageBio);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnPhotoClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pagePhotos);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnVideoClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageVideos);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnBackgroundClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageBackgrounds);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnConnectClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageConnect);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnSettingsClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageSettings);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.WebFormKeyDown = function (Sender, Key, Shift) {
      if ((Key.get() === 27) && !this.divViewerHolder.GetElementHandle().classList.contains("d-none")) this.divViewerHolderClick(null);
    };
    this.SetBootstrapTooltip = function (button, placement) {
      var btn = null;
      var title = "";
      btn = button.GetElementHandle();
      title = button.FHint;
      button.SetHint("");
      var tooltip = new bootstrap.Tooltip(btn, {
        title: title,
        placement: placement,
        customClass: 'custom-tooltip',
        delay: { "show": 1500, "hide": 100 }
      });
      $mod.MainForm.PreventCompilerHint$3(btn);
      $mod.MainForm.PreventCompilerHint$1(title);
    };
    this.SetBootstrapTooltipDiv = function (element, hint, placement) {
      var btn = null;
      var title = "";
      btn = element.GetElementHandle();
      title = hint;
      // NOTE: html and sanitize are added here to allow displaying tables
      var tooltip = new bootstrap.Tooltip(btn, {
        title: title,
        html: true,
        sanitize: false,
        placement: placement,
        customClass: 'custom-tooltip',
        delay: { "show": 1500, "hide": 100 }
      });
      $mod.MainForm.PreventCompilerHint$3(btn);
      $mod.MainForm.PreventCompilerHint$1(title);
    };
    this.WebFormShow = function (Sender) {
      // Lets make sure all our Bootstrap tooltips are accessible
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl));
    };
    this.tmrFocusTimer = function (Sender) {
      if (this.tmrFocus.FTag > 0) {
        this.edtSearch.SetFocus();
        this.tmrFocus.FTag = 0;
      } else {
        this.tmrFocus.SetEnabled(false);
      };
    };
    this.tmrStartTimer = function (Sender) {
      if (this.TablesReady === 2) {
        this.tmrStart.SetEnabled(false);
        if (this.StartupMode === "today") {
          this.GetBirthDays(pas.DateUtils.MonthOfTheYear(pas.SysUtils.Now()),pas.DateUtils.DayOfTheMonth(pas.SysUtils.Now()));
        } else if (this.StartupMode === "reference") {
          this.Startup = false;
          this.GetReference(pas["WEBLib.WebTools"].GetQueryParam("R"));
        } else if (this.StartupMode === "adult") {
          this.Startup = false;
          this.GetBirthDays(pas.DateUtils.MonthOfTheYear(pas.SysUtils.Now()),pas.DateUtils.DayOfTheMonth(pas.SysUtils.Now()));
        };
      };
    };
    this.btnActorsClick = function (Sender) {
      this.btnActors.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnWriters.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDirectors.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnWritersClick = function (Sender) {
      this.btnWriters.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnActors.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDirectors.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnDirectorsClick = function (Sender) {
      this.btnDirectors.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnWriters.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnActors.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnDiscordClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageDiscord);
      this.divInfoPages.SetFocus();
      $mod.MainForm.VersionCheck = true;
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-secondary","btn-primary");
      this.btnAbout.GetElementHandle().classList.replace("btn-primary","btn-secondary");
    };
    this.btnDiscordLaunchClick = function (Sender) {
      window.open("https://discord.gg/TrvjHbwyyd","_blank");
    };
    this.WebFormResize = function (Sender) {
      if (typeof window.RefreshMenu === 'function') {
        window.RefreshMenu();
      };
      if (this.ViewerVisible) {
        this.ViewerVisible = false;
        this.ShowViewer();
      };
      var switchHeight = divInfo.getBoundingClientRect().top + divInfo.getBoundingClientRect().height;
      if (switchHeight < window.innerHeight * 0.75) {
        document.body.style.setProperty('width','100vw');
        document.body.style.setProperty('height','100vh');
        divBottom.style.setProperty('max-height','unset');
      }
      else {
        document.body.style.setProperty('width','98vw');
        document.body.style.setProperty('height','unset');
        divBottom.style.setProperty('max-height','75vh');
      };
    };
    this.btnTop1000Click = function (Sender) {
      this.GetTop1000();
    };
    this.switchLimitDataClick = function (Sender) {
      var i = 0;
      if (this.switchLimitData.GetChecked()) {
        this.DataLimited = true;
        this.lblLimitData.SetCaption("Limit Person Requests to 50 Records");
      } else {
        this.DataLimited = false;
        this.lblLimitData.SetCaption("Person Requests Return All Records");
      };
      this.Top1000CacheDate = pas.SysUtils.Now() - 1;
      this.Top1000CacheData = "[]";
      for (i = 1; i <= 366; i++) {
        this.BirthdayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.BirthdayCacheData[i - 1] = "[]";
        this.DeathdayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.DeathdayCacheData[i - 1] = "[]";
        this.ReleasedayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.ReleasedayCacheData[i - 1] = "[]";
      };
    };
    this.btnAboutClick = function (Sender) {
      this.divInfoPages.SetActivePage(this.pageAbout);
      this.divInfoPages.SetFocus();
      this.btnBio.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnPhoto.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnVideo.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnBackground.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnConnect.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnSettings.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnDiscord.GetElementHandle().classList.replace("btn-primary","btn-secondary");
      this.btnAbout.GetElementHandle().classList.replace("btn-secondary","btn-primary");
    };
    this.divPrevBirthDayClick = function (Sender) {
      var NewDate = "";
      if (this.CurrentBirthDate === "") this.CurrentBirthDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      NewDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.EncodeDate(pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentBirthDate,1,4)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentBirthDate,6,2)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentBirthDate,9,2))) - 1);
      this.Birthdate.setDate(NewDate,true);
      $mod.MainForm.PreventCompilerHint$1(NewDate);
    };
    this.divPrevDeathDayClick = function (Sender) {
      var NewDate = "";
      if (this.CurrentDeathDate === "") this.CurrentDeathDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      NewDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.EncodeDate(pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentDeathDate,1,4)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentDeathDate,6,2)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentDeathDate,9,2))) - 1);
      this.Deathdate.setDate(NewDate,true);
      $mod.MainForm.PreventCompilerHint$1(NewDate);
    };
    this.divNextDeathDayClick = function (Sender) {
      var NewDate = "";
      if (this.CurrentDeathDate === "") this.CurrentDeathDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      NewDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.EncodeDate(pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentDeathDate,1,4)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentDeathDate,6,2)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentDeathDate,9,2))) + 1);
      this.Deathdate.setDate(NewDate,true);
      $mod.MainForm.PreventCompilerHint$1(NewDate);
    };
    this.divPrevReleaseDayClick = function (Sender) {
      var NewDate = "";
      if (this.CurrentReleaseDate === "") this.CurrentReleaseDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      NewDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.EncodeDate(pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentReleaseDate,1,4)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentReleaseDate,6,2)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentReleaseDate,9,2))) - 1);
      this.Releasedate.setDate(NewDate,true);
      $mod.MainForm.PreventCompilerHint$1(NewDate);
    };
    this.divNextReleaseDayClick = function (Sender) {
      var NewDate = "";
      if (this.CurrentReleaseDate === "") this.CurrentReleaseDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.Now());
      NewDate = pas.SysUtils.FormatDateTime("yyyy-mm-dd",pas.SysUtils.EncodeDate(pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentReleaseDate,1,4)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentReleaseDate,6,2)),pas.SysUtils.StrToInt(pas.System.Copy(this.CurrentReleaseDate,9,2))) + 1);
      this.Releasedate.setDate(NewDate,true);
      $mod.MainForm.PreventCompilerHint$1(NewDate);
    };
    this.switchLimitDataTopClick = function (Sender) {
      var i = 0;
      if (this.switchLimitDataTop.GetChecked()) {
        this.DataLimitedTop = true;
        this.lblLimitDataTop.SetCaption("Limit Top Requests to 1,000 Records");
        this.btnTop1000.SetCaption("TMDb Top 1,000 Actors");
      } else {
        this.DataLimitedTop = false;
        this.lblLimitDataTop.SetCaption("Top Requests Return 5,000 Records");
        this.btnTop1000.SetCaption("TMDb Top 5,000 Actors");
      };
      this.Top1000CacheDate = pas.SysUtils.Now() - 1;
      this.Top1000CacheData = "[]";
      this.Top5000CacheDate = pas.SysUtils.Now() - 1;
      this.Top5000CacheData = "[]";
      for (i = 1; i <= 366; i++) {
        this.BirthdayCacheDate[i - 1] = pas.SysUtils.Now() - 1;
        this.BirthdayCacheData[i - 1] = "[]";
      };
    };
    this.btnSearchClick = async function (Sender) {
      var Response = null;
      var Data = "";
      var Blob = undefined;
      var Progress = "";
      var Endpoint = "";
      if (pas.SysUtils.Trim(this.edtSearch.GetText()).length < 3) return;
      $mod.MainForm.NowSearching = true;
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
      Progress = rtl.guidrToStr(pas.SysUtils.TGuidHelper.NewGuid());
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.CurrentRole = -1;
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.Carnival === null) {
        try {
          $mod.MainForm.Carnival = pas["XData.Web.Connection"].TXDataWebConnection.$create("Create$1",[null]);
          $mod.MainForm.Carnival.SetURL(this.Server);
          await $mod.MainForm.Carnival.OpenAsync();
          $mod.MainForm.Client = pas["XData.Web.Client"].TXDataWebClient.$create("Create$1",[null]);
          $mod.MainForm.Client.SetConnection($mod.MainForm.Carnival);
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
            if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
            if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
            $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
            window.console.log("Server Communication Exception Encountered.");
            window.console.log(" -- " + E.$classname);
            window.console.log(" -- " + E.FMessage);
            window.console.log(" -- Automatic retry attempt in 30s");
            $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.tmrStart.SetInterval(30000);
            $mod.MainForm.tmrStart.SetEnabled(true);
            return;
          } else throw $e
        };
      };
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.QuickSearch) {
        Endpoint = "IActorInfoService.SearchPeople"}
       else Endpoint = "IActorInfoService.SearchPeopleExtended";
      try {
        Response = await $mod.MainForm.Client.RawInvokeAsync(Endpoint,[window.atob("TGVlbG9vRGFsbGFzTXVsdGlQYXNz"),this.edtSearch.GetText(),Progress]);
        Blob = Response.FResult;
        Data = "[]";
        Data = await Blob.text();
        Data = JSON.parse(Data);
      } catch ($e) {
        if (pas.SysUtils.Exception.isPrototypeOf($e)) {
          var E = $e;
          if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
          if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
          $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
          window.console.log("Server Communication Exception Encountered.");
          window.console.log(" -- " + E.$classname);
          window.console.log(" -- " + E.FMessage);
          window.console.log(" -- Automatic retry attempt in 30s");
          $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.tmrStart.SetInterval(30000);
          $mod.MainForm.tmrStart.SetEnabled(true);
          return;
        } else throw $e
      };
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Preparing");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Preparing");
      var table1 = pas.Main.MainForm.ActorTabulator;
          var table2 = pas.Main.MainForm.RoleTabulator;
          var actorData = Data;
      
          // Filter out Adult content
          var adult = pas.Main.MainForm.AdultContent;
          var acount = 0;
          if (!adult) {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if (actorData[i]['XXX'] == true) {
                actorData.splice(i,1);
                acount++;
              }
            }
          } else {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                actorData.splice(i,1);
                acount++;
              }
            }
          }
      
          pas.Main.MainForm.ActorTabulator.setData(actorData)
            .then(function(){
      
              // update the first column header to show a count
              var rowCount = table1.getDataCount("active");
              if (table1.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
              else { window.actorcount.innerHTML = rowCount; };
      
              if (rowCount > 0) {
      
                // highlight the first row, based on whatever sorting is currently in place
                table1.selectRow(table1.getRowFromPosition(1, true));
      
                // Do what we would do if we had directly clicked on that row
                window.Actor_Selected(null, table1.getRowFromPosition(1,true));
      
              }
              else {
                table2.clearData();
              }
      
            });
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.NowSearching = false;
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
      $mod.MainForm.PreventCompilerHint$1(Data);
    };
    this.edtSearchChange = function (Sender) {
      if (pas.SysUtils.Trim(this.edtSearch.GetText()).length < 3) {}
      else {
        this.tmrSearch.SetEnabled(false);
        this.tmrSearch.SetEnabled(true);
      };
    };
    this.tmrSearchTimer = function (Sender) {
      if (this.NowSearching === false) {
        this.btnSearchClick(Sender);
        this.tmrSearch.SetEnabled(false);
      };
    };
    this.edtSearchEnter = function (Sender) {
      this.edtSearch.SelectAll();
    };
    this.switchSearchClick = function (Sender) {
      if (this.switchSearch.GetChecked()) {
        this.QuickSearch = true;
        this.lblQuickSearch.SetCaption("Limit Quick Search to 20 Results");
        btnSearch.innerHTML = window.icon_magnifying_glass;
      } else {
        this.QuickSearch = false;
        this.lblQuickSearch.SetCaption("Slow Search Limited to 100 Results");
        btnSearch.innerHTML = window.icon_magnifying_glass_swap;
      };
    };
    this.lblLimitDataTopClick = function (Sender) {
      this.switchLimitDataTopClick(Sender);
    };
    this.lblLimitDataClick = function (Sender) {
      this.switchLimitDataClick(Sender);
    };
    this.lblQuickSearchClick = function (Sender) {
      this.switchSearchClick(Sender);
    };
    this.tmrImageCheckTimer = function (Sender) {
      var reload = 0;
      reload = 0;
      var errorElements = document.querySelectorAll(".lazy.entered.loaded");
        errorElements.forEach(el => {
        if (el.src.indexOf('hourglass') > 0) {
          el.classList.remove("entered","loaded");
          el.removeAttribute("data-was-processed");
          el.removeAttribute("data-ll-status");
          reload = reload + 1;
        }
      });
      if (reload > 0) window.lazyLoadInstance.update();
      if (reload === 0) {
        $mod.MainForm.tmrImageCheck.SetEnabled(false);
      };
    };
    this.btnRelativesClick = async function (Sender) {
      var Response = null;
      var Data = "";
      var Blob = undefined;
      var Progress = "";
      var Endpoint = "";
      $mod.MainForm.NowSearching = true;
      $mod.MainForm.CurrentPerson = -1;
      $mod.MainForm.CurrentRole = -1;
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
      Progress = rtl.guidrToStr(pas.SysUtils.TGuidHelper.NewGuid());
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      if ($mod.MainForm.Carnival === null) {
        try {
          $mod.MainForm.Carnival = pas["XData.Web.Connection"].TXDataWebConnection.$create("Create$1",[null]);
          $mod.MainForm.Carnival.SetURL(this.Server);
          await $mod.MainForm.Carnival.OpenAsync();
          $mod.MainForm.Client = pas["XData.Web.Client"].TXDataWebClient.$create("Create$1",[null]);
          $mod.MainForm.Client.SetConnection($mod.MainForm.Carnival);
        } catch ($e) {
          if (pas.SysUtils.Exception.isPrototypeOf($e)) {
            var E = $e;
            if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
            if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
            $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
            window.console.log("Server Communication Exception Encountered.");
            window.console.log(" -- " + E.$classname);
            window.console.log(" -- " + E.FMessage);
            window.console.log(" -- Automatic retry attempt in 30s");
            $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
            $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
            $mod.MainForm.tmrStart.SetInterval(30000);
            $mod.MainForm.tmrStart.SetEnabled(true);
            return;
          } else throw $e
        };
      };
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Loading");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","ReqError");
      Endpoint = "IActorInfoService.Relatives";
      try {
        Response = await $mod.MainForm.Client.RawInvokeAsync(Endpoint,[window.atob("TGVlbG9vRGFsbGFzTXVsdGlQYXNz"),$mod.MainForm.btnRelatives.FTag$1,Progress]);
        Blob = Response.FResult;
        Data = "[]";
        Data = await Blob.text();
        Data = JSON.parse(Data);
      } catch ($e) {
        if (pas.SysUtils.Exception.isPrototypeOf($e)) {
          var E = $e;
          if ($mod.MainForm.Client !== null) rtl.free($mod.MainForm,"Client");
          if ($mod.MainForm.Carnival !== null) rtl.free($mod.MainForm,"Carnival");
          $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
          window.console.log("Server Communication Exception Encountered.");
          window.console.log(" -- " + E.$classname);
          window.console.log(" -- " + E.FMessage);
          window.console.log(" -- Automatic retry attempt in 30s");
          $mod.MainForm.divPhoto.FHTML.SetTextStr('<div style="width:100%; height:100%;text-align:center; margin-top:110px;"><i class="fa-duotone fa-cloud-exclamation fa-2x text-white"></i></div>');
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("ReqError");
          $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading");
          $mod.MainForm.tmrStart.SetInterval(30000);
          $mod.MainForm.tmrStart.SetEnabled(true);
          return;
        } else throw $e
      };
      $mod.MainForm.divProgressSpinner.FHTML.SetTextStr("");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.add("Preparing");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.add("Preparing");
      var actorData = Data;
      
          // Filter out Adult content
          var adult = pas.Main.MainForm.AdultContent;
          var acount = 0;
          if (!adult) {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if (actorData[i]['XXX'] == true) {
                actorData.splice(i,1);
                acount++;
              }
            }
          } else {
            for (var i = actorData.length - 1; i >= 0; i--) {
              if ((actorData[i]['XXX'] == false) || (actorData[i]['XXX'] == undefined)) {
                actorData.splice(i,1);
                acount++;
              }
            }
          }
      
          pas.Main.MainForm.ActorTabulator.setData(actorData)
            .then(function(){
      
              // update the first column header to show a count
              var rowCount = pas.Main.MainForm.ActorTabulator.getDataCount("active");
              if (pas.Main.MainForm.ActorTabulator.getDataCount() !== rowCount) { window.actorcount.innerHTML = '<span style="color: var(--bs-warning);">'+rowCount+'</span>'; }
              else { window.actorcount.innerHTML = rowCount; };
      
              if (rowCount > 0) {
      
                // highlight the first row, based on whatever sorting is currently in place
                pas.Main.MainForm.ActorTabulator.selectRow( pas.Main.MainForm.ActorTabulator.getRowFromPosition(1, true));
      
                // Do what we would do if we had directly clicked on that row
                window.Actor_Selected(null, pas.Main.MainForm.ActorTabulator.getRowFromPosition(1,true));
      
              }
              else {
                pas.Main.MainForm.RoleTabulator.clearData();
              }
      
            });
      $mod.MainForm.divActorTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.divRoleTabulatorHolder.GetElementHandle().classList.remove("Searching","Preparing","Loading","ReqError");
      $mod.MainForm.NowSearching = false;
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
      $mod.MainForm.PreventCompilerHint$1(Data);
    };
    this.btnSetRelatives = function (relative, name) {
      var aName = "";
      aName = name;
      $mod.MainForm.btnRelatives.FTag$1 = relative;
      if ($mod.MainForm.btnRelatives.FTag$1 > 0) {
        $mod.MainForm.btnRelatives.SetEnabled(true)}
       else $mod.MainForm.btnRelatives.SetEnabled(false);
      btnRelatives.innerHTML = '<div style="display:flex; fill:white;">'+window.icon_family+'<div class="ms-1"> Friends and Family of '+aName+'</div></div>';
      $mod.MainForm.PreventCompilerHint$1(aName);
    };
    this.btnBlockZoomPlusClick = function (Sender) {
      pas.Main.MainForm.pz.zoomIn();
    };
    this.btnBlockZoomMinusClick = function (Sender) {
      pas.Main.MainForm.pz.zoomOut();
    };
    this.btnBlockZoomResetClick = function (Sender) {
      pas.Main.MainForm.pz.reset();
    };
    this.btnBlockPreviousClick = function (Sender) {
      if (this.ViewerMode === "Person") {
        var ActorTable = pas.Main.MainForm.ActorTabulator;
        var rows = ActorTable.getSelectedRows();
        if (rows.length == 1) {
          var row = rows[0].getPrevRow();
          while (row && (row.getCell('PIC').getValue().indexOf('placeholder') !== -1)) {
            row = row.getPrevRow();
          }
          if (row) {
            ActorTable.deselectRow();
            ActorTable.selectRow(row);
            ActorTable.scrollToRow(row,'bottom',false);
            window.Actor_Selected(null, row);
            pas.Main.MainForm.ViewerMode = 'Person';
            pas.Main.MainForm.ViewerURL1 = row.getCell('PIC').getValue();
            pas.Main.MainForm.ViewerURL2 = row.getCell('PIC').getValue().replace('/w45/','/original/');
            pas.Main.MainForm.ViewerURLA = row.getCell('NAM').getValue();
            pas.Main.MainForm.ViewerURLC = row.getPosition();
            pas.Main.MainForm.ViewerURLT = row.getTable().getDataCount();
            pas.Main.MainForm.divViewerHolderClick();
            pas.Main.MainForm.ShowViewer();
          }
        };
      } else if (this.ViewerMode === "Role") {
        var RoleTable = pas.Main.MainForm.RoleTabulator;
        var rows = RoleTable.getSelectedRows();
        if (rows.length == 1) {
          var row = rows[0].getPrevRow();
          while (row && (row.getCell('PIC').getValue().indexOf('placeholder') !== -1)) {
            row = row.getPrevRow();
          }
          if (row) {
            RoleTable.deselectRow();
            RoleTable.selectRow(row);
            RoleTable.scrollToRow(row,'top',false);
            window.Role_Selected(null, row);
            pas.Main.MainForm.ViewerMode = 'Role';
            pas.Main.MainForm.ViewerURL1 = row.getCell('PIC').getValue();
            pas.Main.MainForm.ViewerURL2 = row.getCell('PIC').getValue().replace('/w92/','/original/');
            pas.Main.MainForm.ViewerURLA = row.getCell('NAM').getValue();
            pas.Main.MainForm.ViewerURLC = row.getPosition();
            pas.Main.MainForm.ViewerURLT = row.getTable().getDataCount();
            pas.Main.MainForm.divViewerHolderClick();
            pas.Main.MainForm.ShowViewer();
          }
        };
      } else if (this.ViewerMode === "PersonPhotos") {
        pas.Main.MainForm.ViewerURLN = Math.min(pas.Main.MainForm.ViewerURLN + 1, window.swiper.slides.length-1);
        var clickedslide = window.swiper.slides[pas.Main.MainForm.ViewerURLN];
        pas.Main.MainForm.ViewerMode = 'PersonPhotos';
        pas.Main.MainForm.ViewerURL1 = clickedslide.firstElementChild.getAttribute('data-src');
        pas.Main.MainForm.ViewerURL2 = clickedslide.firstElementChild.getAttribute('data-src').replace('/w45/','/original/');
        pas.Main.MainForm.ViewerURL2 = pas.Main.MainForm.ViewerURL2.replace('/w185/','/original/');
        pas.Main.MainForm.ViewerURLA = pas.Main.MainForm.PhotoA;
        pas.Main.MainForm.ViewerURLC = pas.Main.MainForm.ViewerURLN+1;
        pas.Main.MainForm.ViewerURLT = pas.Main.MainForm.PhotoCount;
        pas.Main.MainForm.ShowViewer();
      } else if (this.ViewerMode === "Backdrops") {
        pas.Main.MainForm.ViewerURLN = Math.min(pas.Main.MainForm.ViewerURLN + 1, window.swiper3.slides.length-1);
        var clickedslide = window.swiper3.slides[pas.Main.MainForm.ViewerURLN];
        pas.Main.MainForm.ViewerMode = 'Backdrops';
        pas.Main.MainForm.ViewerURL1 = clickedslide.firstElementChild.getAttribute('data-src');
        pas.Main.MainForm.ViewerURL2 = clickedslide.firstElementChild.getAttribute('data-src').replace('/w300/','/original/');
        pas.Main.MainForm.ViewerURL2 = pas.Main.MainForm.ViewerURL2.replace('/w780/','/original/');
        pas.Main.MainForm.ViewerURLA = pas.Main.MainForm.PhotoA;
        pas.Main.MainForm.ViewerURLC = pas.Main.MainForm.ViewerURLN+1;
        pas.Main.MainForm.ViewerURLT = pas.Main.MainForm.BackgroundCount;
        pas.Main.MainForm.ShowViewer();
      };
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
    };
    this.btnBlockNextClick = function (Sender) {
      if (this.ViewerMode === "Person") {
        var ActorTable = pas.Main.MainForm.ActorTabulator;
        var rows = ActorTable.getSelectedRows();
        if (rows.length == 1) {
          var row = rows[0].getNextRow();
          while (row && (row.getCell('PIC').getValue().indexOf('placeholder') !== -1)) {
            row = row.getNextRow();
          }
          if (row) {
            ActorTable.deselectRow();
            ActorTable.selectRow(row);
            ActorTable.scrollToRow(row,'bottom',false);
            window.Actor_Selected(null, row);
            pas.Main.MainForm.ViewerMode = 'Person';
            pas.Main.MainForm.ViewerURL1 = row.getCell('PIC').getValue();
            pas.Main.MainForm.ViewerURL2 = row.getCell('PIC').getValue().replace('/w45/','/original/');
            pas.Main.MainForm.ViewerURLA = row.getCell('NAM').getValue();
            pas.Main.MainForm.ViewerURLC = row.getPosition();
            pas.Main.MainForm.ViewerURLT = row.getTable().getDataCount();
            pas.Main.MainForm.divViewerHolderClick();
            pas.Main.MainForm.ShowViewer();
          }
        };
      } else if (this.ViewerMode === "Role") {
        var RoleTable = pas.Main.MainForm.RoleTabulator;
        var rows = RoleTable.getSelectedRows();
        if (rows.length == 1) {
          var row = rows[0].getNextRow();
          while (row && (row.getCell('PIC').getValue().indexOf('placeholder') !== -1)) {
            row = row.getNextRow();
          }
          if (row) {
            RoleTable.deselectRow();
            RoleTable.selectRow(row);
            RoleTable.scrollToRow(row,'bottom',false);
            window.Role_Selected(null, row);
            pas.Main.MainForm.ViewerMode = 'Role';
            pas.Main.MainForm.ViewerURL1 = row.getCell('PIC').getValue();
            pas.Main.MainForm.ViewerURL2 = row.getCell('PIC').getValue().replace('/w92/','/original/');
            pas.Main.MainForm.ViewerURLA = row.getCell('NAM').getValue();
            pas.Main.MainForm.ViewerURLC = row.getPosition();
            pas.Main.MainForm.ViewerURLT = row.getTable().getDataCount();
            pas.Main.MainForm.divViewerHolderClick();
            pas.Main.MainForm.ShowViewer();
          }
        };
      } else if (this.ViewerMode === "PersonPhotos") {
        pas.Main.MainForm.ViewerURLN = Math.max(pas.Main.MainForm.ViewerURLN - 1, 0);
        var clickedslide = window.swiper.slides[pas.Main.MainForm.ViewerURLN];
        pas.Main.MainForm.ViewerMode = 'PersonPhotos';
        pas.Main.MainForm.ViewerURL1 = clickedslide.firstElementChild.getAttribute('data-src');
        pas.Main.MainForm.ViewerURL2 = clickedslide.firstElementChild.getAttribute('data-src').replace('/w45/','/original/');
        pas.Main.MainForm.ViewerURL2 = pas.Main.MainForm.ViewerURL2.replace('/w185/','/original/');
        pas.Main.MainForm.ViewerURLA = pas.Main.MainForm.PhotoA;
        pas.Main.MainForm.ViewerURLC = pas.Main.MainForm.ViewerURLN+1;
        pas.Main.MainForm.ViewerURLT = pas.Main.MainForm.PhotoCount;
        pas.Main.MainForm.ShowViewer();
      } else if (this.ViewerMode === "Backdrops") {
        pas.Main.MainForm.ViewerURLN = Math.max(pas.Main.MainForm.ViewerURLN - 1, 0);
        var clickedslide = window.swiper3.slides[pas.Main.MainForm.ViewerURLN];
        pas.Main.MainForm.ViewerMode = 'Backdrops';
        pas.Main.MainForm.ViewerURL1 = clickedslide.firstElementChild.getAttribute('data-src');
        pas.Main.MainForm.ViewerURL2 = clickedslide.firstElementChild.getAttribute('data-src').replace('/w300/','/original/');
        pas.Main.MainForm.ViewerURL2 = pas.Main.MainForm.ViewerURL2.replace('/w780/','/original/');
        pas.Main.MainForm.ViewerURLA = pas.Main.MainForm.PhotoA;
        pas.Main.MainForm.ViewerURLC = pas.Main.MainForm.ViewerURLN+1;
        pas.Main.MainForm.ViewerURLT = pas.Main.MainForm.BackgroundCount;
        pas.Main.MainForm.ShowViewer();
      };
      $mod.MainForm.tmrImageCheck.SetEnabled(true);
    };
    this.StopLinkerRemoval = function (P) {
    };
    this.PreventCompilerHint = function (I) {
    };
    this.PreventCompilerHint$1 = function (S) {
    };
    this.PreventCompilerHint$2 = function (J) {
    };
    this.PreventCompilerHint$3 = function (H) {
    };
    this.LoadDFMValues = function () {
      pas["WEBLib.Forms"].TCustomForm.LoadDFMValues.call(this);
      this.divBottom = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBottom"]);
      this.divActorTabulatorHolder = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divActorTabulatorHolder"]);
      this.divRoleTabulatorHolder = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divRoleTabulatorHolder"]);
      this.divTop = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divTop"]);
      this.divInfo = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divInfo"]);
      this.divInfoPages = pas["WEBLib.ComCtrls"].TPageControl.$create("Create$2",["divInfoPages"]);
      this.pageBio = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$2",["pageBio"]);
      this.divBiography = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBiography"]);
      this.pageAbout = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$2",["pageAbout"]);
      this.divAbout = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divAbout"]);
      this.pagePhotos = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]);
      this.divPhotoSlider = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPhotoSlider"]);
      this.pageVideos = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]);
      this.divVideoSlider = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divVideoSlider"]);
      this.pageBackgrounds = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]);
      this.divBackgroundSlider = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBackgroundSlider"]);
      this.pageConnect = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$1",[this]);
      this.btnRelatives = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnRelatives"]);
      this.pageDiscord = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$2",["pageDiscord"]);
      this.lblSupport = pas["WEBLib.StdCtrls"].TLabel.$create("Create$2",["lblSupport"]);
      this.btnDiscordLaunch = pas["WEBLib.StdCtrls"].TButton.$create("Create$1",[this]);
      this.pageSettings = pas["WEBLib.ComCtrls"].TTabSheet.$create("Create$2",["pageSettings"]);
      this.divSettings = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divSettings"]);
      this.divSettingsPersonRequests = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divSettingsPersonRequests"]);
      this.lblLimitData = pas["WEBLib.StdCtrls"].TLabel.$create("Create$2",["lblLimitData"]);
      this.switchLimitData = pas["WEBLib.Buttons"].TToggleButton.$create("Create$2",["switchLimitData"]);
      this.divSettingsTopRequests = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divSettingsTopRequests"]);
      this.lblLimitDataTop = pas["WEBLib.StdCtrls"].TLabel.$create("Create$2",["lblLimitData"]);
      this.switchLimitDataTop = pas["WEBLib.Buttons"].TToggleButton.$create("Create$2",["switchLimitData"]);
      this.divSettingsSearch = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divSettingsSearch"]);
      this.lblQuickSearch = pas["WEBLib.StdCtrls"].TLabel.$create("Create$2",["lblQuickSearch"]);
      this.switchSearch = pas["WEBLib.Buttons"].TToggleButton.$create("Create$2",["switchLimitData"]);
      this.divButtons = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divButtons"]);
      this.divButtonHolder = pas["WEBLib.ExtCtrls"].TPanel.$create("Create$2",["divButtonHolder"]);
      this.btnBio = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBio"]);
      this.btnPhoto = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnPhoto"]);
      this.btnVideo = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnVideo"]);
      this.btnConnect = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnConnect"]);
      this.btnBackground = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBackground"]);
      this.btnSettings = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnSettings"]);
      this.btnAbout = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnAbout"]);
      this.btnDiscord = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnDiscord"]);
      this.divMain = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divMain"]);
      this.divMainHolder = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divMainHolder"]);
      this.divLogo = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divLogo"]);
      this.divBirthdayNav = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBirthdayNav"]);
      this.divBirthDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBirthDay"]);
      this.divPrevBirthDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPrevBirthDay"]);
      this.divNextBirthDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divNextBirthDay"]);
      this.divAttribution = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divAttribution"]);
      this.divDepartedNav = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divDepartedNav"]);
      this.divDeathDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divDeathDay"]);
      this.divPrevDeathDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPrevDeathDay"]);
      this.divNextDeathDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divNextDeathDay"]);
      this.divReleaseNav = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divReleaseNav"]);
      this.divReleaseDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divReleaseDay"]);
      this.divPrevReleaseDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPrevReleaseDay"]);
      this.divNextReleaseDay = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divNextReleaseDay"]);
      this.divTop100Nav = pas["WEBLib.ExtCtrls"].TPanel.$create("Create$2",["divTop100Nav"]);
      this.btnTop1000 = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnTop1000"]);
      this.divPeopleNav = pas["WEBLib.ExtCtrls"].TPanel.$create("Create$2",["divPeopleNav"]);
      this.btnActors = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnActors"]);
      this.btnDirectors = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnDirectors"]);
      this.btnWriters = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnWriters"]);
      this.divSearchNav = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divSearchNav"]);
      this.edtSearch = pas["WEBLib.StdCtrls"].TEdit.$create("Create$2",["edtSearch"]);
      this.btnSearch = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnSearch"]);
      this.divTopButtons = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divTopButtons"]);
      this.divLinkSet1 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divLinkSet1"]);
      this.WebHTMLDiv4 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv5 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.linkFavourite = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkFavourite"]);
      this.WebHTMLDiv7 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.linkLoading = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkLoading"]);
      this.linkLogin = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkLogin"]);
      this.WebHTMLDiv12 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv13 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.divLinkSet2 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divLinkSet2"]);
      this.linkList4 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkList4"]);
      this.linkList3 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkList3"]);
      this.linkList2 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkList2"]);
      this.linkTour = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkTour"]);
      this.linkLink = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkLink"]);
      this.linkList1 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkList1"]);
      this.linkEMail = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkEMail"]);
      this.linkRating = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkRating"]);
      this.divLinkSet4 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divLinkSet4"]);
      this.linkWikiData = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkWikiData"]);
      this.linkScore = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkScore"]);
      this.linkTMDb = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkTMDb"]);
      this.linkRottenTomatoes = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkRottenTomatoes"]);
      this.linkMetaCritic = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkMetaCritic"]);
      this.linkIMDb = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkIMDb"]);
      this.linkWeb = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkWeb"]);
      this.linkGoogleImageSearch = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkGoogleImageSearch"]);
      this.divLinkSet5 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divLinkSet5"]);
      this.linkTwitter = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkTwitter"]);
      this.linkInstagram = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkInstagram"]);
      this.linkFacebook = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkFacebook"]);
      this.linkModels = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkModels"]);
      this.linkWikipedia = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkWikipedia"]);
      this.linkHeight = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkHeight"]);
      this.linkCitizenship = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkCitizenship"]);
      this.linkShare = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkShare"]);
      this.divLinkSet3 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divLinkSet3"]);
      this.WebHTMLDiv3 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv6 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv8 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv9 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv10 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv11 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.WebHTMLDiv14 = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$1",[this]);
      this.linkPizza = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["linkPizza"]);
      this.divPhotoHolder = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPhotoHolder"]);
      this.divPhoto = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPhoto"]);
      this.divProgressSpinner = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divProgressSpinner"]);
      this.divPhotoBorder = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divPhotoBorder"]);
      this.divProgress = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divProgress"]);
      this.divBlock = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBlock"]);
      this.divViewerHolder = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divViewerHolder"]);
      this.divBlockControls = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBlockControls"]);
      this.btnBlockClose = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockClose"]);
      this.btnBlockZoomReset = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockZoomReset"]);
      this.btnBlockZoomPlus = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockZoomPlus"]);
      this.btnBlockZoomMinus = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockZoomMinus"]);
      this.btnBlockPrevious = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockPrevious"]);
      this.btnBlockNext = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockNext"]);
      this.divBlockData = pas["WEBLib.WebCtrls"].THTMLDiv.$create("Create$2",["divBlockData"]);
      this.btnBlockCount = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockCount"]);
      this.btnBlockLine = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockLine"]);
      this.btnBlockTotal = pas["WEBLib.StdCtrls"].TButton.$create("Create$2",["btnBlockTotal"]);
      this.tmrFocus = pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]);
      this.tmrStart = pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]);
      this.tmrSearch = pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]);
      this.tmrImageCheck = pas["WEBLib.ExtCtrls"].TTimer.$create("Create$1",[this]);
      this.WebHttpRequest1 = pas["WEBLib.REST"].THttpRequest.$create("Create$1",[this]);
      this.divBottom.BeforeLoadDFMValues();
      this.divActorTabulatorHolder.BeforeLoadDFMValues();
      this.divRoleTabulatorHolder.BeforeLoadDFMValues();
      this.divTop.BeforeLoadDFMValues();
      this.divInfo.BeforeLoadDFMValues();
      this.divInfoPages.BeforeLoadDFMValues();
      this.pageBio.BeforeLoadDFMValues();
      this.divBiography.BeforeLoadDFMValues();
      this.pageAbout.BeforeLoadDFMValues();
      this.divAbout.BeforeLoadDFMValues();
      this.pagePhotos.BeforeLoadDFMValues();
      this.divPhotoSlider.BeforeLoadDFMValues();
      this.pageVideos.BeforeLoadDFMValues();
      this.divVideoSlider.BeforeLoadDFMValues();
      this.pageBackgrounds.BeforeLoadDFMValues();
      this.divBackgroundSlider.BeforeLoadDFMValues();
      this.pageConnect.BeforeLoadDFMValues();
      this.btnRelatives.BeforeLoadDFMValues();
      this.pageDiscord.BeforeLoadDFMValues();
      this.lblSupport.BeforeLoadDFMValues();
      this.btnDiscordLaunch.BeforeLoadDFMValues();
      this.pageSettings.BeforeLoadDFMValues();
      this.divSettings.BeforeLoadDFMValues();
      this.divSettingsPersonRequests.BeforeLoadDFMValues();
      this.lblLimitData.BeforeLoadDFMValues();
      this.switchLimitData.BeforeLoadDFMValues();
      this.divSettingsTopRequests.BeforeLoadDFMValues();
      this.lblLimitDataTop.BeforeLoadDFMValues();
      this.switchLimitDataTop.BeforeLoadDFMValues();
      this.divSettingsSearch.BeforeLoadDFMValues();
      this.lblQuickSearch.BeforeLoadDFMValues();
      this.switchSearch.BeforeLoadDFMValues();
      this.divButtons.BeforeLoadDFMValues();
      this.divButtonHolder.BeforeLoadDFMValues();
      this.btnBio.BeforeLoadDFMValues();
      this.btnPhoto.BeforeLoadDFMValues();
      this.btnVideo.BeforeLoadDFMValues();
      this.btnConnect.BeforeLoadDFMValues();
      this.btnBackground.BeforeLoadDFMValues();
      this.btnSettings.BeforeLoadDFMValues();
      this.btnAbout.BeforeLoadDFMValues();
      this.btnDiscord.BeforeLoadDFMValues();
      this.divMain.BeforeLoadDFMValues();
      this.divMainHolder.BeforeLoadDFMValues();
      this.divLogo.BeforeLoadDFMValues();
      this.divBirthdayNav.BeforeLoadDFMValues();
      this.divBirthDay.BeforeLoadDFMValues();
      this.divPrevBirthDay.BeforeLoadDFMValues();
      this.divNextBirthDay.BeforeLoadDFMValues();
      this.divAttribution.BeforeLoadDFMValues();
      this.divDepartedNav.BeforeLoadDFMValues();
      this.divDeathDay.BeforeLoadDFMValues();
      this.divPrevDeathDay.BeforeLoadDFMValues();
      this.divNextDeathDay.BeforeLoadDFMValues();
      this.divReleaseNav.BeforeLoadDFMValues();
      this.divReleaseDay.BeforeLoadDFMValues();
      this.divPrevReleaseDay.BeforeLoadDFMValues();
      this.divNextReleaseDay.BeforeLoadDFMValues();
      this.divTop100Nav.BeforeLoadDFMValues();
      this.btnTop1000.BeforeLoadDFMValues();
      this.divPeopleNav.BeforeLoadDFMValues();
      this.btnActors.BeforeLoadDFMValues();
      this.btnDirectors.BeforeLoadDFMValues();
      this.btnWriters.BeforeLoadDFMValues();
      this.divSearchNav.BeforeLoadDFMValues();
      this.edtSearch.BeforeLoadDFMValues();
      this.btnSearch.BeforeLoadDFMValues();
      this.divTopButtons.BeforeLoadDFMValues();
      this.divLinkSet1.BeforeLoadDFMValues();
      this.WebHTMLDiv4.BeforeLoadDFMValues();
      this.WebHTMLDiv5.BeforeLoadDFMValues();
      this.linkFavourite.BeforeLoadDFMValues();
      this.WebHTMLDiv7.BeforeLoadDFMValues();
      this.linkLoading.BeforeLoadDFMValues();
      this.linkLogin.BeforeLoadDFMValues();
      this.WebHTMLDiv12.BeforeLoadDFMValues();
      this.WebHTMLDiv13.BeforeLoadDFMValues();
      this.divLinkSet2.BeforeLoadDFMValues();
      this.linkList4.BeforeLoadDFMValues();
      this.linkList3.BeforeLoadDFMValues();
      this.linkList2.BeforeLoadDFMValues();
      this.linkTour.BeforeLoadDFMValues();
      this.linkLink.BeforeLoadDFMValues();
      this.linkList1.BeforeLoadDFMValues();
      this.linkEMail.BeforeLoadDFMValues();
      this.linkRating.BeforeLoadDFMValues();
      this.divLinkSet4.BeforeLoadDFMValues();
      this.linkWikiData.BeforeLoadDFMValues();
      this.linkScore.BeforeLoadDFMValues();
      this.linkTMDb.BeforeLoadDFMValues();
      this.linkRottenTomatoes.BeforeLoadDFMValues();
      this.linkMetaCritic.BeforeLoadDFMValues();
      this.linkIMDb.BeforeLoadDFMValues();
      this.linkWeb.BeforeLoadDFMValues();
      this.linkGoogleImageSearch.BeforeLoadDFMValues();
      this.divLinkSet5.BeforeLoadDFMValues();
      this.linkTwitter.BeforeLoadDFMValues();
      this.linkInstagram.BeforeLoadDFMValues();
      this.linkFacebook.BeforeLoadDFMValues();
      this.linkModels.BeforeLoadDFMValues();
      this.linkWikipedia.BeforeLoadDFMValues();
      this.linkHeight.BeforeLoadDFMValues();
      this.linkCitizenship.BeforeLoadDFMValues();
      this.linkShare.BeforeLoadDFMValues();
      this.divLinkSet3.BeforeLoadDFMValues();
      this.WebHTMLDiv3.BeforeLoadDFMValues();
      this.WebHTMLDiv6.BeforeLoadDFMValues();
      this.WebHTMLDiv8.BeforeLoadDFMValues();
      this.WebHTMLDiv9.BeforeLoadDFMValues();
      this.WebHTMLDiv10.BeforeLoadDFMValues();
      this.WebHTMLDiv11.BeforeLoadDFMValues();
      this.WebHTMLDiv14.BeforeLoadDFMValues();
      this.linkPizza.BeforeLoadDFMValues();
      this.divPhotoHolder.BeforeLoadDFMValues();
      this.divPhoto.BeforeLoadDFMValues();
      this.divProgressSpinner.BeforeLoadDFMValues();
      this.divPhotoBorder.BeforeLoadDFMValues();
      this.divProgress.BeforeLoadDFMValues();
      this.divBlock.BeforeLoadDFMValues();
      this.divViewerHolder.BeforeLoadDFMValues();
      this.divBlockControls.BeforeLoadDFMValues();
      this.btnBlockClose.BeforeLoadDFMValues();
      this.btnBlockZoomReset.BeforeLoadDFMValues();
      this.btnBlockZoomPlus.BeforeLoadDFMValues();
      this.btnBlockZoomMinus.BeforeLoadDFMValues();
      this.btnBlockPrevious.BeforeLoadDFMValues();
      this.btnBlockNext.BeforeLoadDFMValues();
      this.divBlockData.BeforeLoadDFMValues();
      this.btnBlockCount.BeforeLoadDFMValues();
      this.btnBlockLine.BeforeLoadDFMValues();
      this.btnBlockTotal.BeforeLoadDFMValues();
      this.tmrFocus.BeforeLoadDFMValues();
      this.tmrStart.BeforeLoadDFMValues();
      this.tmrSearch.BeforeLoadDFMValues();
      this.tmrImageCheck.BeforeLoadDFMValues();
      this.WebHttpRequest1.BeforeLoadDFMValues();
      try {
        this.SetName("MainForm");
        this.SetWidth(1274);
        this.SetHeight(822);
        this.SetAlign(5);
        this.SetCaption("Actorious");
        this.SetColor(0);
        this.FCSSLibrary = 1;
        this.SetElementClassName("d-flex flex-column");
        this.SetElementFont(1);
        this.FFont.FCharset = 1;
        this.FFont.SetColor(65793);
        this.FFont.SetHeight(-15);
        this.FFont.SetName("Tahoma");
        this.FFont.SetStyle({});
        this.SetParentFont(false);
        this.SetShadow(false);
        this.FShowClose = false;
        this.SetEvent(this,"OnCreate","WebFormCreate");
        this.SetEvent(this,"OnKeyDown","WebFormKeyDown");
        this.SetEvent(this,"OnResize","WebFormResize");
        this.SetEvent(this,"OnShow","WebFormShow");
        this.divBottom.SetParentComponent(this);
        this.divBottom.SetName("divBottom");
        this.divBottom.SetLeft(0);
        this.divBottom.SetTop(281);
        this.divBottom.SetWidth(1266);
        this.divBottom.SetHeight(500);
        this.divBottom.FMargins.SetLeft(4);
        this.divBottom.FMargins.SetTop(1);
        this.divBottom.FMargins.SetRight(4);
        this.divBottom.FMargins.SetBottom(4);
        this.divBottom.SetElementClassName("order-1 d-flex flex-row ");
        this.divBottom.SetHeightStyle(2);
        this.divBottom.SetWidthStyle(0);
        this.divBottom.SetChildOrderEx(2);
        this.divBottom.SetElementPosition(1);
        this.divBottom.SetElementFont(1);
        this.divBottom.SetRole("");
        this.divActorTabulatorHolder.SetParentComponent(this.divBottom);
        this.divActorTabulatorHolder.SetName("divActorTabulatorHolder");
        this.divActorTabulatorHolder.SetLeft(-1);
        this.divActorTabulatorHolder.SetTop(-2);
        this.divActorTabulatorHolder.SetWidth(631);
        this.divActorTabulatorHolder.SetHeight(551);
        this.divActorTabulatorHolder.FMargins.SetLeft(0);
        this.divActorTabulatorHolder.FMargins.SetTop(0);
        this.divActorTabulatorHolder.FMargins.SetRight(2);
        this.divActorTabulatorHolder.FMargins.SetBottom(0);
        this.divActorTabulatorHolder.SetElementClassName("rounded border border-secondary Loading w-50 me-1");
        this.divActorTabulatorHolder.SetHeightStyle(2);
        this.divActorTabulatorHolder.SetWidthStyle(2);
        this.divActorTabulatorHolder.SetElementPosition(1);
        this.divActorTabulatorHolder.SetElementFont(1);
        this.divActorTabulatorHolder.FHTML.BeginUpdate();
        try {
          this.divActorTabulatorHolder.FHTML.Clear();
          this.divActorTabulatorHolder.FHTML.Add('<div id="divActorTabulator" class="rounded border-0" ></div>');
        } finally {
          this.divActorTabulatorHolder.FHTML.EndUpdate();
        };
        this.divActorTabulatorHolder.SetRole("");
        this.divRoleTabulatorHolder.SetParentComponent(this.divBottom);
        this.divRoleTabulatorHolder.SetName("divRoleTabulatorHolder");
        this.divRoleTabulatorHolder.SetLeft(634);
        this.divRoleTabulatorHolder.SetTop(-1);
        this.divRoleTabulatorHolder.SetWidth(631);
        this.divRoleTabulatorHolder.SetHeight(551);
        this.divRoleTabulatorHolder.FMargins.SetLeft(2);
        this.divRoleTabulatorHolder.FMargins.SetTop(0);
        this.divRoleTabulatorHolder.FMargins.SetRight(0);
        this.divRoleTabulatorHolder.FMargins.SetBottom(0);
        this.divRoleTabulatorHolder.SetElementClassName("rounded border border-secondary overflow-hidden Loading w-50");
        this.divRoleTabulatorHolder.SetHeightStyle(2);
        this.divRoleTabulatorHolder.SetWidthStyle(2);
        this.divRoleTabulatorHolder.SetChildOrderEx(2);
        this.divRoleTabulatorHolder.SetElementPosition(1);
        this.divRoleTabulatorHolder.SetElementFont(1);
        this.divRoleTabulatorHolder.FHTML.BeginUpdate();
        try {
          this.divRoleTabulatorHolder.FHTML.Clear();
          this.divRoleTabulatorHolder.FHTML.Add('<div id="divRoleTabulator" class="rounded border-0" style="height:100%; width:100%;"></div>');
        } finally {
          this.divRoleTabulatorHolder.FHTML.EndUpdate();
        };
        this.divRoleTabulatorHolder.SetRole("");
        this.divTop.SetParentComponent(this);
        this.divTop.SetName("divTop");
        this.divTop.SetLeft(0);
        this.divTop.SetTop(-3);
        this.divTop.SetWidth(1274);
        this.divTop.SetHeight(281);
        this.divTop.FMargins.SetLeft(4);
        this.divTop.FMargins.SetTop(4);
        this.divTop.FMargins.SetRight(4);
        this.divTop.FMargins.SetBottom(2);
        this.divTop.SetElementClassName("justify-content-center order-0 p-1 gap-1 d-flex flex-row flex-wrap ");
        this.divTop.SetHeightStyle(2);
        this.divTop.SetWidthStyle(0);
        this.divTop.SetElementPosition(1);
        this.divTop.SetElementFont(1);
        this.divTop.SetRole("");
        this.divInfo.SetParentComponent(this.divTop);
        this.divInfo.SetName("divInfo");
        this.divInfo.SetLeft(629);
        this.divInfo.SetTop(6);
        this.divInfo.SetWidth(579);
        this.divInfo.SetHeight(277);
        this.divInfo.FMargins.SetLeft(2);
        this.divInfo.FMargins.SetTop(0);
        this.divInfo.FMargins.SetRight(2);
        this.divInfo.FMargins.SetBottom(0);
        this.divInfo.SetElementClassName("flex-grow-1 gap-1 order-3 bg-none d-flex flex-column ");
        this.divInfo.SetChildOrderEx(2);
        this.divInfo.SetElementPosition(1);
        this.divInfo.SetElementFont(1);
        this.divInfo.SetRole("");
        this.divInfoPages.SetParentComponent(this.divInfo);
        this.divInfoPages.SetName("divInfoPages");
        this.divInfoPages.SetLeft(0);
        this.divInfoPages.SetTop(58);
        this.divInfoPages.SetWidth(500);
        this.divInfoPages.SetHeight(223);
        this.divInfoPages.FMargins.SetLeft(0);
        this.divInfoPages.FMargins.SetTop(1);
        this.divInfoPages.FMargins.SetRight(0);
        this.divInfoPages.FMargins.SetBottom(1);
        this.divInfoPages.SetElementClassName("order-1 w-100 bg-dark rounded border border-secondary");
        this.divInfoPages.SetChildOrderEx(4);
        this.divInfoPages.SetElementFont(1);
        this.divInfoPages.SetTabIndex(0);
        this.divInfoPages.SetShowTabs(false);
        this.divInfoPages.SetTabOrder(0);
        this.pageBio.SetParentComponent(this.divInfoPages);
        this.pageBio.SetName("pageBio");
        this.pageBio.SetAlignWithMargins(true);
        this.pageBio.SetLeft(0);
        this.pageBio.SetTop(20);
        this.pageBio.SetWidth(500);
        this.pageBio.SetHeight(203);
        this.pageBio.FMargins.SetLeft(0);
        this.pageBio.FMargins.SetTop(0);
        this.pageBio.FMargins.SetRight(0);
        this.pageBio.FMargins.SetBottom(0);
        this.pageBio.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageBio.SetAlign(5);
        this.pageBio.SetCaption("Bio");
        this.pageBio.SetChildOrderEx(2);
        this.pageBio.SetElementFont(1);
        this.pageBio.SetShowCaption(false);
        this.pageBio.SetTabVisible(false);
        this.divBiography.SetParentComponent(this.pageBio);
        this.divBiography.SetName("divBiography");
        this.divBiography.SetLeft(32);
        this.divBiography.SetTop(15);
        this.divBiography.SetWidth(483);
        this.divBiography.SetHeight(150);
        this.divBiography.FMargins.SetLeft(4);
        this.divBiography.FMargins.SetTop(4);
        this.divBiography.FMargins.SetRight(4);
        this.divBiography.FMargins.SetBottom(4);
        this.divBiography.SetElementClassName("text-white CustomScroll");
        this.divBiography.SetChildOrderEx(4);
        this.divBiography.SetElementFont(1);
        this.divBiography.SetRole("");
        this.pageAbout.SetParentComponent(this.divInfoPages);
        this.pageAbout.SetName("pageAbout");
        this.pageAbout.SetLeft(0);
        this.pageAbout.SetTop(20);
        this.pageAbout.SetWidth(500);
        this.pageAbout.SetHeight(203);
        this.pageAbout.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageAbout.SetCaption("About");
        this.pageAbout.SetChildOrderEx(1);
        this.pageAbout.SetElementFont(1);
        this.divAbout.SetParentComponent(this.pageAbout);
        this.divAbout.SetName("divAbout");
        this.divAbout.SetAlignWithMargins(true);
        this.divAbout.SetLeft(4);
        this.divAbout.SetTop(4);
        this.divAbout.SetWidth(492);
        this.divAbout.SetHeight(195);
        this.divAbout.FMargins.SetLeft(4);
        this.divAbout.FMargins.SetTop(4);
        this.divAbout.FMargins.SetRight(4);
        this.divAbout.FMargins.SetBottom(4);
        this.divAbout.SetElementClassName("text-white ");
        this.divAbout.SetAlign(5);
        this.divAbout.SetChildOrderEx(4);
        this.divAbout.SetElementFont(1);
        this.divAbout.FHTML.BeginUpdate();
        try {
          this.divAbout.FHTML.Clear();
          this.divAbout.FHTML.Add('<div class="w-100 h-100 ps-2 pe-2 pb-4 " style="white-space:normal; overflow-y:scroll; font-size:14px">');
          this.divAbout.FHTML.Add("<p><strong>About Actorious</strong></p>");
          this.divAbout.FHTML.Add("<p>This project was initially created by <a href=mailto:andrew@500foods.com>Andrew Simard</a> as a demo app, illustrating how to use <a ");
          this.divAbout.FHTML.Add('href="http://tabulator.info" ');
          this.divAbout.FHTML.Add('target="_blank">Tabulator</a> within a <a href="https://www.tmssoftware.com/" target=_blank>TMS WEB Core</a> project.  This was detailed in a series of ');
          this.divAbout.FHTML.Add('articles he wrote for the <a href="https://www.tmssoftware.com/blog" target=_blank>TMS Software Blog</a>, starting with <a ');
          this.divAbout.FHTML.Add('href="https://www.tmssoftware.com/site/blog.asp?post=948" target=_blank>Part 1</a> on June 13, 2022.</p>');
          this.divAbout.FHTML.Add("");
          this.divAbout.FHTML.Add("<br /><p><strong>Data Attribution</strong></p>");
          this.divAbout.FHTML.Add("<p>Birthday data comes from WikiData, but is not endorsed or certified by WikiData.");
          this.divAbout.FHTML.Add("The rest of the data comes from The Movie Database, using the TMDB API, but is not endorsed or certified by TMDB.</p>");
          this.divAbout.FHTML.Add("");
          this.divAbout.FHTML.Add("<br /><p><strong>Application Design</strong></p>");
          this.divAbout.FHTML.Add("<p>The following commercial and open source products, libraries, and other resources were used in creating this web application. More information about this ");
          this.divAbout.FHTML.Add('project can be found on <a href="https://github.com/500Foods/TMS-WEB-Core-ActorInfo" target=_blank">GitHub</a>.</p>');
          this.divAbout.FHTML.Add("<br />Embarcadero - Delkphi 10.3");
          this.divAbout.FHTML.Add("<br />TMS Software - TMS WEB Core");
          this.divAbout.FHTML.Add("<br />Tabulator");
          this.divAbout.FHTML.Add("<br />Luxon");
          this.divAbout.FHTML.Add("<br />FlatPickr");
          this.divAbout.FHTML.Add("<br />Bootstrap");
          this.divAbout.FHTML.Add("<br />FontAwesome");
          this.divAbout.FHTML.Add("<br />Google Fonts");
          this.divAbout.FHTML.Add("</div>");
        } finally {
          this.divAbout.FHTML.EndUpdate();
        };
        this.divAbout.SetRole("");
        this.pagePhotos.SetParentComponent(this.divInfoPages);
        this.pagePhotos.SetName("pagePhotos");
        this.pagePhotos.SetLeft(0);
        this.pagePhotos.SetTop(20);
        this.pagePhotos.SetWidth(500);
        this.pagePhotos.SetHeight(203);
        this.pagePhotos.SetElementClassName("bg-dark rounded border border-secondary");
        this.pagePhotos.SetCaption("Photos");
        this.pagePhotos.SetChildOrderEx(2);
        this.pagePhotos.SetElementFont(1);
        this.divPhotoSlider.SetParentComponent(this.pagePhotos);
        this.divPhotoSlider.SetName("divPhotoSlider");
        this.divPhotoSlider.SetLeft(0);
        this.divPhotoSlider.SetTop(0);
        this.divPhotoSlider.SetWidth(500);
        this.divPhotoSlider.SetHeight(203);
        this.divPhotoSlider.SetAlign(5);
        this.divPhotoSlider.SetElementFont(1);
        this.divPhotoSlider.FHTML.BeginUpdate();
        try {
          this.divPhotoSlider.FHTML.Clear();
          this.divPhotoSlider.FHTML.Add('<div style="display:flex; flex-direction:column; height:100%; width:100%; overflow:hidden; padding-top:3px; padding-bottom:3px;">  ');
          this.divPhotoSlider.FHTML.Add('  <div class="swiper" style="width:100%; height: 100%;">  ');
          this.divPhotoSlider.FHTML.Add('    <div class="swiper-wrapper"> </div>  ');
          this.divPhotoSlider.FHTML.Add("  </div>  ");
          this.divPhotoSlider.FHTML.Add("</div>  ");
        } finally {
          this.divPhotoSlider.FHTML.EndUpdate();
        };
        this.divPhotoSlider.SetRole("");
        this.pageVideos.SetParentComponent(this.divInfoPages);
        this.pageVideos.SetName("pageVideos");
        this.pageVideos.SetLeft(0);
        this.pageVideos.SetTop(20);
        this.pageVideos.SetWidth(500);
        this.pageVideos.SetHeight(203);
        this.pageVideos.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageVideos.SetCaption("Videos");
        this.pageVideos.SetChildOrderEx(3);
        this.pageVideos.SetElementFont(1);
        this.divVideoSlider.SetParentComponent(this.pageVideos);
        this.divVideoSlider.SetName("divVideoSlider");
        this.divVideoSlider.SetLeft(0);
        this.divVideoSlider.SetTop(0);
        this.divVideoSlider.SetWidth(500);
        this.divVideoSlider.SetHeight(203);
        this.divVideoSlider.SetAlign(5);
        this.divVideoSlider.SetElementFont(1);
        this.divVideoSlider.FHTML.BeginUpdate();
        try {
          this.divVideoSlider.FHTML.Clear();
          this.divVideoSlider.FHTML.Add('<div style="display:flex; flex-direction:column; height:100%; width:100%; overflow:hidden; padding-top:3px; padding-bottom:3px;">  ');
          this.divVideoSlider.FHTML.Add('  <div class="swiper2" style="width:100%; height: 100%;">  ');
          this.divVideoSlider.FHTML.Add('    <div class="swiper-wrapper"> </div>  ');
          this.divVideoSlider.FHTML.Add("  </div>  ");
          this.divVideoSlider.FHTML.Add("</div>  ");
        } finally {
          this.divVideoSlider.FHTML.EndUpdate();
        };
        this.divVideoSlider.SetRole("");
        this.pageBackgrounds.SetParentComponent(this.divInfoPages);
        this.pageBackgrounds.SetName("pageBackgrounds");
        this.pageBackgrounds.SetLeft(0);
        this.pageBackgrounds.SetTop(20);
        this.pageBackgrounds.SetWidth(500);
        this.pageBackgrounds.SetHeight(203);
        this.pageBackgrounds.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageBackgrounds.SetCaption("BG");
        this.pageBackgrounds.SetChildOrderEx(4);
        this.pageBackgrounds.SetElementFont(1);
        this.divBackgroundSlider.SetParentComponent(this.pageBackgrounds);
        this.divBackgroundSlider.SetName("divBackgroundSlider");
        this.divBackgroundSlider.SetLeft(0);
        this.divBackgroundSlider.SetTop(0);
        this.divBackgroundSlider.SetWidth(500);
        this.divBackgroundSlider.SetHeight(203);
        this.divBackgroundSlider.SetAlign(5);
        this.divBackgroundSlider.SetElementFont(1);
        this.divBackgroundSlider.FHTML.BeginUpdate();
        try {
          this.divBackgroundSlider.FHTML.Clear();
          this.divBackgroundSlider.FHTML.Add('<div style="display:flex; flex-direction:column; height:100%; width:100%; overflow:hidden; padding-top:3px; padding-bottom:3px;">  ');
          this.divBackgroundSlider.FHTML.Add('  <div class="swiper3" style="width:100%; height: 100%;">  ');
          this.divBackgroundSlider.FHTML.Add('    <div class="swiper-wrapper"> </div>  ');
          this.divBackgroundSlider.FHTML.Add("  </div>  ");
          this.divBackgroundSlider.FHTML.Add("</div>  ");
        } finally {
          this.divBackgroundSlider.FHTML.EndUpdate();
        };
        this.divBackgroundSlider.SetRole("");
        this.pageConnect.SetParentComponent(this.divInfoPages);
        this.pageConnect.SetName("pageConnect");
        this.pageConnect.SetLeft(0);
        this.pageConnect.SetTop(20);
        this.pageConnect.SetWidth(500);
        this.pageConnect.SetHeight(203);
        this.pageConnect.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageConnect.SetCaption("Connect");
        this.pageConnect.SetChildOrderEx(5);
        this.pageConnect.SetElementFont(1);
        this.btnRelatives.SetParentComponent(this.pageConnect);
        this.btnRelatives.SetName("btnRelatives");
        this.btnRelatives.SetLeft(5);
        this.btnRelatives.SetTop(5);
        this.btnRelatives.SetWidth(96);
        this.btnRelatives.SetHeight(32);
        this.btnRelatives.SetCaption("Find Relatives");
        this.btnRelatives.SetElementClassName("btn btn-sm btn-primary");
        this.btnRelatives.SetElementFont(1);
        this.btnRelatives.SetHeightPercent(100.000000000000000000);
        this.btnRelatives.SetWidthStyle(2);
        this.btnRelatives.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnRelatives,this,"OnClick","btnRelativesClick");
        this.pageDiscord.SetParentComponent(this.divInfoPages);
        this.pageDiscord.SetName("pageDiscord");
        this.pageDiscord.SetLeft(0);
        this.pageDiscord.SetTop(20);
        this.pageDiscord.SetWidth(500);
        this.pageDiscord.SetHeight(203);
        this.pageDiscord.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageDiscord.SetCaption("Discord");
        this.pageDiscord.SetChildOrderEx(7);
        this.pageDiscord.SetElementFont(1);
        this.lblSupport.SetParentComponent(this.pageDiscord);
        this.lblSupport.SetName("lblSupport");
        this.lblSupport.SetLeft(6);
        this.lblSupport.SetTop(40);
        this.lblSupport.SetWidth(494);
        this.lblSupport.SetHeight(160);
        this.lblSupport.SetAnchors(rtl.createSet(0,1,2,3));
        this.lblSupport.SetAutoSize(false);
        this.lblSupport.SetCaption("Support and discussions about Actorious are managed through Discord, a free service.");
        this.lblSupport.SetElementLabelClassName("text-white");
        this.lblSupport.SetElementFont(1);
        this.lblSupport.SetHeightStyle(2);
        this.lblSupport.SetHeightPercent(100.000000000000000000);
        this.lblSupport.FWordWrap = true;
        this.lblSupport.SetWidthStyle(0);
        this.lblSupport.SetWidthPercent(100.000000000000000000);
        this.btnDiscordLaunch.SetParentComponent(this.pageDiscord);
        this.btnDiscordLaunch.SetName("btnDiscordLaunch");
        this.btnDiscordLaunch.SetLeft(4);
        this.btnDiscordLaunch.SetTop(4);
        this.btnDiscordLaunch.SetWidth(141);
        this.btnDiscordLaunch.SetHeight(35);
        this.btnDiscordLaunch.SetCaption('<i class="fa-brands fa-discord fa-lg"> </i> Launch Discord');
        this.btnDiscordLaunch.SetElementClassName("btn btn-sm btn-primary");
        this.btnDiscordLaunch.SetElementFont(1);
        this.btnDiscordLaunch.SetHeightStyle(2);
        this.btnDiscordLaunch.SetHeightPercent(100.000000000000000000);
        this.btnDiscordLaunch.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnDiscordLaunch,this,"OnClick","btnDiscordLaunchClick");
        this.pageSettings.SetParentComponent(this.divInfoPages);
        this.pageSettings.SetName("pageSettings");
        this.pageSettings.SetLeft(0);
        this.pageSettings.SetTop(20);
        this.pageSettings.SetWidth(500);
        this.pageSettings.SetHeight(203);
        this.pageSettings.SetElementClassName("bg-dark rounded border border-secondary");
        this.pageSettings.SetCaption("Settings");
        this.pageSettings.SetChildOrderEx(6);
        this.pageSettings.SetElementFont(1);
        this.divSettings.SetParentComponent(this.pageSettings);
        this.divSettings.SetName("divSettings");
        this.divSettings.SetLeft(0);
        this.divSettings.SetTop(0);
        this.divSettings.SetWidth(500);
        this.divSettings.SetHeight(203);
        this.divSettings.SetElementClassName("bg-none border border-0 d-flex flex-column");
        this.divSettings.SetAlign(5);
        this.divSettings.SetChildOrderEx(2);
        this.divSettings.SetElementFont(1);
        this.divSettings.SetRole("");
        this.divSettingsPersonRequests.SetParentComponent(this.divSettings);
        this.divSettingsPersonRequests.SetName("divSettingsPersonRequests");
        this.divSettingsPersonRequests.SetLeft(0);
        this.divSettingsPersonRequests.SetTop(30);
        this.divSettingsPersonRequests.SetWidth(500);
        this.divSettingsPersonRequests.SetHeight(30);
        this.divSettingsPersonRequests.SetElementClassName("order-0 ms-1 mt-1 d-flex order-1");
        this.divSettingsPersonRequests.SetHeightStyle(2);
        this.divSettingsPersonRequests.SetWidthStyle(2);
        this.divSettingsPersonRequests.SetAlign(1);
        this.divSettingsPersonRequests.SetChildOrderEx(2);
        this.divSettingsPersonRequests.SetElementPosition(1);
        this.divSettingsPersonRequests.SetElementFont(1);
        this.divSettingsPersonRequests.SetRole("");
        this.SetEvent$1(this.divSettingsPersonRequests,this,"OnClick","switchLimitDataClick");
        this.lblLimitData.SetParentComponent(this.divSettingsPersonRequests);
        this.lblLimitData.SetName("lblLimitData");
        this.lblLimitData.SetAlignWithMargins(true);
        this.lblLimitData.SetLeft(58);
        this.lblLimitData.SetTop(2);
        this.lblLimitData.SetWidth(438);
        this.lblLimitData.SetHeight(24);
        this.lblLimitData.SetControlCursor(21);
        this.lblLimitData.FMargins.SetLeft(4);
        this.lblLimitData.FMargins.SetTop(2);
        this.lblLimitData.FMargins.SetRight(4);
        this.lblLimitData.FMargins.SetBottom(4);
        this.lblLimitData.SetAlign(5);
        this.lblLimitData.SetAutoSize(false);
        this.lblLimitData.SetCaption("Limit Person Requests to 50 Records");
        this.lblLimitData.SetElementClassName("text-light ms-2");
        this.lblLimitData.SetElementLabelClassName("text-white");
        this.lblLimitData.SetElementFont(1);
        this.lblLimitData.SetElementPosition(1);
        this.lblLimitData.SetHeightStyle(2);
        this.lblLimitData.SetHeightPercent(100.000000000000000000);
        this.lblLimitData.FWordWrap = true;
        this.lblLimitData.SetWidthStyle(2);
        this.lblLimitData.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.lblLimitData,this,"OnClick","lblLimitDataClick");
        this.switchLimitData.SetParentComponent(this.divSettingsPersonRequests);
        this.switchLimitData.SetName("switchLimitData");
        this.switchLimitData.SetAlignWithMargins(true);
        this.switchLimitData.SetLeft(5);
        this.switchLimitData.SetTop(5);
        this.switchLimitData.SetWidth(44);
        this.switchLimitData.SetHeight(22);
        this.switchLimitData.FMargins.SetLeft(5);
        this.switchLimitData.FMargins.SetTop(5);
        this.switchLimitData.FMargins.SetRight(5);
        this.switchLimitData.FMargins.SetBottom(2);
        this.switchLimitData.SetAlign(3);
        this.switchLimitData.SetChecked(true);
        this.switchLimitData.SetElementClassName("grow-0 shrink--0");
        this.switchLimitData.SetElementPosition(1);
        this.SetEvent$1(this.switchLimitData,this,"OnClick","switchLimitDataClick");
        this.divSettingsTopRequests.SetParentComponent(this.divSettings);
        this.divSettingsTopRequests.SetName("divSettingsTopRequests");
        this.divSettingsTopRequests.SetLeft(0);
        this.divSettingsTopRequests.SetTop(0);
        this.divSettingsTopRequests.SetWidth(500);
        this.divSettingsTopRequests.SetHeight(30);
        this.divSettingsTopRequests.SetElementClassName("order-1 ms-1 mt-1 d-flex");
        this.divSettingsTopRequests.SetHeightStyle(2);
        this.divSettingsTopRequests.SetWidthStyle(2);
        this.divSettingsTopRequests.SetAlign(1);
        this.divSettingsTopRequests.SetChildOrderEx(2);
        this.divSettingsTopRequests.SetElementPosition(1);
        this.divSettingsTopRequests.SetElementFont(1);
        this.divSettingsTopRequests.SetRole("");
        this.SetEvent$1(this.divSettingsTopRequests,this,"OnClick","switchLimitDataTopClick");
        this.lblLimitDataTop.SetParentComponent(this.divSettingsTopRequests);
        this.lblLimitDataTop.SetName("lblLimitDataTop");
        this.lblLimitDataTop.SetAlignWithMargins(true);
        this.lblLimitDataTop.SetLeft(58);
        this.lblLimitDataTop.SetTop(2);
        this.lblLimitDataTop.SetWidth(438);
        this.lblLimitDataTop.SetHeight(24);
        this.lblLimitDataTop.SetControlCursor(21);
        this.lblLimitDataTop.FMargins.SetLeft(4);
        this.lblLimitDataTop.FMargins.SetTop(2);
        this.lblLimitDataTop.FMargins.SetRight(4);
        this.lblLimitDataTop.FMargins.SetBottom(4);
        this.lblLimitDataTop.SetAlign(5);
        this.lblLimitDataTop.SetAutoSize(false);
        this.lblLimitDataTop.SetCaption("Limit Top Requests to 1,000 Records");
        this.lblLimitDataTop.SetElementClassName("text-light ms-2");
        this.lblLimitDataTop.SetElementLabelClassName("text-white");
        this.lblLimitDataTop.SetElementFont(1);
        this.lblLimitDataTop.SetElementPosition(1);
        this.lblLimitDataTop.SetHeightStyle(2);
        this.lblLimitDataTop.SetHeightPercent(100.000000000000000000);
        this.lblLimitDataTop.FWordWrap = true;
        this.lblLimitDataTop.SetWidthStyle(2);
        this.lblLimitDataTop.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.lblLimitDataTop,this,"OnClick","lblLimitDataTopClick");
        this.switchLimitDataTop.SetParentComponent(this.divSettingsTopRequests);
        this.switchLimitDataTop.SetName("switchLimitDataTop");
        this.switchLimitDataTop.SetAlignWithMargins(true);
        this.switchLimitDataTop.SetLeft(5);
        this.switchLimitDataTop.SetTop(5);
        this.switchLimitDataTop.SetWidth(44);
        this.switchLimitDataTop.SetHeight(22);
        this.switchLimitDataTop.FMargins.SetLeft(5);
        this.switchLimitDataTop.FMargins.SetTop(5);
        this.switchLimitDataTop.FMargins.SetRight(5);
        this.switchLimitDataTop.FMargins.SetBottom(2);
        this.switchLimitDataTop.SetAlign(3);
        this.switchLimitDataTop.SetChecked(true);
        this.switchLimitDataTop.SetElementClassName("grow-0 shrink-0");
        this.switchLimitDataTop.SetElementPosition(1);
        this.SetEvent$1(this.switchLimitDataTop,this,"OnClick","switchLimitDataTopClick");
        this.divSettingsSearch.SetParentComponent(this.divSettings);
        this.divSettingsSearch.SetName("divSettingsSearch");
        this.divSettingsSearch.SetLeft(0);
        this.divSettingsSearch.SetTop(60);
        this.divSettingsSearch.SetWidth(500);
        this.divSettingsSearch.SetHeight(30);
        this.divSettingsSearch.SetElementClassName("order-2 ms-1 mt-1 d-flex");
        this.divSettingsSearch.SetHeightStyle(2);
        this.divSettingsSearch.SetWidthStyle(2);
        this.divSettingsSearch.SetAlign(1);
        this.divSettingsSearch.SetChildOrderEx(2);
        this.divSettingsSearch.SetElementPosition(1);
        this.divSettingsSearch.SetElementFont(1);
        this.divSettingsSearch.SetRole("");
        this.SetEvent$1(this.divSettingsSearch,this,"OnClick","switchSearchClick");
        this.lblQuickSearch.SetParentComponent(this.divSettingsSearch);
        this.lblQuickSearch.SetName("lblQuickSearch");
        this.lblQuickSearch.SetAlignWithMargins(true);
        this.lblQuickSearch.SetLeft(58);
        this.lblQuickSearch.SetTop(2);
        this.lblQuickSearch.SetWidth(438);
        this.lblQuickSearch.SetHeight(24);
        this.lblQuickSearch.SetControlCursor(21);
        this.lblQuickSearch.FMargins.SetLeft(4);
        this.lblQuickSearch.FMargins.SetTop(2);
        this.lblQuickSearch.FMargins.SetRight(4);
        this.lblQuickSearch.FMargins.SetBottom(4);
        this.lblQuickSearch.SetAlign(5);
        this.lblQuickSearch.SetAutoSize(false);
        this.lblQuickSearch.SetCaption("Limit Quick Search to 20 Results");
        this.lblQuickSearch.SetElementClassName("text-light ms-2");
        this.lblQuickSearch.SetElementLabelClassName("text-white");
        this.lblQuickSearch.SetElementFont(1);
        this.lblQuickSearch.SetElementPosition(1);
        this.lblQuickSearch.SetHeightStyle(2);
        this.lblQuickSearch.SetHeightPercent(100.000000000000000000);
        this.lblQuickSearch.FWordWrap = true;
        this.lblQuickSearch.SetWidthStyle(2);
        this.lblQuickSearch.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.lblQuickSearch,this,"OnClick","lblQuickSearchClick");
        this.switchSearch.SetParentComponent(this.divSettingsSearch);
        this.switchSearch.SetName("switchSearch");
        this.switchSearch.SetAlignWithMargins(true);
        this.switchSearch.SetLeft(5);
        this.switchSearch.SetTop(5);
        this.switchSearch.SetWidth(44);
        this.switchSearch.SetHeight(22);
        this.switchSearch.FMargins.SetLeft(5);
        this.switchSearch.FMargins.SetTop(5);
        this.switchSearch.FMargins.SetRight(5);
        this.switchSearch.FMargins.SetBottom(2);
        this.switchSearch.SetAlign(3);
        this.switchSearch.SetChecked(true);
        this.switchSearch.SetElementClassName("grow-0 shrink--0");
        this.switchSearch.SetElementPosition(1);
        this.SetEvent$1(this.switchSearch,this,"OnClick","switchSearchClick");
        this.divButtons.SetParentComponent(this.divInfo);
        this.divButtons.SetName("divButtons");
        this.divButtons.SetAlignWithMargins(true);
        this.divButtons.SetLeft(0);
        this.divButtons.SetTop(0);
        this.divButtons.SetWidth(579);
        this.divButtons.SetHeight(31);
        this.divButtons.FMargins.SetLeft(0);
        this.divButtons.FMargins.SetTop(0);
        this.divButtons.FMargins.SetRight(0);
        this.divButtons.FMargins.SetBottom(2);
        this.divButtons.SetElementClassName("order-0 w-100 rounded bg-dark border border-0");
        this.divButtons.SetAlign(1);
        this.divButtons.SetChildOrderEx(5);
        this.divButtons.SetElementPosition(1);
        this.divButtons.SetElementFont(1);
        this.divButtons.SetRole("");
        this.divButtonHolder.SetParentComponent(this.divButtons);
        this.divButtonHolder.SetName("divButtonHolder");
        this.divButtonHolder.SetLeft(0);
        this.divButtonHolder.SetTop(0);
        this.divButtonHolder.SetWidth(579);
        this.divButtonHolder.SetHeight(31);
        this.divButtonHolder.SetElementClassName("bg-none rounded w-100 overflow-hidden");
        this.divButtonHolder.SetAlignment(0);
        this.divButtonHolder.SetChildOrderEx(2);
        this.divButtonHolder.FElementBodyClassName = "w-100 btn-group btn-group-sm align-items-stretch d-flex";
        this.divButtonHolder.SetElementFont(1);
        this.btnBio.SetParentComponent(this.divButtonHolder);
        this.btnBio.SetName("btnBio");
        this.btnBio.SetLeft(0);
        this.btnBio.SetTop(0);
        this.btnBio.SetWidth(50);
        this.btnBio.SetHeight(31);
        this.btnBio.SetHint("Biography");
        this.btnBio.FMargins.SetLeft(0);
        this.btnBio.FMargins.SetTop(0);
        this.btnBio.FMargins.SetRight(0);
        this.btnBio.FMargins.SetBottom(0);
        this.btnBio.SetAlign(3);
        this.btnBio.SetElementClassName("btn btn-sm btn-secondary px-1");
        this.btnBio.SetElementFont(1);
        this.btnBio.SetElementPosition(1);
        this.btnBio.SetHeightPercent(100.000000000000000000);
        this.btnBio.SetTabOrder(1);
        this.btnBio.SetTabStop(false);
        this.btnBio.SetWidthStyle(2);
        this.btnBio.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBio,this,"OnClick","btnBioClick");
        this.btnPhoto.SetParentComponent(this.divButtonHolder);
        this.btnPhoto.SetName("btnPhoto");
        this.btnPhoto.SetLeft(50);
        this.btnPhoto.SetTop(0);
        this.btnPhoto.SetWidth(50);
        this.btnPhoto.SetHeight(31);
        this.btnPhoto.SetHint("Photos");
        this.btnPhoto.FMargins.SetLeft(0);
        this.btnPhoto.FMargins.SetTop(0);
        this.btnPhoto.FMargins.SetRight(0);
        this.btnPhoto.FMargins.SetBottom(0);
        this.btnPhoto.SetAlign(3);
        this.btnPhoto.SetChildOrderEx(1);
        this.btnPhoto.SetElementClassName("btn btn-sm btn-secondary px-1");
        this.btnPhoto.SetElementFont(1);
        this.btnPhoto.SetElementPosition(1);
        this.btnPhoto.SetHeightPercent(100.000000000000000000);
        this.btnPhoto.SetTabStop(false);
        this.btnPhoto.SetWidthStyle(2);
        this.btnPhoto.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnPhoto,this,"OnClick","btnPhotoClick");
        this.btnVideo.SetParentComponent(this.divButtonHolder);
        this.btnVideo.SetName("btnVideo");
        this.btnVideo.SetLeft(100);
        this.btnVideo.SetTop(0);
        this.btnVideo.SetWidth(50);
        this.btnVideo.SetHeight(31);
        this.btnVideo.SetHint("Videos");
        this.btnVideo.FMargins.SetLeft(0);
        this.btnVideo.FMargins.SetTop(0);
        this.btnVideo.FMargins.SetRight(0);
        this.btnVideo.FMargins.SetBottom(0);
        this.btnVideo.SetAlign(3);
        this.btnVideo.SetChildOrderEx(2);
        this.btnVideo.SetElementClassName("btn btn-sm btn-secondary px-1 d-none");
        this.btnVideo.SetElementFont(1);
        this.btnVideo.SetElementPosition(1);
        this.btnVideo.SetHeightPercent(100.000000000000000000);
        this.btnVideo.SetTabOrder(2);
        this.btnVideo.SetTabStop(false);
        this.btnVideo.SetWidthStyle(2);
        this.btnVideo.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnVideo,this,"OnClick","btnVideoClick");
        this.btnConnect.SetParentComponent(this.divButtonHolder);
        this.btnConnect.SetName("btnConnect");
        this.btnConnect.SetLeft(200);
        this.btnConnect.SetTop(0);
        this.btnConnect.SetWidth(50);
        this.btnConnect.SetHeight(31);
        this.btnConnect.SetHint("Connections");
        this.btnConnect.FMargins.SetLeft(0);
        this.btnConnect.FMargins.SetTop(0);
        this.btnConnect.FMargins.SetRight(0);
        this.btnConnect.FMargins.SetBottom(0);
        this.btnConnect.SetAlign(3);
        this.btnConnect.SetChildOrderEx(4);
        this.btnConnect.SetElementClassName("btn btn-sm btn-secondary px-1");
        this.btnConnect.SetElementFont(1);
        this.btnConnect.SetElementPosition(1);
        this.btnConnect.SetHeightPercent(100.000000000000000000);
        this.btnConnect.SetTabOrder(3);
        this.btnConnect.SetTabStop(false);
        this.btnConnect.SetWidthStyle(2);
        this.btnConnect.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnConnect,this,"OnClick","btnConnectClick");
        this.btnBackground.SetParentComponent(this.divButtonHolder);
        this.btnBackground.SetName("btnBackground");
        this.btnBackground.SetLeft(150);
        this.btnBackground.SetTop(0);
        this.btnBackground.SetWidth(50);
        this.btnBackground.SetHeight(31);
        this.btnBackground.SetHint("Backgrounds");
        this.btnBackground.FMargins.SetLeft(0);
        this.btnBackground.FMargins.SetTop(0);
        this.btnBackground.FMargins.SetRight(0);
        this.btnBackground.FMargins.SetBottom(0);
        this.btnBackground.SetAlign(3);
        this.btnBackground.SetChildOrderEx(3);
        this.btnBackground.SetElementClassName("btn btn-sm btn-secondary px-1 d-none");
        this.btnBackground.SetElementFont(1);
        this.btnBackground.SetElementPosition(1);
        this.btnBackground.SetHeightPercent(100.000000000000000000);
        this.btnBackground.SetTabOrder(4);
        this.btnBackground.SetTabStop(false);
        this.btnBackground.SetWidthStyle(2);
        this.btnBackground.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBackground,this,"OnClick","btnBackgroundClick");
        this.btnSettings.SetParentComponent(this.divButtonHolder);
        this.btnSettings.SetName("btnSettings");
        this.btnSettings.SetLeft(250);
        this.btnSettings.SetTop(0);
        this.btnSettings.SetWidth(50);
        this.btnSettings.SetHeight(31);
        this.btnSettings.SetHint("Settings");
        this.btnSettings.FMargins.SetLeft(0);
        this.btnSettings.FMargins.SetTop(0);
        this.btnSettings.FMargins.SetRight(0);
        this.btnSettings.FMargins.SetBottom(0);
        this.btnSettings.SetAlign(3);
        this.btnSettings.SetChildOrderEx(5);
        this.btnSettings.SetElementClassName("btn btn-sm btn-secondary px-1");
        this.btnSettings.SetElementFont(1);
        this.btnSettings.SetElementPosition(1);
        this.btnSettings.SetHeightPercent(100.000000000000000000);
        this.btnSettings.SetTabOrder(5);
        this.btnSettings.SetTabStop(false);
        this.btnSettings.SetWidthStyle(2);
        this.btnSettings.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnSettings,this,"OnClick","btnSettingsClick");
        this.btnAbout.SetParentComponent(this.divButtonHolder);
        this.btnAbout.SetName("btnAbout");
        this.btnAbout.SetLeft(350);
        this.btnAbout.SetTop(0);
        this.btnAbout.SetWidth(50);
        this.btnAbout.SetHeight(31);
        this.btnAbout.SetHint("About Actorious");
        this.btnAbout.FMargins.SetLeft(0);
        this.btnAbout.FMargins.SetTop(0);
        this.btnAbout.FMargins.SetRight(0);
        this.btnAbout.FMargins.SetBottom(0);
        this.btnAbout.SetAlign(3);
        this.btnAbout.SetChildOrderEx(6);
        this.btnAbout.SetElementClassName("btn btn-sm btn-secondary px-0");
        this.btnAbout.SetElementFont(1);
        this.btnAbout.SetElementPosition(1);
        this.btnAbout.SetHeightPercent(100.000000000000000000);
        this.btnAbout.SetTabOrder(6);
        this.btnAbout.SetTabStop(false);
        this.btnAbout.SetWidthStyle(2);
        this.btnAbout.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnAbout,this,"OnClick","btnAboutClick");
        this.btnDiscord.SetParentComponent(this.divButtonHolder);
        this.btnDiscord.SetName("btnDiscord");
        this.btnDiscord.SetLeft(300);
        this.btnDiscord.SetTop(0);
        this.btnDiscord.SetWidth(50);
        this.btnDiscord.SetHeight(31);
        this.btnDiscord.SetHint("Support via Discord");
        this.btnDiscord.FMargins.SetLeft(0);
        this.btnDiscord.FMargins.SetTop(0);
        this.btnDiscord.FMargins.SetRight(0);
        this.btnDiscord.FMargins.SetBottom(0);
        this.btnDiscord.SetAlign(3);
        this.btnDiscord.SetChildOrderEx(6);
        this.btnDiscord.SetElementClassName("btn btn-sm btn-secondary px-1");
        this.btnDiscord.SetElementFont(1);
        this.btnDiscord.SetElementPosition(1);
        this.btnDiscord.SetHeightStyle(2);
        this.btnDiscord.SetHeightPercent(100.000000000000000000);
        this.btnDiscord.SetTabOrder(7);
        this.btnDiscord.SetTabStop(false);
        this.btnDiscord.SetWidthStyle(2);
        this.btnDiscord.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnDiscord,this,"OnClick","btnDiscordClick");
        this.divMain.SetParentComponent(this.divTop);
        this.divMain.SetName("divMain");
        this.divMain.SetLeft(0);
        this.divMain.SetTop(0);
        this.divMain.SetWidth(213);
        this.divMain.SetHeight(277);
        this.divMain.FMargins.SetLeft(0);
        this.divMain.FMargins.SetTop(0);
        this.divMain.FMargins.SetRight(1);
        this.divMain.FMargins.SetBottom(0);
        this.divMain.SetElementClassName("bg-none");
        this.divMain.SetElementPosition(1);
        this.divMain.SetElementFont(1);
        this.divMain.SetRole("");
        this.divMainHolder.SetParentComponent(this.divMain);
        this.divMainHolder.SetName("divMainHolder");
        this.divMainHolder.SetAlignWithMargins(true);
        this.divMainHolder.SetLeft(0);
        this.divMainHolder.SetTop(0);
        this.divMainHolder.SetWidth(213);
        this.divMainHolder.SetHeight(277);
        this.divMainHolder.FMargins.SetLeft(0);
        this.divMainHolder.FMargins.SetTop(0);
        this.divMainHolder.FMargins.SetRight(0);
        this.divMainHolder.FMargins.SetBottom(0);
        this.divMainHolder.SetElementClassName("bg-dark border  border-secondary rounded");
        this.divMainHolder.SetAlign(5);
        this.divMainHolder.SetChildOrderEx(2);
        this.divMainHolder.SetElementFont(1);
        this.divMainHolder.SetRole("");
        this.divLogo.SetParentComponent(this.divMainHolder);
        this.divLogo.SetName("divLogo");
        this.divLogo.SetAlignWithMargins(true);
        this.divLogo.SetLeft(0);
        this.divLogo.SetTop(2);
        this.divLogo.SetWidth(213);
        this.divLogo.SetHeight(32);
        this.divLogo.FMargins.SetLeft(0);
        this.divLogo.FMargins.SetTop(2);
        this.divLogo.FMargins.SetRight(0);
        this.divLogo.FMargins.SetBottom(0);
        this.divLogo.SetElementClassName("rounded overflow-hidden");
        this.divLogo.SetAlign(1);
        this.divLogo.SetElementFont(1);
        this.divLogo.FHTML.BeginUpdate();
        try {
          this.divLogo.FHTML.Clear();
          this.divLogo.FHTML.Add('<a href="https://www.actorious.com" style="text-decoration:none;">');
          this.divLogo.FHTML.Add("  <img ");
          this.divLogo.FHTML.Add('    src="img/actorious_logo.png" ');
          this.divLogo.FHTML.Add('    alt="Actorious Logo" ');
          this.divLogo.FHTML.Add('    style="width:144px; height:29px; margin-left:50%; transform:translateX(-50%);"');
          this.divLogo.FHTML.Add("  />");
          this.divLogo.FHTML.Add("</a>");
        } finally {
          this.divLogo.FHTML.EndUpdate();
        };
        this.divLogo.SetRole("");
        this.divBirthdayNav.SetParentComponent(this.divMainHolder);
        this.divBirthdayNav.SetName("divBirthdayNav");
        this.divBirthdayNav.SetAlignWithMargins(true);
        this.divBirthdayNav.SetLeft(4);
        this.divBirthdayNav.SetTop(68);
        this.divBirthdayNav.SetWidth(205);
        this.divBirthdayNav.SetHeight(34);
        this.divBirthdayNav.FMargins.SetLeft(4);
        this.divBirthdayNav.FMargins.SetTop(0);
        this.divBirthdayNav.FMargins.SetRight(4);
        this.divBirthdayNav.FMargins.SetBottom(1);
        this.divBirthdayNav.SetAlign(1);
        this.divBirthdayNav.SetChildOrderEx(2);
        this.divBirthdayNav.SetElementFont(1);
        this.divBirthdayNav.SetRole("");
        this.divBirthDay.SetParentComponent(this.divBirthdayNav);
        this.divBirthDay.SetName("divBirthDay");
        this.divBirthDay.SetAlignWithMargins(true);
        this.divBirthDay.SetLeft(32);
        this.divBirthDay.SetTop(0);
        this.divBirthDay.SetWidth(141);
        this.divBirthDay.SetHeight(34);
        this.divBirthDay.FMargins.SetLeft(0);
        this.divBirthDay.FMargins.SetTop(0);
        this.divBirthDay.FMargins.SetRight(0);
        this.divBirthDay.FMargins.SetBottom(0);
        this.divBirthDay.SetElementClassName("rounded-0 border border-dark bg-light text-dark");
        this.divBirthDay.SetAlign(5);
        this.divBirthDay.SetChildOrderEx(3);
        this.divBirthDay.SetElementFont(1);
        this.divBirthDay.SetRole("");
        this.divPrevBirthDay.SetParentComponent(this.divBirthdayNav);
        this.divPrevBirthDay.SetName("divPrevBirthDay");
        this.divPrevBirthDay.SetAlignWithMargins(true);
        this.divPrevBirthDay.SetLeft(0);
        this.divPrevBirthDay.SetTop(0);
        this.divPrevBirthDay.SetWidth(32);
        this.divPrevBirthDay.SetHeight(34);
        this.divPrevBirthDay.SetControlCursor(21);
        this.divPrevBirthDay.FMargins.SetLeft(0);
        this.divPrevBirthDay.FMargins.SetTop(0);
        this.divPrevBirthDay.FMargins.SetRight(0);
        this.divPrevBirthDay.FMargins.SetBottom(0);
        this.divPrevBirthDay.SetElementClassName("rounded-start bg-light text-dark border border-dark");
        this.divPrevBirthDay.SetAlign(3);
        this.divPrevBirthDay.SetChildOrderEx(3);
        this.divPrevBirthDay.SetElementFont(1);
        this.divPrevBirthDay.SetRole("");
        this.SetEvent$1(this.divPrevBirthDay,this,"OnClick","divPrevBirthDayClick");
        this.divNextBirthDay.SetParentComponent(this.divBirthdayNav);
        this.divNextBirthDay.SetName("divNextBirthDay");
        this.divNextBirthDay.SetAlignWithMargins(true);
        this.divNextBirthDay.SetLeft(173);
        this.divNextBirthDay.SetTop(0);
        this.divNextBirthDay.SetWidth(32);
        this.divNextBirthDay.SetHeight(34);
        this.divNextBirthDay.SetControlCursor(21);
        this.divNextBirthDay.FMargins.SetLeft(0);
        this.divNextBirthDay.FMargins.SetTop(0);
        this.divNextBirthDay.FMargins.SetRight(0);
        this.divNextBirthDay.FMargins.SetBottom(0);
        this.divNextBirthDay.SetElementClassName("rounded-end bg-light text-dark border border-dark");
        this.divNextBirthDay.SetAlign(4);
        this.divNextBirthDay.SetChildOrderEx(3);
        this.divNextBirthDay.SetElementFont(1);
        this.divNextBirthDay.SetRole("");
        this.SetEvent$1(this.divNextBirthDay,this,"OnClick","divNextBirthDayClick");
        this.divAttribution.SetParentComponent(this.divMainHolder);
        this.divAttribution.SetName("divAttribution");
        this.divAttribution.SetAlignWithMargins(true);
        this.divAttribution.SetLeft(4);
        this.divAttribution.SetTop(246);
        this.divAttribution.SetWidth(205);
        this.divAttribution.SetHeight(31);
        this.divAttribution.FMargins.SetLeft(4);
        this.divAttribution.FMargins.SetTop(0);
        this.divAttribution.FMargins.SetRight(4);
        this.divAttribution.FMargins.SetBottom(0);
        this.divAttribution.SetElementClassName("rounded border border-dark bg-dark text-dark d-flex justify-content-evenly");
        this.divAttribution.SetAlign(2);
        this.divAttribution.SetChildOrderEx(7);
        this.divAttribution.SetElementFont(1);
        this.divAttribution.FHTML.BeginUpdate();
        try {
          this.divAttribution.FHTML.Clear();
          this.divAttribution.FHTML.Add('<a href="https://www.wikidata.org" target=_blank>');
          this.divAttribution.FHTML.Add('  <img width="102px" ');
          this.divAttribution.FHTML.Add('           height="28px"');
          this.divAttribution.FHTML.Add('           src="img/wikidata_logo.png"');
          this.divAttribution.FHTML.Add('           title="WikiData" ');
          this.divAttribution.FHTML.Add('           alt="WikiData Logo"');
          this.divAttribution.FHTML.Add('           data-bs-toggle="tooltip" ');
          this.divAttribution.FHTML.Add('           data-bs-placement="top"');
          this.divAttribution.FHTML.Add('           data-bs-delay={"show":1000,"hide":100}>');
          this.divAttribution.FHTML.Add("</a>");
          this.divAttribution.FHTML.Add('<a href="https://www.themoviedb.org" target=_blank>');
          this.divAttribution.FHTML.Add('  <img width="63px" ');
          this.divAttribution.FHTML.Add('           height="27px"');
          this.divAttribution.FHTML.Add('           src="img/tmdb.svg"');
          this.divAttribution.FHTML.Add('           style="padding-top:1px;"');
          this.divAttribution.FHTML.Add('           title="The Movie Database" ');
          this.divAttribution.FHTML.Add('           alt="TMDb Logo"');
          this.divAttribution.FHTML.Add('           data-bs-toggle="tooltip" ');
          this.divAttribution.FHTML.Add('           data-bs-placement="top"');
          this.divAttribution.FHTML.Add('           data-bs-delay={"show":1000,"hide":100}>');
          this.divAttribution.FHTML.Add("</a>");
        } finally {
          this.divAttribution.FHTML.EndUpdate();
        };
        this.divAttribution.SetRole("");
        this.divDepartedNav.SetParentComponent(this.divMainHolder);
        this.divDepartedNav.SetName("divDepartedNav");
        this.divDepartedNav.SetAlignWithMargins(true);
        this.divDepartedNav.SetLeft(4);
        this.divDepartedNav.SetTop(103);
        this.divDepartedNav.SetWidth(205);
        this.divDepartedNav.SetHeight(34);
        this.divDepartedNav.FMargins.SetLeft(4);
        this.divDepartedNav.FMargins.SetTop(0);
        this.divDepartedNav.FMargins.SetRight(4);
        this.divDepartedNav.FMargins.SetBottom(1);
        this.divDepartedNav.SetAlign(1);
        this.divDepartedNav.SetChildOrderEx(3);
        this.divDepartedNav.SetElementFont(1);
        this.divDepartedNav.SetRole("");
        this.divDeathDay.SetParentComponent(this.divDepartedNav);
        this.divDeathDay.SetName("divDeathDay");
        this.divDeathDay.SetAlignWithMargins(true);
        this.divDeathDay.SetLeft(32);
        this.divDeathDay.SetTop(0);
        this.divDeathDay.SetWidth(141);
        this.divDeathDay.SetHeight(34);
        this.divDeathDay.FMargins.SetLeft(0);
        this.divDeathDay.FMargins.SetTop(0);
        this.divDeathDay.FMargins.SetRight(0);
        this.divDeathDay.FMargins.SetBottom(0);
        this.divDeathDay.SetElementClassName("rounded-0 border border-dark bg-light text-dark");
        this.divDeathDay.SetAlign(5);
        this.divDeathDay.SetChildOrderEx(3);
        this.divDeathDay.SetElementFont(1);
        this.divDeathDay.SetRole("");
        this.divPrevDeathDay.SetParentComponent(this.divDepartedNav);
        this.divPrevDeathDay.SetName("divPrevDeathDay");
        this.divPrevDeathDay.SetAlignWithMargins(true);
        this.divPrevDeathDay.SetLeft(0);
        this.divPrevDeathDay.SetTop(0);
        this.divPrevDeathDay.SetWidth(32);
        this.divPrevDeathDay.SetHeight(34);
        this.divPrevDeathDay.SetControlCursor(21);
        this.divPrevDeathDay.FMargins.SetLeft(0);
        this.divPrevDeathDay.FMargins.SetTop(0);
        this.divPrevDeathDay.FMargins.SetRight(0);
        this.divPrevDeathDay.FMargins.SetBottom(0);
        this.divPrevDeathDay.SetElementClassName("rounded-start bg-light text-dark border border-dark");
        this.divPrevDeathDay.SetAlign(3);
        this.divPrevDeathDay.SetChildOrderEx(3);
        this.divPrevDeathDay.SetElementFont(1);
        this.divPrevDeathDay.SetRole("");
        this.SetEvent$1(this.divPrevDeathDay,this,"OnClick","divPrevDeathDayClick");
        this.divNextDeathDay.SetParentComponent(this.divDepartedNav);
        this.divNextDeathDay.SetName("divNextDeathDay");
        this.divNextDeathDay.SetAlignWithMargins(true);
        this.divNextDeathDay.SetLeft(173);
        this.divNextDeathDay.SetTop(0);
        this.divNextDeathDay.SetWidth(32);
        this.divNextDeathDay.SetHeight(34);
        this.divNextDeathDay.SetControlCursor(21);
        this.divNextDeathDay.FMargins.SetLeft(0);
        this.divNextDeathDay.FMargins.SetTop(0);
        this.divNextDeathDay.FMargins.SetRight(0);
        this.divNextDeathDay.FMargins.SetBottom(0);
        this.divNextDeathDay.SetElementClassName("rounded-end bg-light text-dark border border-dark");
        this.divNextDeathDay.SetAlign(4);
        this.divNextDeathDay.SetChildOrderEx(3);
        this.divNextDeathDay.SetElementFont(1);
        this.divNextDeathDay.SetRole("");
        this.SetEvent$1(this.divNextDeathDay,this,"OnClick","divNextDeathDayClick");
        this.divReleaseNav.SetParentComponent(this.divMainHolder);
        this.divReleaseNav.SetName("divReleaseNav");
        this.divReleaseNav.SetAlignWithMargins(true);
        this.divReleaseNav.SetLeft(4);
        this.divReleaseNav.SetTop(138);
        this.divReleaseNav.SetWidth(205);
        this.divReleaseNav.SetHeight(34);
        this.divReleaseNav.FMargins.SetLeft(4);
        this.divReleaseNav.FMargins.SetTop(0);
        this.divReleaseNav.FMargins.SetRight(4);
        this.divReleaseNav.FMargins.SetBottom(1);
        this.divReleaseNav.SetAlign(1);
        this.divReleaseNav.SetChildOrderEx(4);
        this.divReleaseNav.SetElementFont(1);
        this.divReleaseNav.SetRole("");
        this.divReleaseDay.SetParentComponent(this.divReleaseNav);
        this.divReleaseDay.SetName("divReleaseDay");
        this.divReleaseDay.SetAlignWithMargins(true);
        this.divReleaseDay.SetLeft(32);
        this.divReleaseDay.SetTop(0);
        this.divReleaseDay.SetWidth(141);
        this.divReleaseDay.SetHeight(34);
        this.divReleaseDay.FMargins.SetLeft(0);
        this.divReleaseDay.FMargins.SetTop(0);
        this.divReleaseDay.FMargins.SetRight(0);
        this.divReleaseDay.FMargins.SetBottom(0);
        this.divReleaseDay.SetElementClassName("rounded-0 border border-dark bg-light text-dark");
        this.divReleaseDay.SetAlign(5);
        this.divReleaseDay.SetChildOrderEx(3);
        this.divReleaseDay.SetElementFont(1);
        this.divReleaseDay.SetRole("");
        this.divPrevReleaseDay.SetParentComponent(this.divReleaseNav);
        this.divPrevReleaseDay.SetName("divPrevReleaseDay");
        this.divPrevReleaseDay.SetAlignWithMargins(true);
        this.divPrevReleaseDay.SetLeft(0);
        this.divPrevReleaseDay.SetTop(0);
        this.divPrevReleaseDay.SetWidth(32);
        this.divPrevReleaseDay.SetHeight(34);
        this.divPrevReleaseDay.SetControlCursor(21);
        this.divPrevReleaseDay.FMargins.SetLeft(0);
        this.divPrevReleaseDay.FMargins.SetTop(0);
        this.divPrevReleaseDay.FMargins.SetRight(0);
        this.divPrevReleaseDay.FMargins.SetBottom(0);
        this.divPrevReleaseDay.SetElementClassName("rounded-start bg-light text-dark border border-dark");
        this.divPrevReleaseDay.SetAlign(3);
        this.divPrevReleaseDay.SetChildOrderEx(3);
        this.divPrevReleaseDay.SetElementFont(1);
        this.divPrevReleaseDay.SetRole("");
        this.SetEvent$1(this.divPrevReleaseDay,this,"OnClick","divPrevReleaseDayClick");
        this.divNextReleaseDay.SetParentComponent(this.divReleaseNav);
        this.divNextReleaseDay.SetName("divNextReleaseDay");
        this.divNextReleaseDay.SetAlignWithMargins(true);
        this.divNextReleaseDay.SetLeft(173);
        this.divNextReleaseDay.SetTop(0);
        this.divNextReleaseDay.SetWidth(32);
        this.divNextReleaseDay.SetHeight(34);
        this.divNextReleaseDay.SetControlCursor(21);
        this.divNextReleaseDay.FMargins.SetLeft(0);
        this.divNextReleaseDay.FMargins.SetTop(0);
        this.divNextReleaseDay.FMargins.SetRight(0);
        this.divNextReleaseDay.FMargins.SetBottom(0);
        this.divNextReleaseDay.SetElementClassName("rounded-end bg-light text-dark border border-dark");
        this.divNextReleaseDay.SetAlign(4);
        this.divNextReleaseDay.SetChildOrderEx(3);
        this.divNextReleaseDay.SetElementFont(1);
        this.divNextReleaseDay.SetRole("");
        this.SetEvent$1(this.divNextReleaseDay,this,"OnClick","divNextReleaseDayClick");
        this.divTop100Nav.SetParentComponent(this.divMainHolder);
        this.divTop100Nav.SetName("divTop100Nav");
        this.divTop100Nav.SetAlignWithMargins(true);
        this.divTop100Nav.SetLeft(4);
        this.divTop100Nav.SetTop(207);
        this.divTop100Nav.SetWidth(205);
        this.divTop100Nav.SetHeight(32);
        this.divTop100Nav.FMargins.SetLeft(4);
        this.divTop100Nav.FMargins.SetTop(0);
        this.divTop100Nav.FMargins.SetRight(4);
        this.divTop100Nav.FMargins.SetBottom(1);
        this.divTop100Nav.SetElementClassName("bg-none rounded");
        this.divTop100Nav.SetAlign(1);
        this.divTop100Nav.SetChildOrderEx(6);
        this.divTop100Nav.SetElementFont(1);
        this.btnTop1000.SetParentComponent(this.divTop100Nav);
        this.btnTop1000.SetName("btnTop1000");
        this.btnTop1000.SetAlignWithMargins(true);
        this.btnTop1000.SetLeft(0);
        this.btnTop1000.SetTop(0);
        this.btnTop1000.SetWidth(205);
        this.btnTop1000.SetHeight(32);
        this.btnTop1000.FMargins.SetLeft(0);
        this.btnTop1000.FMargins.SetTop(0);
        this.btnTop1000.FMargins.SetRight(0);
        this.btnTop1000.FMargins.SetBottom(0);
        this.btnTop1000.SetAlign(5);
        this.btnTop1000.SetElementClassName("btn btn-sm btn-secondary");
        this.btnTop1000.SetElementFont(1);
        this.btnTop1000.SetHeightPercent(100.000000000000000000);
        this.btnTop1000.SetTabStop(false);
        this.btnTop1000.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnTop1000,this,"OnClick","btnTop1000Click");
        this.divPeopleNav.SetParentComponent(this.divMainHolder);
        this.divPeopleNav.SetName("divPeopleNav");
        this.divPeopleNav.SetAlignWithMargins(true);
        this.divPeopleNav.SetLeft(4);
        this.divPeopleNav.SetTop(34);
        this.divPeopleNav.SetWidth(205);
        this.divPeopleNav.SetHeight(32);
        this.divPeopleNav.FMargins.SetLeft(4);
        this.divPeopleNav.FMargins.SetTop(0);
        this.divPeopleNav.FMargins.SetRight(4);
        this.divPeopleNav.FMargins.SetBottom(2);
        this.divPeopleNav.SetElementClassName("bg-none rounded");
        this.divPeopleNav.SetAlign(1);
        this.divPeopleNav.SetChildOrderEx(1);
        this.divPeopleNav.FElementBodyClassName = "btn-group btn-group-sm d-flex align-items-stretch ";
        this.divPeopleNav.SetElementFont(1);
        this.btnActors.SetParentComponent(this.divPeopleNav);
        this.btnActors.SetName("btnActors");
        this.btnActors.SetLeft(114);
        this.btnActors.SetTop(0);
        this.btnActors.SetWidth(57);
        this.btnActors.SetHeight(32);
        this.btnActors.SetAlign(3);
        this.btnActors.SetChildOrderEx(2);
        this.btnActors.SetElementClassName("btn btn-sm btn-secondary");
        this.btnActors.SetElementFont(1);
        this.btnActors.SetElementPosition(1);
        this.btnActors.SetHeightPercent(100.000000000000000000);
        this.btnActors.SetTabStop(false);
        this.btnActors.SetWidthStyle(2);
        this.btnActors.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnActors,this,"OnClick","btnActorsClick");
        this.btnDirectors.SetParentComponent(this.divPeopleNav);
        this.btnDirectors.SetName("btnDirectors");
        this.btnDirectors.SetLeft(57);
        this.btnDirectors.SetTop(0);
        this.btnDirectors.SetWidth(57);
        this.btnDirectors.SetHeight(32);
        this.btnDirectors.SetAlign(3);
        this.btnDirectors.SetChildOrderEx(1);
        this.btnDirectors.SetElementClassName("btn btn-sm btn-secondary");
        this.btnDirectors.SetElementFont(1);
        this.btnDirectors.SetElementPosition(1);
        this.btnDirectors.SetHeightPercent(100.000000000000000000);
        this.btnDirectors.SetTabOrder(1);
        this.btnDirectors.SetTabStop(false);
        this.btnDirectors.SetWidthStyle(2);
        this.btnDirectors.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnDirectors,this,"OnClick","btnDirectorsClick");
        this.btnWriters.SetParentComponent(this.divPeopleNav);
        this.btnWriters.SetName("btnWriters");
        this.btnWriters.SetLeft(0);
        this.btnWriters.SetTop(0);
        this.btnWriters.SetWidth(57);
        this.btnWriters.SetHeight(32);
        this.btnWriters.SetAlign(3);
        this.btnWriters.SetElementClassName("btn btn-sm btn-secondary");
        this.btnWriters.SetElementFont(1);
        this.btnWriters.SetElementPosition(1);
        this.btnWriters.SetHeightPercent(100.000000000000000000);
        this.btnWriters.SetTabOrder(2);
        this.btnWriters.SetTabStop(false);
        this.btnWriters.SetWidthStyle(2);
        this.btnWriters.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnWriters,this,"OnClick","btnWritersClick");
        this.divSearchNav.SetParentComponent(this.divMainHolder);
        this.divSearchNav.SetName("divSearchNav");
        this.divSearchNav.SetAlignWithMargins(true);
        this.divSearchNav.SetLeft(4);
        this.divSearchNav.SetTop(173);
        this.divSearchNav.SetWidth(204);
        this.divSearchNav.SetHeight(32);
        this.divSearchNav.FMargins.SetLeft(4);
        this.divSearchNav.FMargins.SetTop(0);
        this.divSearchNav.FMargins.SetRight(5);
        this.divSearchNav.FMargins.SetBottom(2);
        this.divSearchNav.SetElementClassName("rounded border border-dark bg-light ");
        this.divSearchNav.SetAlign(1);
        this.divSearchNav.SetChildOrderEx(5);
        this.divSearchNav.SetElementFont(1);
        this.divSearchNav.SetRole("");
        this.edtSearch.SetParentComponent(this.divSearchNav);
        this.edtSearch.SetName("edtSearch");
        this.edtSearch.SetLeft(0);
        this.edtSearch.SetTop(0);
        this.edtSearch.SetWidth(204);
        this.edtSearch.SetHeight(32);
        this.edtSearch.FMargins.SetLeft(0);
        this.edtSearch.FMargins.SetTop(0);
        this.edtSearch.FMargins.SetRight(0);
        this.edtSearch.FMargins.SetBottom(0);
        this.edtSearch.SetTabStop(false);
        this.edtSearch.SetAlign(5);
        this.edtSearch.SetAutoFocus(true);
        this.edtSearch.SetChildOrderEx(7);
        this.edtSearch.SetElementClassName("border-0 rounded bg-light ps-2 pb-1");
        this.edtSearch.SetElementFont(1);
        this.edtSearch.SetHeightPercent(100.000000000000000000);
        this.edtSearch.SetMaxLength(25);
        this.edtSearch.SetSpellCheck(false);
        this.edtSearch.SetTextHint("Search People...");
        this.edtSearch.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.edtSearch,this,"OnChange","edtSearchChange");
        this.SetEvent$1(this.edtSearch,this,"OnEnter","edtSearchEnter");
        this.btnSearch.SetParentComponent(this.divMainHolder);
        this.btnSearch.SetName("btnSearch");
        this.btnSearch.SetLeft(173);
        this.btnSearch.SetTop(173);
        this.btnSearch.SetWidth(32);
        this.btnSearch.SetHeight(32);
        this.btnSearch.SetHint("Search People");
        this.btnSearch.SetCaption('<i class="fa-duotone fa-search align-top text-black fa-lg"></i> ');
        this.btnSearch.SetChildOrderEx(1);
        this.btnSearch.SetDefault(true);
        this.btnSearch.SetElementClassName("btn btn-sm btn-link border-0 shadow-none");
        this.btnSearch.SetElementFont(1);
        this.btnSearch.SetHeightPercent(100.000000000000000000);
        this.btnSearch.SetTabOrder(8);
        this.btnSearch.SetTabStop(false);
        this.btnSearch.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnSearch,this,"OnClick","btnSearchClick");
        this.divTopButtons.SetParentComponent(this.divTop);
        this.divTopButtons.SetName("divTopButtons");
        this.divTopButtons.SetLeft(432);
        this.divTopButtons.SetTop(5);
        this.divTopButtons.SetWidth(192);
        this.divTopButtons.SetHeight(277);
        this.divTopButtons.SetElementClassName("order-2 d-flex flex-row gap-1");
        this.divTopButtons.SetWidthStyle(2);
        this.divTopButtons.SetChildOrderEx(10);
        this.divTopButtons.SetElementPosition(1);
        this.divTopButtons.SetElementFont(1);
        this.divTopButtons.SetRole("");
        this.divLinkSet1.SetParentComponent(this.divTopButtons);
        this.divLinkSet1.SetName("divLinkSet1");
        this.divLinkSet1.SetLeft(0);
        this.divLinkSet1.SetTop(0);
        this.divLinkSet1.SetWidth(32);
        this.divLinkSet1.SetHeight(277);
        this.divLinkSet1.SetElementClassName("order-0 d-flex flex-column gap-1");
        this.divLinkSet1.SetChildOrderEx(4);
        this.divLinkSet1.SetElementPosition(1);
        this.divLinkSet1.SetElementFont(1);
        this.divLinkSet1.SetRole("");
        this.WebHTMLDiv4.SetParentComponent(this.divLinkSet1);
        this.WebHTMLDiv4.SetName("WebHTMLDiv4");
        this.WebHTMLDiv4.SetLeft(3);
        this.WebHTMLDiv4.SetTop(105);
        this.WebHTMLDiv4.SetWidth(32);
        this.WebHTMLDiv4.SetHeight(32);
        this.WebHTMLDiv4.FMargins.SetLeft(0);
        this.WebHTMLDiv4.FMargins.SetTop(0);
        this.WebHTMLDiv4.FMargins.SetRight(0);
        this.WebHTMLDiv4.SetElementClassName("order-4 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv4.SetChildOrderEx(1);
        this.WebHTMLDiv4.SetElementPosition(1);
        this.WebHTMLDiv4.SetElementFont(1);
        this.WebHTMLDiv4.SetRole("");
        this.WebHTMLDiv5.SetParentComponent(this.divLinkSet1);
        this.WebHTMLDiv5.SetName("WebHTMLDiv5");
        this.WebHTMLDiv5.SetLeft(0);
        this.WebHTMLDiv5.SetTop(70);
        this.WebHTMLDiv5.SetWidth(32);
        this.WebHTMLDiv5.SetHeight(32);
        this.WebHTMLDiv5.FMargins.SetLeft(0);
        this.WebHTMLDiv5.FMargins.SetTop(0);
        this.WebHTMLDiv5.FMargins.SetRight(0);
        this.WebHTMLDiv5.SetElementClassName("order-3 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv5.SetChildOrderEx(2);
        this.WebHTMLDiv5.SetElementPosition(1);
        this.WebHTMLDiv5.SetElementFont(1);
        this.WebHTMLDiv5.SetRole("");
        this.linkFavourite.SetParentComponent(this.divLinkSet1);
        this.linkFavourite.SetName("linkFavourite");
        this.linkFavourite.SetLeft(0);
        this.linkFavourite.SetTop(35);
        this.linkFavourite.SetWidth(32);
        this.linkFavourite.SetHeight(32);
        this.linkFavourite.FMargins.SetLeft(0);
        this.linkFavourite.FMargins.SetTop(0);
        this.linkFavourite.FMargins.SetRight(0);
        this.linkFavourite.SetElementClassName("order-2 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkFavourite.SetChildOrderEx(3);
        this.linkFavourite.SetElementPosition(1);
        this.linkFavourite.SetElementFont(1);
        this.linkFavourite.FHTML.BeginUpdate();
        try {
          this.linkFavourite.FHTML.Clear();
          this.linkFavourite.FHTML.Add('<div style="padding:3px 3px; color:#f00;"><i class="fa-solid fa-heart fa-xl"></i></div>');
        } finally {
          this.linkFavourite.FHTML.EndUpdate();
        };
        this.linkFavourite.SetRole("");
        this.WebHTMLDiv7.SetParentComponent(this.divLinkSet1);
        this.WebHTMLDiv7.SetName("WebHTMLDiv7");
        this.WebHTMLDiv7.SetLeft(0);
        this.WebHTMLDiv7.SetTop(140);
        this.WebHTMLDiv7.SetWidth(32);
        this.WebHTMLDiv7.SetHeight(32);
        this.WebHTMLDiv7.FMargins.SetLeft(0);
        this.WebHTMLDiv7.FMargins.SetTop(0);
        this.WebHTMLDiv7.FMargins.SetRight(0);
        this.WebHTMLDiv7.SetElementClassName("order-5 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv7.SetChildOrderEx(5);
        this.WebHTMLDiv7.SetElementPosition(1);
        this.WebHTMLDiv7.SetElementFont(1);
        this.WebHTMLDiv7.SetRole("");
        this.linkLoading.SetParentComponent(this.divLinkSet1);
        this.linkLoading.SetName("linkLoading");
        this.linkLoading.SetLeft(0);
        this.linkLoading.SetTop(243);
        this.linkLoading.SetWidth(32);
        this.linkLoading.SetHeight(32);
        this.linkLoading.FMargins.SetLeft(0);
        this.linkLoading.FMargins.SetTop(0);
        this.linkLoading.FMargins.SetRight(0);
        this.linkLoading.SetElementClassName("order-7 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkLoading.SetChildOrderEx(5);
        this.linkLoading.SetElementPosition(1);
        this.linkLoading.SetElementFont(1);
        this.linkLoading.SetRole("");
        this.linkLogin.SetParentComponent(this.divLinkSet1);
        this.linkLogin.SetName("linkLogin");
        this.linkLogin.SetLeft(3);
        this.linkLogin.SetTop(0);
        this.linkLogin.SetWidth(32);
        this.linkLogin.SetHeight(32);
        this.linkLogin.FMargins.SetLeft(0);
        this.linkLogin.FMargins.SetTop(0);
        this.linkLogin.FMargins.SetRight(0);
        this.linkLogin.SetElementClassName("order-1 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkLogin.SetChildOrderEx(3);
        this.linkLogin.SetElementPosition(1);
        this.linkLogin.SetElementFont(1);
        this.linkLogin.FHTML.BeginUpdate();
        try {
          this.linkLogin.FHTML.Clear();
          this.linkLogin.FHTML.Add('<div style="padding:3px 4px; color:var(--bs-gray-200);"><i class="fa-duotone fa-right-to-bracket fa-lg"></i></div>');
        } finally {
          this.linkLogin.FHTML.EndUpdate();
        };
        this.linkLogin.SetRole("");
        this.WebHTMLDiv12.SetParentComponent(this.divLinkSet1);
        this.WebHTMLDiv12.SetName("WebHTMLDiv12");
        this.WebHTMLDiv12.SetLeft(0);
        this.WebHTMLDiv12.SetTop(210);
        this.WebHTMLDiv12.SetWidth(32);
        this.WebHTMLDiv12.SetHeight(32);
        this.WebHTMLDiv12.FMargins.SetLeft(0);
        this.WebHTMLDiv12.FMargins.SetTop(0);
        this.WebHTMLDiv12.FMargins.SetRight(0);
        this.WebHTMLDiv12.SetElementClassName("order-7 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv12.SetChildOrderEx(5);
        this.WebHTMLDiv12.SetElementPosition(1);
        this.WebHTMLDiv12.SetElementFont(1);
        this.WebHTMLDiv12.SetRole("");
        this.WebHTMLDiv13.SetParentComponent(this.divLinkSet1);
        this.WebHTMLDiv13.SetName("WebHTMLDiv13");
        this.WebHTMLDiv13.SetLeft(0);
        this.WebHTMLDiv13.SetTop(175);
        this.WebHTMLDiv13.SetWidth(32);
        this.WebHTMLDiv13.SetHeight(32);
        this.WebHTMLDiv13.FMargins.SetLeft(0);
        this.WebHTMLDiv13.FMargins.SetTop(0);
        this.WebHTMLDiv13.FMargins.SetRight(0);
        this.WebHTMLDiv13.SetElementClassName("order-6 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv13.SetChildOrderEx(5);
        this.WebHTMLDiv13.SetElementPosition(1);
        this.WebHTMLDiv13.SetElementFont(1);
        this.WebHTMLDiv13.SetRole("");
        this.divLinkSet2.SetParentComponent(this.divTopButtons);
        this.divLinkSet2.SetName("divLinkSet2");
        this.divLinkSet2.SetLeft(36);
        this.divLinkSet2.SetTop(0);
        this.divLinkSet2.SetWidth(32);
        this.divLinkSet2.SetHeight(277);
        this.divLinkSet2.SetElementClassName("order-1 d-flex flex-column gap-1");
        this.divLinkSet2.SetChildOrderEx(4);
        this.divLinkSet2.SetElementPosition(1);
        this.divLinkSet2.SetElementFont(1);
        this.divLinkSet2.SetRole("");
        this.linkList4.SetParentComponent(this.divLinkSet2);
        this.linkList4.SetName("linkList4");
        this.linkList4.SetLeft(0);
        this.linkList4.SetTop(140);
        this.linkList4.SetWidth(32);
        this.linkList4.SetHeight(32);
        this.linkList4.FMargins.SetLeft(0);
        this.linkList4.FMargins.SetTop(0);
        this.linkList4.FMargins.SetRight(0);
        this.linkList4.SetElementClassName("order-5 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkList4.SetChildOrderEx(3);
        this.linkList4.SetElementPosition(1);
        this.linkList4.SetElementFont(1);
        this.linkList4.SetRole("");
        this.linkList3.SetParentComponent(this.divLinkSet2);
        this.linkList3.SetName("linkList3");
        this.linkList3.SetLeft(0);
        this.linkList3.SetTop(70);
        this.linkList3.SetWidth(32);
        this.linkList3.SetHeight(32);
        this.linkList3.FMargins.SetLeft(0);
        this.linkList3.FMargins.SetTop(0);
        this.linkList3.FMargins.SetRight(0);
        this.linkList3.SetElementClassName("order-3 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkList3.SetChildOrderEx(2);
        this.linkList3.SetElementPosition(1);
        this.linkList3.SetElementFont(1);
        this.linkList3.SetRole("");
        this.linkList2.SetParentComponent(this.divLinkSet2);
        this.linkList2.SetName("linkList2");
        this.linkList2.SetLeft(0);
        this.linkList2.SetTop(35);
        this.linkList2.SetWidth(32);
        this.linkList2.SetHeight(32);
        this.linkList2.FMargins.SetLeft(0);
        this.linkList2.FMargins.SetTop(0);
        this.linkList2.FMargins.SetRight(0);
        this.linkList2.SetElementClassName("order-2 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkList2.SetChildOrderEx(1);
        this.linkList2.SetElementPosition(1);
        this.linkList2.SetElementFont(1);
        this.linkList2.SetRole("");
        this.linkTour.SetParentComponent(this.divLinkSet2);
        this.linkTour.SetName("linkTour");
        this.linkTour.SetLeft(0);
        this.linkTour.SetTop(175);
        this.linkTour.SetWidth(32);
        this.linkTour.SetHeight(32);
        this.linkTour.FMargins.SetLeft(0);
        this.linkTour.FMargins.SetTop(0);
        this.linkTour.FMargins.SetRight(0);
        this.linkTour.SetElementClassName("order-7 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkTour.SetChildOrderEx(4);
        this.linkTour.SetElementPosition(1);
        this.linkTour.SetElementFont(1);
        this.linkTour.SetRole("");
        this.linkLink.SetParentComponent(this.divLinkSet2);
        this.linkLink.SetName("linkLink");
        this.linkLink.SetLeft(0);
        this.linkLink.SetTop(210);
        this.linkLink.SetWidth(32);
        this.linkLink.SetHeight(32);
        this.linkLink.FMargins.SetLeft(0);
        this.linkLink.FMargins.SetTop(0);
        this.linkLink.FMargins.SetRight(0);
        this.linkLink.SetElementClassName("order-7 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkLink.SetChildOrderEx(6);
        this.linkLink.SetElementPosition(1);
        this.linkLink.SetElementFont(1);
        this.linkLink.SetRole("");
        this.linkList1.SetParentComponent(this.divLinkSet2);
        this.linkList1.SetName("linkList1");
        this.linkList1.SetLeft(0);
        this.linkList1.SetTop(0);
        this.linkList1.SetWidth(32);
        this.linkList1.SetHeight(32);
        this.linkList1.FMargins.SetLeft(0);
        this.linkList1.FMargins.SetTop(0);
        this.linkList1.FMargins.SetRight(0);
        this.linkList1.SetElementClassName("order-1 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkList1.SetChildOrderEx(5);
        this.linkList1.SetElementPosition(1);
        this.linkList1.SetElementFont(1);
        this.linkList1.SetRole("");
        this.linkEMail.SetParentComponent(this.divLinkSet2);
        this.linkEMail.SetName("linkEMail");
        this.linkEMail.SetLeft(0);
        this.linkEMail.SetTop(245);
        this.linkEMail.SetWidth(32);
        this.linkEMail.SetHeight(32);
        this.linkEMail.FMargins.SetLeft(0);
        this.linkEMail.FMargins.SetTop(0);
        this.linkEMail.FMargins.SetRight(0);
        this.linkEMail.SetElementClassName("order-8 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkEMail.SetChildOrderEx(7);
        this.linkEMail.SetElementPosition(1);
        this.linkEMail.SetElementFont(1);
        this.linkEMail.SetRole("");
        this.linkRating.SetParentComponent(this.divLinkSet2);
        this.linkRating.SetName("linkRating");
        this.linkRating.SetLeft(0);
        this.linkRating.SetTop(105);
        this.linkRating.SetWidth(32);
        this.linkRating.SetHeight(32);
        this.linkRating.FMargins.SetLeft(0);
        this.linkRating.FMargins.SetTop(0);
        this.linkRating.FMargins.SetRight(0);
        this.linkRating.SetElementClassName("order-4 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkRating.SetChildOrderEx(5);
        this.linkRating.SetElementPosition(1);
        this.linkRating.SetElementFont(1);
        this.linkRating.SetRole("");
        this.divLinkSet4.SetParentComponent(this.divTopButtons);
        this.divLinkSet4.SetName("divLinkSet4");
        this.divLinkSet4.SetLeft(108);
        this.divLinkSet4.SetTop(0);
        this.divLinkSet4.SetWidth(32);
        this.divLinkSet4.SetHeight(277);
        this.divLinkSet4.SetElementClassName("order-3 d-flex flex-column gap-1");
        this.divLinkSet4.SetChildOrderEx(3);
        this.divLinkSet4.SetElementPosition(1);
        this.divLinkSet4.SetElementFont(1);
        this.divLinkSet4.SetRole("");
        this.linkWikiData.SetParentComponent(this.divLinkSet4);
        this.linkWikiData.SetName("linkWikiData");
        this.linkWikiData.SetLeft(0);
        this.linkWikiData.SetTop(70);
        this.linkWikiData.SetWidth(32);
        this.linkWikiData.SetHeight(32);
        this.linkWikiData.FMargins.SetLeft(0);
        this.linkWikiData.FMargins.SetTop(0);
        this.linkWikiData.FMargins.SetRight(0);
        this.linkWikiData.SetElementClassName("order-3 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkWikiData.SetChildOrderEx(1);
        this.linkWikiData.SetElementPosition(1);
        this.linkWikiData.SetElementFont(1);
        this.linkWikiData.FHTML.BeginUpdate();
        try {
          this.linkWikiData.FHTML.Clear();
          this.linkWikiData.FHTML.Add('<img style="padding:2px;" alt="WikiData Logo" src="img/wikidata_icon.png" height=100% width=100%>');
        } finally {
          this.linkWikiData.FHTML.EndUpdate();
        };
        this.linkWikiData.SetRole("");
        this.linkScore.SetParentComponent(this.divLinkSet4);
        this.linkScore.SetName("linkScore");
        this.linkScore.SetLeft(0);
        this.linkScore.SetTop(35);
        this.linkScore.SetWidth(32);
        this.linkScore.SetHeight(32);
        this.linkScore.FMargins.SetLeft(0);
        this.linkScore.FMargins.SetTop(0);
        this.linkScore.FMargins.SetRight(0);
        this.linkScore.SetElementClassName("order-2 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkScore.SetChildOrderEx(2);
        this.linkScore.SetElementPosition(1);
        this.linkScore.SetElementFont(1);
        this.linkScore.SetRole("");
        this.linkTMDb.SetParentComponent(this.divLinkSet4);
        this.linkTMDb.SetName("linkTMDb");
        this.linkTMDb.SetLeft(0);
        this.linkTMDb.SetTop(0);
        this.linkTMDb.SetWidth(32);
        this.linkTMDb.SetHeight(32);
        this.linkTMDb.FMargins.SetLeft(0);
        this.linkTMDb.FMargins.SetTop(0);
        this.linkTMDb.FMargins.SetRight(0);
        this.linkTMDb.SetElementClassName("order-1 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkTMDb.SetChildOrderEx(4);
        this.linkTMDb.SetElementPosition(1);
        this.linkTMDb.SetElementFont(1);
        this.linkTMDb.FHTML.BeginUpdate();
        try {
          this.linkTMDb.FHTML.Clear();
          this.linkTMDb.FHTML.Add('<img style="padding:2px;" alt="TMDb Logo" src="img/tmdb_icon.svg" height=100% width=100%>');
        } finally {
          this.linkTMDb.FHTML.EndUpdate();
        };
        this.linkTMDb.SetRole("");
        this.linkRottenTomatoes.SetParentComponent(this.divLinkSet4);
        this.linkRottenTomatoes.SetName("linkRottenTomatoes");
        this.linkRottenTomatoes.SetLeft(0);
        this.linkRottenTomatoes.SetTop(175);
        this.linkRottenTomatoes.SetWidth(32);
        this.linkRottenTomatoes.SetHeight(32);
        this.linkRottenTomatoes.FMargins.SetLeft(0);
        this.linkRottenTomatoes.FMargins.SetTop(0);
        this.linkRottenTomatoes.FMargins.SetRight(0);
        this.linkRottenTomatoes.SetElementClassName("order-6 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkRottenTomatoes.SetChildOrderEx(5);
        this.linkRottenTomatoes.SetElementPosition(1);
        this.linkRottenTomatoes.SetElementFont(1);
        this.linkRottenTomatoes.FHTML.BeginUpdate();
        try {
          this.linkRottenTomatoes.FHTML.Clear();
          this.linkRottenTomatoes.FHTML.Add('<img alt="Rotten Tomatoes Logo" style="padding:2px;" src="img/rottentomatoes_icon.png" height=100% width=100%>');
        } finally {
          this.linkRottenTomatoes.FHTML.EndUpdate();
        };
        this.linkRottenTomatoes.SetRole("");
        this.linkMetaCritic.SetParentComponent(this.divLinkSet4);
        this.linkMetaCritic.SetName("linkMetaCritic");
        this.linkMetaCritic.SetLeft(0);
        this.linkMetaCritic.SetTop(210);
        this.linkMetaCritic.SetWidth(32);
        this.linkMetaCritic.SetHeight(32);
        this.linkMetaCritic.FMargins.SetLeft(0);
        this.linkMetaCritic.FMargins.SetTop(0);
        this.linkMetaCritic.FMargins.SetRight(0);
        this.linkMetaCritic.SetElementClassName("order-7 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkMetaCritic.SetChildOrderEx(5);
        this.linkMetaCritic.SetElementPosition(1);
        this.linkMetaCritic.SetElementFont(1);
        this.linkMetaCritic.FHTML.BeginUpdate();
        try {
          this.linkMetaCritic.FHTML.Clear();
          this.linkMetaCritic.FHTML.Add('<img alt="Metacritic Logo" tyle="padding:2px;" src="img/metacritic_icon.png" height=100% width=100%>');
        } finally {
          this.linkMetaCritic.FHTML.EndUpdate();
        };
        this.linkMetaCritic.SetRole("");
        this.linkIMDb.SetParentComponent(this.divLinkSet4);
        this.linkIMDb.SetName("linkIMDb");
        this.linkIMDb.SetLeft(0);
        this.linkIMDb.SetTop(140);
        this.linkIMDb.SetWidth(32);
        this.linkIMDb.SetHeight(32);
        this.linkIMDb.FMargins.SetLeft(0);
        this.linkIMDb.FMargins.SetTop(0);
        this.linkIMDb.FMargins.SetRight(0);
        this.linkIMDb.SetElementClassName("order-5 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkIMDb.SetChildOrderEx(5);
        this.linkIMDb.SetElementPosition(1);
        this.linkIMDb.SetElementFont(1);
        this.linkIMDb.FHTML.BeginUpdate();
        try {
          this.linkIMDb.FHTML.Clear();
          this.linkIMDb.FHTML.Add('<img style="padding:2px;" alt="IMDB Logo" src="img/imdb_icon.png" height=100% width=100%>');
        } finally {
          this.linkIMDb.FHTML.EndUpdate();
        };
        this.linkIMDb.SetRole("");
        this.linkWeb.SetParentComponent(this.divLinkSet4);
        this.linkWeb.SetName("linkWeb");
        this.linkWeb.SetLeft(0);
        this.linkWeb.SetTop(245);
        this.linkWeb.SetWidth(32);
        this.linkWeb.SetHeight(32);
        this.linkWeb.FMargins.SetLeft(0);
        this.linkWeb.FMargins.SetTop(0);
        this.linkWeb.FMargins.SetRight(0);
        this.linkWeb.SetElementClassName("order-8 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkWeb.SetChildOrderEx(5);
        this.linkWeb.SetElementPosition(1);
        this.linkWeb.SetElementFont(1);
        this.linkWeb.FHTML.BeginUpdate();
        try {
          this.linkWeb.FHTML.Clear();
          this.linkWeb.FHTML.Add('<img alt="Website" style="padding:2px;" src="img/web_icon.png" height=100% width=100%>');
        } finally {
          this.linkWeb.FHTML.EndUpdate();
        };
        this.linkWeb.SetRole("");
        this.linkGoogleImageSearch.SetParentComponent(this.divLinkSet4);
        this.linkGoogleImageSearch.SetName("linkGoogleImageSearch");
        this.linkGoogleImageSearch.SetLeft(1);
        this.linkGoogleImageSearch.SetTop(105);
        this.linkGoogleImageSearch.SetWidth(32);
        this.linkGoogleImageSearch.SetHeight(32);
        this.linkGoogleImageSearch.FMargins.SetLeft(0);
        this.linkGoogleImageSearch.FMargins.SetTop(0);
        this.linkGoogleImageSearch.FMargins.SetRight(0);
        this.linkGoogleImageSearch.SetElementClassName("order-4 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkGoogleImageSearch.SetChildOrderEx(5);
        this.linkGoogleImageSearch.SetElementPosition(1);
        this.linkGoogleImageSearch.SetElementFont(1);
        this.linkGoogleImageSearch.FHTML.BeginUpdate();
        try {
          this.linkGoogleImageSearch.FHTML.Clear();
          this.linkGoogleImageSearch.FHTML.Add('<img style="padding:3px;width:100%;height:100%;" alt="Google Logo" src="img/google_icon.png">');
        } finally {
          this.linkGoogleImageSearch.FHTML.EndUpdate();
        };
        this.linkGoogleImageSearch.SetRole("");
        this.divLinkSet5.SetParentComponent(this.divTopButtons);
        this.divLinkSet5.SetName("divLinkSet5");
        this.divLinkSet5.SetLeft(144);
        this.divLinkSet5.SetTop(0);
        this.divLinkSet5.SetWidth(32);
        this.divLinkSet5.SetHeight(277);
        this.divLinkSet5.SetElementClassName("order-3 d-flex flex-column gap-1");
        this.divLinkSet5.SetChildOrderEx(4);
        this.divLinkSet5.SetElementPosition(1);
        this.divLinkSet5.SetElementFont(1);
        this.divLinkSet5.SetRole("");
        this.linkTwitter.SetParentComponent(this.divLinkSet5);
        this.linkTwitter.SetName("linkTwitter");
        this.linkTwitter.SetLeft(0);
        this.linkTwitter.SetTop(175);
        this.linkTwitter.SetWidth(32);
        this.linkTwitter.SetHeight(32);
        this.linkTwitter.FMargins.SetLeft(0);
        this.linkTwitter.FMargins.SetTop(0);
        this.linkTwitter.FMargins.SetRight(0);
        this.linkTwitter.SetElementClassName("order-6 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkTwitter.SetChildOrderEx(1);
        this.linkTwitter.SetElementPosition(1);
        this.linkTwitter.SetElementFont(1);
        this.linkTwitter.FHTML.BeginUpdate();
        try {
          this.linkTwitter.FHTML.Clear();
          this.linkTwitter.FHTML.Add('<img style="padding:2px;" alt="Twitter Logo" src="img/twitter_icon.png" height=100% width=100%>');
        } finally {
          this.linkTwitter.FHTML.EndUpdate();
        };
        this.linkTwitter.SetRole("");
        this.linkInstagram.SetParentComponent(this.divLinkSet5);
        this.linkInstagram.SetName("linkInstagram");
        this.linkInstagram.SetLeft(0);
        this.linkInstagram.SetTop(140);
        this.linkInstagram.SetWidth(32);
        this.linkInstagram.SetHeight(32);
        this.linkInstagram.FMargins.SetLeft(0);
        this.linkInstagram.FMargins.SetTop(0);
        this.linkInstagram.FMargins.SetRight(0);
        this.linkInstagram.SetElementClassName("order-5 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkInstagram.SetChildOrderEx(2);
        this.linkInstagram.SetElementPosition(1);
        this.linkInstagram.SetElementFont(1);
        this.linkInstagram.FHTML.BeginUpdate();
        try {
          this.linkInstagram.FHTML.Clear();
          this.linkInstagram.FHTML.Add('<img style="padding:2px;" src="img/instagram_icon.png" height=100% width=100%>');
        } finally {
          this.linkInstagram.FHTML.EndUpdate();
        };
        this.linkInstagram.SetRole("");
        this.linkFacebook.SetParentComponent(this.divLinkSet5);
        this.linkFacebook.SetName("linkFacebook");
        this.linkFacebook.SetLeft(0);
        this.linkFacebook.SetTop(105);
        this.linkFacebook.SetWidth(32);
        this.linkFacebook.SetHeight(32);
        this.linkFacebook.FMargins.SetLeft(0);
        this.linkFacebook.FMargins.SetTop(0);
        this.linkFacebook.FMargins.SetRight(0);
        this.linkFacebook.SetElementClassName("order-4 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkFacebook.SetChildOrderEx(3);
        this.linkFacebook.SetElementPosition(1);
        this.linkFacebook.SetElementFont(1);
        this.linkFacebook.FHTML.BeginUpdate();
        try {
          this.linkFacebook.FHTML.Clear();
          this.linkFacebook.FHTML.Add('<img style="padding:2px;" alt="Facebook Logo" src="img/facebook_icon.png" height=100% width=100%>');
        } finally {
          this.linkFacebook.FHTML.EndUpdate();
        };
        this.linkFacebook.SetRole("");
        this.linkModels.SetParentComponent(this.divLinkSet5);
        this.linkModels.SetName("linkModels");
        this.linkModels.SetLeft(0);
        this.linkModels.SetTop(210);
        this.linkModels.SetWidth(32);
        this.linkModels.SetHeight(32);
        this.linkModels.FMargins.SetLeft(0);
        this.linkModels.FMargins.SetTop(0);
        this.linkModels.FMargins.SetRight(0);
        this.linkModels.SetElementClassName("order-7 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkModels.SetChildOrderEx(5);
        this.linkModels.SetElementPosition(1);
        this.linkModels.SetElementFont(1);
        this.linkModels.FHTML.BeginUpdate();
        try {
          this.linkModels.FHTML.Clear();
          this.linkModels.FHTML.Add('<img alt="Models.com Logo" style="padding:2px;" src="img/models_icon.png" height=100% width=100%>');
        } finally {
          this.linkModels.FHTML.EndUpdate();
        };
        this.linkModels.SetRole("");
        this.linkWikipedia.SetParentComponent(this.divLinkSet5);
        this.linkWikipedia.SetName("linkWikipedia");
        this.linkWikipedia.SetLeft(0);
        this.linkWikipedia.SetTop(70);
        this.linkWikipedia.SetWidth(32);
        this.linkWikipedia.SetHeight(32);
        this.linkWikipedia.FMargins.SetLeft(0);
        this.linkWikipedia.FMargins.SetTop(0);
        this.linkWikipedia.FMargins.SetRight(0);
        this.linkWikipedia.SetElementClassName("order-3 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkWikipedia.SetChildOrderEx(3);
        this.linkWikipedia.SetElementPosition(1);
        this.linkWikipedia.SetElementFont(1);
        this.linkWikipedia.FHTML.BeginUpdate();
        try {
          this.linkWikipedia.FHTML.Clear();
          this.linkWikipedia.FHTML.Add('<img style="padding:2px;" alt="Wikipedia Logo" src="img/wikipedia_icon.png" height=100% width=100%>');
        } finally {
          this.linkWikipedia.FHTML.EndUpdate();
        };
        this.linkWikipedia.SetRole("");
        this.linkHeight.SetParentComponent(this.divLinkSet5);
        this.linkHeight.SetName("linkHeight");
        this.linkHeight.SetLeft(0);
        this.linkHeight.SetTop(35);
        this.linkHeight.SetWidth(32);
        this.linkHeight.SetHeight(32);
        this.linkHeight.FMargins.SetLeft(0);
        this.linkHeight.FMargins.SetTop(0);
        this.linkHeight.FMargins.SetRight(0);
        this.linkHeight.SetElementClassName("order-2 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkHeight.SetChildOrderEx(5);
        this.linkHeight.SetElementPosition(1);
        this.linkHeight.SetElementFont(1);
        this.linkHeight.SetRole("");
        this.linkCitizenship.SetParentComponent(this.divLinkSet5);
        this.linkCitizenship.SetName("linkCitizenship");
        this.linkCitizenship.SetLeft(0);
        this.linkCitizenship.SetTop(0);
        this.linkCitizenship.SetWidth(32);
        this.linkCitizenship.SetHeight(32);
        this.linkCitizenship.FMargins.SetLeft(0);
        this.linkCitizenship.FMargins.SetTop(0);
        this.linkCitizenship.FMargins.SetRight(0);
        this.linkCitizenship.SetElementClassName("order-1 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkCitizenship.SetChildOrderEx(5);
        this.linkCitizenship.SetElementPosition(1);
        this.linkCitizenship.SetElementFont(1);
        this.linkCitizenship.SetRole("");
        this.linkShare.SetParentComponent(this.divLinkSet5);
        this.linkShare.SetName("linkShare");
        this.linkShare.SetLeft(0);
        this.linkShare.SetTop(245);
        this.linkShare.SetWidth(32);
        this.linkShare.SetHeight(32);
        this.linkShare.SetControlCursor(21);
        this.linkShare.FMargins.SetLeft(0);
        this.linkShare.FMargins.SetTop(0);
        this.linkShare.FMargins.SetRight(0);
        this.linkShare.SetElementClassName("order-8 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkShare.SetChildOrderEx(5);
        this.linkShare.SetElementPosition(1);
        this.linkShare.SetElementFont(1);
        this.linkShare.FHTML.BeginUpdate();
        try {
          this.linkShare.FHTML.Clear();
          this.linkShare.FHTML.Add('<div style="padding:2px 3px;color:var(--bs-gray-200);"><i class="fa-duotone fa-share-all fa-lg"></i></div>');
        } finally {
          this.linkShare.FHTML.EndUpdate();
        };
        this.linkShare.SetRole("");
        this.divLinkSet3.SetParentComponent(this.divTopButtons);
        this.divLinkSet3.SetName("divLinkSet3");
        this.divLinkSet3.SetLeft(72);
        this.divLinkSet3.SetTop(1);
        this.divLinkSet3.SetWidth(32);
        this.divLinkSet3.SetHeight(277);
        this.divLinkSet3.FMargins.SetLeft(2);
        this.divLinkSet3.FMargins.SetTop(0);
        this.divLinkSet3.FMargins.SetRight(1);
        this.divLinkSet3.FMargins.SetBottom(0);
        this.divLinkSet3.SetElementClassName("order-2 d-flex flex-column gap-1");
        this.divLinkSet3.SetChildOrderEx(4);
        this.divLinkSet3.SetElementPosition(1);
        this.divLinkSet3.SetElementFont(1);
        this.divLinkSet3.SetRole("");
        this.WebHTMLDiv3.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv3.SetName("WebHTMLDiv3");
        this.WebHTMLDiv3.SetLeft(0);
        this.WebHTMLDiv3.SetTop(175);
        this.WebHTMLDiv3.SetWidth(32);
        this.WebHTMLDiv3.SetHeight(32);
        this.WebHTMLDiv3.FMargins.SetLeft(0);
        this.WebHTMLDiv3.FMargins.SetTop(0);
        this.WebHTMLDiv3.FMargins.SetRight(0);
        this.WebHTMLDiv3.SetElementClassName("order-6 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv3.SetChildOrderEx(1);
        this.WebHTMLDiv3.SetElementPosition(1);
        this.WebHTMLDiv3.SetElementFont(1);
        this.WebHTMLDiv3.SetRole("");
        this.WebHTMLDiv6.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv6.SetName("WebHTMLDiv6");
        this.WebHTMLDiv6.SetLeft(0);
        this.WebHTMLDiv6.SetTop(140);
        this.WebHTMLDiv6.SetWidth(32);
        this.WebHTMLDiv6.SetHeight(32);
        this.WebHTMLDiv6.FMargins.SetLeft(0);
        this.WebHTMLDiv6.FMargins.SetTop(0);
        this.WebHTMLDiv6.FMargins.SetRight(0);
        this.WebHTMLDiv6.SetElementClassName("order-5 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv6.SetChildOrderEx(2);
        this.WebHTMLDiv6.SetElementPosition(1);
        this.WebHTMLDiv6.SetElementFont(1);
        this.WebHTMLDiv6.SetRole("");
        this.WebHTMLDiv8.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv8.SetName("WebHTMLDiv8");
        this.WebHTMLDiv8.SetLeft(-2);
        this.WebHTMLDiv8.SetTop(105);
        this.WebHTMLDiv8.SetWidth(32);
        this.WebHTMLDiv8.SetHeight(32);
        this.WebHTMLDiv8.FMargins.SetLeft(0);
        this.WebHTMLDiv8.FMargins.SetTop(0);
        this.WebHTMLDiv8.FMargins.SetRight(0);
        this.WebHTMLDiv8.SetElementClassName("order-4  opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv8.SetChildOrderEx(3);
        this.WebHTMLDiv8.SetElementPosition(1);
        this.WebHTMLDiv8.SetElementFont(1);
        this.WebHTMLDiv8.SetRole("");
        this.WebHTMLDiv9.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv9.SetName("WebHTMLDiv9");
        this.WebHTMLDiv9.SetLeft(0);
        this.WebHTMLDiv9.SetTop(210);
        this.WebHTMLDiv9.SetWidth(32);
        this.WebHTMLDiv9.SetHeight(32);
        this.WebHTMLDiv9.FMargins.SetLeft(0);
        this.WebHTMLDiv9.FMargins.SetTop(0);
        this.WebHTMLDiv9.FMargins.SetRight(0);
        this.WebHTMLDiv9.SetElementClassName("order-7 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv9.SetChildOrderEx(5);
        this.WebHTMLDiv9.SetElementPosition(1);
        this.WebHTMLDiv9.SetElementFont(1);
        this.WebHTMLDiv9.SetRole("");
        this.WebHTMLDiv10.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv10.SetName("WebHTMLDiv10");
        this.WebHTMLDiv10.SetLeft(0);
        this.WebHTMLDiv10.SetTop(70);
        this.WebHTMLDiv10.SetWidth(32);
        this.WebHTMLDiv10.SetHeight(32);
        this.WebHTMLDiv10.FMargins.SetLeft(0);
        this.WebHTMLDiv10.FMargins.SetTop(0);
        this.WebHTMLDiv10.FMargins.SetRight(0);
        this.WebHTMLDiv10.SetElementClassName("order-3 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv10.SetChildOrderEx(3);
        this.WebHTMLDiv10.SetElementPosition(1);
        this.WebHTMLDiv10.SetElementFont(1);
        this.WebHTMLDiv10.SetRole("");
        this.WebHTMLDiv11.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv11.SetName("WebHTMLDiv11");
        this.WebHTMLDiv11.SetLeft(0);
        this.WebHTMLDiv11.SetTop(35);
        this.WebHTMLDiv11.SetWidth(32);
        this.WebHTMLDiv11.SetHeight(32);
        this.WebHTMLDiv11.FMargins.SetLeft(0);
        this.WebHTMLDiv11.FMargins.SetTop(0);
        this.WebHTMLDiv11.FMargins.SetRight(0);
        this.WebHTMLDiv11.SetElementClassName("order-2 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv11.SetChildOrderEx(5);
        this.WebHTMLDiv11.SetElementPosition(1);
        this.WebHTMLDiv11.SetElementFont(1);
        this.WebHTMLDiv11.SetRole("");
        this.WebHTMLDiv14.SetParentComponent(this.divLinkSet3);
        this.WebHTMLDiv14.SetName("WebHTMLDiv14");
        this.WebHTMLDiv14.SetLeft(0);
        this.WebHTMLDiv14.SetTop(0);
        this.WebHTMLDiv14.SetWidth(32);
        this.WebHTMLDiv14.SetHeight(32);
        this.WebHTMLDiv14.FMargins.SetLeft(0);
        this.WebHTMLDiv14.FMargins.SetTop(0);
        this.WebHTMLDiv14.FMargins.SetRight(0);
        this.WebHTMLDiv14.SetElementClassName("order-1 opacity-25 bg-dark border  border-secondary rounded overflow-hidden");
        this.WebHTMLDiv14.SetChildOrderEx(5);
        this.WebHTMLDiv14.SetElementPosition(1);
        this.WebHTMLDiv14.SetElementFont(1);
        this.WebHTMLDiv14.SetRole("");
        this.linkPizza.SetParentComponent(this.divLinkSet3);
        this.linkPizza.SetName("linkPizza");
        this.linkPizza.SetLeft(1);
        this.linkPizza.SetTop(245);
        this.linkPizza.SetWidth(32);
        this.linkPizza.SetHeight(32);
        this.linkPizza.SetControlCursor(21);
        this.linkPizza.FMargins.SetLeft(0);
        this.linkPizza.FMargins.SetTop(0);
        this.linkPizza.FMargins.SetRight(0);
        this.linkPizza.SetElementClassName("order-8 bg-dark border  border-secondary rounded overflow-hidden");
        this.linkPizza.SetChildOrderEx(5);
        this.linkPizza.SetElementPosition(1);
        this.linkPizza.SetElementFont(1);
        this.linkPizza.FHTML.BeginUpdate();
        try {
          this.linkPizza.FHTML.Clear();
          this.linkPizza.FHTML.Add('<a href="https://www.buymeacoffee.com/andrewsimard500" style="text-decoration:none;" target="_blank" aria-label="Buy Me a Pizza">');
          this.linkPizza.FHTML.Add('  <img style="padding:2px;" alt="Pizza" src="img/pizza_promo_icon.png" height=100% width=100%>');
          this.linkPizza.FHTML.Add("</a>");
        } finally {
          this.linkPizza.FHTML.EndUpdate();
        };
        this.linkPizza.SetRole("");
        this.divPhotoHolder.SetParentComponent(this.divTop);
        this.divPhotoHolder.SetName("divPhotoHolder");
        this.divPhotoHolder.SetLeft(217);
        this.divPhotoHolder.SetTop(3);
        this.divPhotoHolder.SetWidth(185);
        this.divPhotoHolder.SetHeight(277);
        this.divPhotoHolder.SetElementClassName("order-1");
        this.divPhotoHolder.SetChildOrderEx(7);
        this.divPhotoHolder.SetElementPosition(1);
        this.divPhotoHolder.SetElementFont(1);
        this.divPhotoHolder.SetRole("");
        this.divPhoto.SetParentComponent(this.divPhotoHolder);
        this.divPhoto.SetName("divPhoto");
        this.divPhoto.SetLeft(0);
        this.divPhoto.SetTop(0);
        this.divPhoto.SetWidth(185);
        this.divPhoto.SetHeight(277);
        this.divPhoto.SetControlCursor(21);
        this.divPhoto.FMargins.SetLeft(2);
        this.divPhoto.FMargins.SetTop(0);
        this.divPhoto.FMargins.SetRight(1);
        this.divPhoto.FMargins.SetBottom(0);
        this.divPhoto.SetElementClassName("order-1 bg-dark border  border-0 rounded overflow-hidden");
        this.divPhoto.SetChildOrderEx(1);
        this.divPhoto.SetElementFont(1);
        this.divPhoto.SetRole("");
        this.SetEvent$1(this.divPhoto,this,"OnClick","divPhotoClick");
        this.divProgressSpinner.SetParentComponent(this.divPhotoHolder);
        this.divProgressSpinner.SetName("divProgressSpinner");
        this.divProgressSpinner.SetLeft(53);
        this.divProgressSpinner.SetTop(10);
        this.divProgressSpinner.SetWidth(185);
        this.divProgressSpinner.SetHeight(185);
        this.divProgressSpinner.SetElementClassName("bg-none border border-0 pe-none");
        this.divProgressSpinner.SetHeightStyle(2);
        this.divProgressSpinner.SetWidthStyle(2);
        this.divProgressSpinner.SetChildOrderEx(9);
        this.divProgressSpinner.SetElementPosition(2);
        this.divProgressSpinner.SetElementFont(1);
        this.divProgressSpinner.FHTML.BeginUpdate();
        try {
          this.divProgressSpinner.FHTML.Clear();
          this.divProgressSpinner.FHTML.Add('<div style="width:100%; height:100%; font-size:11em; color:var(--bs-danger); opacity:0.75; text-align: center;"><i class="fa-regular fa-loader fa-spin"></i></div>');
        } finally {
          this.divProgressSpinner.FHTML.EndUpdate();
        };
        this.divProgressSpinner.SetRole("");
        this.divPhotoBorder.SetParentComponent(this.divPhotoHolder);
        this.divPhotoBorder.SetName("divPhotoBorder");
        this.divPhotoBorder.SetLeft(-1);
        this.divPhotoBorder.SetTop(0);
        this.divPhotoBorder.SetWidth(185);
        this.divPhotoBorder.SetHeight(277);
        this.divPhotoBorder.SetElementClassName("rounded border border-secondary pe-none bg-none");
        this.divPhotoBorder.SetChildOrderEx(6);
        this.divPhotoBorder.SetElementFont(1);
        this.divPhotoBorder.SetRole("");
        this.divProgress.SetParentComponent(this.divPhotoHolder);
        this.divProgress.SetName("divProgress");
        this.divProgress.SetLeft(-3);
        this.divProgress.SetTop(103);
        this.divProgress.SetWidth(185);
        this.divProgress.SetHeight(63);
        this.divProgress.SetElementClassName("bg-danger rounded  opacity-50");
        this.divProgress.SetHeightStyle(2);
        this.divProgress.SetWidthStyle(2);
        this.divProgress.SetChildOrderEx(6);
        this.divProgress.SetElementPosition(2);
        this.divProgress.SetElementFont(1);
        this.divProgress.SetRole("");
        this.divBlock.SetParentComponent(this);
        this.divBlock.SetName("divBlock");
        this.divBlock.SetLeft(21);
        this.divBlock.SetTop(352);
        this.divBlock.SetWidth(313);
        this.divBlock.SetHeight(281);
        this.divBlock.SetElementClassName("d-none");
        this.divBlock.SetHeightStyle(0);
        this.divBlock.SetWidthStyle(0);
        this.divBlock.SetChildOrderEx(3);
        this.divBlock.SetElementFont(1);
        this.divBlock.SetRole("");
        this.SetEvent$1(this.divBlock,this,"OnClick","divViewerHolderClick");
        this.divViewerHolder.SetParentComponent(this);
        this.divViewerHolder.SetName("divViewerHolder");
        this.divViewerHolder.SetLeft(443);
        this.divViewerHolder.SetTop(400);
        this.divViewerHolder.SetWidth(478);
        this.divViewerHolder.SetHeight(281);
        this.divViewerHolder.SetControlCursor(21);
        this.divViewerHolder.SetElementClassName("divViewerHolder rounded bg-dark border border-secondary d-none overflow-hidden");
        this.divViewerHolder.SetChildOrderEx(3);
        this.divViewerHolder.SetElementFont(1);
        this.divViewerHolder.FHTML.BeginUpdate();
        try {
          this.divViewerHolder.FHTML.Clear();
          this.divViewerHolder.FHTML.Add('<div id="divViewer" class="rounded overflow-hidden" style="width: 100%; height:100%;"></div>');
        } finally {
          this.divViewerHolder.FHTML.EndUpdate();
        };
        this.divViewerHolder.SetRole("");
        this.SetEvent$1(this.divViewerHolder,this,"OnClick","divViewerHolderClick");
        this.divBlockControls.SetParentComponent(this);
        this.divBlockControls.SetName("divBlockControls");
        this.divBlockControls.SetLeft(340);
        this.divBlockControls.SetTop(352);
        this.divBlockControls.SetWidth(48);
        this.divBlockControls.SetHeight(288);
        this.divBlockControls.SetElementClassName("d-none flex-column justify-content-center align-items-end");
        this.divBlockControls.SetChildOrderEx(6);
        this.divBlockControls.SetElementPosition(2);
        this.divBlockControls.SetElementFont(1);
        this.divBlockControls.SetRole("");
        this.btnBlockClose.SetParentComponent(this.divBlockControls);
        this.btnBlockClose.SetName("btnBlockClose");
        this.btnBlockClose.SetLeft(0);
        this.btnBlockClose.SetTop(240);
        this.btnBlockClose.SetWidth(48);
        this.btnBlockClose.SetHeight(48);
        this.btnBlockClose.SetControlCursor(21);
        this.btnBlockClose.SetAlign(2);
        this.btnBlockClose.SetCaption('<i class="fa-duotone fa-circle-xmark fa-2x text-white opacity-75"> </i>');
        this.btnBlockClose.SetChildOrderEx(5);
        this.btnBlockClose.SetElementClassName("btn btn-link");
        this.btnBlockClose.SetElementFont(1);
        this.btnBlockClose.SetElementPosition(1);
        this.btnBlockClose.SetHeightPercent(100.000000000000000000);
        this.btnBlockClose.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockClose,this,"OnClick","divViewerHolderClick");
        this.btnBlockZoomReset.SetParentComponent(this.divBlockControls);
        this.btnBlockZoomReset.SetName("btnBlockZoomReset");
        this.btnBlockZoomReset.SetLeft(0);
        this.btnBlockZoomReset.SetTop(192);
        this.btnBlockZoomReset.SetWidth(48);
        this.btnBlockZoomReset.SetHeight(48);
        this.btnBlockZoomReset.SetControlCursor(21);
        this.btnBlockZoomReset.SetAlign(2);
        this.btnBlockZoomReset.SetCaption('<i class="fa-duotone fa-circle-dot fa-2x text-white opacity-75"> </i>');
        this.btnBlockZoomReset.SetChildOrderEx(4);
        this.btnBlockZoomReset.SetElementClassName("btn btn-link ");
        this.btnBlockZoomReset.SetElementFont(1);
        this.btnBlockZoomReset.SetElementPosition(1);
        this.btnBlockZoomReset.SetHeightPercent(100.000000000000000000);
        this.btnBlockZoomReset.SetTabOrder(1);
        this.btnBlockZoomReset.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockZoomReset,this,"OnClick","btnBlockZoomResetClick");
        this.btnBlockZoomPlus.SetParentComponent(this.divBlockControls);
        this.btnBlockZoomPlus.SetName("btnBlockZoomPlus");
        this.btnBlockZoomPlus.SetLeft(0);
        this.btnBlockZoomPlus.SetTop(96);
        this.btnBlockZoomPlus.SetWidth(48);
        this.btnBlockZoomPlus.SetHeight(48);
        this.btnBlockZoomPlus.SetControlCursor(21);
        this.btnBlockZoomPlus.SetAlign(2);
        this.btnBlockZoomPlus.SetCaption('<i class="fa-duotone fa-magnifying-glass-plus fa-2x text-white opacity-75"> </i>');
        this.btnBlockZoomPlus.SetChildOrderEx(2);
        this.btnBlockZoomPlus.SetElementClassName("btn btn-link");
        this.btnBlockZoomPlus.SetElementFont(1);
        this.btnBlockZoomPlus.SetElementPosition(1);
        this.btnBlockZoomPlus.SetHeightPercent(100.000000000000000000);
        this.btnBlockZoomPlus.SetTabOrder(2);
        this.btnBlockZoomPlus.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockZoomPlus,this,"OnClick","btnBlockZoomPlusClick");
        this.btnBlockZoomMinus.SetParentComponent(this.divBlockControls);
        this.btnBlockZoomMinus.SetName("btnBlockZoomMinus");
        this.btnBlockZoomMinus.SetLeft(0);
        this.btnBlockZoomMinus.SetTop(144);
        this.btnBlockZoomMinus.SetWidth(48);
        this.btnBlockZoomMinus.SetHeight(48);
        this.btnBlockZoomMinus.SetControlCursor(21);
        this.btnBlockZoomMinus.SetAlign(2);
        this.btnBlockZoomMinus.SetCaption('<i class="fa-duotone fa-magnifying-glass-minus fa-2x text-white opacity-75"> </i>');
        this.btnBlockZoomMinus.SetChildOrderEx(3);
        this.btnBlockZoomMinus.SetElementClassName("btn btn-link");
        this.btnBlockZoomMinus.SetElementFont(1);
        this.btnBlockZoomMinus.SetElementPosition(1);
        this.btnBlockZoomMinus.SetHeightPercent(100.000000000000000000);
        this.btnBlockZoomMinus.SetTabOrder(3);
        this.btnBlockZoomMinus.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockZoomMinus,this,"OnClick","btnBlockZoomMinusClick");
        this.btnBlockPrevious.SetParentComponent(this.divBlockControls);
        this.btnBlockPrevious.SetName("btnBlockPrevious");
        this.btnBlockPrevious.SetLeft(0);
        this.btnBlockPrevious.SetTop(0);
        this.btnBlockPrevious.SetWidth(48);
        this.btnBlockPrevious.SetHeight(48);
        this.btnBlockPrevious.SetControlCursor(21);
        this.btnBlockPrevious.SetAlign(2);
        this.btnBlockPrevious.SetCaption('<i class="fa-duotone fa-circle-arrow-up fa-2x text-white opacity-75"> </i>');
        this.btnBlockPrevious.SetElementClassName("btn btn-link");
        this.btnBlockPrevious.SetElementFont(1);
        this.btnBlockPrevious.SetElementPosition(1);
        this.btnBlockPrevious.SetHeightStyle(2);
        this.btnBlockPrevious.SetHeightPercent(100.000000000000000000);
        this.btnBlockPrevious.SetTabOrder(4);
        this.btnBlockPrevious.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockPrevious,this,"OnClick","btnBlockPreviousClick");
        this.btnBlockNext.SetParentComponent(this.divBlockControls);
        this.btnBlockNext.SetName("btnBlockNext");
        this.btnBlockNext.SetLeft(0);
        this.btnBlockNext.SetTop(48);
        this.btnBlockNext.SetWidth(48);
        this.btnBlockNext.SetHeight(48);
        this.btnBlockNext.SetControlCursor(21);
        this.btnBlockNext.SetAlign(2);
        this.btnBlockNext.SetCaption('<i class="fa-duotone fa-circle-arrow-down fa-2x text-white opacity-75"> </i>');
        this.btnBlockNext.SetChildOrderEx(1);
        this.btnBlockNext.SetElementClassName("btn btn-link");
        this.btnBlockNext.SetElementFont(1);
        this.btnBlockNext.SetElementPosition(1);
        this.btnBlockNext.SetHeightStyle(2);
        this.btnBlockNext.SetHeightPercent(100.000000000000000000);
        this.btnBlockNext.SetTabOrder(5);
        this.btnBlockNext.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockNext,this,"OnClick","btnBlockNextClick");
        this.divBlockData.SetParentComponent(this);
        this.divBlockData.SetName("divBlockData");
        this.divBlockData.SetLeft(394);
        this.divBlockData.SetTop(352);
        this.divBlockData.SetWidth(75);
        this.divBlockData.SetHeight(144);
        this.divBlockData.SetElementClassName("d-none flex-column justify-content-center ");
        this.divBlockData.SetChildOrderEx(6);
        this.divBlockData.SetElementPosition(2);
        this.divBlockData.SetElementFont(1);
        this.divBlockData.SetRole("");
        this.btnBlockCount.SetParentComponent(this.divBlockData);
        this.btnBlockCount.SetName("btnBlockCount");
        this.btnBlockCount.SetLeft(0);
        this.btnBlockCount.SetTop(0);
        this.btnBlockCount.SetWidth(80);
        this.btnBlockCount.SetHeight(44);
        this.btnBlockCount.FMargins.SetLeft(7);
        this.btnBlockCount.FMargins.SetTop(0);
        this.btnBlockCount.FMargins.SetRight(0);
        this.btnBlockCount.FMargins.SetBottom(0);
        this.btnBlockCount.SetCaption("1");
        this.btnBlockCount.SetChildOrderEx(1);
        this.btnBlockCount.SetElementClassName("fs-4 btn btn-link text-decoration-none text-white opacity-75");
        this.btnBlockCount.SetElementFont(1);
        this.btnBlockCount.SetHeightPercent(100.000000000000000000);
        this.btnBlockCount.SetTabOrder(4);
        this.btnBlockCount.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockCount,this,"OnClick","divViewerHolderClick");
        this.btnBlockLine.SetParentComponent(this.divBlockData);
        this.btnBlockLine.SetName("btnBlockLine");
        this.btnBlockLine.SetLeft(0);
        this.btnBlockLine.SetTop(22);
        this.btnBlockLine.SetWidth(80);
        this.btnBlockLine.SetHeight(24);
        this.btnBlockLine.SetCaption('<i class="fa-duotone fa-horizontal-rule fa-2x text-white opacity-75"> </i>');
        this.btnBlockLine.SetElementClassName("btn btn-link pe-none mb-3");
        this.btnBlockLine.SetElementFont(1);
        this.btnBlockLine.SetHeightPercent(100.000000000000000000);
        this.btnBlockLine.SetTabOrder(5);
        this.btnBlockLine.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockLine,this,"OnClick","divViewerHolderClick");
        this.btnBlockTotal.SetParentComponent(this.divBlockData);
        this.btnBlockTotal.SetName("btnBlockTotal");
        this.btnBlockTotal.SetLeft(0);
        this.btnBlockTotal.SetTop(40);
        this.btnBlockTotal.SetWidth(80);
        this.btnBlockTotal.SetHeight(44);
        this.btnBlockTotal.FMargins.SetLeft(7);
        this.btnBlockTotal.FMargins.SetTop(0);
        this.btnBlockTotal.FMargins.SetRight(0);
        this.btnBlockTotal.FMargins.SetBottom(0);
        this.btnBlockTotal.SetCaption("1");
        this.btnBlockTotal.SetChildOrderEx(2);
        this.btnBlockTotal.SetElementClassName("fs-4 btn btn-link text-decoration-none text-white opacity-75");
        this.btnBlockTotal.SetElementFont(1);
        this.btnBlockTotal.SetHeightPercent(100.000000000000000000);
        this.btnBlockTotal.SetTabOrder(2);
        this.btnBlockTotal.SetWidthPercent(100.000000000000000000);
        this.SetEvent$1(this.btnBlockTotal,this,"OnClick","divViewerHolderClick");
        this.tmrFocus.SetParentComponent(this);
        this.tmrFocus.SetName("tmrFocus");
        this.tmrFocus.SetEnabled(false);
        this.tmrFocus.SetInterval(100);
        this.SetEvent$1(this.tmrFocus,this,"OnTimer","tmrFocusTimer");
        this.tmrFocus.SetLeft(272);
        this.tmrFocus.SetTop(12);
        this.tmrStart.SetParentComponent(this);
        this.tmrStart.SetName("tmrStart");
        this.tmrStart.SetEnabled(false);
        this.tmrStart.SetInterval(10);
        this.SetEvent$1(this.tmrStart,this,"OnTimer","tmrStartTimer");
        this.tmrStart.SetLeft(272);
        this.tmrStart.SetTop(68);
        this.tmrSearch.SetParentComponent(this);
        this.tmrSearch.SetName("tmrSearch");
        this.tmrSearch.SetEnabled(false);
        this.tmrSearch.SetInterval(500);
        this.SetEvent$1(this.tmrSearch,this,"OnTimer","tmrSearchTimer");
        this.tmrSearch.SetLeft(268);
        this.tmrSearch.SetTop(124);
        this.tmrImageCheck.SetParentComponent(this);
        this.tmrImageCheck.SetName("tmrImageCheck");
        this.tmrImageCheck.SetInterval(500);
        this.SetEvent$1(this.tmrImageCheck,this,"OnTimer","tmrImageCheckTimer");
        this.tmrImageCheck.SetLeft(268);
        this.tmrImageCheck.SetTop(188);
        this.WebHttpRequest1.SetParentComponent(this);
        this.WebHttpRequest1.SetName("WebHttpRequest1");
        this.WebHttpRequest1.FHeaders.BeginUpdate();
        try {
          this.WebHttpRequest1.FHeaders.Clear();
          this.WebHttpRequest1.FHeaders.Add("Cache-Control=no-cache, no-store, must-revalidate");
        } finally {
          this.WebHttpRequest1.FHeaders.EndUpdate();
        };
        this.WebHttpRequest1.SetLeft(491);
        this.WebHttpRequest1.SetTop(350);
      } finally {
        this.divBottom.AfterLoadDFMValues();
        this.divActorTabulatorHolder.AfterLoadDFMValues();
        this.divRoleTabulatorHolder.AfterLoadDFMValues();
        this.divTop.AfterLoadDFMValues();
        this.divInfo.AfterLoadDFMValues();
        this.divInfoPages.AfterLoadDFMValues();
        this.pageBio.AfterLoadDFMValues();
        this.divBiography.AfterLoadDFMValues();
        this.pageAbout.AfterLoadDFMValues();
        this.divAbout.AfterLoadDFMValues();
        this.pagePhotos.AfterLoadDFMValues();
        this.divPhotoSlider.AfterLoadDFMValues();
        this.pageVideos.AfterLoadDFMValues();
        this.divVideoSlider.AfterLoadDFMValues();
        this.pageBackgrounds.AfterLoadDFMValues();
        this.divBackgroundSlider.AfterLoadDFMValues();
        this.pageConnect.AfterLoadDFMValues();
        this.btnRelatives.AfterLoadDFMValues();
        this.pageDiscord.AfterLoadDFMValues();
        this.lblSupport.AfterLoadDFMValues();
        this.btnDiscordLaunch.AfterLoadDFMValues();
        this.pageSettings.AfterLoadDFMValues();
        this.divSettings.AfterLoadDFMValues();
        this.divSettingsPersonRequests.AfterLoadDFMValues();
        this.lblLimitData.AfterLoadDFMValues();
        this.switchLimitData.AfterLoadDFMValues();
        this.divSettingsTopRequests.AfterLoadDFMValues();
        this.lblLimitDataTop.AfterLoadDFMValues();
        this.switchLimitDataTop.AfterLoadDFMValues();
        this.divSettingsSearch.AfterLoadDFMValues();
        this.lblQuickSearch.AfterLoadDFMValues();
        this.switchSearch.AfterLoadDFMValues();
        this.divButtons.AfterLoadDFMValues();
        this.divButtonHolder.AfterLoadDFMValues();
        this.btnBio.AfterLoadDFMValues();
        this.btnPhoto.AfterLoadDFMValues();
        this.btnVideo.AfterLoadDFMValues();
        this.btnConnect.AfterLoadDFMValues();
        this.btnBackground.AfterLoadDFMValues();
        this.btnSettings.AfterLoadDFMValues();
        this.btnAbout.AfterLoadDFMValues();
        this.btnDiscord.AfterLoadDFMValues();
        this.divMain.AfterLoadDFMValues();
        this.divMainHolder.AfterLoadDFMValues();
        this.divLogo.AfterLoadDFMValues();
        this.divBirthdayNav.AfterLoadDFMValues();
        this.divBirthDay.AfterLoadDFMValues();
        this.divPrevBirthDay.AfterLoadDFMValues();
        this.divNextBirthDay.AfterLoadDFMValues();
        this.divAttribution.AfterLoadDFMValues();
        this.divDepartedNav.AfterLoadDFMValues();
        this.divDeathDay.AfterLoadDFMValues();
        this.divPrevDeathDay.AfterLoadDFMValues();
        this.divNextDeathDay.AfterLoadDFMValues();
        this.divReleaseNav.AfterLoadDFMValues();
        this.divReleaseDay.AfterLoadDFMValues();
        this.divPrevReleaseDay.AfterLoadDFMValues();
        this.divNextReleaseDay.AfterLoadDFMValues();
        this.divTop100Nav.AfterLoadDFMValues();
        this.btnTop1000.AfterLoadDFMValues();
        this.divPeopleNav.AfterLoadDFMValues();
        this.btnActors.AfterLoadDFMValues();
        this.btnDirectors.AfterLoadDFMValues();
        this.btnWriters.AfterLoadDFMValues();
        this.divSearchNav.AfterLoadDFMValues();
        this.edtSearch.AfterLoadDFMValues();
        this.btnSearch.AfterLoadDFMValues();
        this.divTopButtons.AfterLoadDFMValues();
        this.divLinkSet1.AfterLoadDFMValues();
        this.WebHTMLDiv4.AfterLoadDFMValues();
        this.WebHTMLDiv5.AfterLoadDFMValues();
        this.linkFavourite.AfterLoadDFMValues();
        this.WebHTMLDiv7.AfterLoadDFMValues();
        this.linkLoading.AfterLoadDFMValues();
        this.linkLogin.AfterLoadDFMValues();
        this.WebHTMLDiv12.AfterLoadDFMValues();
        this.WebHTMLDiv13.AfterLoadDFMValues();
        this.divLinkSet2.AfterLoadDFMValues();
        this.linkList4.AfterLoadDFMValues();
        this.linkList3.AfterLoadDFMValues();
        this.linkList2.AfterLoadDFMValues();
        this.linkTour.AfterLoadDFMValues();
        this.linkLink.AfterLoadDFMValues();
        this.linkList1.AfterLoadDFMValues();
        this.linkEMail.AfterLoadDFMValues();
        this.linkRating.AfterLoadDFMValues();
        this.divLinkSet4.AfterLoadDFMValues();
        this.linkWikiData.AfterLoadDFMValues();
        this.linkScore.AfterLoadDFMValues();
        this.linkTMDb.AfterLoadDFMValues();
        this.linkRottenTomatoes.AfterLoadDFMValues();
        this.linkMetaCritic.AfterLoadDFMValues();
        this.linkIMDb.AfterLoadDFMValues();
        this.linkWeb.AfterLoadDFMValues();
        this.linkGoogleImageSearch.AfterLoadDFMValues();
        this.divLinkSet5.AfterLoadDFMValues();
        this.linkTwitter.AfterLoadDFMValues();
        this.linkInstagram.AfterLoadDFMValues();
        this.linkFacebook.AfterLoadDFMValues();
        this.linkModels.AfterLoadDFMValues();
        this.linkWikipedia.AfterLoadDFMValues();
        this.linkHeight.AfterLoadDFMValues();
        this.linkCitizenship.AfterLoadDFMValues();
        this.linkShare.AfterLoadDFMValues();
        this.divLinkSet3.AfterLoadDFMValues();
        this.WebHTMLDiv3.AfterLoadDFMValues();
        this.WebHTMLDiv6.AfterLoadDFMValues();
        this.WebHTMLDiv8.AfterLoadDFMValues();
        this.WebHTMLDiv9.AfterLoadDFMValues();
        this.WebHTMLDiv10.AfterLoadDFMValues();
        this.WebHTMLDiv11.AfterLoadDFMValues();
        this.WebHTMLDiv14.AfterLoadDFMValues();
        this.linkPizza.AfterLoadDFMValues();
        this.divPhotoHolder.AfterLoadDFMValues();
        this.divPhoto.AfterLoadDFMValues();
        this.divProgressSpinner.AfterLoadDFMValues();
        this.divPhotoBorder.AfterLoadDFMValues();
        this.divProgress.AfterLoadDFMValues();
        this.divBlock.AfterLoadDFMValues();
        this.divViewerHolder.AfterLoadDFMValues();
        this.divBlockControls.AfterLoadDFMValues();
        this.btnBlockClose.AfterLoadDFMValues();
        this.btnBlockZoomReset.AfterLoadDFMValues();
        this.btnBlockZoomPlus.AfterLoadDFMValues();
        this.btnBlockZoomMinus.AfterLoadDFMValues();
        this.btnBlockPrevious.AfterLoadDFMValues();
        this.btnBlockNext.AfterLoadDFMValues();
        this.divBlockData.AfterLoadDFMValues();
        this.btnBlockCount.AfterLoadDFMValues();
        this.btnBlockLine.AfterLoadDFMValues();
        this.btnBlockTotal.AfterLoadDFMValues();
        this.tmrFocus.AfterLoadDFMValues();
        this.tmrStart.AfterLoadDFMValues();
        this.tmrSearch.AfterLoadDFMValues();
        this.tmrImageCheck.AfterLoadDFMValues();
        this.WebHttpRequest1.AfterLoadDFMValues();
      };
    };
    rtl.addIntf(this,pas.System.IUnknown);
    var $r = this.$rtti;
    $r.addField("divTop",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divMain",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divInfo",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divInfoPages",pas["WEBLib.ComCtrls"].$rtti["TPageControl"]);
    $r.addField("pageBio",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("divBiography",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divBottom",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divActorTabulatorHolder",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divRoleTabulatorHolder",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divButtons",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divButtonHolder",pas["WEBLib.ExtCtrls"].$rtti["TPanel"]);
    $r.addField("btnBio",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnPhoto",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnVideo",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnConnect",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("divMainHolder",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divViewerHolder",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divLogo",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divBirthdayNav",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divBirthDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divPrevBirthDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divNextBirthDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divBlock",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("btnBackground",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("divAttribution",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("pageAbout",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("divAbout",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("pagePhotos",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("pageVideos",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("pageBackgrounds",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("pageConnect",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("divDepartedNav",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divDeathDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divPrevDeathDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divNextDeathDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divReleaseNav",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divReleaseDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divPrevReleaseDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divNextReleaseDay",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divTop100Nav",pas["WEBLib.ExtCtrls"].$rtti["TPanel"]);
    $r.addField("btnTop1000",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("divPeopleNav",pas["WEBLib.ExtCtrls"].$rtti["TPanel"]);
    $r.addField("btnActors",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnDirectors",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnWriters",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnSettings",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnAbout",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("divSearchNav",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("edtSearch",pas["WEBLib.StdCtrls"].$rtti["TEdit"]);
    $r.addField("tmrFocus",pas["WEBLib.ExtCtrls"].$rtti["TTimer"]);
    $r.addField("tmrStart",pas["WEBLib.ExtCtrls"].$rtti["TTimer"]);
    $r.addField("btnDiscord",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("pageDiscord",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("btnDiscordLaunch",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("lblSupport",pas["WEBLib.StdCtrls"].$rtti["TLabel"]);
    $r.addField("pageSettings",pas["WEBLib.ComCtrls"].$rtti["TTabSheet"]);
    $r.addField("divSettings",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divSettingsPersonRequests",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("lblLimitData",pas["WEBLib.StdCtrls"].$rtti["TLabel"]);
    $r.addField("switchLimitData",pas["WEBLib.Buttons"].$rtti["TToggleButton"]);
    $r.addField("divSettingsTopRequests",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("lblLimitDataTop",pas["WEBLib.StdCtrls"].$rtti["TLabel"]);
    $r.addField("switchLimitDataTop",pas["WEBLib.Buttons"].$rtti["TToggleButton"]);
    $r.addField("tmrSearch",pas["WEBLib.ExtCtrls"].$rtti["TTimer"]);
    $r.addField("divSettingsSearch",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("lblQuickSearch",pas["WEBLib.StdCtrls"].$rtti["TLabel"]);
    $r.addField("switchSearch",pas["WEBLib.Buttons"].$rtti["TToggleButton"]);
    $r.addField("btnSearch",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("tmrImageCheck",pas["WEBLib.ExtCtrls"].$rtti["TTimer"]);
    $r.addField("divPhotoSlider",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("btnRelatives",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("WebHttpRequest1",pas["WEBLib.REST"].$rtti["THttpRequest"]);
    $r.addField("divBlockControls",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("btnBlockClose",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockZoomReset",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockZoomPlus",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockZoomMinus",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockPrevious",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockNext",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("divVideoSlider",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divBackgroundSlider",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divBlockData",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("btnBlockCount",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockLine",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("btnBlockTotal",pas["WEBLib.StdCtrls"].$rtti["TButton"]);
    $r.addField("divTopButtons",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divLinkSet1",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv4",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv5",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkFavourite",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv7",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkLoading",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkLogin",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv12",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv13",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divLinkSet2",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkList4",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkList3",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkList2",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkTour",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkLink",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkList1",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkEMail",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkRating",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divLinkSet4",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkWikiData",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkScore",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkTMDb",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkRottenTomatoes",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkMetaCritic",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkIMDb",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkWeb",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkGoogleImageSearch",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divLinkSet5",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkTwitter",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkInstagram",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkFacebook",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkModels",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkWikipedia",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkHeight",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkCitizenship",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkShare",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divPhotoHolder",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divPhoto",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divProgressSpinner",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divPhotoBorder",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divProgress",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("divLinkSet3",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv3",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv6",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv8",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv9",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv10",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv11",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("WebHTMLDiv14",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addField("linkPizza",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]);
    $r.addMethod("tmrImageCheckEnable",0,[]);
    $r.addMethod("WebFormCreate",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("CheckVersion",0,[],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("GetBirthDays",0,[["aMonth",rtl.longint],["aDay",rtl.longint]],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("GetDeathDays",0,[["aMonth",rtl.longint],["aDay",rtl.longint]],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("GetTop1000",0,[],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("GetReference",0,[["Reference",rtl.string]],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("GetAge",1,[["BirthDate",rtl.string],["CurrentDate",rtl.string]],rtl.longint);
    $r.addMethod("divPhotoClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("ShowViewer",0,[]);
    $r.addMethod("divViewerHolderClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("divNextBirthDayClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnBioClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnPhotoClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnVideoClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnBackgroundClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnConnectClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnSettingsClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("WebFormKeyDown",0,[["Sender",pas.System.$rtti["TObject"]],["Key",rtl.word,1],["Shift",pas.Classes.$rtti["TShiftState"]]]);
    $r.addMethod("SetBootstrapTooltip",0,[["button",pas["WEBLib.StdCtrls"].$rtti["TButton"]],["placement",rtl.string]]);
    $r.addMethod("SetBootstrapTooltipDiv",0,[["element",pas["WEBLib.WebCtrls"].$rtti["THTMLDiv"]],["hint",rtl.string],["placement",rtl.string]]);
    $r.addMethod("WebFormShow",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("tmrFocusTimer",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("tmrStartTimer",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnActorsClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnWritersClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnDirectorsClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnDiscordClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnDiscordLaunchClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("WebFormResize",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnTop1000Click",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("switchLimitDataClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnAboutClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("divPrevBirthDayClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("divPrevDeathDayClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("divNextDeathDayClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("divPrevReleaseDayClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("divNextReleaseDayClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("switchLimitDataTopClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnSearchClick",0,[["Sender",pas.System.$rtti["TObject"]]],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("edtSearchChange",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("tmrSearchTimer",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("edtSearchEnter",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("switchSearchClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("lblLimitDataTopClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("lblLimitDataClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("lblQuickSearchClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("tmrImageCheckTimer",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnRelativesClick",0,[["Sender",pas.System.$rtti["TObject"]]],null,16,{attr: [pas.JS.AsyncAttribute,"Create"]});
    $r.addMethod("btnSetRelatives",0,[["relative",rtl.longint],["name",rtl.string]]);
    $r.addMethod("btnBlockZoomPlusClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnBlockZoomMinusClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnBlockZoomResetClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnBlockPreviousClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
    $r.addMethod("btnBlockNextClick",0,[["Sender",pas.System.$rtti["TObject"]]]);
  });
  this.MainForm = null;
});
rtl.module("program",["System","WEBLib.Forms","WEBLib.Forms","Main"],function () {
  "use strict";
  var $mod = this;
  $mod.$main = function () {
    pas["WEBLib.Forms"].Application.Initialize();
    pas["WEBLib.Forms"].Application.FMainFormOnTaskBar = true;
    pas["WEBLib.Forms"].Application.CreateFormDirect(pas.Main.TMainForm,{p: pas.Main, get: function () {
        return this.p.MainForm;
      }, set: function (v) {
        this.p.MainForm = v;
      }});
    pas["WEBLib.Forms"].Application.Run();
  };
});
//# sourceMappingURL=ActoriousClient_1_0_3316.js.map
